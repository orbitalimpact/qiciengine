!function(a,b,c){"use strict";function d(){document.body.style.background="rgb(59, 60, 64)",qc.widget.List.prototype._selectBackground="#3e4b6b",qc.widget.List.prototype._labelColor="#caccd8",qc.widget.List.prototype._labelFont="13px Arial",qc.widget.List.prototype._labelSelectColor="#ceae37",qc.widget.List.prototype._inactiveSelectBackground="rgb(72, 72, 72)",qc.widget.Tree.prototype._labelColor="#caccd8",qc.widget.Tree.prototype._labelSelectColor="#ceae37",qc.widget.Tree.prototype._selectBackground="#3e4b6b",qc.widget.Tree.prototype._inactiveSelectBackground="rgb(72, 72, 72)",qc.widget.TextField.prototype._ninePatchImage="textfield.9",qc.widget.TextField.prototype._ninePatchBorder=[8,8,8,8],qc.widget.TextField.prototype._borderColor=null,qc.widget.TextField.prototype._padding=[1,2,1,2],qc.editor.Dialog.prototype._ninePatchImage="dialog.9",qc.editor.Dialog.prototype._ninePatchBorder=[50,10,10,10],qc.editor.Dialog.prototype._titleBackground=null,qc.editor.Dialog.prototype._titleColor="#fecb19",qc.editor.Dialog.prototype._titleFont="14px Arial",qc.editor.Dialog.prototype._htmlColor="#caccd8",qc.editor.Dialog.prototype._buttonNinePatchImage="dialog_button.9",qc.editor.Dialog.prototype._buttonNinePatchBorder=[10,10,10,10],qc.editor.Dialog.prototype._buttonActiveNinePatchImage="dialog_button_active.9",qc.editor.Dialog.prototype._buttonActiveNinePatchBorder=[10,10,10,10],qc.editor.Dialog.prototype._closeNinePatchImage="dialog.close.9",qc.editor.Dialog.prototype._closeNinePatchBorder=[13,13,13,13],qc.editor.Dialog.prototype._buttonColor="#caccd8",qc.editor.Dialog.prototype._closeIcon="dialogClose",qc.widget.ButtonBase.prototype._background="rgb(93, 93, 93)",qc.widget.ButtonBase.prototype._gradientColor="rgb(60, 60, 60)",qc.widget.ButtonBase.prototype._hoverBackground="rgb(93, 93, 93)",qc.widget.ButtonBase.prototype._hoverGradientColor="rgb(60, 60, 60)",qc.widget.ButtonBase.prototype._activeBackground="rgb(99, 99, 99)",qc.widget.ButtonBase.prototype._activeGradientColor="rgb(130, 130, 130)",qc.widget.ButtonBase.prototype._borderColor="rgb(32, 32, 32)",qc.widget.ButtonBase.prototype._textColor="rgb(177, 177, 177)",qc.widget.graph.GraphView.prototype._labelColor="#caccd8",qc.widget.graph.GraphView.prototype._labelSelectColor="#ceae37",qc.widget.graph.GraphView.prototype._selectBackground="#3e4b6b",qc.widget.graph.GraphView.prototype._inactiveSelectBackground="rgb(72, 72, 72)",qc.editor.InspectorButton.prototype._ninePatchImage="inspector_button.9",qc.editor.InspectorButton.prototype._ninePatchBorder=[10,10,10,10],qc.editor.InspectorButton.prototype._hoverNinePatchImage="inspector_button.9",qc.editor.InspectorButton.prototype._hoverNinePatchBorder=[10,10,10,10],qc.editor.InspectorButton.prototype._activeNinePatchImage="inspector_button_active.9",qc.editor.InspectorButton.prototype._activeNinePatchBorder=[10,10,10,10],qc.editor.InspectorButton.prototype._borderColor=0,qc.widget.ContextMenu.prototype._ninePatchImage="contextmenu.9",qc.widget.ContextMenu.prototype._ninePatchBorder=[16,16,16,16],qc.widget.ContextMenu.prototype._borderWidth=0,qc.widget.ContextMenu.prototype._borderColor="rgba(0, 0, 0, 0)",qc.widget.ContextMenu.prototype._labelColor="#caccd8",qc.widget.ContextMenu.prototype._hoverLabelColor="#ceae37",qc.widget.ContextMenu.prototype._hoverBackground="#3e4b6b",qc.widget.ContextMenu.prototype._borderColor="rgb(35, 35, 35)",qc.widget.Slider.prototype._background="rgb(32, 32, 32)",qc.widget.Slider.prototype._forecolor="rgb(32, 32, 32)",qc.widget.Slider.prototype._thumbBackground="rgb(60, 60, 60)",qc.widget.Slider.prototype._thumbGradientColor="rgb(93, 93, 93)",qc.widget.Slider.prototype._thumbGradient="linear.north",qc.widget.Slider.prototype._thumbBorderColor="rgb(32, 32, 32)",qc.editor.ProgressBar.prototype._textColor="#caccd8"}function e(){qc.widget.Container.prototype._background="rgb(38, 50, 56)",qc.widget.Button.prototype._textColor="#caccd8",qc.widget.Button.prototype._ninePatchImage="inspector_button.9",qc.widget.Button.prototype._ninePatchBorder=[8,8,8,8],qc.widget.Button.prototype._hoverNinePatchImage="inspector_button.9",qc.widget.Button.prototype._hoverNinePatchBorder=[8,8,8,8],qc.widget.Button.prototype._activeNinePatchImage="inspector_button_active.9",qc.widget.Button.prototype._activeNinePatchBorder=[8,8,8,8]}function f(){document.body.style.background="rgb(59, 60, 64)",k.Color.iconBackground="rgb(105, 105, 105)",k.Color.selectColor="rgba(0, 0, 0, 0)",k.Color.checkColor="#fff",k.Color.disabledBackground="rgba(255, 255, 255, 0.4)",qc.widget.Menu.prototype._ninePatchImage="menu.9",qc.widget.Menu.prototype._ninePatchBorder=[10,10,10,10],qc.widget.Menu.prototype._activeNinePatchImage="menu_active.9",qc.widget.Menu.prototype._activeNinePatchBorder=[10,10,10,10],qc.widget.Menu.prototype._hoverBackground=null,qc.widget.Menu.prototype._hoverGradientColor=null,qc.widget.Menu.prototype._labelColor="#caccd8",qc.widget.Menu.prototype._activeLabelColor="#caccd8",qc.widget.ContextMenu.prototype._ninePatchImage="contextmenu.9",qc.widget.ContextMenu.prototype._ninePatchBorder=[16,16,16,16],qc.widget.ContextMenu.prototype._borderWidth=0,qc.widget.ContextMenu.prototype._borderColor="rgba(0, 0, 0, 0)",qc.widget.ContextMenu.prototype._labelColor="#caccd8",qc.widget.ContextMenu.prototype._hoverLabelColor="#ceae37",qc.widget.ContextMenu.prototype._hoverBackground="#3e4b6b",qc.widget.ContextMenu.prototype._borderColor="rgb(35, 35, 35)",qc.widget.CheckBox.prototype._checkIcon="checkIcon",qc.widget.CheckBox.prototype._uncheckIcon="uncheckIcon",qc.widget.TextField.prototype._ninePatchImage="textfield.9",qc.widget.TextField.prototype._ninePatchBorder=[8,8,8,8],qc.widget.TextField.prototype._borderColor=null,qc.widget.TextField.prototype._textColor="#060a0b",qc.editor.DropDownList.prototype._ninePatchImage="textfield.9",qc.editor.DropDownList.prototype._ninePatchBorder=[8,8,8,8],qc.editor.DropDownList.prototype._borderWidth=0,qc.editor.DropDownList.prototype._textColor="#060a0b",qc.editor.DropDownList.prototype._dropDownBackground="rgb(56, 56, 56)",qc.editor.DropDownList.prototype._filterColor="rgb(220, 220, 220)",qc.editor.DropDownList.prototype._iconBackground="rgb(246, 247, 249)",qc.widget.Slider.prototype._background="rgb(32, 32, 32)",qc.widget.Slider.prototype._forecolor="rgb(32, 32, 32)",qc.widget.Slider.prototype._thumbBackground="rgb(60, 60, 60)",qc.widget.Slider.prototype._thumbGradientColor="rgb(93, 93, 93)",qc.widget.Slider.prototype._thumbGradient="linear.north",qc.widget.Slider.prototype._thumbBorderColor="rgb(32, 32, 32)",qc.widget.ButtonBase.prototype._background="rgb(93, 93, 93)",qc.widget.ButtonBase.prototype._gradientColor="rgb(60, 60, 60)",qc.widget.ButtonBase.prototype._hoverBackground="rgb(93, 93, 93)",qc.widget.ButtonBase.prototype._hoverGradientColor="rgb(60, 60, 60)",qc.widget.ButtonBase.prototype._activeBackground="rgb(99, 99, 99)",qc.widget.ButtonBase.prototype._activeGradientColor="rgb(130, 130, 130)",qc.widget.ButtonBase.prototype._borderColor="rgb(32, 32, 32)",qc.widget.ButtonBase.prototype._textColor="rgb(177, 177, 177)",qc.editor.PreviewView.prototype._ninePatchImage="preview.9",qc.editor.PreviewView.prototype._ninePatchBorder=[32,40,32,40],qc.editor.InspectorButton.prototype._ninePatchImage="inspector_button.9",qc.editor.InspectorButton.prototype._ninePatchBorder=[10,10,10,10],qc.editor.InspectorButton.prototype._hoverNinePatchImage="inspector_button.9",qc.editor.InspectorButton.prototype._hoverNinePatchBorder=[10,10,10,10],qc.editor.InspectorButton.prototype._activeNinePatchImage="inspector_button_active.9",qc.editor.InspectorButton.prototype._activeNinePatchBorder=[10,10,10,10],qc.editor.InspectorButton.prototype._borderColor=0,qc.editor.ProgressBar.prototype._textColor="#caccd8",qc.editor.Text.prototype._textColor="#caccd8",qc.widget.Label.prototype._textColor="#caccd8",qc.widget.Tree.prototype._labelColor="#caccd8",qc.widget.Tree.prototype._labelSelectColor="#ceae37",qc.widget.Tree.prototype._selectBackground="#3e4b6b",qc.widget.Tree.prototype._inactiveSelectBackground="rgb(72, 72, 72)",qc.widget.List.prototype._labelColor="#caccd8",qc.widget.List.prototype._labelSelectColor="#ceae37",qc.widget.List.prototype._selectBackground="#3e4b6b",qc.widget.List.prototype._inactiveSelectBackground="rgb(72, 72, 72)",qc.widget.graph.GraphView.prototype._labelColor="#caccd8",qc.widget.graph.GraphView.prototype._labelSelectColor="#ceae37",qc.widget.graph.GraphView.prototype._selectBackground="#3e4b6b",qc.widget.graph.GraphView.prototype._inactiveSelectBackground="rgb(72, 72, 72)",qc.widget.ColorChooser.prototype._background="rgb(49, 49, 49)",qc.widget.ColorChooser.prototype._color="rgb(177, 177, 177)",qc.widget.ColorChooser.prototype._shadow=!1,qc.widget.ColorChooser.prototype._thumbBorderColor="white",qc.widget.ColorChooser.prototype._titleColor="black",qc.widget.layout.BorderLayout.prototype._splitterColor="rgb(100, 101, 105)",qc.widget.layout.BorderLayout.prototype._toggleIconBackground="rgb(49, 49, 49)",qc.widget.layout.SplitLayout.prototype._splitterColor="rgb(100, 101, 105)",qc.widget.Tabs.prototype._titleBackground="#27282c",qc.widget.Tabs.prototype._tabNinePatchImage="tab.9",qc.widget.Tabs.prototype._tabNinePatchBorder=[10,10,10,10],qc.widget.Tabs.prototype._tabActiveNinePatchImage="tab.9",qc.widget.Tabs.prototype._tabActiveNinePatchBorder=[10,10,10,10],qc.widget.Tabs.prototype._labelColor="#ebd541",qc.widget.Tabs.prototype._borderWidth=0,qc.widget.Tabs.prototype._splitterColor="rgba(0, 0, 0, 0)",qc.editor.Dialog.prototype._ninePatchImage="dialog.9",qc.editor.Dialog.prototype._ninePatchBorder=[50,10,10,10],qc.editor.Dialog.prototype._titleBackground=null,qc.editor.Dialog.prototype._titleColor="#fecb19",qc.editor.Dialog.prototype._titleFont="14px Arial",qc.editor.Dialog.prototype._htmlColor="#caccd8",qc.editor.Dialog.prototype._buttonNinePatchImage="dialog_button.9",qc.editor.Dialog.prototype._buttonNinePatchBorder=[10,10,10,10],qc.editor.Dialog.prototype._buttonActiveNinePatchImage="dialog_button_active.9",qc.editor.Dialog.prototype._buttonActiveNinePatchBorder=[10,10,10,10],qc.editor.Dialog.prototype._closeNinePatchImage="dialog.close.9",qc.editor.Dialog.prototype._closeNinePatchBorder=[13,13,13,13],qc.editor.Dialog.prototype._buttonColor="#caccd8",qc.editor.Dialog.prototype._closeIcon="dialogClose",qc.editor.FrameList.prototype._background="rgb(65, 65, 65)",qc.editor.FrameList.prototype._borderColor="rgb(32, 32, 32)",qc.editor.ResourceList.prototype._background="rgb(65, 65, 65)",qc.editor.ResourceList.prototype._borderColor="rgb(32, 32, 32)",qc.editor.ObjectSelectPane.prototype._background="rgb(59, 60, 64)",qc.widget.ComboBox.prototype._border="1px solid rgb(32, 32, 32)",qc.widget.ComboBox.prototype._background="rgb(65, 65, 65)",Ma.prototype._background=null,Ma.prototype._gradientColor=null,Ma.prototype.titleNinePatchImage="panel_title.9",Ma.prototype.titleNinePatchBorder=[5,5,5,5],Ma.prototype.titleTextNinePatchImage="panel_title_text.9",Ma.prototype.titleTextNinePatchBorder=[10,10,10,10],Ma.prototype._titleColor="rgb(177, 177, 177)",Ma.prototype._titleLineColor="rgb(89, 89, 89)",qc.editor.InspectorList.prototype._background="rgb(65, 65, 65)",qc.editor.InspectorList.prototype._borderColor="rgb(32, 32, 32)",qc.editor.FilterList.prototype._background="rgb(65, 65, 65)",qc.editor.FilterList.prototype._borderColor="rgb(32, 32, 32)",qc.editor.Painter.prototype._background="rgb(65, 65, 65)",qc.editor.Painter.prototype._borderColor="rgb(32, 32, 32)",qc.editor.ProgressBar.prototype._background=null,qc.editor.LeftBanner.prototype._ninePatchImage="banner_background.9",qc.editor.LeftBanner.prototype._ninePatchBorder=[8,4,8,4],qc.editor.RunBanner.prototype._ninePatchImage="banner_background.9",qc.editor.RunBanner.prototype._ninePatchBorder=[8,4,8,4],qc.editor.MiddleBanner.prototype._ninePatchImage="banner_background.9",qc.editor.MiddleBanner.prototype._ninePatchBorder=[8,4,8,4],qc.editor.RightBanner.prototype._ninePatchImage="banner_background.9",qc.editor.RightBanner.prototype._ninePatchBorder=[8,4,8,4],qc.editor.AnchorPresetsView.prototype._background="rgb(45, 45, 45)",qc.editor.AnchorPresetsView.prototype._titleBackground="rgb(49, 49, 49)",qc.editor.AnchorPresetsView.prototype._borderColor="rgb(110, 110, 110)",qc.editor.AnchorButton.prototype._labelColor="rgb(177, 177, 177)",qc.editor.AnchorButton.prototype._imageBackground="rgb(61, 61, 61)",qc.editor.CurveButton.prototype._imageBackground="rgb(61, 61, 61)",qc.editor.CurveButton.prototype._imageBorderColor="rgb(32, 32, 32)",qc.editor.ComponentsPanel.prototype._background="rgb(49, 49, 49)",qc.editor.ComponentsPanel.prototype._titleBackground="rgb(63, 63, 63)",qc.editor.ComponentsPanel.prototype._borderColor="rgb(110, 110, 110)",qc.editor.AddComponentButton.prototype._ninePatchImage="inspector_button.9",qc.editor.AddComponentButton.prototype._ninePatchBorder=[10,10,10,10],qc.editor.AddComponentButton.prototype._hoverNinePatchImage="inspector_button.9",qc.editor.AddComponentButton.prototype._hoverNinePatchBorder=[10,10,10,10],qc.editor.AddComponentButton.prototype._activeNinePatchImage="inspector_button_active.9",qc.editor.AddComponentButton.prototype._activeNinePatchBorder=[10,10,10,10],qc.editor.AddComponentButton.prototype._borderWidth=0;var a="rgba(153, 153, 155, 0.5)";qc.widget.List.prototype._scrollBarColor=a,qc.widget.Tree.prototype._scrollBarColor=a,qc.widget.graph.GraphView.prototype._scrollBarColor=a,qc.widget.Container.prototype._scrollBarColor=a,fa.menu.view.style.background="#212025",fa.leftBanner.view.style.background="#212025",fa.runBanner.view.style.background="#212025",fa.middleBanner.view.style.background="#212025",fa.rightBanner.view.style.background="#212025",fa.leftBanner.findViewById("editMode").ninePatchImage="banner_button.9",fa.leftBanner.findViewById("editMode").ninePatchBorder=[8,8,8,8],fa.leftBanner.findViewById("sceneHandler").ninePatchImage="banner_button.9",fa.leftBanner.findViewById("sceneHandler").ninePatchBorder=[8,8,8,8],fa.project.layout.topSplitterColor="url("+fa.assetSkinPath+"projectSplitter.png)",fa.hierarchyContainer.layout.topSplitterColor="url("+fa.assetSkinPath+"projectSplitter.png)",fa.inspector.layout.splitterColor="url("+fa.assetSkinPath+"panel_title.9.png)",fa.mainContainer.iv(!0)}function g(){}function h(){}function i(){}if(!qc.editor){qc.editor={},qc.editor.gui={};var j=2*Math.PI,k=qc.widget.Default,l=k.devicePixelRatio,m=k.define,n=k.layout,o=k.inflate,p=k.createDiv,q=k.createCanvas,r=k.removeHTML,s=k.initContext,t=k.setCanvas,u=k.unionPoint,v=k.containsPoint,w=k.intersectionLineRect,x=k.intersectionLineLine,y=k.getDistance,z=k.startDragging,A=k.isDragging,B=k.getClientPoint,C=k.getPagePoint,D=k.isSelectAll,E=k.isDelete,F=k.isEsc,G=k.isEnter,H=k.isLeft,I=k.isRight,J=k.isUp,K=k.isDown,L=k.isDoubleClick,M=k.getTouchCount,N=k.isLeftButton,O=k.isShiftDown,P=k.isCtrlDown,Q=k.initDash,R=k.restoreDash,S=k.drawText,T=k.drawArc,U=k.callLater,V=k.createAnim,W=k.startAnim,X=k.timeNow,Y=k.preventDefault,Z=k.isMac,$=(a&&a.process&&a.process.versions.electron,function(b,d){d=d||a;var e,f,g=decodeURIComponent(d.location.search.substring(1)),h=g.split("&");for(f=0;f<h.length;f++)if(e=h[f].split("="),e[0]===b)return e[1]===c?!0:e[1]}),_=qc.editor.gui;qc.editor.VERSION="1.0.3",qc.editor.version={latestVersion:{}},qc.editor.version.showUpdateDialog=function(){qc.editor._progressUpdateDialog&&qc.editor._progressUpdateDialog.visible||nb(fa._("A new version of QICI Engine is available!"),fa._("Update Info"),[{text:fa._("Update"),key:"enter",onClick:function(){qc.editor.version.updateVersion(),this.hide()}},{text:fa._("Cancel"),key:"esc",onClick:function(){this.hide()}}])},qc.editor.version.updateVersion=function(){qc.editor.Operation.UPDATE_VERSION(function(a){fa.notification.info(0!==a.result?fa._("You are using the latest version."):fa._("Begin to update..."))})},qc.editor.version.showProgressUpdateDialog=function(){if(qc.editor.__updateFailedDialog&&qc.editor.__updateFailedDialog.visible)return null;if(!qc.editor._progressUpdateDialog){var a=qc.editor._progressUpdateDialog=new qc.editor.ProgressDialog;a.title=fa._("Update version"),a.modal=!0,a.width=300,a.height=100,a.tools=[],a.show()}return qc.editor._progressUpdateDialog.visible||qc.editor._progressUpdateDialog.show(),qc.editor._progressUpdateDialog},qc.editor.version.progressUpdateDialog=function(a,b){var c=qc.editor.version.showProgressUpdateDialog();c&&(c.progressBar.percent=a,c.progressBar.text=b)},qc.editor.version.showUpdateFailed=function(a){if(qc.editor._progressUpdateDialog&&qc.editor._progressUpdateDialog.hide(),qc.editor.__updateFailedDialog)qc.editor.__updateFailedDialog.show(),qc.editor.__updateFailedDialog.requestFocus();else{var b;switch(a){case-2:b=fa._("Download failed, please try again.");break;case-1:default:b=fa._("Failed to update, please make sure no files are occupied by other process.")}qc.editor.__updateFailedDialog=nb(b,fa._("Confirm"),[{text:fa._("OK"),key:"enter",onClick:function(){this.hide()}}])}},qc.editor.version.showUpdateFinished=function(){qc.editor._progressUpdateDialog&&qc.editor._progressUpdateDialog.hide(),nb(fa._("The update is completed, and refresh to load the new version?"),fa._("Confirm"),[{text:fa._("Refresh"),key:"enter",onClick:function(){this.hide(),a.location.reload(!0)}},{text:fa._("Cancel"),key:"esc",onClick:function(){this.hide()}}])},qc.editor.version.checkLatestUpdates=function(){var a=qc.editor,b=qc.editor.version.latestVersion;a.Operation.CHECK_FOR_UPDATES(!1,function(c){a.version.mixin(c,b),a.version.versionCompare(qc.editor.VERSION,b.editor)<0&&qc.editor.version.showUpdateDialog()})},qc.editor.version.versionCompare=function(a,b){if("string"!=typeof a||"string"!=typeof b)return 1;for(var c=a.split("."),d=b.split("."),e=Math.max(c.length,d.length),f=0;e>f;++f){var g=c[f]?parseInt(c[f]):0,h=d[f]?parseInt(d[f]):0;if(g!==h)return g-h}return 0},qc.editor.version.mixin=function(a,b){if(!a||"object"!=typeof a)return b;for(var c in a){var d=typeof a[c],e=a[c];b[c]=a[c]&&"object"===d?typeof b[c]===d?qc.editor.version.mixin(a[c],b[c]):qc.editor.version.mixin(a[c],new e.constructor):a[c]}return b},qc.editor.version.archiveVersion=function(a){qc.editor.Operation.ARCHIVE_VERSION(a,function(){})},_._containers=[],_.titleLine=function(a,b,c){var d=_._containers,e=d[d.length-1],f={cells:[]},g=[];0===e.length&&(f.widths=_.columnWidths);var h=new qc.widget.Label({text:a,align:"left",iconWidth:12,iconHeight:12,padding:0,icon:b?"collapse":"expand"});if(h._expand=!b,c){f.cells.push({colspan:_.columnWidths.length-(c._layoutConfig.colspan||0),fill:"none",element:h});var i=c._layoutConfig;delete c._layoutConfig,i.element=c,f.cells.push(i)}else f.cells.push({colspan:_.columnWidths.length,fill:"none",element:h});return e.push(f),h.addEventListener("click",function(){h._expand=!h._expand,h.icon=h._expand?"expand":"collapse";for(var a=h;a&&!(a instanceof qc.widget.Container&&a.layout instanceof qc.widget.layout.TableLayout);)a=a.parent;if(a)for(var b=0;b<g.length;b++)h._expand?a.layout.showRow(g[b]):a.layout.hideRow(g[b])}),{get toolTip(){return h.toolTip},set toolTip(a){a?h.enableToolTip():h.disableToolTip(),h.toolTip=a},index:e.length-1,add:function(a){var c=a.index;a=d[d.length-1][c],a.visible=!b,g.push(c)}}},_.line=function(a,b){var d=_._containers,e=d[d.length-1],f={cells:[]};null!=b&&(f.height=b),0===e.length&&(f.widths=_.columnWidths);for(var g=0;g<a.length;g++){var h=a[g],i=h._layoutConfig;0===g&&i&&i.cellPadding===c&&(i.cellPadding=[1,1,1,15]),f.cells.push(i),delete h._layoutConfig}return e.push(f),{index:e.length-1}},_.divider=function(a,b){var c=new qc.editor.Divider;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.label=function(a,b,c){var d=new qc.editor.Label;c=c||{},c.element=d,d._layoutConfig=c,d.text=a;for(var e in b)d[e]=b[e];return d},_.text=function(a,b,c){var d=new qc.editor.Text;c=c||{},c.element=d,d._layoutConfig=c,d.text=a;for(var e in b)d[e]=b[e];return d},_.empty=function(a){var b={};return a=a||{},a.element=null,b._layoutConfig=a,b},_.comp=function(a,b,c){c=c||{},c.element=a,a._layoutConfig=c;for(var d in b)a[d]=b[d];return a},_.button=function(a,b,c){var d=new qc.editor.InspectorButton;c=c||{},c.element=d,d._layoutConfig=c,d.text=a;for(var e in b)d[e]=b[e];return d},_.curveButton=function(a,b){var c=new qc.editor.CurveButton;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.buttonGroup=function(a,b,c){var d=new qc.editor.ButtonGroup;if(c=c||{},c.element=d,d._layoutConfig=c,a){for(var e=[],f=0;f<a.length;f++){var g=new qc.widget.ToggleButton(a[f]);e.push(g)}d.setItems(e)}for(var h in b)d[h]=b[h];return d},_.imageList=function(a,b){var c=new qc.editor.ImageList;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.painter=function(a,b){var c=new qc.editor.Painter;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.stringInput=function(a,b){var c=new qc.editor.StringInput;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.objectInput=function(a,b){var c,d=a.objectType;null==a.targetField&&(a.targetField=a.bind),c="texture"===d?_._textureInput(a):"font"===d||"bitmapFont"===d?_._fontInput(a):"allFont"===d?_._allFontInput(a):"sound"===d?_._soundInput(a):"textAsset"===d?_._textAssetInput(a):"excelAsset"===d?_._excelAssetInput(a):"prefab"===d?_._prefabInput(a):"node"===d?_._nodeInput(a):new qc.editor.ObjectInput,b=b||{},b.element=c,c._layoutConfig=b;for(var e in a)c[e]=a[e];return c},_._textureInput=function(a){var b=a.onValueChanged,c=a.targetField,d=a.target;delete a.onValueChanged;var e=new Ca(a),f=function(a){var b=a.view;if(b instanceof Gd){var c=a.view.draggingData;if(!c)return;if(!(c instanceof qc.editor.FileNode))return;var d=(c.master||c).treeData.resUUID,e=fa.game.assets.find(d);if(!(e instanceof qc.Atlas))return;return!0}};e.objectInput.handleCrossDrag=function(a,b,c){if("exit"===b||"cancel"===b)e.resetNinePatchImage();else if("enter"===b)f(c)&&(e._objectInput.ninePatchImage="textfield_active.9",e._objectInput.ninePatchBorder=[10,10,10,10]);else if("drop"===b&&f(c)){var d=c.view.draggingData,g=(d.master||d).treeData.resUUID,h=fa.game.assets.find(g);e.resetNinePatchImage(),e.setTextureObjectValue(h,d.master?d.name:null,!0)}};var g;return c.indexOf("/")>0&&(g=c.substring(c.indexOf("/")+1),c=c.substring(0,c.indexOf("/"))),g?e.setTextureObjectValue(d[c],d[g]):e.setTextureObjectValue(d[c]),e.onValueChanged=b,e},_._allFontInput=function(a){var b=a.onValueChanged,c=a.targetField,d=a.target;delete a.onValueChanged;var e=new Ca(a),f=function(a){var b=a.view;if(b instanceof Gd){var c=a.view.draggingData;if(!c)return;if(c.master)return;if(!(c instanceof qc.editor.FileNode))return;var d=c.treeData.resUUID,e=fa.game.assets.find(d);if(!(e instanceof qc.Font))return;return!0}};e.objectInput.handleCrossDrag=function(a,b,c){if("exit"===b||"cancel"===b)e.resetNinePatchImage();else if("enter"===b)f(c)&&(e._objectInput.ninePatchImage="textfield_active.9",e._objectInput.ninePatchBorder=[10,10,10,10]);else if("drop"===b&&f(c)){var d=c.view.draggingData,g=d.treeData.resUUID,h=fa.game.assets.find(g);e.resetNinePatchImage(),e.setObjectValue(h,!0)}};var g=d[c];return e.setObjectValue(g),e.onValueChanged=b,e},_._fontInput=function(a){var b=a.onValueChanged,c=a.targetField,d=a.target;delete a.onValueChanged;var e=new Ca(a),f="bitmapFont"===a.objectType?qc.UIText.BITMAPFONT:qc.UIText.WEBFONT,g=function(a){var b=a.view;if(b instanceof Gd){var c=a.view.draggingData;if(!c)return;if(c.master)return;if(!(c instanceof qc.editor.FileNode))return;var d=c.treeData.resUUID,e=fa.game.assets.find(d);if(!(e instanceof qc.Font))return;if(e._fontFamily!==f)return;return!0}};e.objectInput.handleCrossDrag=function(a,b,c){if("exit"===b||"cancel"===b)e.resetNinePatchImage();else if("enter"===b)g(c)&&(e._objectInput.ninePatchImage="textfield_active.9",e._objectInput.ninePatchBorder=[10,10,10,10]);else if("drop"===b&&g(c)){var d=c.view.draggingData,f=d.treeData.resUUID,h=fa.game.assets.find(f);e.resetNinePatchImage(),e.setObjectValue(h,!0)}};var h=d[c];return e.setObjectValue(h),e.onValueChanged=b,e},_._soundInput=function(a){var b=a.onValueChanged,c=a.targetField,d=a.target;delete a.onValueChanged;var e=new Ca(a),f=function(a){var b=a.view;if(b instanceof Gd){var c=a.view.draggingData;if(!c)return;if(c.master)return;if(!(c instanceof qc.editor.FileNode))return;var d=c.treeData.resUUID,e=fa.game.assets.find(d);if(!(e instanceof qc.SoundAsset))return;return!0}};e.objectInput.handleCrossDrag=function(a,b,c){if("exit"===b||"cancel"===b)e.resetNinePatchImage();else if("enter"===b)f(c)&&(e._objectInput.ninePatchImage="textfield_active.9",e._objectInput.ninePatchBorder=[10,10,10,10]);else if("drop"===b&&f(c)){var d=c.view.draggingData,g=d.treeData.resUUID,h=fa.game.assets.find(g);e.resetNinePatchImage(),e.setObjectValue(h,!0)}};var g=d[c];return e.setObjectValue(g),e.onValueChanged=b,e},_._textAssetInput=function(a){var b=a.onValueChanged,c=a.targetField,d=a.target;delete a.onValueChanged;var e=new Ca(a),f=function(a){var b=a.view;if(b instanceof Gd){var c=a.view.draggingData;if(!c)return;if(c.master)return;if(!(c instanceof qc.editor.FileNode))return;var d=c.treeData.resUUID,e=fa.game.assets.find(d);if(!(e instanceof qc.TextAsset))return;return!0}};e.objectInput.handleCrossDrag=function(a,b,c){if("exit"===b||"cancel"===b)e.resetNinePatchImage();else if("enter"===b)f(c)&&(e._objectInput.ninePatchImage="textfield_active.9",e._objectInput.ninePatchBorder=[10,10,10,10]);else if("drop"===b&&f(c)){var d=c.view.draggingData,g=d.treeData.resUUID,h=fa.game.assets.find(g);e.resetNinePatchImage(),e.setObjectValue(h,!0)}};var g=d[c];return e.setObjectValue(g),e.onValueChanged=b,e},_._excelAssetInput=function(a){var b=a.onValueChanged,c=a.targetField,d=a.target;delete a.onValueChanged;var e=new Ca(a),f=function(a){var b=a.view;if(b instanceof Gd){var c=a.view.draggingData;if(!c)return;if(c.master)return;if(!(c instanceof qc.editor.FileNode))return;var d=c.treeData.resUUID,e=fa.game.assets.find(d);if(!(e instanceof qc.ExcelAsset))return;return!0}};e.objectInput.handleCrossDrag=function(a,b,c){if("exit"===b||"cancel"===b)e.resetNinePatchImage();else if("enter"===b)f(c)&&(e._objectInput.ninePatchImage="textfield_active.9",e._objectInput.ninePatchBorder=[10,10,10,10]);else if("drop"===b&&f(c)){var d=c.view.draggingData,g=d.treeData.resUUID,h=fa.game.assets.find(g);e.resetNinePatchImage(),e.setObjectValue(h,!0)}};var g=d[c];return e.setObjectValue(g),e.onValueChanged=b,e},_._prefabInput=function(a){var b=a.onValueChanged,c=a.targetField,d=a.target;delete a.onValueChanged;var e=new Ca(a),f=function(a){var b=a.view;if(b instanceof Gd){var c=a.view.draggingData;if(!c)return;if(c.master)return;if(!(c instanceof qc.editor.FileNode))return;var d=c.treeData.resUUID,e=fa.game.assets.find(d);if(!(e instanceof qc.Prefab))return;return!0}};return e.objectInput.handleCrossDrag=function(a,b,c){if("exit"===b||"cancel"===b)e.resetNinePatchImage();else if("enter"===b)f(c)&&(e._objectInput.ninePatchImage="textfield_active.9",e._objectInput.ninePatchBorder=[10,10,10,10]);else if("drop"===b&&f(c)){var d=c.view.draggingData,g=d.treeData.resUUID,h=fa.game.assets.find(g);e.resetNinePatchImage(),e.setObjectValue(h,!0)}},e.onValueChanged=b,e.setObjectValue(d[c]),e},_._nodeInput=function(a){var b=a.onValueChanged,c=a.targetField,d=a.target,e=a.nodeType||qc.Node;delete a.onValueChanged;var f=new Ca(a),g=d[c];f.setObjectValue(g);var h=function(a){var b=a.view.draggingData;return b=b.node,b instanceof e?!0:void 0};return f.objectInput.handleCrossDrag=function(a,b,c){if("exit"===b||"cancel"===b)f.resetNinePatchImage();else if("enter"===b)h(c)&&(f._objectInput.ninePatchImage="textfield_active.9",f._objectInput.ninePatchBorder=[10,10,10,10]);else if("drop"===b&&h(c)){var d=c.view.draggingData.node;f.resetNinePatchImage(),f.setObjectValue(d,!0)}},f.onValueChanged=b,f},_.textArea=function(a,b){var c=new qc.editor.TextAreaContainer;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.numberInput=function(a,b){var c=new qc.editor.NumberInput;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.angleInput=function(a,b){var c=new qc.editor.AngleInput;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.sliderInput=function(a,b){var c=new qc.editor.SliderInput(a);b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.intInput=function(a,b){var c=new qc.editor.IntInput;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.checkBox=function(a,b){var c=new qc.editor.CheckBox;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.toggleButton=function(a,b){var c=new qc.editor.ToggleButton;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.dropDownList=function(a,b){var c=new qc.editor.DropDownList;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.multiDropDownList=function(a,b){var c=new qc.editor.MultiDropDownList;b=b||{},b.element=c,c._layoutConfig=b;for(var d in a)c[d]=a[d];return c},_.colorPicker=function(a,b){var c,d={};a&&null!=a["dropDown.colorChooser.alphaEnabled"]?(c=a["dropDown.colorChooser.alphaEnabled"],delete a["dropDown.colorChooser.alphaEnabled"]):c=!0,d["dropDown.colorChooser.alphaEnabled"]=c;var e=new qc.editor.ColorPicker(d);b=b||{},b.element=e,e._layoutConfig=b;for(var f in a)e[f]=a[f];return e},b.defineProperty(_,"containers",{get:function(){var a=this._containers;return this._columnWidths=[],this._containers=[],a}}),b.defineProperty(_,"columnWidths",{get:function(){return this._columnWidths},set:function(a){this._columnWidths=a,this._containers.push([])}}),qc.editor.InspectorTips={"CNode.uuid":{zh:"对象的唯一标识符 ",en:"Unique identity of the node. "},"CNode.name":{zh:"节点的名字 ",en:"The node's name. "},"CNode.ignoreDestroy":{zh:"节点及其孩子在切换场景时不会被析构。一定要置于根节点才起效 ",en:"Makes the object target not be destroyed automatically when loading a new scene. "},"CNode.alpha":{zh:"透明度值，0 - 1 ",en:"The node's alpha: 0 - 1 "},"CNode.visible":{zh:"是否可见，注意 visible 为 false 时则所有孩子都不显示，visible 为 true 的时则使用孩子们自己的 visible；另外 visiable 为 false 时连 transform 都不再更新计算 ",en:"The visible state of the node. Non-visible nodes and all of their children are not rendered. "},"CNode.parent":{zh:"父亲节点 ",en:"The parent of the node. "},"CNode.worldVisible":{zh:"只读，节点最终的 visible ",en:"Read only. Indicates if the node is globally visible. "},"CNode.mask":{zh:"遮罩，必须为 PIXI.Graphics 对象 ",en:"Set mask, must be PIXI.Graphics "},"CNode.children":{zh:"只读，儿子列表 ",en:"Read only. The list of the node' children. "},"CNode.colorTint":{zh:"混合颜色 ",en:"The tint applied to the node. "},"CNode.scripts":{zh:"只读。挂载的逻辑脚本列表 ",en:"Read only. The list of the components that this node attacks. "},"CNode.x":{zh:"本地 x 坐标（相对于父节点） ",en:"X position of the transform relative to the parent transform. "},"CNode.y":{zh:"本地 y 坐标（相对于父节点） ",en:"Y position of the transform relative to the parent transform. "},"CNode.anchoredX":{zh:"相对于父亲anchor的X偏移量。UI中大部分使用此属性，而不是x属性。 ",en:"The x position of the pivot of this RectTransform relative to the anchor reference point. "},"CNode.anchoredY":{zh:"相对于父亲anchor的Y偏移量。UI中大部分使用此属性，而不是y属性。 ",en:"The y position of the pivot of this RectTransform relative to the anchor reference point. "},"CNode.scaleX":{zh:"节点在 X 轴上的缩放 ",en:"The scale.x of the transform relative to the parent. "},"CNode.scaleY":{zh:"节点在 Y 轴上的缩放 ",en:"The scale.y of the transform relative to the parent. "},"CNode.pivotX":{zh:"节点自身的原点X位置（0为左边，1为右边） ",en:"The x normalized position in this RectTransform that it rotates around. "},"CNode.pivotY":{zh:"节点自身的原点Y位置（0为上边，1为下边） ",en:"The y normalized position in this RectTransform that it rotates around. "},"CNode.rotation":{zh:"旋转角度。在代码中，使用弧度为单位。在编辑器的Inspector面板中，使用弧度为单位。 ",en:"The rotation of the transform relative to the parent transform's rotation. "},"CNode.width":{zh:"节点的宽度 ",en:"The width of node. "},"CNode.height":{zh:"节点的高度 ",
en:"The height of node. "},"CNode.minAnchor":{zh:"只读，定位矩形左上角的坐标（相对于父亲长宽的比例值），请使用方法 setAnchor 进行设置。",en:"Read only. The normalized position in the parent RectTransform that the lower left corner is anchored to. Call setAnchor to set minAnchor."},"CNode.maxAnchor":{zh:"只读，定位矩形右下角的坐标（相对于父亲长宽的比例值），请使用方法 setAnchor 进行设置。 ",en:"Read only. The normalized position in the parent RectTransform that the upper right corner is anchored to. Call setAnchor to set maxAnchor. "},"CNode.left":{zh:"距离左边的位置（如果minAnchor.x = maxAnchor.x，此时不起效） ",en:"Distance left relative to the parent transform. "},"CNode.right":{zh:"距离右边的位置（如果minAnchor.x = maxAnchor.x，此时不起效） ",en:"Distance right relative to the parent transform. "},"CNode.top":{zh:"距离上边的位置（如果minAnchor.y = maxAnchor.y，此时不起效） ",en:"Distance top relative to the parent transform. "},"CNode.bottom":{zh:"距离下边的位置（如果minAnchor.y = maxAnchor.y，此时不起效） ",en:"Distance bottom relative to the parent transform. "},"CNode.rect":{zh:"相对父亲节点的矩形包围盒 ",en:"The calculated rectangle in the local space of the Transform. "},"CNode.worldTransform":{zh:"在世界中的最终变换矩阵 ",en:"Current transform of the object based on world (parent) factors "},"CNode.localBounds":{zh:"节点自身的显示范围 ",en:"Retrieves the local bounds of the node as a rectangle object "},"CNode.onRelayout":{zh:"节点重新布局的事件通知 ",en:"When transform changed, this event is triggered. "},"CNode.interactive":{zh:"节点是否允许交互（即：是否有能力接受输入事件） ",en:"Can pick up mouse / touch events? "},"CNode.hitArea":{zh:"碰撞区域 ",en:"This is the defined area that will pick up mouse / touch events. It is null by default. "},"CNode.onDown":{zh:"按下的事件 ",en:"When pointer pressed, this event is triggered. "},"CNode.onUp":{zh:"松开的事件 ",en:"When pointer released, this event is triggered. "},"CNode.onClick":{zh:"点击的事件 ",en:"When the node is click, this event is triggered. "},"CNode.onDragStart":{zh:"拖拽开始事件 ",en:"When starting a drag operation, onDragStart is called.  "},"CNode.onDrag":{zh:"拖拽事件，每帧触发 ",en:"When dragging, onDrag is called. "},"CNode.onDragEnd":{zh:"拖拽结束事件 ",en:"When ending a drag operation, onDragEnd is called. "},"CNode.onDragDrop":{zh:"拖拽放下事件（目标节点触发） ",en:"When dropped, onDragDrop is called. "},"CNode.onWheel":{zh:"滚轮事件 ",en:"When mouse wheels, onWheel is called. "},"CNode.onEnter":{zh:"光标进入事件 ",en:"When mouse enters, onEnter is called. "},"CNode.onExit":{zh:"光标移出事件 ",en:"When mouse exits, onExit is called. "},"CNode.Variable":{en:"Description     "},"CUIImage.texture":{zh:"图片资源或图集 ",en:"The texture altas used for UIImage. "},"CUIImage.frame":{zh:"具体的图片帧，在 texture 为图集的时候，可以指定该 frame 表示子图片，如果是普通图片而不是图集，frame设置无效（默认为 0） ",en:"The frame's name in the texture atlas. "},"CUIImage.nativeSize":{zh:"只读，图片原始大小（不带任何缩放） ",en:"Read only. The frame's size. "},"CUIImage.imageType":{zh:"图片显示的方式，包含三种：UIImage.IMAGE_TYPE_SIMPLE（简单缩放）、UIImage.IMAGE_TYPE_SLICED（九宫格缩放）、UIImage.IMAGE_TYPE_TILED（九宫格平铺），详见 UIImage.imageType ",en:"How the Image is draw: UIImage.IMAGE_TYPE_SIMPLE, UIImage.IMAGE_TYPE_SLICED, UIImage.IMAGE_TYPE_TILED. See: UIImage.imageType "},"CUIImage.Variable":{en:"Description           "},"CSprite.animationNameList":{zh:"只读，当前资源的动作名列表 ",en:"Read only. The list of animation names. "},"CSprite.animationType":{zh:"只读，动画的类型（Sprite.NONE_ANIMATION，Sprite.FRAME_ANIMATION，Sprite.DRAGON_BONES，Sprite.FRAME_SAMPLES) ",en:"Read only. The type of Animation: Sprite.NONE_ANIMATION, Sprite.FRAME_ANIMATION, Sprite.DRAGON_BONES, Sprite.FRAME_SAMPLES "},"CSprite.defaultAnimation":{zh:"默认的动作名称，反序列化将自动播放。 ",en:"The default animation' name. It will automatic play when awake. "},"CSprite.armature":{zh:"获取当前使用的骨骼根节点 ",en:"current armature node "},"CSprite.frame":{zh:"具体的图片帧（播放动作中以及骨骼动画情况下，设置 frame 是无效的） ",en:"The frame' name in the texture atlas. "},"CSprite.colorTint":{zh:"设置颜色混合 ",en:"Get or set tint color. "},"CSprite.isPlaying":{zh:"只读，动作是否在播放中 ",en:"Read only. Is the sprite playing an animation? "},"CSprite.isComplete":{zh:"只读，动作是否结束 ",en:"Read only. Is the animation is finished? "},"CSprite.lastAnimationName":{zh:"只读，上一个（如果正在播放中，则为当前）播放的动作名 ",en:"Read only. Last animation name played. "},"CSprite.nativeSize":{zh:"当前 Sprite 所用到的图片的原始大小 ",en:"The texture's real size. "},"CSprite.paused":{zh:"属性，动作是否暂停 && 设置暂停动作 ",en:"Pause / Resume playing animation. "},"CSprite.texture":{zh:"动画资源（qc.Atlas对象，可通过  game.assets.find(key) 来获取)，若有动画信息，则创建动画管理器 ",en:"The texture atlas. "},"CSprite.Variable":{en:"Description           "},"CUIText.autoSize":{zh:"是否自动根据文字内容的宽高调整 text 的宽高 ",en:"Should the text be allowed to auto resized. "},"CUIText.fontFamily":{zh:"字体类型，目前有：UIText.SYSTEMFONT（系统字体）、UIText.WEBFONT（自定义字体资源）、UIText.BITMAPFONT（自定义图片字体） ",en:"The FontType used by the text: UIText.SYSTEMFONT, UIText.WEBFONT, UIText.BITMAPFONT "},"CUIText.alignH":{zh:"水平对齐方式，目前有：UIText.LEFT（左对齐）、UIText.CENTER（居中对齐）、UIText.RIGHT（右对齐） ",en:"Horizontal alignment for text: UIText.LEFT, UIText.CENTER, UIText.RIGHT "},"CUIText.alignV":{zh:"垂直对齐方式，目前有：UIText.TOP（上对齐）、UIText.MIDDLE（居中对齐）、UIText.BOTTOM（下对齐） ",en:"Vertical alignment for text: UIText.TOP, UIText.MIDDLE, UIText.BOTTOM "},"CUIText.font":{zh:"字体，fontFamily为SYSTEMFONT时font类型为string，值为字体名字；fontFamily为其他类型的时候，font为字体资源 ",en:"When fontFamily is SYSTEMFONT, font is string type; fontFamily is other type，font is qcFont "},"CUIText.bold":{zh:"字体是否加粗 ",en:"Bold style applied to your texts. "},"CUIText.fontSize":{zh:"字体大小，单位为 px ",en:"The size that the Font should render at. "},"CUIText.colorTint":{zh:"颜色混合 ",en:"Tint color "},"CUIText.color":{zh:"字体颜色 ",en:"Base color of the font. "},"CUIText.text":{zh:"文本内容 ",en:"The string value this text will display. "},"CUIText.lineSpacing":{zh:"行间距，单位是 px ",en:"Line spacing, specified as a factor of font line height. A value of 1 will produce normal line spacing. "},"CUIText.wrap":{zh:"是否换行显示 ",en:"Is the text can be wrap? "},"CUIText.overflow":{zh:"定义内容溢出的行为：如果为 true 则裁切，否则不裁切 ",en:"Text flows freely outside the element. "},"CUIText.pivotX":{zh:"节点自身的原点X位置，0到1 ",en:"Rotations, size, and scale modifications occur around the pivot  "},"CUIText.pivotY":{zh:"节点自身的原点Y位置，0到1 ",en:"Rotations, size, and scale modifications occur around the pivot  "},"CUIText.width":{zh:"获取或设置文本的宽度 ",en:"The width of text "},"CUIText.height":{zh:"获取或设置文本的高度 ",en:"The height of text "},"CUIText.gradient":{zh:"是否开启渐变 ",en:"Is the effect of gradient enabled? "},"CUIText.startColor":{zh:"渐变开始的颜色 ",en:"Start gradient color "},"CUIText.endColor":{zh:"渐变结束的颜色 ",en:"End gradient color "},"CUIText.stroke":{zh:"描边的颜色 ",en:"Stroke color "},"CUIText.strokeThickness":{zh:"描边的宽度 ",en:"Stroke width "},"CUIText.enableShadow":{zh:"是否显示阴影 ",en:"Is the effect of shadow enable? "},"CUIText.shadowColor":{zh:"阴影的颜色 ",en:"The shadow's color. "},"CUIText.shadowBlur":{zh:"阴影的模糊程度 ",en:"The shadow's blur. "},"CUIText.shadowOffsetX":{zh:"阴影偏移量X ",en:"How far is the shadow from the text. "},"CUIText.shadowOffsetY":{zh:"阴影偏移量Y ",en:"How far is the shadow from the text. "},"CUIText.enableGlow":{zh:"是否启用外发光 ",en:"Is the effect of glow enable? "},"CUIText.glowColor":{zh:"外发光的颜色 ",en:"The glow's color. "},"CUIText.glowBlur":{zh:"外发光模糊值 ",en:"The glow's blur. "},"CUIText.nativeSize":{zh:"text实际大小 ",en:"text real size "},"CUIText.Variable":{en:"Description           "},"CButton.state":{zh:"当前按钮的状态，包括：UIState.NORMAL（正常状态）、UIState.PRESSED（按下状态）、UIState.DISABLED（不可用） ",en:"The state of button: UIState.NORMAL(normal state), UIState.PRESSED(button pressed), UIState.DISABLED(button is disable) "},"CButton.text":{zh:"按钮上的文本对象 ",en:"The reference text node. "},"CButton.supportNativeEvent":{zh:"是否响应浏览器直接事件 ",en:"Is the button support native event of browser. "},"CButton.Variable":{en:"Description           "},"CToggle.background":{zh:"背景图片 ",en:"The reference of background image. "},"CToggle.checkMark":{zh:"选中标记图片 ",en:"The reference of check mark image. "},"CToggle.text":{zh:"挂载在开关上的文本组件 ",en:"The reference of text node. "},"CToggle.on":{zh:"开关是否处于开的状态 ",en:"Is the toggle on. "},"CToggle.state":{zh:"开关的点击状态，包括：UIState.NORMAL（正常状态）、UIState.PRESSED（按下状态）、UIState.DISABLED（不可用） ",en:"The state of toggle: UIState.NORMAL, UIState.PRESSED, UIState.DISABLED "},"CToggle.Variable":{en:"Description    "},"CScrollBar.sliders":{zh:"滑块对象 ",en:"The reference to slider Node. "},"CScrollBar.direction":{zh:"滚动条的滑动方向 ",en:"The direction of the scrollbar from minimum to maximum value. "},"CScrollBar.value":{zh:"当前滑动的值，[0-1] ",en:"The current value of the scrollbar, between 0 and 1. "},"CScrollBar.size":{zh:"滑块长度和滑块区域的比例,(0,1], 滑块最小5个像素 ",en:"The size of the scrollbar handle where 1 means it fills the entire scrollbar. "},"CScrollBar.numberOfStep":{zh:"滑动时，滑块从 0 到 1 的步数 ",en:"The number of steps to use for the value. A value of 0 disables use of steps. "},"CScrollBar.stepSize":{zh:"滚动时每步改变的值 ",en:"The Step size. "},"CScrollBar.fixSlidersSize":{zh:"是否固定滑条大小 ",en:"The size of slider is fixed. "},"CScrollBar.Variable":{en:"作用           "},"CScrollView.canHorizontal":{zh:"是否响应水平滑动 ",en:"Should horizontal scrolling be enabled? "},"CScrollView.canVertical":{zh:"是否响应垂直滑动 ",en:"Should vertical scrolling be enabled? "},"CScrollView.movementType":{zh:"边界限制类型，ScrollView.MOVEMENT_UNRESTRICTED（滚动区域无限制）、ScrollView.MOVEMENT_ELASTIC（滚动区域有限制，但可以超越边界，之后被拖回）、ScrollView.MOVEMENT_CLAMPED（滚动区域有限制，无法超过边界） ",en:"The behavior to use when the content moves beyond the scroll rect: ScrollView.MOVEMENT_UNRESTRICTED(Unrestricted movement. The content can move forever.), ScrollView.MOVEMENT_ELASTIC(Elastic movement. The content is allowed to temporarily move beyond the container, but is pulled back elastically.), ScrollView.MOVEMENT_CLAMPED(Clamped movement. The content can not be moved beyond its container.) "},"CScrollView.elasticity":{zh:"当 moveMentType 为 MOVEMENT_ELASTIC 时生效，用于表示复位速度 ",en:"The amount of elasticity to use when the content moves beyond the scroll rect. "},"CScrollView.inertia":{zh:"是否惯性滑动 ",en:"Should movement inertia be enabled? "},"CScrollView.decelerationRate":{zh:"惯性滑动的减速参数 ",en:"The rate at which movement slows down. "},"CScrollView.scrollSensitivity":{zh:"响应滚动时的倍率 ",en:"The sensitivity to scroll wheel and track pad scroll events. "},"CScrollView.propagationScroll":{zh:"是否向上传递滚动事件 ",en:"是否向上传递滚动事件 "},"CScrollView.content":{zh:"需要滚动显示的内容 ",en:"The content that can be scrolled. It should be a child of this scrollView. "},"CScrollView.horizontalScrollBar":{zh:"水平滚动条，该 ScrollBar 的滑动会影响 ScrollView 的水平值，反之亦然 ",en:"Optional Scrollbar object linked to the horizontal scrolling of the ScrollView. "},"CScrollView.horizontalNormalizedPosition":{zh:"水平方向滚动的比例（0 - 1） ",en:"The horizontal scroll position between 0 and 1. "},"CScrollView.verticalScrollBar":{zh:"垂直滚动条，该 ScrollBar 的滑动会影响 ScrollView 的纵向值，反之亦然 ",en:"Optional Scrollbar object linked to the vertical scrolling of the ScrollView. "},"CScrollView.verticalNormalizedPosition":{zh:"垂直方向滚动的比例（0 - 1） ",en:"The vertical scroll position between 0 and 1. "},"CScrollView.Variable":{en:"Description           "},"CProgressBar.style":{zh:"显示样式，包括 ProgressBar.STYLE_HORIZONTAL（水平进度条）、ProgressBar.STYLE_VERTICAL（竖直进度条）、ProgressBar.STYLE_CIRCLE（圆形进度条） ",en:"The manner in which progress should be indicated on the progress bar: ProgressBar.STYLE_HORIZONTAL(From left to right), ProgressBar.STYLE_VERTICAL(From up to bottom), ProgressBar.STYLE_CIRCLE(Circle progressbar) "},"CProgressBar.sliders":{zh:"滑块对象 ",en:"The referebce to the slider Node. "},"CProgressBar.indeterminable":{zh:"是否是不确定类型，如果无法明确知道进度或者结束值，则使用不确定类型，进度条将循环播放 ",en:"Whether the ProgressBar shows actual values or generic, continuous progress feedback. "},"CProgressBar.minValue":{zh:"当前进度条的最小值 ",en:"The minimum allowed value of the progressBar. "},"CProgressBar.maxValue":{zh:"当前进度条的最大值 ",en:"The maximum allowed value of the progressBar. "},"CProgressBar.length":{zh:"只读，进度条的长度（值为 maxValue - minValue） ",en:"Read only. = maxValue - minValue "},"CProgressBar.value":{zh:"当前的进度值 ",en:"The current value of the progressBar. "},"CProgressBar.loopTime":{zh:"循环时间，当 indeterminable 为 true 时候生效 ",en:"When indeterminable=true, loopTime works.  "},"CProgressBar.numberOfStep":{zh:"在循环播放时，从0到max的步数，仅当indeterminable为true时有效, 小于等于0时，按实际值显示 ",en:"Then number of steps from 0 to max when play in loop. It is only effect when indeterminable variable is true. "},"CProgressBar.stepSize":{zh:"步进距离 ",en:"The size of each step "},"CProgressBar.fixedSize":{zh:"滑块的大小，值为占整个进度条区域的百分比，1为整个区域, < 0 时表示不限制大小 ",en:"The size of the slider. Value is percent. 1: full area "},"CProgressBar.clipSliders":{zh:"是否裁切滑块 ",en:"Whether to cut slider "},"CProgressBar.showMode":{zh:"显示模式，ProgressBar.SHOW_PROCESSED（显示进行了的部分）、ProgressBar.SHOW_REMAINED（显示剩余的部分 ）",en:"Show mode. You can take the following two values: ProgressBar.SHOW_PROCESSED(show processed part), and ProgressBar.SHOW_REMAINED(show left part)"},"CProgressBar.reverse":{zh:"是否反向显示 ",en:"Whether to show reverse "},"CProgressBar.startRadian":{zh:"开始的弧度，仅当style为STYLE_CIRCLE时有效 ",en:"The start radian. It is only effect when style is STYLE_CIRCLE. "},"CProgressBar.endRadian":{zh:"结束的弧度，仅当style为STYLE_CIRCLE时有效，endRadian > startRadian && endRadian <= startRadian + Math.PI * 2 ",en:"The end radian. It is only effect when style is STYLE_CIRCLE. "},"CProgressBar.startAngle":{zh:"开始的角度，仅当style为STYLE_CIRCLE时有效 ",en:"The start angle. It is only effect when style is STYLE_CIRCLE. "},"CProgressBar.endAngle":{zh:"结束的角度，仅当style为STYLE_CIRCLE时有效，endRadian > startRadian && endRadian <= startRadian + Math.PI * 2 ",en:"The end angle. It is only effect when style is STYLE_CIRCLE. "},"CProgressBar.showRadian":{zh:"只读，当前显示的弧度 ",en:"Read only. current radian "},"CProgressBar.Variable":{en:"Description           "},"CSlider.canPursue":{zh:"是否允许滑块追赶点击位置 ",en:"Whether to allow the slider to pursue the click position "},"CSlider.style":{zh:"滑条类型，包含：Slider.STYLE_HORIZONTAL（水平进度条）、Slider.STYLE_VERTICAL（竖直进度条）、Slider.STYLE_CIRCLE（圆形进度条）",en:"The manner in which progress should be indicated on the progress bar: Slider.STYLE_HORIZONTAL(From left to right), Slider.STYLE_VERTICAL(From up to bottom), Slider.STYLE_CIRCLE(Circle progressbar) "},"CSlider.state":{zh:"滑块的状态 ",en:"State of the slider. "},"CSlider.Variable":{en:"Description           "},"CInputField.state":{zh:"输入框的状态，包含:UIState.NORMAL（正常）、UIState.PRESSED（按下）、UIState.DISABLED（不可用） ",en:"The state for this object: UIState.NORMAL(normal state), UIState.PRESSED(node is pressed), UIState.DISABLED(node is disable) "},"CInputField.lineType":{zh:"编辑框是多行or单行，InputField.SINGLE_LINE（单行）、InputField.MULTI_LINE（多行） ",en:"The LineType used by the InputField: InputField.SINGLE_LINE(single line), InputField.MULTI_LINE(multiline) "},"CInputField.contentType":{zh:"输入框的类型，包括有：InputField.STANDARD（任意字符串）、InputField.INT（整数）、InputField.NUMBER（数字）、InputField.TEL（电话号码）、InputField.EMAIL（电子邮件）、InputField.PASSWORD（密码） ",en:"Specifies the type of the input text content.InputField.STANDARD(Allows all input), InputField.INT(Allow whole numbers), InputField.NUMBER(Allows decimal numbers), InputField.TEL(Allows phone), InputField.EMAIL(The input is used for typing in an email address), InputField.PASSWORD(Allows all input and hides the typed characters by showing them as asterisks characters.) "},"CInputField.text":{zh:"编辑框的内容 ",en:"The current value of the input field. "},"CInputField.placeholderText":{zh:"占位符字符串 ",en:"The placeholder text "},"CInputField.characterLimit":{zh:"输入字符的限制。-1表示不受限 ",en:"How many characters the input field is limited to. -1 = infinite. "},"CInputField.overflow":{zh:"超出部分是否要裁切掉，默认为true ",en:"Text flows freely outside the element. Default: true. "},"CInputField.isFocused":{zh:"是否处于编辑状态 ",en:"ture:is editing "},"CInputField.textComponent":{zh:"关联的输入文本对象 ",en:"The reference of input text node. "},"CInputField.placeholder":{zh:"关联的占位符文本对象 ",en:"The reference of placeholder text node. "},"CInputField.Variable":{en:"Description   "},"CSound.audio":{zh:"声音源 ",en:"The asset of audio clip. "},"CSound.destroyWhenStop":{zh:"播放完毕之后是否自动销毁 ",en:"When the sound stop, destroy it. "},"CSound.loop":{zh:"是否循环播放当前声音 ",en:"Is the audio clip looping? "},"CSound.mute":{zh:"静音 ",en:"Un- / Mutes the Audio. "},"CSound.playOnAwake":{zh:"是否创建时自动播放 ",en:"If set to true, the sound will automatically start playing on awake. "},"CSound.volume":{zh:"音量, 0 - 1 ",en:"The volume of the audio (0.0 to 1.0). "},"CSound.isPlaying":{zh:"是否正在播放 ",en:"Whether is playing "},"CSound.isPaused":{zh:"是否暂停中 ",en:"Whether is paused "},"CSound.Variable":{en:"Description           "},"CDom.div":{zh:"对应的div元素 ",en:"div element "},"CDom.pos":{zh:"节点的位置，qc.Dom.BACK(背景层); qc.Dom.FRON(顶层) ",en:"The pos of node. There is two value: qc.Dom.BACK(back layer); qc.Dom.FRONT(top layer) "},"CDom.innerHTML":{zh:"内部的HTML元素，当serializable=false时，本字段不能被序列化 ",en:"innerHTML property of div "},"CDom.className":{zh:"使用的样式表  ",en:"CSS class  "},"CDom.serializable":{zh:"innerHTML信息是否需要保存，默认为true  ",en:"Is innerHTML information needs to be saved, the default value is true  "},"CDom.overflow":{zh:"对应于style.overflow，可取值：auto、hidden、visible、scroll  ",en:"Corresponding to style.overflow, possible values: auto, hidden, visible, scroll  "},"CDom.zIndex":{zh:"对应于style.zIndex。不能设置为0（游戏场景），值越大表示在上层 ",en:"Corresponding to style.zIndex,  element with greater zIndex is always in front of another element with lower zIndex. Can not be set to zero. "},"CDom.Variable":{en:"Description           "},"CTilemap.nativeSize":{zh:"只读，地图的实际大小（不带任何缩放） ",en:"Read only. native size(not scale) "},"CTilemap.layers":{zh:"图层数组 ",en:"The layer array "},"CTilemap.tilesets":{zh:"图集数组 ",en:"The tileset array "},"CTilemap.scrollX":{zh:"水平滚动距离 ",en:"The scroll distance in axis x "},"CTilemap.scrollY":{zh:"垂直滚动距离 ",en:"The scroll distance in axis y "},"CTilemap.tileWidth":{zh:"平铺格子的宽度 ",en:"The width of tile "},"CTilemap.tileHeight":{zh:"平铺格子的高度 ",en:"The height of tile "},"CTilemap.mapWidth":{zh:"地图X轴上格子的数量 ",en:"The cell count in axis x "},"CTilemap.mapHeight":{zh:"地图Y轴上格子的数量 ",en:"The cell count in axis y "},"CTilemap.data":{zh:"Tilemap数据 ",en:"Tilemap data "},"CTilemap.Variable":{en:"Description        "},"TransitionBehaviour.target":{zh:"行为的目标 ",en:"The target node to apply transition. "},"TransitionBehaviour.transition":{zh:"按钮切换的方式，目前包含 4 种qc.Transition，Transition.Node（不需要变换）、Transition.COLOR_TINT（变换颜色）、Transition.TEXTURE_SWAP（替换贴图）、Transition.ANIMATION（使用自定义动画） ",en:"Transition mode: Transition.Node(No Transition), Transition.COLOR_TINT(Use an color tint transition), Transition.TEXTURE_SWAP(Use a sprite swap transition), Transition.ANIMATION(Use an animation transition) "},"TransitionBehaviour.disabledColor":{zh:"Transition.COLOR_TINT模式 && 置灰状态下的颜色 ",en:"transition=Transition.COLOR_TINT && The color when disable "},"TransitionBehaviour.disabledTexture":{zh:"Transition.TEXTURE_SWAP模式 && 置灰状态下的贴图 ",en:"transition=Transition.TEXTURE_SWAP && The Texture when disable "},"TransitionBehaviour.normalColor":{zh:"Transition.COLOR_TINT模式 && 普通状态下的颜色 ",en:"transition=Transition.COLOR_TINT && The normal color "},"TransitionBehaviour.normalTexture":{zh:"Transition.TEXTURE_SWAP模式 && 普通状态下的贴图 ",en:"transition=Transition.TEXTURE_SWAP && The normal texture "},"TransitionBehaviour.pressedColor":{zh:"Transition.COLOR_TINT模式 && 按下状态下的颜色 ",en:"transition=Transition.COLOR_TINT && The color when pressed "},"TransitionBehaviour.pressedTexture":{zh:"Transition.TEXTURE_SWAP模式 && 按下状态下的贴图 ",en:"transition=Transition.TEXTURE_SWAP && The texture when pressed "},"TransitionBehaviour.Variable":{en:"Description           "},"ScaleAdapter.target":{zh:"行为的目标 ",en:"target object "},"ScaleAdapter.referenceResolution":{zh:"希望使用的分辨率  ",en:"Reference resolution  "},"ScaleAdapter.manualType":{zh:"分辨率适应的缩放类型",en:"Scale type"},"ScaleAdapter.fullTarget":{zh:"是否使内容填满 ",en:"Whether to fill full area "},"ScaleAdapter.ScaleAdapter":{zh:"对宽高分别进行缩放，使得目标区域的分辨率为referenceResolution ",en:"Scale width and height individually, make target resolution is equal to referenceResolution "},"ScaleAdapter.Variable":{en:"Description        "},"ScaleAdapter.Constant":{en:"Description        "},"ToggleGroup.toggle":{zh:"当前处于激活状态的开关 ",en:"Currently active toggle "},"ToggleGroup.allowSwitchOff":{zh:"是否允许选择为空 ",en:"Is it allowed that no toggle is switched on "},"ToggleGroup.toggles":{zh:"所有的开关列表 ",en:"List of managed toggles "},"ToggleGroup.Variable":{en:"Description        "},"NodeMask.checkInField":{zh:"是否检测子节点是否在范围内 ",en:"Whether to detect whether the child node is in the range "},"NodeMask.mode":{zh:"裁切模式。（NodeMask.MODE_DEFAULT：以当前节点的显示矩形进行裁切、NodeMask.MODE_PIXEL：以当前节点的显示内容进行裁切、NodeMask.MODE_GRAPHICS：以自定义的图形进行裁切） ",en:"mask mode.(NodeMask.MODE_DEFAULT:cut the display rectangle of the current node、NodeMask.MODE_PIXEL：cut the display content of the current node、NodeMask.MODE_GRAPHICS：cut with custom graphics） "},"NodeMask.customGraphics":{zh:"自定义的裁切图形 ",en:"custom graphics "},"NodeMask.Variable":{en:"Description           "},"Bounds.sizeProvider":{zh:"尺寸提供方式，有两个取值：Bounds.USE_BOUNDS(使用实际显示范围作为边框)、Bounds.USE_RECTTRANSFORM(使用 rectTransform 作为边框，不受旋转缩放的影响) ",en:"The way for size calculate. There is two value:Bounds.USE_BOUNDS(Use the actual display range as the border)、Bounds.USE_RECTTRANSFORM(Use rectTransform as border, unUnaffected by rotation、scale and so on) "},"Bounds.marginTop":{zh:"相对父节点的上边边距 ",en:"The top margin relative to the parent "},"Bounds.marginBottom":{zh:"相对父节点的下边边距 ",en:"The bottom margin relative to the parent "},"Bounds.marginLeft":{zh:"相对父节点的左边边距 ",en:"The left margin relative to the parent "},"Bounds.marginRight":{zh:"相对父节点的右边边距 ",en:"The right margin relative to the parent "},"Bounds.paddingTop":{zh:"相对子节点的上边边距 ",en:"The top margin relative to the child "},"Bounds.paddingBottom":{zh:"相对子节点的下边边距 ",en:"The bottom margin relative to the child "},"Bounds.paddingLeft":{zh:"相对子节点的左边边距 ",en:"The left margin relative to the child "},"Bounds.paddingRight":{zh:"相对子节点的右边边距 ",en:"The right margin relative to the child "},"Bounds.Variable":{en:"Description        "},"TableLayout.constraint":{zh:"表格元素布局限制",en:"Layout constraint"},"TableLayout.startCorner":{zh:"布局开始的角，默认从左上开始 ",en:"Layout start corner, left top by default "},"TableLayout.startAxis":{zh:"布局开始添加的轴，默认优先填充水平方向 ",en:"Layout start direction, horizontal by default "},"TableLayout.contentSizeProvider":{zh:"内容尺寸提供器，见Bounds中的sizeProvider ",en:"Size calculate mode. seeBounds's sizeProvider "},"TableLayout.style":{zh:"当前布局器的样式，是保持子节点大小还是以本节点 RectTransform 对子节点进行调整，默认保持子节点尺寸",en:"Current layout style. TableLayout.STYLE_WRAP_ELEMENT、TableLayout.STYLE_RESIZE_ELEMENT"},"TableLayout.spacingX":{zh:"单元格的水平间距 ",en:"Spacing in x axis "},"TableLayout.spacingY":{zh:"单元格的垂直间距 ",en:"Spacing in y axis "},"TableLayout.cellWidth":{zh:"单元格的宽度",en:"Width of cell"},"TableLayout.cellHeight":{zh:"单元格的高度",en:"Height of cell "},"TableLayout.contentAlignment":{zh:"内容在容器中的对齐方式，仅在style为TableLayout.STYLE_RESIZE_ELEMENT时生效 ",en:"Alignment mode of content, effective only while style is TableLayout.STYLE_RESIZE_ELEMENT. "},"TableLayout.cellAlignment":{zh:"单元格的内容在容器中的对齐方式 ",en:"Alignment mode of cell "},"TableLayout.columnsCount":{zh:"只读，当前列数 ",en:"Read Only. current column count "},"TableLayout.rowsCount":{zh:"只读，当前行数 ",en:"Read Only. current row count "},"TableLayout.ignoreX":{zh:"是否不调整 x 坐标 ",en:"Whether ignore the adjustment on the x-axis direction. "},"TableLayout.ignoreY":{zh:"是否不调整 y 坐标 ",en:"Whether ignore the adjustment on the y-axis direction. "},"TableLayout.autoUpdate":{zh:"是否每帧自动重排 ",en:"Whether relayout per frame automatically. "},"TableLayout.Variable":{en:"Description        "},"TableLayout.Constant":{en:"Description        "},"HorizontalLayout.spacing":{zh:"表格元素布局限制，见本文下方的[常量] ",en:"Spacing value "},"HorizontalLayout.childForceExpandWidth":{zh:"是否强制拉伸宽度",en:"Whether to stretch width forcely "},"HorizontalLayout.childForceExpandHeight":{zh:"是否强制拉伸高度 ",en:"Whether to stretch height forcely"},"HorizontalLayout.Variable":{en:"Description        "},"VerticalLayout.spacing":{zh:"y轴方向布局间距 ",en:"Spacing value "},"VerticalLayout.childForceExpandWidth":{zh:"是否强制拉伸宽度",en:"Whether to stretch width forcely "},"VerticalLayout.childForceExpandHeight":{zh:"是否强制拉伸高度 ",en:"Whether to stretch height forcely"},"VerticalLayout.Variable":{en:"Description        "},"LayoutElement.ignoreLayout":{zh:"是否允许忽略布局参数 ",en:"Whether to allow to ignore layout "},"LayoutElement.minWidth":{zh:"节点允许的最小宽度 ",en:"Minimum width "},"LayoutElement.minHeight":{zh:"节点允许的最小高度 ",en:"Minimum height "},"LayoutElement.preferredWidth":{zh:"首选宽度 ",en:"Preferred width "},"LayoutElement.preferredHeight":{zh:"首选高度 ",en:"Preferred height "},"LayoutElement.flexibleWidth":{zh:"可变宽度",en:"Flexible width"},"LayoutElement.flexibleHeight":{zh:"可变高度 ",en:"Flexible height "},"LayoutElement.hasMinWidth":{zh:"是否设置了最小宽度 ",en:"Has minimum width set "},"LayoutElement.hasMinHeight":{zh:"是否设置了最小高度",en:"Has minimum height set"},"LayoutElement.hasPreferredWidth":{zh:"是否设置了首选宽度",en:"Has preferred width set"},"LayoutElement.hasPreferredHeight":{zh:"是否设置了首选高度 ",en:"Has preferred height set "},"LayoutElement.hasFlexibleWidth":{zh:"是否设置了拓展宽度 ",en:"Has flexible width set "},"LayoutElement.hasFlexibleHeight":{zh:"是否设置了拓展高度 ",en:"Has flexible height set "},"LayoutElement.Variable":{en:"Description        "},"AspectRatioFitter.mode":{zh:"控制比例的方式",en:"The mode to use to enforce the aspect ratio"},"AspectRatioFitter.ratio":{zh:"长宽的比例 ",en:"The aspect ratio "},"AspectRatioFitter.AspectRatioFitter":{zh:"填满父亲节点大小 ",en:"Sizes the rectangle such that the parent rectangle is fully contained within. "},"AspectRatioFitter.Variable":{en:"Description        "},"AspectRatioFitter.Name":{en:"Description        "},"CacheAsBitmap.cacheType":{zh:"缓存的类型，有两个取值：CacheAsBitmap.CACHE_FOR_SCREEN(为屏幕显示创建缓存)、CacheAsBitmap.CAHCE_FOR_SELF(为自身显示创建缓存) ",en:"The cache type, there are two possible values: CacheAsBitmap.CACHE FOR SCREEN, CacheAsBitmap.CAHCE_FOR_SELF "},"CacheAsBitmap.boundsType":{zh:"缓存的边界类型，有两个取值：CacheAsBitmap.BOUNDS_SELF(只缓存单个节点)、CacheAsBitmap.BOUNDS_ALL(缓存自己和子孙) ",en:"The bound type, there are two possible values: CacheAsBitmap.BOUNDS_SELF(only cache self)、CacheAsBitmap.BOUNDS_ALL(cache self and child) "},"CacheAsBitmap.boundsInScreen":{zh:"是否限制缓存区域大小，默认为false ",en:"Whether to limit the size of the cache, false by default "},"CacheAsBitmap.dirty":{zh:"是否需要更新缓存内容 ",en:"Whether need to refresh cache "},"CacheAsBitmap.Variable":{en:"Description        "},"Tween.playOnAwake":{zh:"创建时是否自动播放动作，默认为false ",en:"If set to true, the tween will automatically start playing on awake. "},"Tween.flag":{zh:"组件的标记。当一个对象挂载多个相同Tween组件时会有用 ",en:"The flag of tween. "},"Tween.style":{zh:"循环类型，有3个取值：Tween.STYLE_ONCE(执行一次)、Tween.STYLE_LOOP(循环播放动画)、Tween.STYLE_PINGPONG(来回播放动画) ",en:"Does it play once? Does it loop? Value: Tween.STYLE_ONCE(Play Once)、Tween.STYLE_LOOP(Loop the tween)、Tween.STYLE_PINGPONG(Pingpong the tween) "},"Tween.curve":{zh:"动画曲线 ",en:"Curve of tween. "},"Tween.delay":{zh:"延迟开始播放动画的时间，单位为秒 ",en:"How long will the tweener wait before starting the tween? Unit: second. "},"Tween.duration":{zh:"动作的持续时间，单位为秒 ",en:"How long is the duration of the tween? Unit: second. "},"Tween.tweenGroup":{zh:"Tween的动作编组 ",en:"Used by buttons and tween sequences. Group of '0' means not in a sequence. "},"Tween.Variable":{en:"Description "},"TweenPosition.from":{zh:"初始的位置 ",en:"From position. "},"TweenPosition.to":{zh:"结束的位置 ",en:"To Position. "},"TweenPosition.moveAxis":{zh:"位置改变的类型，TweenPosition.ONLY_X(只改变X轴)、TweenPosition.ONLY_Y(只改变Y轴)、TweenPosition.BOTH(X、Y都改变) ",en:"TweenPosition.ONLY_X(move x position only)、TweenPosition.ONLY_Y(move y position only)、TweenPosition.BOTH(move x and y) "},"TweenPosition.Variable":{en:"Description "},"TweenRotation.from":{zh:"初始的弧度 ",en:"From radian "},"TweenRotation.to":{zh:"结束的弧度 ",en:"To radian "},"TweenRotation.Variable":{en:"Description "},"TweenAlpha.from":{zh:"初始的透明度，0-1 ",en:"From alpha, 0-1 "},"TweenAlpha.to":{zh:"结束的透明度，0-1 ",en:"To alpha, 0-1 "},"TweenAlpha.Variable":{en:"Description "},"TweenScale.from":{zh:"初始的缩放 ",en:"From scale "},"TweenScale.to":{zh:"结束的缩放 ",en:"To Scale "},"TweenScale.Variable":{en:"Description "},"TweenColor.from":{zh:"初始的颜色值 ",en:"From color. "},"TweenColor.to":{zh:"结束的颜色值 ",en:"To color. "},"TweenColor.Variable":{en:"Description "},"TweenProperty.property":{zh:"对象的属性 ",en:"Property of the object. "},"TweenProperty.from":{zh:"初始的数值 ",en:"From value. "},"TweenProperty.to":{zh:"结束的数值 ",en:"To value. "},"TweenProperty.Variable":{en:"Description "},"DebugView.debugOn":{zh:"是否打开调试功能，详见Debug ",en:"The debug mode is enable if true. See: Debug "},"DebugView.Variable":{en:"Description "}},qc.editor.Language={"QICI Engine/About QICI Engine...":{zh:"青瓷引擎/关于青瓷引擎..."},"QICI Engine/Check for Updates...":{zh:"青瓷引擎/检测更新..."},"QICI Engine/Help/zh/Manual...":{zh:"青瓷引擎/帮助/中文/手册..."},"QICI Engine/Help/zh/API...":{zh:"青瓷引擎/帮助/中文/API..."},"QICI Engine/Help/zh/Forum...":{zh:"青瓷引擎/帮助/中文/论坛..."},"QICI Engine/Help/en/Manual...":{zh:"青瓷引擎/帮助/英文/手册..."},"QICI Engine/Help/en/API...":{zh:"青瓷引擎/帮助/英文/API..."},"QICI Engine/Help/en/Forum...":{zh:"青瓷引擎/帮助/英文/论坛..."},"QICI Engine/Preference...":{zh:"青瓷引擎/偏好设置"},"Project/New Scene":{zh:"工程/新场景"},"Project/Save Scene":{zh:"工程/保存场景"},"Project/Reload Scene":{zh:"工程/刷新场景"},"Project/Open Recent":{zh:"工程/打开最近工程"},"Project/New Project":{zh:"工程/新建工程"},"Project/Open Project":{zh:"工程/打开工程"},"Project/Publish...":{zh:"工程/发布..."},"Project/Settings...":{zh:"工程/设置..."},"Edit/Undo":{zh:"编辑/回退"},"Edit/Redo":{zh:"编辑/重做"},"Edit/Cut":{zh:"编辑/剪切"},"Edit/Copy":{zh:"编辑/拷贝"},"Edit/Paste":{zh:"编辑/粘贴"},"Edit/Duplicate":{zh:"编辑/复制"},"Edit/Delete":{zh:"编辑/删除"},"Edit/Preview (WebGL)":{zh:"编辑/预览（WebGL）"},"Edit/Preview (Canvas)":{zh:"编辑/预览（Canvas）"},"Edit/Run":{zh:"编辑/运行"},"Edit/Apply To Prefab":{zh:"编辑/应用预制修改"},"GameObject/Empty Node":{zh:"游戏对象/空节点"},"GameObject/Image":{zh:"游戏对象/图片"},"GameObject/Sprite":{zh:"游戏对象/精灵"},"GameObject/Text":{zh:"游戏对象/文本"},"GameObject/Button":{zh:"游戏对象/按钮"},"GameObject/Toggle":{zh:"游戏对象/开关"},"GameObject/ScrollBar":{zh:"游戏对象/滚动条"},"GameObject/ScrollView":{zh:"游戏对象/滚动视图"},"GameObject/ProgressBar":{zh:"游戏对象/进度条"},"GameObject/Slider":{zh:"游戏对象/拉条"},"GameObject/Input Field":{zh:"游戏对象/输入框"},"GameObject/Sound":{zh:"游戏对象/音效"},"GameObject/Dom":{zh:"游戏对象/Dom节点"},"GameObject/UIRoot":{zh:"游戏对象/UIRoot"},"GameObject/Emitter":{zh:"游戏对象/粒子发射器"},"GameObject/Tilemap":{zh:"游戏对象/瓦片地图"},"GameObject/Graphics":{zh:"游戏对象/绘图"},"Empty Node":{zh:"空节点"},Image:{zh:"图片"},Sprite:{zh:"精灵"},Text:{zh:"文本"},Button:{zh:"按钮"},Toggle:{zh:"开关"},ScrollBar:{zh:"滚动条"},ScrollView:{zh:"滚动视图"},ProgressBar:{zh:"进度条"},Slider:{zh:"拉条"},"Input Field":{zh:"输入框"},Sound:{zh:"音效"},Emitter:{zh:"粒子发射器"},Graphics:{zh:"绘图"},Tilemap:{zh:"瓦片地图"},"Tool/Frame Animation Editor":{zh:"工具/帧动作编辑器"},"Tool/Repack Texture Atlases":{zh:"工具/重打包图集"},"Tool/Import Assets":{zh:"工具/资源导入"},"Tool/Create WebFont":{zh:"工具/创建WebFont"},"Plugins/Plugin Manager":{zh:"插件/插件管理"},"Plugins/Plugin Store":{zh:"插件/插件商店"},"Plugins/Export Plugin":{zh:"插件/导出插件"},"Layout/Portrait":{zh:"布局/竖屏"},"Layout/Landscape":{zh:"布局/横屏"},"Language/中文":{zh:"语言/中文"},"Language/English":{zh:"语言/English"},"Quit running mode first":{zh:"请先退出运行模式"},"Stop editing prefab first":{zh:"请先结束预制编辑"},"Enter the new scene name":{zh:"请输入新场景名"},"Do you want to save the scene?":{zh:"是否保存当前场景？"},"Do you want to save the changes?":{zh:"是否保存改变？"},"Don't Save":{zh:"不保存"},Save:{zh:"保存"},Cancel:{zh:"取消"},"Add Component":{zh:"添加脚本"},Components:{zh:"脚本列表"},Rebuild:{zh:"重新生成"},Preference:{zh:"偏好设置"},"UI Atlas":{zh:"图集"},"Normal Texture":{zh:"普通贴图"},Atlas:{zh:"图集"},"Frame Animation":{zh:"帧动画"},DragonBone:{zh:"骨骼动画"},"DragonBone(Sampled)":{zh:"骨骼动画（采样）"},"Edit Frame Animation":{zh:"编辑帧动作"},Sampled:{zh:"动作采样"},"DragonBone({0}) sampling is done":{zh:"骨骼（{0}）采样完成"},"Animations List":{zh:"动作列表"},Name:{zh:"名称"},Loop:{zh:"循环"},Operation:{zh:"操作"},Play:{zh:"播放"},Pause:{zh:"暂停"},"Next Frame":{zh:"下一帧"},Frames:{zh:"图片帧"},"Nine Patch Padding":{zh:"九宫格间距"},"Web Font":{zh:"Web Font"},"Font Name":{en:"Name",zh:"字体名称"},"Font URLs (One URL per line)":{zh:"字体地址（按行分开）"},"Font URLs are invalid":{zh:"字体的地址非法"},"Name must be digital or letter":{
zh:"字体名称应该为数字或字母"},"Web font is saved to: ":{zh:"字体被保存到："},"JavaScript Management":{zh:"脚本管理"},Script:{zh:"脚本"},Path:{zh:"路径"},Entry:{zh:"入口脚本"},"Drop JavaScript File Here":{zh:"将JS文件拖拽到这里"},"Dependence List":{zh:"依赖列表"},"Add Filter":{zh:"添加着色器"},"Apply Prefab":{zh:"应用预制修改"},"Plugin Manager":{zh:"插件管理"},"Plugin List":{zh:"插件列表"},"Check for Updates":{zh:"检测更新"},"Version Info":{zh:"版本信息"},Update:{zh:"更新"},"Project Settings":{zh:"工程设置"},"Project Name":{zh:"工程名"},"Game Name":{zh:"游戏名"},Company:{zh:"公司名"},Identifier:{zh:"标识符"},Instance:{zh:"实例名"},Version:{zh:"版本号"},Width:{zh:"宽度"},Orientation:{zh:"转向"},"Auto Rotate":{zh:"自动旋转"},Portrait:{zh:"竖屏"},Landscape:{zh:"横屏"},"Frame Rate":{zh:"帧率"},"Background Color":{zh:"背景色"},Apply:{zh:"应用"},"Scene List":{zh:"场景列表"},"Reset Native Size":{zh:"重置大小"},"Generate Layers":{zh:"生成图层"},Relayout:{zh:"重排"},On:{zh:"开启"},"Frame Animation Editor":{zh:"帧动作编辑"},"File must be texture atlas":{zh:"文件必须为图集资源"},"DragonBone cannot be modified.":{zh:"骨骼动画不能被编辑"},"Drop Atlas File Here":{zh:"将图集文件拖到这里"},Animation:{zh:"动作"}," New ":{zh:" 新建 "}," Save ":{zh:" 保存 "}," Delete ":{zh:" 删除 "}," Back ":{zh:" 返回 "},"Animation is empty":{zh:"动作帧信息不能为空"},"Animation's name is invalid":{zh:"动作名非法"},"Please create an animation":{zh:"请先创建一个动作"},"Import Assets":{zh:"资源导入"},Import:{zh:"导入"},"Asset Name":{zh:"资源名称"},"Asset Path":{zh:"资源路径"},"Asset Type":{zh:"资源类型"},"List of Files":{zh:"文件列表"},"Drop files here":{zh:"拖拽文件到此处"},"Invalid asset":{zh:"未检测到资源"},"The asset name is invalid":{zh:"资源名称非法"},"Asset path is empty":{zh:"请选择保存路径"},"Files is empty":{zh:"导入文件列表为空"},"Import is done":{zh:"资源导入成功"},"Import error:":{zh:"资源导入失败："},"Double click to select the folder":{zh:"双击选择文件夹"},"Set Curr To Start":{zh:"设置当前值为起始值"},"Set Curr To End":{zh:"设置当前值为结束值"},"Play/Stop":{zh:"运行/停止"},"Reset To Begin":{zh:"重置到起始值"},"Play/Stop Group":{zh:"运行组/停止组"},"Reset Group to Begin":{zh:"重置组到起始值"},"Stop editing frame animation?":{zh:"正在编辑帧动作，确定要退出吗？"},Yes:{zh:"是"},"New Folder":{zh:"创建目录"},"Open in Local File Explorer":{zh:"在本地文件管理器中打开"},Delete:{zh:"删除"},Rename:{zh:"重命名"},"New JavaScript File":{zh:"创建JavaScript脚本"},Reimport:{zh:"重新导入资源"},"Sure to delete this file?":{zh:"确认删除选择文件？"},"{0} cannot be removed(builtin files).":{zh:"{0}为内置文件，无法删除。"},"{0} cannot be modified(builtin files).":{zh:"{0}为内置文件，无法编辑。"},"JavaScript File":{en:"JavaScript",zh:"JavaScript文件"},"Enter a new JavaScript file name":{zh:"输入JavaScript文件名"},Expand:{zh:"展开"},Collapse:{zh:"合并"},"Enter a new folder name":{zh:"请输入目录名"},"Downscaling is done.":{zh:"缩放成功"},"Please select an animation asset":{zh:"请选中一个动画资源"},"Folder created":{zh:"创建目录成功"},"Failed to create folder":{zh:"创建目录失败"},"Stop running game?":{zh:"是否停止当前运行中的游戏？"},Stop:{zh:"停止"},"Publish failed:":{zh:"发布失败："},"Publish succeeded":{zh:"发布成功"},"Remove completed":{zh:"删除成功"},"Remove failed:":{zh:"删除失败"},"Rename succeeded":{zh:"重命名完成"},"Scene saved":{zh:"场景保存完成"},"Prefab saved":{zh:"预制保存完成"},"Built-in files cannot be modified":{zh:"内置文件不能被编辑"},"Reimport completed":{zh:"资源重导入完成"},"Operation completed":{zh:"操作成功"},"Connect failed":{zh:"连接失败"},"Sure to remove this component?":{zh:"确定删除此组件？"},Remove:{zh:"删除"},OK:{zh:"确定"},BitmapFont:{zh:"BitmapFont"},Cut:{zh:"剪切"},Copy:{zh:"拷贝"},Paste:{zh:"粘贴"},Create:{zh:"创建"},Duplicate:{zh:"复制"},"Sure to remove this node?":{zh:"确定删除选择节点吗？"},"Failed to fetch recent projects list":{zh:"获取最近打开的工程列表失败。"},Open:{zh:"打开"},"Open Project":{zh:"打开工程"},"Failed to open project":{zh:"打开工程失败。"},"Failed to create project":{zh:"创建工程失败。"},"Close Tip":{en:"Make sure the changes you made in the scene are saved.\nYour changes will be lost if you do not save them.\nDo you really want to exit?",zh:"请确定所有数据已保存，确定要退出编辑吗？"},Folder:{zh:"文件夹"},"Choose Folder":{zh:"选择文件夹"},"Double click to choose the folder":{zh:"双击选择文件夹"},"Please choose a folder to create the project":{zh:"请选择创建工程路径"},"Create a new project":{zh:"创建新工程"},"Project Folder":{zh:"工程路径"},"Recent Opened Projects":{en:"Recent Projects",zh:"最近打开的工程"},"Recent Projects":{zh:"最近工程"},"New Project":{zh:"新建工程"},"Code Editor":{zh:"代码编辑器"},"Code Preview":{zh:"代码预览"},"Code Saved":{zh:"代码已保存"},"Select Object":{zh:"选择对象"},"You are using the latest version.":{zh:"当前使用的已经是最新版本。"},"Local Editor Version: ":{zh:"本地编辑器版本："},"Latest Editor Version: ":{zh:"最新编辑器版本："},"Local Core Version: ":{zh:"本地核心库版本："},"Latest Core Version: ":{zh:"最新核心库版本："},"Begin to update...":{zh:"开始更新版本..."},"Update failed, please try again later.":{zh:"更新失败，请稍后重试。"},"Updated successfully, restart the node.js server and refresh this page":{zh:"更新成功，请重启后台Node.js服务，并刷新本页面。"},"Update Info":{zh:"更新信息"},"A new version of QICI Engine is available!":{zh:"青瓷引擎有新的版本发布了！"},"Pan Mode":{en:"Pan",zh:"移动场景"},"Move Mode":{en:"Move",zh:"移动元素"},"Scale Mode":{en:"Scale",zh:"缩放"},"Transform Mode":{en:"Transform",zh:"变换"},"Fit Content":{zh:"重置场景大小"},"Show/Hide Grid":{zh:"显示/隐藏标尺"},"Show/Hide Debug":{zh:"显示/隐藏调试信息"},"Checking...":{zh:"检查中..."},Install:{zh:"安装"},"Installing...":{zh:"安装中..."},Installed:{zh:"已安装"},"{0} has been successfully installed.":{zh:"{0}安装成功"},"{0} failed to install.":{zh:"{0}安装失败"},"Operate Failed":{zh:"操作失败。"},"Revert to Dragonbones successfully.":{zh:"成功还原动作为骨骼动画。"},Revert:{zh:"还原为骨骼动画。"},"Loading Prefab":{zh:"加载预制"},"Project has been removed successfully.":{zh:"工程已删除"},Warning:{zh:"警告"},Confirm:{zh:"确认"},Prompt:{zh:"提示"},"Search:":{zh:"搜索："},"Downloading...":{zh:"下载中..."},"Backup current version...":{zh:"备份现有版本中..."},"Completing update...":{zh:"正在完成更新，请稍候..."},"Update version":{zh:"版本更新"},"The update is completed, and refresh to load the new version":{zh:"更新完成，刷新页面载入新版本?"},Refresh:{zh:"更新"},"Failed to update, please make sure no files are occupied by other process.":{zh:"更新失败。请确认文件未被其他进程使用。"},"Download failed, please try again.":{zh:"下载更新失败，请重试。"},"Script added.":{zh:"脚本成功挂载在节点上。"},"Start to download images, count: ":{zh:"开始下载图元，数量"},"Images downloaded, Start to pack atlas.":{zh:"所有图元已成功下载，开始打包"},"All atlases has been packed.":{zh:"全部图集打包完毕！！！"},"Show Retainers":{zh:"查看引用者"},Retainers:{zh:"引用者"},"No retainer":{zh:"没有其它节点引用此节点"},"Run in Background":{zh:"后台运行"},Antialias:{zh:"抗锯齿"},Transparent:{zh:"背景透明"},Renderer:{zh:"渲染器"},"Can not move file into raw floder":{zh:"无法将文件移动到raw目录下"},"Prefab cannot be removed":{zh:"Prefab不能删除"},"Failed to add component":{en:"The component isn't supported by this node.",zh:"此节点不支持挂载该组件。"},"TweenFunction func error":{en:"More than one function with the same name: ",zh:"存在多个相同函数名的函数："},Edit:{zh:"编辑"},"Edit Text":{zh:"编辑文本"},"Please input an integer between 1 - 60":{zh:"请输入一个 1 - 60 的整数"},"Sample Frame Rate(1-60, default 15)":{zh:"每秒采样帧率（1-60，默认15帧）"},"Current scripts rely on other, it can not be used as the entrance.":{zh:"当前脚本依赖其他文件，无法作为入口。"},"Curve Editor":{zh:"曲线编辑器"},"Add Key":{zh:"添加关键帧"},"Delete Key":{zh:"删除关键帧"},"Reset View":{zh:"重置显示范围"},"√ Auto":{zh:"√ 自动"},Auto:{zh:"自动"},"√ Free Smooth":{zh:"√ 平滑"},"Free Smooth":{zh:"平滑"},"√ Flat":{zh:"√ 水平"},Flat:{zh:"水平"},"√ Broken":{zh:"√ 打断"},Broken:{zh:"打断"},"√ Ping Pong":{zh:"√ 反复"},"Ping Pong":{zh:"反复"},"√ Loop":{zh:"√ 循环"},"√ Clamp":{zh:"√ 固定"},Clamp:{zh:"固定"},"Save as New Curve":{zh:"保存为新曲线"},"Delete Curve":{zh:"删除曲线"},"Add Default Curves":{zh:"添加默认曲线"},"Developer Mode":{zh:"开发者模式"},Restore:{zh:"恢复"},Reload:{zh:"重新加载"},"Scene file changed":{zh:"</br></br>该文件已变更。</br>是否需要重新加载？</br></br>如果重新加载，该场景未保存的改动将会丢失。",en:"</br></br>This file has been modified outside.</br>Do you want to reload it?</br></br>Your unsaved changes in the scene will be lost if you reload it."},"State History Size":{zh:"场景历史记录保存数量"},"Save Scene Interval":{zh:"自动保存临时场景的间隔时间"},"Use System Editor for JavaScript":{zh:"使用系统编辑器打开JavaScript文件"},"Double Click":{zh:"双击"},"Shift + Double Click":{zh:"Shift + 双击"},"Current Scene is not {0}, can not revert.":{zh:"当前编辑中的场景并非{0}，不能执行还原操作"},"Revert Failed.":{zh:"还原失败"},Calculate:{zh:"计算"},"Asset is not loaded, please try later.":{zh:"资源尚未加载完毕，请稍后再尝试。"},"Current node is not allowed to add this component.":{zh:"当前节点无法添加此组件。"},"Please first stop to edit prafab.":{zh:"请先退出编辑预制状态。"},"It is not allowed to edit prafab in running mode.":{zh:"运行模式下无法编辑预制"},"Exception notification":{en:"Error: {0}</br></br>Please open 'Developer Tools'->'Console' to see detail.",zh:"发生报错：{0}</br></br>打开开发者工具的 Console 面板查看详细信息。"},"Load Order":{zh:"加载顺序"},"Script Order Panel":{zh:"脚本依赖"},"My Computer":{zh:"我的电脑"},Home:{zh:"用户目录"},Favorites:{zh:"收藏夹"},"Add to Favorites":{zh:"添加到收藏夹"},"Remove from Favorites":{zh:"从收藏夹删除"},"Add, remove and switch order for files or folders":{zh:"对脚本文件或目录进行增加、删除和顺序切换"},Type:{zh:"类型"}};var aa=qc.editor.Localize=function(a){this.language=a,this.values=qc.editor.Language;var b=qc.editor.InspectorTips;for(var d in b)this.values[d]===c&&(this.values[d]=b[d])};aa.prototype={},aa.prototype.constructor=aa,aa.prototype._=function(a){return this.values[a]&&this.values[a][this.language]?this.values[a][this.language]:a};var ba=qc.editor.SkinManager=function(){var a=this;fa.e.on(fa.e.SKIN_CHANGE,function(b){a.skin=b.newValue})};ba.prototype={},ba.prototype.constructor=ba,ba.prototype.registerProjectIcons=function(){k.setImage("tree_folder",fa.assetPath+"tree_folder.png",16,13),k.setImage("contextmenu.9",fa.assetSkinPath+"contextmenu.9.png"),k.setImage("inspector_button.9",fa.assetSkinPath+"inspector_button.9.png"),k.setImage("inspector_button_active.9",fa.assetSkinPath+"inspector_button_active.9.png"),k.setImage("textfield.9",fa.assetSkinPath+"textfield.9.png"),k.setImage("dialog.9",fa.assetSkinPath+"dialog.9.png"),k.setImage("dialog.close.9",fa.assetSkinPath+"dialog.close.9.png"),k.setImage("dialog_button.9",fa.assetSkinPath+"dialog_button.9.png"),k.setImage("dialog_button_active.9",fa.assetSkinPath+"dialog_button_active.9.png"),k.setImage("dialogClose",fa.assetSkinPath+"dialogClose.png",18,18),k.setImage("folder",fa.assetPath+"folder.png"),k.setImage("treeExpand",fa.assetSkinPath+"expand.png",13,9),k.setImage("treeCollapse",fa.assetSkinPath+"collapse.png",9,13)},ba.prototype.registerCodeEditorIcons=function(){k.setImage("inspector_button.9",fa.assetSkinPath+"inspector_button.9.png"),k.setImage("inspector_button_active.9",fa.assetSkinPath+"inspector_button_active.9.png")},ba.prototype.registerIcons=function(){k.setImage("menu.9",fa.assetSkinPath+"menu.9.png"),k.setImage("menu_active.9",fa.assetSkinPath+"menu_active.9.png"),k.setImage("contextmenu.9",fa.assetSkinPath+"contextmenu.9.png"),k.setImage("banner_background.9",fa.assetSkinPath+"banner_background.9.png"),k.setImage("banner_button.9",fa.assetSkinPath+"banner_button.9.png"),k.setImage("banner_button_active.9",fa.assetSkinPath+"banner_button_active.9.png"),k.setImage("banner_button_active_left.9",fa.assetSkinPath+"banner_button_active_left.9.png"),k.setImage("banner_button_active_right.9",fa.assetSkinPath+"banner_button_active_right.9.png"),k.setImage("banner_creator_active.9",fa.assetSkinPath+"banner_creator_active.9.png"),k.setImage("banner_pause.9",fa.assetSkinPath+"banner_pause.9.png"),k.setImage("banner_nextframe.9",fa.assetSkinPath+"banner_nextframe.9.png"),k.setImage("banner_run.9",fa.assetSkinPath+"banner_run.9.png"),k.setImage("dialog.9",fa.assetSkinPath+"dialog.9.png"),k.setImage("dialog.close.9",fa.assetSkinPath+"dialog.close.9.png"),k.setImage("dialog_button.9",fa.assetSkinPath+"dialog_button.9.png"),k.setImage("dialog_button_active.9",fa.assetSkinPath+"dialog_button_active.9.png"),k.setImage("dialogClose",fa.assetSkinPath+"dialogClose.png",18,18),k.setImage("banner_pause_active.9",fa.assetSkinPath+"banner_pause_active.9.png"),k.setImage("banner_nextframe_active.9",fa.assetSkinPath+"banner_nextframe_active.9.png"),k.setImage("banner_run_active.9",fa.assetSkinPath+"banner_run_active.9.png"),k.setImage("preview.9",fa.assetSkinPath+"preview.9.png"),k.setImage("tab.9",fa.assetSkinPath+"tab.9.png"),k.setImage("textfield.9",fa.assetSkinPath+"textfield.9.png"),k.setImage("textfield_active.9",fa.assetSkinPath+"textfield_active.9.png"),k.setImage("addcomponent_active.9",fa.assetSkinPath+"addcomponent_active.9.png"),k.setImage("inspector_button.9",fa.assetSkinPath+"inspector_button.9.png"),k.setImage("inspector_button_active.9",fa.assetSkinPath+"inspector_button_active.9.png"),k.setImage("uncheckIcon",fa.assetSkinPath+"uncheckIcon.png",15,15),k.setImage("checkIcon",fa.assetSkinPath+"checkIcon.png",15,15),k.setImage("panel_title.9",fa.assetSkinPath+"panel_title.9.png"),k.setImage("panel_title_text.9",fa.assetSkinPath+"panel_title_text.9.png"),k.setImage("treeExpand",fa.assetSkinPath+"expand.png",13,9),k.setImage("treeCollapse",fa.assetSkinPath+"collapse.png",9,13),k.setImage("objectpicker",fa.assetSkinPath+"objectpicker.png",15,15),k.setImage("project_add",fa.assetSkinPath+"project_add.png",11,11),k.setImage("project_add.9",fa.assetSkinPath+"project_add.9.png"),k.setImage("pan",fa.assetSkinPath+"pan.png",22,22),k.setImage("pan_active",fa.assetSkinPath+"pan_active.png",22,22),k.setImage("move",fa.assetSkinPath+"move.png",22,22),k.setImage("move_active",fa.assetSkinPath+"move_active.png",22,22),k.setImage("pause",fa.assetSkinPath+"pause.png",17,20),k.setImage("pause_active",fa.assetSkinPath+"pause_active.png",23,27),k.setImage("play",fa.assetSkinPath+"play.png",19,22),k.setImage("play_active",fa.assetSkinPath+"play_active.png",26,28),k.setImage("step",fa.assetSkinPath+"step.png",22,22),k.setImage("step_active",fa.assetSkinPath+"step_active.png",30,30),k.setImage("scale",fa.assetSkinPath+"scale.png",22,22),k.setImage("scale_active",fa.assetSkinPath+"scale_active.png",22,22),k.setImage("transform",fa.assetSkinPath+"transform.png",22,22),k.setImage("transform_active",fa.assetSkinPath+"transform_active.png",22,22),k.setImage("fitContent",fa.assetSkinPath+"fitContent.png",22,22),k.setImage("fitContent_active",fa.assetSkinPath+"fitContent_active.png",22,22),k.setImage("grid",fa.assetSkinPath+"grid.png",22,22),k.setImage("grid_active",fa.assetSkinPath+"grid_active.png",22,22),k.setImage("debug",fa.assetSkinPath+"debug.png",22,22),k.setImage("debug_active",fa.assetSkinPath+"debug_active.png",22,22),k.setImage("project_expand",fa.assetPath+"project_expand.png",23,24),k.setImage("project_collapse",fa.assetPath+"project_collapse.png",23,24),k.setImage("project",fa.assetSkinPath+"project.png",17,14),k.setImage("hierarchy",fa.assetSkinPath+"hierarchy.png",13,11),k.setImage("inspector",fa.assetSkinPath+"inspector.png",16,16),k.setImage("delete",fa.assetPath+"delete.png",15,15),k.setImage("lock",fa.assetPath+"lock.png",15,15),k.setImage("unlock",fa.assetPath+"unlock.png",15,15),k.setImage("refresh",fa.assetPath+"refresh.png",15,15),k.setImage("tree_link_folder",fa.assetPath+"tree_link_folder.png",16,13),k.setImage("tree_assets_folder",fa.assetPath+"tree_assets_folder.png",16,13),k.setImage("tree_atlas_folder",fa.assetPath+"tree_atlas_folder.png",16,13),k.setImage("tree_css_folder",fa.assetPath+"tree_css_folder.png",16,13),k.setImage("tree_js_folder",fa.assetPath+"tree_js_folder.png",16,13),k.setImage("tree_prefab_folder",fa.assetPath+"tree_prefab_folder.png",16,13),k.setImage("tree_raw_folder",fa.assetPath+"tree_raw_folder.png",16,13),k.setImage("tree_sprite_folder",fa.assetPath+"tree_sprite_folder.png",16,13),k.setImage("tree_audio_folder",fa.assetPath+"tree_audio_folder.png",16,13),k.setImage("tree_excel_folder",fa.assetPath+"tree_excel_folder.png",16,13),k.setImage("tree_font_folder",fa.assetPath+"tree_font_folder.png",16,13),k.setImage("tree_state_folder",fa.assetPath+"tree_state_folder.png",16,13),k.setImage("tree_folder",fa.assetPath+"tree_folder.png",16,13),k.setImage("folder",fa.assetPath+"folder.png"),k.setImage("assets_folder",fa.assetPath+"assets_folder.png"),k.setImage("atlas_folder",fa.assetPath+"atlas_folder.png"),k.setImage("audio_folder",fa.assetPath+"audio_folder.png"),k.setImage("excel_folder",fa.assetPath+"excel_folder.png"),k.setImage("font_folder",fa.assetPath+"font_folder.png"),k.setImage("state_folder",fa.assetPath+"state_folder.png"),k.setImage("css_folder",fa.assetPath+"css_folder.png"),k.setImage("js_folder",fa.assetPath+"js_folder.png"),k.setImage("prefab_folder",fa.assetPath+"prefab_folder.png"),k.setImage("raw_folder",fa.assetPath+"raw_folder.png"),k.setImage("sprite_folder",fa.assetPath+"sprite_folder.png"),k.setImage("link_folder",fa.assetPath+"link_folder.png"),k.setImage("CssIcon",fa.assetPath+"CssIcon.png"),k.setImage("JsIcon",fa.assetPath+"JsIcon.png"),k.setImage("JsonIcon",fa.assetPath+"JsonIcon.png"),k.setImage("FontIcon",fa.assetPath+"FontIcon.png"),k.setImage("SoundIcon",fa.assetPath+"SoundIcon.png"),k.setImage("StateIcon",fa.assetPath+"StateIcon.png"),k.setImage("UnknowIcon",fa.assetPath+"UnknowIcon.png"),k.setImage("alert",fa.assetPath+"alert.png",16,16),k.setImage("lost",fa.assetRootPath+"lost.png"),k.setImage("inspector_rectTransform",fa.assetPath+"inspector_rectTransform.png",22,22),k.setImage("inspector_button",fa.assetPath+"inspector_button.png",22,22),k.setImage("inspector_image",fa.assetPath+"inspector_image.png",22,22),k.setImage("inspector_toggle",fa.assetPath+"inspector_toggle.png",22,22),k.setImage("inspector_scrollbar",fa.assetPath+"inspector_scrollbar.png",22,22),k.setImage("inspector_scrollview",fa.assetPath+"inspector_scrollview.png",22,22),k.setImage("inspector_progressbar",fa.assetPath+"inspector_progressbar.png",22,22),k.setImage("inspector_node",fa.assetPath+"inspector_node.png",22,22),k.setImage("inspector_text",fa.assetPath+"inspector_text.png",22,22),k.setImage("inspector_sound",fa.assetPath+"inspector_sound.png",22,22),k.setImage("inspector_sprite",fa.assetPath+"inspector_sprite.png",22,22),k.setImage("inspector_slider",fa.assetPath+"inspector_slider.png",22,22),k.setImage("inspector_inputfield",fa.assetPath+"inspector_inputfield.png",22,22),k.setImage("inspector_particle",fa.assetPath+"inspector_particle.png",22,22),k.setImage("inspector_dom",fa.assetPath+"inspector_dom.png",22,22),k.setImage("inspector_tilemap",fa.assetPath+"inspector_tilemap.png",22,22),k.setImage("inspector_title_tilemap",fa.assetPath+"inspector_title_tilemap.png",15,15),k.setImage("inspector_title_tilelayer",fa.assetPath+"inspector_title_tilelayer.png",15,15)},ba.prototype.initTheme=function(){qc.widget.List.prototype._indent=16,qc.widget.Tree.prototype._indent=16,qc.editor.ItemList.prototype._indent=16,qc.widget.Menu.prototype._topGap=3,qc.widget.Menu.prototype._bottomGap=3,qc.widget.Menu.prototype._gap=15,qc.widget.Menu.prototype._labelFont="13px Arial",qc.editor.ItemList.prototype._rowHeight=18,qc.widget.List.prototype._rowHeight=18,qc.widget.List.prototype._labelFont="11px Arial",qc.widget.Tree.prototype._rowHeight=18,qc.widget.Tree.prototype._labelFont="11px Arial",qc.widget.Tree.prototype._expandIcon="treeExpand",qc.widget.Tree.prototype._collapseIcon="treeCollapse",qc.widget.ContextMenu.prototype._rowHeight=22,qc.widget.ContextMenu.prototype._labelFont="13px Arial",qc.widget.ContextMenu.prototype._padding=[5,1,5,1],qc.widget.ContextMenu.prototype._leftGap=15,qc.widget.ContextMenu.prototype._rightGap=15,qc.widget.Tabs.prototype._tabHeight=26,qc.widget.Tabs.prototype._labelFont="13px Arial",qc.editor.Dialog.prototype._contentPadding=[20,10,10,20],qc.editor.Dialog.prototype._borderWidth=0,qc.editor.Dialog.prototype._titleHeight=25,qc.editor.Dialog.prototype._buttonGap=5,qc.editor.Dialog.prototype._buttonFont="14px Arial",qc.editor.Dialog.prototype._htmlFont="16px Arial",qc.widget.TextField.prototype._padding=[1,2,1,2],qc.widget.List.prototype._activable=!0,qc.widget.List.prototype.getSelectBackground=function(){return this===fa.activeView?this._selectBackground:this._inactiveSelectBackground},qc.widget.List.prototype.getLabelColor=function(a){if(a===this.draggingData)return"#fce486";if(this.checkMode){if(this._focusData===a)return this.labelSelectColor}else if(this.isSelected(a))return this.labelSelectColor;return this.labelColor},qc.editor.ComponentsList.prototype.getSelectBackground=function(){return this._selectBackground},qc.editor.ComponentsList.prototype.getLabelColor=function(a){return this.isSelected(a)?this.labelSelectColor:this.labelColor},qc.widget.Tree.prototype._activable=!0,qc.widget.Tree.prototype.getSelectBackground=qc.widget.List.prototype.getSelectBackground,qc.widget.Tree.prototype.getLabelColor=qc.widget.List.prototype.getLabelColor,qc.widget.graph.GraphView.prototype._activable=!0,qc.widget.graph.GraphView.prototype.getLabelColor=function(a){return a===this.draggingData?"#fce486":a.s("label.visible")===!1?"rgba(0, 0, 0, 0)":this.isSelected(a)?this._labelSelectColor:this._labelColor},qc.widget.graph.GraphView.prototype.getLabelBackground=function(a){return this.isSelected(a)&&a.s("label.visible")!==!1&&"list"!==this.layout?this===fa.activeView?this._selectBackground:this._inactiveSelectBackground:null},qc.widget.graph.GraphView.prototype.getLabel2Color=function(a){return a.s("label2.visible")===!1?"rgba(0, 0, 0, 0)":this.isSelected(a)?this._labelSelectColor:this._labelColor},qc.widget.graph.GraphView.prototype.getLabel2Background=function(a){return this.isSelected(a)&&a.s("label2.visible")!==!1?this===fa.activeView?this._selectBackground:this._inactiveSelectBackground:null},qc.widget.Button.prototype.getStateIcon=function(){var a=this,b=a.state;return"active"===b?this.activeIcon||this.icon:this.icon},qc.widget.ToggleButton.prototype.getStateIcon=function(){var a=this,b=a.selected;return b?this.activeIcon||this.icon:this.icon}},ba.prototype.overrideSizeMethod=function(){qc.widget.Default.calculateClientWidth=function(a){return a.width},qc.widget.Default.calculateClientHeight=function(a){return a.height},qc.widget.TextField.prototype.calculateClientWidth=function(){return this.width},qc.widget.TextField.prototype.calculateClientHeight=function(){return this.height},qc.widget.ComboBox.prototype.calculateClientWidth=function(){return this.width-2},qc.widget.ComboBox.prototype.calculateClientHeight=function(){return this.height-2}},b.defineProperties(ba.prototype,{page:{get:function(){return this._page},set:function(a){this._page=a}},skin:{get:function(){return this._skin},set:function(a){this._skin=a;var b=this.skinMap[a+"_"+this.page];b&&b()}},skinMap:{value:{Dark_Editor:f,Light_Editor:i,Dark_Project:d,Light_Project:g,Dark_CodeEditor:e,Light_CodeEditor:h}}});var ca=qc.editor.Log=function(){this.enableTrace=!0};ca.prototype={},ca.prototype.constructor=ca,ca.prototype.trace=function(){this.enableTrace&&console.log(this.toContent(arguments))},ca.prototype.print=function(){console.log(this.toContent(arguments))},ca.prototype.important=function(){console.log("%c"+this.toContent(arguments),"color:green")},ca.prototype.error=function(){console.log(this.toContent(arguments));for(var a=1;a<arguments.length;a++)if(arguments[a]&&arguments[a].stack)return void console.error(arguments[a].stack);console.trace()},ca.prototype.toContent=function(a){for(var b=a[0],c=1;c<a.length;c++){var d=new RegExp("\\{"+(c-1)+"\\}","g");b=b.replace(d,a[c])}return b};var da=qc.editor.Event=function(){this._emitter=new qc.widget.Emitter,this.SELECT_COMPONENT="selectComponent",this.SELECT_IMAGE="selectImage",this.EDIT_MODE_CHANGE="editModeChange",this.GRID_VISIBLE_CHANGE="gridVisible",this.PLAYING_CHANGE="playingChange",this.PROPERTY_CHANGE="propertyChange",this.DATA_MODEL_CHANGE="dataModelChange",this.ACTIVE_NODE_CHANGE="activeNodeChange",this.ORIENTATION_CHANGE="orientationChange",this.SKIN_CHANGE="skinChange",this.EDITOR_HITAREA_ENABLED_CHANGE="editHitAreaEnabledChange",this.GAME_SIZE_CHANGE="gameSizeChange",this.GAME_CHANGE="gameChange",this.SCENE_LOADED="sceneLoaded",this.SCENE_INITED="sceneInited",this.HIDDEN_SCENE_INITED="hiddenSceneInited",this.HIDDEN_SCENE_LOADED="hiddenSceneLoaded",this.ACTIVE_VIEW_CHANGE="activeViewChange",this.INSPECTOR_VIEW_CLEAR="inspectorViewClear",this.EXPLORE="explore",this.BG_RESOURCE_LOADED="bgResourceLoaded",this.SCENE_RESOURCE_LOADED="sceneResourceLoaded",this.JS_CHANGED="jsChanged",this.INSPECTOR_COMP_VALUE_CHANGE="inspectorCompValueChange",this.SCENE_SAVED="sceneSaved"};da.prototype={},da.prototype.constructor=da,da.prototype.on=function(a,b,c,d){return this._emitter.on(a,b,c,d)},da.prototype.off=function(a,b,c){return this._emitter.off(a,b,c)},da.prototype.emit=function(a,b){return this._emitter.emit(a,b)};var ea=m("qc.editor.Global",null,function(){this.e=new qc.editor.Event,this._jsPath=this.getJsPath(),this._imgScale=1.5>l?"1x":"2x",this.assetPath=this._jsPath+"imgs/"+this._imgScale+"/",this.assetRootPath=this._jsPath+"imgs/",this._gamePlugin={postRender:function(){fa.inspector.update(),fa.scene.checkForUpdate()},destroy:function(){}},qc.widget.Default.onViewFocused=function(a){a._activable&&(fa.activeView=a)}});ea.prototype._windowDisabled=!1,ea.prototype.getJsPath=function(){var a=document.scripts;a=a[a.length-1].src;var b=a.substring(0,a.lastIndexOf("/")+1);return b},ea.prototype._hackpp=function(){PIXI.DisplayObjectContainer.prototype.updateTransform=function(){if(this.displayObjectUpdateTransform(),!this._cacheAsBitmap)for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform()},Phaser.Camera.prototype.reset=function(){this.target=null,fa.workable&&fa.scene.editable?(fa.scene.translateX=0,fa.scene.translateY=0):(this.view.x=0,this.view.y=0)}},ea.prototype.shutdown=function(){this.workable&&(qc.widget.Default.hideToolTip(),this.undo.reset(),a.removeEventListener("mouseup",this.game.__onMouseUpGlobal,!0),this.game.shutdown())},ea.prototype.checkReloadForJsChange=function(){!fa.reloadSceneOnFocus||fa.playing||fa.prefabInfo?!fa.reloadEditorOnFocus||fa.playing||fa.prefabInfo||(fa.workable&&(fa.e.emit(fa.e.JS_CHANGED),qc.editor.Operation.SAVE_CURR_SCENE(function(){fa.silentRefresh=!0,a.location.reload()})),delete fa.reloadEditorOnFocus):(fa.workable&&(fa.e.emit(fa.e.JS_CHANGED),qc.editor.Operation.SAVE_CURR_SCENE(function(){fa.scene.reload()})),delete fa.reloadSceneOnFocus)},ea.prototype.saveEditingPrefab=function(){fa.prefabInfo&&(qc.editor.Operation.SAVE_PREFAB(fa.prefabInfo.prefab,fa.prefabInfo.treeData.id),fa.cancelEditingPrefab(!0))},ea.prototype.cancelEditingPrefab=function(a){if(fa.prefabInfo){var b=function(){var a=fa.prefabInfo.visibleMap;for(var b in a){var d=fa.dataModel.getDataById(b);d&&(d.node.visible=a[b])}var e=[];fa.game.world.children.forEach(function(b){a[b.uuid]===c&&e.push(b)}),e.forEach(function(a){a.destroyImmediately()}),r(fa.prefabInfo.saveDiv),r(fa.prefabInfo.cancelDiv),fa.runBanner.findViewById("play").disabled=!1,fa.prefabInfo=null,fa.undo.reset(),ib(),fa.scene.fitContent(!0)},d=fa.prefabInfo.json,e=JSON.stringify(fa.game.serializer.buildBundle(fa.prefabInfo.prefab,{}));d===e||a?b():nb(fa._("Do you want to save the changes?"),fa._("Confirm"),[{text:fa._("Save"),key:"enter",onClick:function(){this.hide(),qc.editor.Operation.SAVE_PREFAB(fa.prefabInfo.prefab,fa.prefabInfo.treeData.id),b()}},{text:fa._("Don't Save"),onClick:function(){this.hide(),b()}},{text:fa._("Cancel"),key:"esc",onClick:function(){this.hide()}}])}},ea.prototype.startEditingPrefab=function(a){if(a&&fa.workable){if(fa.playing)return void fa.notification.warn(fa._("It is not allowed to edit prafab in running mode."));var b=fa.game.assets.find(a.resUUID);if(!b)return void fa.notification.warn(fa._("Asset is not loaded, please try later."));if(b.meta.type===this.ASSET_TYPE.ASSET_PREFAB){if(b.hasUnloadedDependence(fa.game))return void fa.notification.warn(fa._("Asset is not loaded, please try later."));fa.prefabInfo&&fa.cancelEditingPrefab();var c=fa.game.add.clone(b),d={};fa.game.world.children.forEach(function(a){a!==c&&(d[a.uuid]=a.visible,a.visible=!1)}),fa.prefabInfo={prefab:c,asset:b,treeData:a,visibleMap:d},fa.game.world.addChild(c),fa.runBanner.findViewById("play").disabled=!0;var e=fa.prefabInfo.saveDiv=fa.scene.createDiv(),f=e.style;f.bottom="10px",f.right="70px",f.width="50px",f.cursor="pointer",f.textAlign="center",e.innerHTML="Save",e.onclick=function(){fa.saveEditingPrefab(),fa.checkReloadForJsChange()};var g=fa.prefabInfo.cancelDiv=fa.scene.createDiv(),f=g.style;f.bottom="10px",f.right="10px",f.width="50px",f.cursor="pointer",f.textAlign="center",g.innerHTML="Cancel",g.onclick=function(){fa.cancelEditingPrefab(),fa.checkReloadForJsChange()},fa.undo.reset(),ib(),fa.scene.focusData(fa.dataModel.getDataById(c.uuid),{finishFunc:function(){fa.prefabInfo.json=JSON.stringify(fa.game.serializer.buildBundle(c,{}))}})}}},b.defineProperties(ea.prototype,{assetSkinPath:{get:function(){return this._jsPath+"imgs/"+this._imgScale+"/"+this.skin+"/"}},activeView:{get:function(){return this._activeView},set:function(a){var b=this._activeView;b&&(b.iv(),b.invalidateSelection&&b.invalidateSelection()),this._activeView=a,a&&(a.iv(),a.invalidateSelection&&a.invalidateSelection()),this.e.emit(this.e.ACTIVE_VIEW_CHANGE,{oldValue:b,newValue:a})}},workable:{get:function(){return this.game&&this.game.phaser.world&&this.game.getWindow()}},editHitAreaEnabled:{get:function(){return this.scene.editHitAreaEnabled},set:function(a){var b=this.scene.editHitAreaEnabled;b!==a&&this.e.emit(this.e.EDITOR_HITAREA_ENABLED_CHANGE,{oldValue:b,newValue:a})}},editMode:{get:function(){return this._editMode},set:function(a){var b=this._editMode;b!==a&&(this._editMode=a,this.e.emit(this.e.EDIT_MODE_CHANGE,{oldValue:b,newValue:a}),fa.storage.set("editMode",a))}},projectPath:{get:function(){return this._projectPath},set:function(a){this._projectPath=a}},windowFocused:{get:function(){return this._windowFocused},set:function(a){this._windowFocused=a}},gridVisible:{get:function(){return this._gridVisible},set:function(a){var b=this._gridVisible;b!==a&&(this._gridVisible=a,this.e.emit(this.e.GRID_VISIBLE_CHANGE,{oldValue:b,newValue:a}),fa.storage.set("gridVisible",a))}},playing:{get:function(){return this._playing},set:function(a){var b=this._playing;if(b!==a){if(fa.prefabInfo)return void fa.notification.warn(fa._("Please first stop to edit prafab."));this._playing=a,this.e.emit(this.e.PLAYING_CHANGE,{oldValue:b,newValue:a}),this.shutdown()}}},orientation:{get:function(){return this._orientation},set:function(a){var b=this._orientation;b!==a&&(fa.windowDisabled=!0,this.shutdown(),this._orientation=a,this.e.emit(this.e.ORIENTATION_CHANGE,{oldValue:b,newValue:a}))}},windowDisabled:{get:function(){return this._windowDisabled},set:function(a){this._windowDisabled!==a&&fa.mainContainer&&(this._windowDisabled=a,a?(fa.mainContainer.setDisabled(!0,fa.assetPath+"loading.gif"),fa.mainContainer.disabledBackground="#333333",fa.mainContainer.requestFocus()):(fa.mainContainer.setDisabled(!1),fa.hierarchy.requestFocus()))}},skin:{get:function(){return this._skin},set:function(a){var b=this._skin;b!==a&&(this._skin=a,this.e.emit(this.e.SKIN_CHANGE,{oldValue:b,newValue:a}))}},gameSize:{get:function(){return this._gameSize},set:function(a){var b=this._gameSize;this._gameSize=a,this.e.emit(this.e.GAME_SIZE_CHANGE,{oldValue:b,newValue:a})}},dataModel:{get:function(){return this._dataModel},set:function(a){var b=this._dataModel;this._dataModel=a,this.e.emit(this.e.DATA_MODEL_CHANGE,{oldValue:b,newValue:a})}},game:{get:function(){return this._game},set:function(b){var c=this._game;c&&(c.plugins.remove(this._gamePlugin),a.removeEventListener("mouseup",c.__onMouseUpGlobal,!0));var d=b.getWindow();a.Phaser=d.Phaser,a.PIXI=d.PIXI;for(var e in d.qc)a.qc[e]=d.qc[e];fa.inspector._nodesMap=[[qc.UIImage,qc.editor.ImagePanel],[qc.Button,qc.editor.ButtonPanel],[qc.UIText,qc.editor.UITextPanel],[qc.Toggle,qc.editor.TogglePanel],[qc.ScrollView,qc.editor.ScrollViewPanel],[qc.ScrollBar,qc.editor.ScrollBarPanel],[qc.Sound,qc.editor.SoundPanel],[qc.ProgressBar,qc.editor.ProgressBarPanel],[qc.Slider,qc.editor.SliderPanel],[qc.Sprite,qc.editor.SpritePanel],[qc.InputField,qc.editor.InputFieldPanel],[qc.Tilemap,qc.editor.TilemapPanel],[qc.TileLayer,qc.editor.TileLayerPanel],[qc.ObjectLayer,qc.editor.ObjectLayerPanel],[qc.Dom,qc.editor.DomPanel],[qc.Graphics,qc.editor.GraphicsPanel]],this._hackpp(),this._game=b,b.canvas.tabIndex=-1,b.plugins.add(this._gamePlugin),b.__onMouseUpGlobal=b.input.mouse._onMouseUpGlobal,a.addEventListener("mouseup",b.input.mouse._onMouseUpGlobal,!0),this.gameDebugger&&this.gameDebugger.destroy(),
this.gameDebugger=new qc.editor.GameDebugger(b),this.dataModel=new qc.editor.GameModel(b),this.e.emit(this.e.GAME_CHANGE,{oldValue:c,newValue:b}),d.__iframePointDown||(d.__iframePointDown=function(a){Eb(a.target)||(qc.widget.Default.closePopup(),b.canvas.focus())},d.addEventListener("mousedown",d.__iframePointDown,!0),d.addEventListener("touchstart",d.__iframePointDown,!0)),d.__iframeContextMenu||(d.__iframeContextMenu=function(a){Eb(a.target)||a.preventDefault()},d.addEventListener("contextmenu",d.__iframeContextMenu,!0)),d.__iframeKeydown||(d.__iframeKeydown=function(a){Eb(a.target)||(E(a)?a.preventDefault():P(a)&&a.preventDefault())},d.addEventListener("keydown",d.__iframeKeydown,!1))}}});var fa=a.G=new ea,ga=qc.editor.Clipboard=function(){this.data=null,this.type=""};ga.prototype={},ga.prototype.constructor=ga;var ha=function(){var b=function(a){a.preventDefault()};a.addEventListener("dragenter",b,!1),a.addEventListener("dragexit",b,!1),a.addEventListener("dragover",b,!1),a.addEventListener("drop",b,!1)};ha.prototype={},ha.prototype.constructor=ha,b.defineProperties(ha.prototype,{tip:{get:function(){if(!this._tip){this._tip=p();var a=this.tip.style;a.whiteSpace="nowrap",a.color="white",a.background="rgba(0,0,0,0.5)",a.font=k.labelFont,a.padding="6px",a.borderRadius="4px",a.position="absolute"}return this._tip}}}),ha.prototype.isDragging=function(){var a=this.tip;return a&&a.parentNode?!0:void 0},ha.prototype.showTip=function(a,b){this.tip.innerHTML=a,this.tip.parentNode!==document.body&&document.body.appendChild(this.tip);var c=C(b);this.tip.style.left=c.x+15+"px",this.tip.style.top=c.y+"px"},ha.prototype.hideTip=function(){r(this.tip)},ha.prototype.clearDropView=function(a,b){this._dropView&&(this._dropView.handleCrossDrag(a,"exit",b),this._dropView=null)},ha.prototype.crossDrag=function(a,b){var c=this._dropView,d=this._findDropView(a);c!==d?(c&&c.handleCrossDrag(a,"exit",b),d&&d.handleCrossDrag(a,"enter",b)):d&&d.handleCrossDrag(a,"over",b),this._dropView=d},ha.prototype.crossDrop=function(a,b){this._dropView&&(this._dropView.handleCrossDrag(a,"drop",b),this._dropView=null)},ha.prototype.crossCancel=function(a,b){this._dropView&&(this._dropView.handleCrossDrag(a,"cancel",b),this._dropView=null)},ha.prototype._findDropView=function(a){for(var b=Bb(a);b&&!b._dropView;)b=b.parentNode;return b?b._dropView:null};var ia=qc.editor.Storage=function(a){this.key=a+"_editor",this.restore()};ia.prototype={},ia.prototype.constructor=ia,ia.prototype.restore=function(){var b=a.localStorage.getItem(this.key);this._data=b?JSON.parse(b):{}},ia.prototype.save=function(){var b=JSON.stringify(this._data);a.localStorage.setItem(this.key,b)},ia.prototype.set=function(a,b){this._data[a]=b,this.save()},ia.prototype.del=function(a){this._data[a]&&delete this._data[a],this.save()},ia.prototype.get=function(a){return this._data[a]};var ja=m("qc.editor.ContextMenu",qc.widget.ContextMenu,function Pd(a){var b=this;Pd["super"].constructor.call(b,a),b._bindingHide=function(){b.close()}});ja.prototype.registerCloseEvent=function(a){ja["super"].registerCloseEvent.call(this,a),fa.e.on(fa.e.JS_CHANGED,this._bindingHide)},ja.prototype.unregisterCloseEvent=function(a){ja["super"].unregisterCloseEvent.call(this,a),fa.e.off(fa.e.JS_CHANGED,this._bindingHide)};var ka=m("qc.editor.ItemNodeUI",qc.widget.graph.NodeUI,function Qd(a,b){var c=this;Qd["super"].constructor.call(c,a,b)});ka.prototype.drawBody=function(a){var b=this,c=b.data,d=b.gv,e=c._position,f=c._anchor,g=c._rotation,h=c.width,i=c.height,j=c._scale,l=j.x,m=j.y,n={x:-h*f.x,y:-i*f.y,width:h,height:i};n.x+=e.x,n.y+=e.y;var o=g||1!==l||1!==m;o&&(a.save(),k.gTranslate(a,e.x,e.y),k.gRotate(a,g),a.scale(l,m),k.gTranslate(a,-e.x,-e.y)),"list"===d.layout&&d.isSelected(c)&&(a.beginPath(),a.fillStyle=d===fa.activeView?d._selectBackground:d._inactiveSelectBackground,a.rect(0,n.y,d.viewRect.width,n.height),a.fill()),o&&a.restore(),ka["super"].drawBody.call(b,a)};var la=m("qc.editor.ItemNode",qc.widget.graph.Node,function Rd(a){var b=this;Rd["super"].constructor.call(b,a),b.s("select.width",0),b.s("pixel.perfect",!1),b.anchor={x:0,y:0}},{_wrapImage:{width:{func:function(a){return a._width||48}},height:{func:function(a){return a._height||48}},clip:!0,comps:{func:function(a){return a.getImageComps()}}}},{},{uiClass:{get:function(){return ka}},image:{set:function(a){qc.editor.ItemNode.setSuperProperty(this,"image",a)},get:function(){return this._wrapImage}}});la.prototype.getImageComps=function(){return[{type:"image",stretch:null,name:{func:function(a,b){var c=a._canvas;if(c)return c;var d=k.getImage(a._image);if(d&&"[object HTMLImageElement]"===d.toString()&&null!=a.a("clipX")){var e=a.width,f=a.height;"list"===b.layout&&(e=f,f=f),c=a._canvas=document.createElement("canvas"),t(c,e,f);var g,h=s(c,0,0,1),i=(a.a("clipX"),a.a("clipY"),a.a("clipWidth")),j=a.a("clipHeight");(i>e||j>f)&&(g=Math.min(e/i,f/j),i*=g,j*=g);var l=Math.round((e-i)/2),m=Math.round((f-j)/2);return h.drawImage(d,a.a("clipX"),a.a("clipY"),a.a("clipWidth"),a.a("clipHeight"),l,m,i,j),h.restore(),c}return d}},rect:{func:function(a,b){var c,d=b._indent;return"tile"===b.layout?b._itemImageRect:c=[b.getListIndent(a),1,d,b._rowHeight-2]}},shadow:{func:function(a,b){return b.isSelected(a)}},shadowOffsetX:0,shadowOffsetY:0,shadowBlur:6}]},la.prototype._imageRelativeProperties={"a:clipX":!0,"a:clipY":!0,"a:clipWidth":!0,"a:clipHeight":!0,image:!0,width:!0,height:!0},la.prototype.onPropertyChange=function(a){la["super"].onPropertyChange.call(this,a);var b=this;b._imageRelativeProperties[a.property]&&(b._canvas=null)};var ma=m("qc.editor.ItemList",qc.widget.graph.GraphView,function Sd(a){var b=this;Sd["super"].constructor.call(b);var c=b.dataModel;b.autoMakeVisible=!0,c.indexAdjustable=!1,b.on("viewChange",function(a){b._doLayoutFlag&&("beginValidate"===a.kind?b.doLayout():"endValidate"===a.kind&&(b.translate(0,0),b._doLayoutFlag=!1))}),b.editable=!1,c.on("dataModelChange",function(){b._doLayoutFlag=!0}),b.on("propertyChange",function(a){["width","height","itemWidth","itemHeight","layout","itemGap","visibleFunc"].indexOf(a.property)>=0&&(b._doLayoutFlag=!0),("itemWidth"===a.property||"itemHeight"===a.property)&&b.calcItemImageRect()}),b.calcItemImageRect(),k.initObject(b,a),b.movableFunc=function(){return!1}},{_layout:"tile",_itemWidth:48,_itemHeight:48,_itemGap:16},{properties:["layout","itemWidth","itemHeight","itemGap"]});ma.prototype.calcItemImageRect=function(){var a=this;"tile"===a.layout&&(a._itemImageRect=[4,4,a.itemWidth-8,a.itemHeight-8])},ma.prototype.adjustTranslateX=function(){return 0},ma.prototype.adjustTranslateY=function(a){if(0>a){var b=this.contentRect,c=this.viewRect,d=this.itemGap;if("tile"===this.layout&&b.height+d<=c.height||"list"===this.layout&&b.height<=c.height)return 0;var e=c.height;return"tile"===this.layout&&(e-=d),-a>b.height-e?-b.height+e:a}return 0},ma.prototype.setZoomImpl=function(){},ma.prototype.handleScroll=function(a,b){this.translate(0,b*(k.isFirefox?40:1),!1),k.preventDefault(a),a.stopPropagation()},ma.prototype.getListLabelIndent=function(){var a=this,b=a._indent;return 2*b},ma.prototype.getListIndent=function(){var a=this,b=a._indent;return b},ma.prototype.calcRightGap=function(){return this.itemGap},ma.prototype.doLayout=function(){var a,b=this,c=b.layout,d=b.dataModel,e=[],f=b.itemWidth,g=b.itemHeight,h=b.itemGap,i=b.clientWidth;if(d.datas.forEach(function(a){b.isVisible(a)&&e.push(a)}),"list"===c){g=b._rowHeight;for(var j=0;j<e.length;j++){a=e[j];var k=b.getListLabelIndent(a);a.width=i,a.height=g,a.s("label.position",16),a.s("label.offset.x",k),a.s("label.offset.y",0),a.s("label.max",null),a.x=0,a.y=g*j}}else if("tile"===c){var l=0,m=0,n=0,o=f+h,p=g+h+16;l+=h,m+=h;for(var j=0;j<e.length;j++)a=e[j],a.width=f,a.height=g,a.s("label.position",31),a.s("label.offset.y",1),a.s("label.offset.x",0),a.s("label.max",f),a.x=l,a.y=m,(n+2)*o+b.calcRightGap()>i?(l=h,j!==e.length-1&&(m+=p),n=0):(l+=o,n++)}},b.defineProperty(ma.prototype,"scrollRect",{get:function(){var a=this,b=a._viewRect,c=k.unionRect(a.contentRect,b);return c.height+=c.y,c.y=0,c}});var na=m("qc.editor.EditorTree",qc.widget.Tree,function(a){na["super"].constructor.call(this,a),this.editable=!0,this.dragToIndexEnabled=!0,this.clearSelectionOnBackgroundClicked=!0,this._lastClickTime=(new Date).getTime(),this.addTopPainter(this.drawDNDState),this.view._dropView=this});b.defineProperties(na.prototype,{editable:{get:function(){return this._editable},set:function(a){this._editable=a}},topRowOrderSelection:{get:function(){var a=this.selectionModel.topSelection,b={},c=[];return a.forEach(function(a){b[a.uuid]=a}),this.validateImpl(),this.rowDatas.forEach(function(a){b[a.uuid]&&c.push(a)}),c}}}),na.prototype._clearDragInfo=function(){fa.dragAndDrop.hideTip(),this._dragInfo&&(this._dragInfo=null,this.iv())},na.prototype._endDrag=function(){},na.prototype._endCrossDrag=function(){},na.prototype.drawDNDState=function(a){var b;if(this._dragInfo&&this._dragInfo.inView?b=this._dragInfo:this._crossDragInfo&&(b=this._crossDragInfo),b){var c=this.clientWidth,d=this.rowHeight,e=b.rowIndex,f=b.type;a.beginPath(),a.rect(0,e*d,c,d),a.fillStyle="rgba(0, 0, 0, 0.3)",a.fill(),"up"===f?(a.beginPath(),a.moveTo(0,e*d),a.lineTo(c,e*d)):"down"===f?(a.beginPath(),a.moveTo(0,(e+1)*d),a.lineTo(c,(e+1)*d)):"parent"===f&&(a.beginPath(),k.drawShape(a,"roundRect",{x:1,y:e*d,width:c-2,height:d})),a.lineWidth=2,a.strokeStyle="#507aea",a.stroke()}},na.prototype._dragging=function(a,b){var c=this.rowHeight,d=this.lp(a),e=d.y/c,f=Math.floor(e);if(f>this.rowDatas.length-1)b.rowIndex=this.rowDatas.length-1,b.type="down";else{b.rowIndex=f;var g=d.y-f*c;b.type=.25*c>g?"up":g>.75*c?"down":"parent"}this.dragToIndexEnabled||(b.type="parent"),this.autoScroll(a),this.iv()},na.prototype.handleDragAndDrop=function(a,b){if("prepare"===b)return void this._clearDragInfo();if("begin"===b){var c=this.draggingData.name;if(this.isSelected(this.draggingData)){var d=this.selection.length;c+=d>1?" (+"+d+") ":""}this._dragInfo={tip:c,view:this}}var e=this._dragInfo;if(e){if("begin"===b||"between"===b){var f=this.view.contains(Bb(a));return f?(e.inView=!0,this._dragging(a,e),fa.dragAndDrop.clearDropView(a,e)):(e.inView&&this.iv(),e.inView=!1,fa.dragAndDrop.crossDrag(a,e)),void fa.dragAndDrop.showTip(e.tip,a)}return"end"===b?(e.inView?this._endDrag(a,e):fa.dragAndDrop.crossDrop(a,e),void this._clearDragInfo()):"cancel"===b?(e.inView||fa.dragAndDrop.crossCancel(a,e),void this._clearDragInfo()):void 0}},na.prototype.handleCrossDrag=function(a,b,c){return"exit"===b||"cancel"===b?(this._crossDragInfo=null,void this.iv()):"enter"===b||"over"===b?(this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(a,this._crossDragInfo)):"drop"===b?(this._endCrossDrag(a,c),this._crossDragInfo=null,void this.iv()):void 0},na.prototype.handleDataDoubleSelect=function(a,b){var c=this;if(c.editable){if(c._pendingEditing)return void(c._pendingEditing="cancel");if(!L(a)){var d=c.getLevel(b);d++,c.getIcon(b)&&d++,c.lp(a).x>d*c.indent&&(c._pendingEditing=!0,setTimeout(function(){c._pendingEditing&&(k.popup||"cancel"===c._pendingEditing||!c.isSelected(b)||c!==fa.activeView||b.isProjectDir||c.beginEditing(b),delete c._pendingEditing)},700))}}},na.prototype.beginEditing=function(a){var b=this;if(b===fa.hierarchy&&b.drawRow===qc.widget.List.prototype.drawRow){var c=0,d=b.rowHeight,e=b.getRowIndex(a)*d+b.translateY,f=b.width-c,g=new qc.widget.TextField,h=g.getInput(),i=a.name;b._currentEditor=g,b.view.appendChild(g.view),n(g,c,e,f,d)}else{var j=b.getLevel(a);j++,b.getIcon(a)&&j++;var c=j*b.indent+1,d=b.rowHeight,e=b.getRowIndex(a)*d+this.translateY,f=b.width-c,g=new qc.widget.TextField,h=g.getInput(),i=a.name;b===fa.fileTree&&(g.maskRe=/[^\s\\/'"?\.]/),b._currentEditor=g,b.view.appendChild(g.view),n(g,c,e,f,d)}h.style.font=this.getLabelFont(a),h.onblur=function(){b.endEditing()},h.onkeydown=function(a){G(a)?b.endEditing():F(a)&&b.cancelEditing()},g._data=a,g.value=null==i?"":i,h.focus(),U(h.select,h)},na.prototype.rename=function(a,b){a.name=b},na.prototype.endEditing=function(){var a=this._currentEditor;a&&(this.rename(a._data,a.value),delete this._currentEditor,r(a.view),this.iv())},na.prototype.cancelEditing=function(){var a=this._currentEditor;a&&(delete this._currentEditor,r(a.view),this.iv())};var oa=m("qc.editor.DraggableButtonInteractor",b,function(a){var b=this;b._draggableButton=a,b.addListeners()},{clear:function(a){var b=this,c=b.view;"dnd"!==b._state||b._dragCancel||c.handleDragAndDrop(a,"end"),b._state=b._clientPoint=b._dragCancel=null},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this,c=b.view;b.clear(a),Y(a),c.requestFocus(),b._clientPoint=B(a),N(a)&&(c.handleDragAndDrop&&c.handleDragAndDrop(a,"prepare"),c.state="active",z(b,a))},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=this,c=b.view,d=b._state,e=b._clientPoint,f=B(a);if(d)"dnd"!==d||b._dragCancel||c.handleDragAndDrop(a,"between");else{var g=y(f,e);if(2>g)return;this._dragCancel||(b._state="dnd",c.handleDragAndDrop(a,"begin"))}},handle_mouseenter:function(){var a=this._draggableButton;k.isDragging()||(a.state="hover")},handle_mouseleave:function(){var a=this._draggableButton;a.state="normal"},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(a){var b=this,c=b._draggableButton;c.state=c.view.contains(a.target)?"hover":"normal",c.view.contains(a.target)&&!c._dragInfo&&(c.validate(),c.emit("click",a)),b.clear(a)},handle_keydown:function(a){var b=this,c=b.view;F(a)&&("dnd"!==b._state||b._dragCancel||(c.handleDragAndDrop(a,"cancel"),b._dragCancel=!0))}},{interactor:!0},{view:{get:function(){return this._draggableButton}}}),pa=m("qc.editor.DraggableButton",qc.widget.Button,function(a){var b=this;qc.widget.Button["super"].constructor.call(b,a),b._interactor=new oa(b)});pa.prototype.handleDragAndDrop=function(a,b){if("prepare"===b)return void this._clearDragInfo();"begin"===b&&(this._dragInfo={view:this,tip:this.id.replace("Create","")});var c=this._dragInfo;if(c)return"begin"===b||"between"===b?(fa.dragAndDrop.crossDrag(a,c),void fa.dragAndDrop.showTip(c.tip,a)):"end"===b?(fa.dragAndDrop.crossDrop(a,c),void this._clearDragInfo()):"cancel"===b?(fa.dragAndDrop.crossCancel(a,c),void this._clearDragInfo()):void 0},pa.prototype._clearDragInfo=function(){fa.dragAndDrop.hideTip(),this._dragInfo=null};var qa=(m("qc.editor.Button",qc.widget.Button,function Td(a){var b=this;Td["super"].constructor.call(b,a)}),m("qc.editor.InspectorButton",qc.editor.Button,function Ud(a){var b=this;Ud["super"].constructor.call(b,a)}),m("qc.editor.ToggleButton",qc.widget.ToggleButton,function Vd(){var a=this;Vd["super"].constructor.call(a),a.on("propertyChange",function(b){"selected"===b.property&&a.onValueChanged&&a.onValueChanged(a.formattedValue)})}));qa.prototype.formatValue=function(){return!!this.selected},b.defineProperties(qa.prototype,{formattedValue:{get:function(){return this.formatValue()}},onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}}});var ra=m("qc.editor.ButtonGroup",qc.widget.ButtonGroup,function Wd(a){var b=this;Wd["super"].constructor.call(b,a),b.scrollBarMode="off",b.on("propertyChange",function(a){"value"===a.property&&b.onValueChanged&&b.onValueChanged(b.formattedValue)}),b.eachable=!1});ra.prototype.formatValue=function(a){return a},b.defineProperties(ra.prototype,{onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}},formattedValue:{get:function(){return this.formatValue(this.value)}}});var sa=m("qc.editor.CheckBox",qc.widget.CheckBox,function Xd(){var a=this;Xd["super"].constructor.call(a),a.on("propertyChange",function(b){"selected"===b.property&&a.onValueChanged&&a.onValueChanged(a.formattedValue)}),a.align="left"});sa.prototype.formatValue=function(){return!!this.selected},b.defineProperties(sa.prototype,{formattedValue:{get:function(){return this.formatValue()}},onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}}});var ta=m("qc.editor.ColorChooserDropDown",qc.widget.ColorChooserDropDown,function(a){ta["super"].constructor.call(this,a)});ta.prototype.createDialog=function(){var a=new qc.editor.Dialog;return a};var ua=m("qc.editor.ColorPicker",qc.widget.ComboBox,function Yd(a){var b=this;a||(a={}),null==a["dropDown.colorChooser.alphaEnabled"]&&(a["dropDown.colorChooser.alphaEnabled"]=!0),Yd["super"].constructor.call(b,a),b.dropDown="qc.editor.ColorChooserDropDown",b._bindingClose=b.close.bind(b),b.on("propertyChange",function(a){"value"===a.property&&b.onValueChanged&&b.onValueChanged(b.formattedValue)})});ua.prototype._instant=!0,ua.prototype.registerCloseEvent=function(a){var b=this;ua["super"].registerCloseEvent.call(b,a),fa.e.on(fa.e.JS_CHANGED,b._bindingClose)},ua.prototype.unregisterCloseEvent=function(a){var b=this;ua["super"].unregisterCloseEvent.call(b,a),fa.e.off(fa.e.JS_CHANGED,b._bindingClose)},ua.prototype.hasFocus=function(){var a=document.activeElement,b=this.view;return b.contains(a)?!0:this.isOpen()?!0:void 0},ua.prototype.formatValue=function(a){return a?new qc.Color([a.r,a.g,a.b,a.a/255]):void 0},b.defineProperties(ua.prototype,{onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}},formattedValue:{get:function(){return this.formatValue(this.value)}},value:{set:function(a){a instanceof qc.Color&&(a=a||new qc.Color(16777215),a=a.toNumber(!0)),"number"==typeof a&&this._componentConfig["colorChooser.alphaEnabled"]===!1&&(a=4278190080|a),ua.setSuperProperty(this,"value",a)},get:function(){return ua.getSuperProperty(this,"value")}}});var va=m("qc.editor.DropDownList",qc.widget.DropDownList,function Zd(a){var b=this;Zd["super"].constructor.call(b,a),b._bindingHandleExpand=b.handleExpand.bind(b),b._bindingHandleCollapse=b.handleCollapse.bind(b),b._bindingHandleListKeyPress=b.handleListKeyPress.bind(b),b._bindingHandleListKeyDown=b.handleListKeyDown.bind(b),b._bindingListFilterPainter=b.listFilterPainter.bind(b),b._bindingCollapse=b.collapse.bind(b),b.on("expand",b._bindingHandleExpand),b.on("collapse",b._bindingHandleCollapse),b.on("propertyChange",function(a){"value"===a.property&&b.onValueChanged&&b.onValueChanged(b.formattedValue)})});va.prototype.hasFocus=function(){var a=document.activeElement,b=this.view;return b.contains(a)?!0:this.isExpanded()?!0:void 0},va.prototype.registerCloseEvent=function(a){var b=this;va["super"].registerCloseEvent.call(b,a),fa.e.on(fa.e.JS_CHANGED,b._bindingCollapse)},va.prototype.unregisterCloseEvent=function(a){var b=this;va["super"].unregisterCloseEvent.call(b,a),fa.e.off(fa.e.JS_CHANGED,b._bindingCollapse)},va.prototype.handleExpand=function(a){var b=this,c=a.list;c.addEventListener("keypress",b._bindingHandleListKeyPress),c.addEventListener("keydown",b._bindingHandleListKeyDown),c.addTopPainter(b._bindingListFilterPainter),b._filterStr=""},va.prototype.handleCollapse=function(a){var b=this,c=a.list;c.removeEventListener("keypress",b._bindingHandleListKeyPress),c.removeEventListener("keydown",b._bindingHandleListKeyDown),c.removeTopPainter(b._bindingListFilterPainter),b._filterStr=""},va.prototype.handleListKeyDown=function(a){var b=this,c=b._list,d=b._filterStr||"";k.isDelete(a)?d=d.substr(0,d.length-1):k.isEsc(a)&&(""===d?b.collapse():d=""),b._filterStr=d,c.visibleFunc=function(a){return a.name.toLowerCase().indexOf(d.toLowerCase())>=0},a.stopPropagation(),k.preventDefault(a)},va.prototype.handleListKeyPress=function(a){var b=this,c=b._list,d=b._filterStr||"";d+=String.fromCharCode(a.charCode),b._filterStr=d,c.visibleFunc=function(a){return a.name.toLowerCase().indexOf(d.toLowerCase())>=0},a.stopPropagation(),k.preventDefault(a)},va.prototype.listFilterPainter=function(a){var b=this,c=b._list,d=c.translateY,e=b._filterStr;if(e){e="S: "+e;var f=k.getTextSize(k.labelFont,e),g=c.clientWidth;a.beginPath(),a.rect(g-f.width,-d,f.width,c.rowHeight),a.fillStyle=b._dropDownBackground,a.fill(),k.drawText(a,e,k.labelFont,b._filterColor,g-f.width,-d,f.width,c.rowHeight,"right","top")}},va.prototype.formatValue=function(a){return a},b.defineProperties(va.prototype,{onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}},formattedValue:{get:function(){return this.formatValue(this.value)}}});var wa=m("qc.editor.MultiDropDownList",qc.editor.DropDownList,function $d(a){var b=this;$d["super"].constructor.call(b,a),b.selectionMode="multiple"});wa.prototype.getLabel=function(a){if(k.isArray(a)){var b="";if(a.length<4)for(var c=0;c<a.length;c++){var d=a[c],e=this._labelMap[d];b+=c===a.length-1?e:e+","}else b="Mixed...";return b}return""},wa.prototype._setValue=function(a){var b=this;if("Nothing"===a)b.value=[];else if("Everything"===a){var c=b.items;a=[];for(var d=2;d<c.length;d++){var e=c[d];e&&a.push(k.isString(e)?e:e.value)}b.value=a}else wa["super"]._setValue.call(this,a)},b.defineProperties(wa.prototype,{items:{set:function(a){a||(a=[]);var b=a[0];k.isString(b)?(k.addArray(a,"Everything",0),k.addArray(a,"Nothing",0)):(k.addArray(a,{label:"Everything",value:"Everything"},0),k.addArray(a,{label:"Nothing",value:"Nothing"},0)),wa.setSuperProperty(this,"items",a)},get:function(){return wa.getSuperProperty(this,"items")}}});var xa=m(null,b,function(a){var b=this;b._text=a,b.addListeners()},{clear:function(){},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){Y(a)},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(){},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(){},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(){}},{interactor:!0},{view:{get:function(){return this._text}}}),ya=m("qc.editor.Text",b,function(a){var b=this,c=b._view=k.createDiv();c.style.setProperty("-webkit-user-select","none",null),c.style.setProperty("user-select","none",null),c.style.whiteSpace="nowrap",c.style.overflow="hidden",b.cursor="default",new xa(b),k.initObject(b,a)},{_preferredSizeProperties:["text","padding","textFont"],_padding:[0,0,0,0],_align:"left",_textColor:k.Color.labelColor,_textFont:k.labelFont},{view:!0,emitter:!0,toolTip:!0,properties:["text","align","textColor","textFont","background","padding"]});b.defineProperty(ya.prototype,"cursor",{get:function(){return this._view.style.cursor},set:function(a){this._view.style.cursor=a}}),b.defineProperty(ya.prototype,"textSize",{get:function(){var a=this,b=a.text;return b?k.getTextSize(a.textFont,b):{width:0,height:0}}}),b.defineProperty(ya.prototype,"toolTip",{get:function(){return this._toolTip},set:function(a){this.setPropertyValue("toolTip",a),a?this.enableToolTip():this.disableToolTip()}}),ya.prototype.addEventListener=function(a,b,c){this._view.addEventListener(a,b,c)},ya.prototype.removeEventListener=function(a,b,c){this._view.removeEventListener(a,b,c)},ya.prototype.onPropertyChange=function(a){var b=this,c=a.property;("text"===c||"textFont"===c)&&(b._textSize=b.textSize),b.checkChildPreferredSizeChange(c),b.iv()},ya.prototype.getToolTipAt=function(){return this.toolTip},ya.prototype.getPreferredSize=function(){var a=this,b=a._preferredSize||a._calcdPreferredSize;if(!b){var c=a._textSize||a.textSize,d=a.padding;c={width:c.width,height:c.height},k.isArray(d)?(c.width+=d[1]+d[3],c.height+=d[0]+d[2]):(c.width+=2*d,c.height+=2*d),c.width=Math.round(c.width),c.height=Math.round(c.height),b=a._calcdPreferredSize=c}return b},ya.prototype.validateImpl=function(){var a=this,b=a._view,c=a.background,d=a.text,e=a.textColor,f=a.textFont,g=a.padding,h=a.align;b.innerHTML=d||"",null!=e&&(b.style.color=e),null!=f&&(b.style.font=f),null!=h&&(b.style.textAlign=h),null!=c&&(b.style.background=c),null!=g&&(b.style.padding=k.isArray(g)?g[0]+"px "+g[1]+"px "+g[2]+"px "+g[3]+"px":g+"px"),b.style.lineHeight=a.height+"px"};var za=m("qc.editor.Label",qc.widget.Label,function _d(a){var b=this;_d["super"].constructor.call(b,a),b.align="left"});b.defineProperties(za.prototype,{style:{get:function(){return this.view.style}}});var Aa=m("qc.editor.StringInput",qc.widget.TextField,function ae(a){var b=this;b._autoSelect=!0,ae["super"].constructor.call(b,a),b.on("propertyChange",function(a){"value"===a.property&&b.onValueChanged&&b.onValueChanged(b.formattedValue)});var c=b.getInput();c.addEventListener("mousedown",function(){b.autoSelect&&!c.contains(document.activeElement)&&setTimeout(function(){c.select()},30)})});Aa.prototype.formatValue=function(a){return a},b.defineProperties(Aa.prototype,{onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}},formattedValue:{get:function(){return this.formatValue(this.value)}},autoSelect:{get:function(){return this._autoSelect},set:function(a){this.setPropertyValue("autoSelect",a)}}});var Ba=m("qc.editor.ObjectSelectPane",qc.widget.Container,function be(a){var b=this;be["super"].constructor.call(b,a);var c=b.layout=new qc.widget.layout.BorderLayout(b),d=b._searchInput=new qc.editor.StringInput,e=new qc.widget.Container,f=b._assetsList=new qc.editor.ItemList,g=b._descLabel=new qc.widget.Label({align:"left"}),h=b._slider=new qc.widget.Slider;d.input.style.backgroundImage='url("'+fa.assetPath+'magnifying-glass.png")',d.input.style.backgroundRepeat="no-repeat",d.input.style.backgroundSize="17px 17px",d.input.style.backgroundPosition="2px 50%",d.padding=[2,0,2,22],d.onValueChanged=b.filterList.bind(b),c.splitterSize=0,e.layout=new qc.widget.layout.BorderLayout(e),e.layout.splitterSize=0,e.scrollBarMode="off",e.setItems([{region:"center",element:g},{region:"right",element:h,width:70}]),b.setItems([{region:"center",element:f},{region:"top",height:22,element:d},{region:"bottom",element:e,height:22}]),b._initSlider(),b._initList(),f.selectionModel.on("selectionChange",function(){var a=f.selection[0];b._descLabel.text=a?a.a("url")||"":""})});Ba.prototype._initList=function(){var a=this,b=a._assetsList,c=a.objectType;b.onDataDoubleClick=a.onAssetNodeDoubleClick.bind(a);var d=new la({name:"None",image:null,isNoneNode:!0});if(b.dataModel.add(d),"node"===c)return void fa.project.exploreTree(function(a){var c=new la;c.image="UnknowIcon",c.name=a.name,c.a("asset",a);for(var d,e=a,f=e.name;(d=e.parent)&&d!==fa.game.world;)f=d.name+"/"+f,e=d;c.a("url",f),b.dataModel.add(c)});var e,f;switch(c){case"bitmapFont":e=fa.ASSET_TYPE.ASSET_FONT;break;case"font":e=fa.ASSET_TYPE.ASSET_WEBFONT,f="FontIcon";break;case"allFont":e=[fa.ASSET_TYPE.ASSET_FONT,fa.ASSET_TYPE.ASSET_WEBFONT],f="FontIcon";break;case"sound":e=fa.ASSET_TYPE.ASSET_SOUND,f="SoundIcon";break;case"textAsset":e=fa.ASSET_TYPE.ASSET_TEXT,f="FontIcon";break;case"js":e=fa.ASSET_TYPE.ASSET_JS,f="JsIcon";break;case"prefab":e=fa.ASSET_TYPE.ASSET_PREFAB,f="UnknowIcon";break;case"excelAsset":e=fa.ASSET_TYPE.ASSET_EXCEL;break;default:e=fa.ASSET_TYPE.ASSET_ATLAS;var g=new la,h=fa.game.assets.find("__builtin_resource__");g.image=h.img,g.name="builtin",g.a("asset",h.uuid),g.a("url","builtin resource"),b.dataModel.add(g)}var i;if(k.isArray(e)?(i=[],e.forEach(function(a){i=i.concat(fa.project.findByType(a))})):i=fa.project.findByType(e),i&&i.length)for(var j=0,l=i.length;l>j;j++){var h=i[j],g=new la;f?g.image=f:(e===fa.ASSET_TYPE.ASSET_ATLAS||e===fa.ASSET_TYPE.ASSET_FONT)&&(g.image=fa.project.getImageURLByAtlas(h)),g.name=sb(h.url),g.a("asset",h.uuid),g.a("url",h.url),b.dataModel.add(g)}},Ba.prototype.onAssetNodeDoubleClick=function(a){this.onSelectAssetNode(a)},Ba.prototype.filterList=function(){var a=this,b=a._searchInput,c=a._assetsList,d=b.value;c.visibleFunc=d?function(a){return a.name&&a.name.indexOf(d)>=0?!0:void 0}:null},Ba.prototype._initSlider=function(){var a=this,b=a._slider,c=a._assetsList;b.value=32,b.disableToolTip(),b.onValueChange=function(a){16>=a?1===a?c.layout="list":b.value=1:(c.layout="tile",c.itemWidth=c.itemHeight=40+(.5*a-8))}},b.defineProperties(Ba.prototype,{objectType:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}}});var Ca=m("qc.editor.ObjectInput",qc.widget.Container,function ce(a){var b=this;ce["super"].constructor.call(b,a);var c=b.layout=new qc.widget.layout.BorderLayout(b),d=b._objectInput=new qc.editor.StringInput,e=b._picker=new qc.widget.Label({icon:"objectpicker"});c.splitterSize=0,b.setItems([{region:"center",element:d},{region:"right",width:20,element:e}]),a&&null!=a.autoSelect||(b._autoSelect=!1),d.view._dropView=d;var f=d.getInput();f.addEventListener("keydown",function(a){a.preventDefault()}),f.style.cursor="default",d.addEventListener("click",function(){var a=b.associatedViewAndData;zb(a)}),b._bindingHandleDocumentMousedown=b.handleDocumentMousedown.bind(b),e.addEventListener("click",b.handlePickerClick.bind(b)),b.eachable=!1});Ca.prototype.hasFocus=function(){var a=document.activeElement,b=this.view;return b.contains(a)?!0:this._dialog?!0:void 0},Ca.prototype.resetNinePatchImage=function(){this._objectInput.ninePatchImage="textfield.9",this._objectInput.ninePatchBorder=[8,8,8,8]},Ca.prototype.handlePickerClick=function(){var a=this,b=a._dialog;if(!b){b=a._dialog=new qc.editor.Dialog,b.on("close",function(){a.removeDialog()}),b.title=fa._("Select Object");var c=new Ba({objectType:a.objectType});c.onSelectAssetNode=function(c){b.hide();var d=a.objectType;if("prefab"===d||"texture"===d||"allFont"===d||"sound"===d||"font"===d||"textAsset"===d||"node"===d||"bitmapFont"===d||"excelAsset"===d)if(c.isNoneNode)"texture"===a.objectType?a.setTextureObjectValue(null,null,!0):"font"!==d&&"bitmapFont"!==d&&"allFont"!==d&&a.setObjectValue(null,!0);else if("node"===d){var e=c.a("asset");if(!(e instanceof qc.Node))return;a.setObjectValue(e,!0)}else{var f=fa.game.assets.findByUUID(c.a("asset")),g=function(b){"texture"===d?a.setTextureObjectValue(b,null,!0):a.setObjectValue(b,!0)};f?g(f):fa.game.assets.load(c.a("asset"),c.a("url"),function(a){g(a)})}},b.content=c,b.contentPadding=2;var d=Cb(700,500);b.width=d.width,b.height=d.height}b.isInDOM()?b.hide():(b.show(),c._searchInput.input.focus(),document.addEventListener("mousedown",a._bindingHandleDocumentMousedown))},Ca.prototype.setTextureObjectValue=function(a,b,c){var d,e,f=this,g=f._objectInput,h=f.target,i=f.targetField,j=f.arrIndex,k=!1;if(i.indexOf("/")>0&&(d=i.substring(i.indexOf("/")+1),i=i.substring(0,i.indexOf("/"))),null!=j)e=h[i]||[],k=e[j]==a,e[j]=a;else{e=a;var l=h[i];if(d){var m=h[d];l==e&&(null==m&&null==b||m===b)&&(k=!0)}else l===e&&(k=!0)}c&&!k&&(h[i]=e,d&&(h[d]=b));var n;n=a?a.url:"Empty(Atlas)",g.value=n,f.initAssociatedViewAndData(n),k||f.handleValueChange(n)},Ca.prototype.setObjectValue=function(a,b){var c,d=this,e=d.objectType,f=d._objectInput,g=d.target,h=d.targetField,i=d.arrIndex,j=!1;if(null!=i)c=g[h]||[],j=c[i]==a,c[i]=a;else{c=a;var l=g[h];l===c&&(j=!0)}if("font"===e){b&&!j&&(g[h]=c);var m;m=a?a.url:"Empty(Font)",f.value=m,d.initAssociatedViewAndData(m),j||d.handleValueChange(m)}if("bitmapFont"===e){b&&!j&&(g[h]=c);var m;m=a?a.url:"Empty(BitmapFont)",f.value=m,d.initAssociatedViewAndData(m),j||d.handleValueChange(m)}else if("allFont"===e){b&&!j&&(g[h]=c);var m;m=a?a.url:"Empty(Font)",f.value=m,d.initAssociatedViewAndData(m),j||d.handleValueChange(m)}else if("sound"===e){b&&!j&&(g[h]=c);var m;m=a?a.url:"Empty(Sound)",f.value=m,"Empty(Sound)"===m?d.initAssociatedViewAndData(m):m&&d.initAssociatedViewAndData(m.lastIndexOf(".bin")===m.length-4?m:m+".bin"),j||d.handleValueChange(m)}else if("textAsset"===e){b&&!j&&(g[h]=c);var m;m=a?a.url:"Empty(TextAsset)",f.value=m,d.initAssociatedViewAndData(m),j||d.handleValueChange(m)}else if("excelAsset"===e){b&&!j&&(g[h]=c);var m;m=a?a.url:"Empty(ExcelAsset)",f.value=m,d.initAssociatedViewAndData(m),j||d.handleValueChange(m)}else if("prefab"===e){b&&!j&&(g[h]=c);

var m;m=a?k.isString(a)?a:a.url:"Empty(Prefab)",f.value=m,d.initAssociatedViewAndData(m),j||d.handleValueChange(m)}else if("node"===e){b&&!j&&(g[h]=c);var n;n=a?a.name:"Empty(Node)",f.value=n,d.initAssociatedViewAndData(a),j||d.handleValueChange(n)}},Ca.prototype.initAssociatedViewAndData=function(a){var b=this,c=b.objectType,d=b.target;if("texture"===c)if(a&&"__builtin_resource__"!==a&&"Empty(Atlas)"!==a){var e,f=b.targetField;f.indexOf("/")>0?(e=f.substring(f.indexOf("/")+1),b.associatedViewAndData={fileTree:a.substring(0,a.lastIndexOf("/")),fileList:[a,d[e]]}):b.associatedViewAndData={fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a}}else b.associatedViewAndData=null;else"font"===c?b.associatedViewAndData=a&&"Empty(Font)"!==a?{fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a}:null:"bitmapFont"===c?b.associatedViewAndData=a&&"Empty(BitmapFont)"!==a?{fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a}:null:"allFont"===c?b.associatedViewAndData=a&&"Empty(Font)"!==a?{fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a}:null:"sound"===c?b.associatedViewAndData=a&&"Empty(Sound)"!==a?{fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a}:null:"textAsset"===c?b.associatedViewAndData=a&&"Empty(TextAsset)"!==a?{fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a}:null:"excelAsset"===c?a&&"Empty(ExcelAsset)"!==a&&(b.associatedViewAndData={fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a}):"node"===c?b.associatedViewAndData=a?{hierarchy:a.uuid}:null:"prefab"===c&&(b.associatedViewAndData=a&&"Empty(Prefab)"!==a?{fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a}:null)},Ca.prototype.handleDocumentMousedown=function(a){var b=this,c=b._dialog,d=a.target;c.view.contains(d)||b._picker.view.contains(d)||c.hide()},Ca.prototype.removeDialog=function(){delete this._dialog,document.removeEventListener("mousedown",this._bindingHandleDocumentMousedown)},Ca.prototype.handleValueChange=function(a){var b=this;b.onValueChanged&&b.onValueChanged(a);var c={property:"value",oldValue:null,newValue:a,source:b};b.emit("propertyChange",c)},b.defineProperties(Ca.prototype,{objectInput:{get:function(){return this._objectInput}},arrIndex:{get:function(){return this._arrIndex},set:function(a){this.setPropertyValue("arrIndex",a)}},target:{get:function(){return this._target},set:function(a){this.setPropertyValue("target",a)}},targetField:{get:function(){return this._targetField},set:function(a){this.setPropertyValue("targetField",a)}},value:{get:function(){return this._objectInput.value},set:function(a){this._objectInput.value=a}},formattedValue:{get:function(){return this.value}},objectType:{get:function(){return this._objectType},set:function(a){this.setPropertyValue("objectType",a)}},onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}},associatedViewAndData:{get:function(){return this._associatedViewAndData},set:function(a){this.setPropertyValue("associatedViewAndData",a)}}});var Da=m("qc.editor.NumberInput",qc.editor.StringInput,function de(a){var b=this;de["super"].constructor.call(b,a),b.maskRe=/[\-\d\.]/;var c=b.input;c.addEventListener("change",function(){b.value=b.finalValue})});Da.prototype.formatValue=function(a){var b=this.precision;return parseFloat(null==b?a:parseFloat(a).toFixed(b))},Da.prototype.epc=function(a,b,c){var d=this,e=d.min,f=d.max,g=!0;if("value"===a&&(null!=e||null!=f)){var h=this.formatValue(c);isNaN(h)||(null!=e&&e>h&&(g=!1),null!=f&&h>f&&(g=!1))}g&&Da["super"].epc.call(d,a,b,c)},Da.prototype._precision=3,b.defineProperties(Da.prototype,{finalValue:{get:function(){var a=this,b=a.formatValue(a.input.value),c=a.min,d=a.max;return isNaN(b)||(null!=c&&c>b&&(b=c),null!=d&&b>d&&(b=d)),b}},max:{get:function(){return this._max},set:function(a){this.setPropertyValue("max",a)}},min:{get:function(){return this._min},set:function(a){this.setPropertyValue("min",a)}},precision:{get:function(){return this._precision},set:function(a){this.setPropertyValue("precision",a)}},value:{get:function(){return this._value},set:function(a){var b=this;if(b.input!==document.activeElement){a=b.formatValue(a);var c=b.min,d=b.max;isNaN(a)||(null!=c&&c>a&&(a=c),null!=d&&a>d&&(a=d))}b.setPropertyValue("value",a)}}});var Ea=m("qc.editor.IntInput",qc.editor.NumberInput,function ee(a){var b=this;ee["super"].constructor.call(b,a)});Ea.prototype._precision=0,Ea.prototype._maskRe=/[\-\d]/;var Fa=m("qc.editor.AngleInput",qc.editor.NumberInput,function fe(a){var b=this;fe["super"].constructor.call(b,a)});Fa.prototype.toGameValue=function(){var a=this,b=a.formattedValue;return b/180*Math.PI},Fa.prototype.toCompValue=function(a){return a/Math.PI*180};var Ga=m("qc.editor.SliderInput",qc.widget.Container,function ge(a){var b=this;ge["super"].constructor.call(b),a&&(b.bind=a.bind,delete a.bind),b.scrollBarMode="off",b.eachable=!1;var c=b.layout=new qc.widget.layout.BorderLayout(b),d=b._slider=new qc.widget.Slider(a),e=b._input=new qc.editor.NumberInput;e.value=d.value,c.bottomViewExpanded=!1,c.splitterSize=0,d.disableToolTip(),null==d.min&&(d.min=0),b.setItems([{region:"center",element:d},{region:"right",width:50,element:e}]),e.input.addEventListener("blur",function(){e._updating||(e.value=d.value)}),d.on("propertyChange",function(a){var c=a.property;d._updating=!0,"value"===c&&(b.epc("value",a.oldValue,a.newValue),b.onValueChanged&&b.onValueChanged(b.value),e._updating||(e.value=a.newValue)),d._updating=!1}),e.on("propertyChange",function(a){var b=a.property;e._updating=!0;var c=parseFloat(a.newValue);"value"!==b||d._updating||isNaN(c)||(d.value=c),e._updating=!1})});b.defineProperties(Ga.prototype,{min:{get:function(){return this._slider.min},set:function(a){this._slider.min=a}},max:{get:function(){return this._slider.max},set:function(a){this._slider.max=a}},step:{get:function(){return this._slider.step},set:function(a){this._slider.step=a}},value:{get:function(){return this._slider.value},set:function(a){this._slider.value=a}},formattedValue:{get:function(){return this.value}},onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}}});var Ha=m("qc.editor.TextArea",qc.widget.TextArea,function he(a){var b=this;he["super"].constructor.call(b,a),b.on("propertyChange",function(a){"value"===a.property&&b.onValueChanged&&b.onValueChanged(b.value)}),b.padding=[1,0,1,0];var c=b.getInput();c.addEventListener("focus",function(){c.select()})});Ha.prototype.formatValue=function(a){return a},b.defineProperties(Ha.prototype,{onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}},formattedValue:{get:function(){return this.formatValue(this.value)}}});var Ia=m("qc.editor.TextAreaContainer",qc.widget.Container,function ie(a){var b=this;ie["super"].constructor.call(b),b.scrollBarMode="off",b.eachable=!1;var c=b.layout=new qc.widget.layout.TableLayout(b),d=b._textArea=new qc.editor.TextArea(a),e=b._popupButton=new qc.editor.Button({text:fa._("Edit"),padding:[2,6,2,6]});c.cellPadding=0,c.bottomViewExpanded=!1,c.splitterSize=0,b.setItems([{height:.1,widths:[.1,42],cells:[{element:d},{align:"center",vAlign:"middle",element:e,fill:"none"}]}]),d.onValueChanged=function(a){b.onValueChanged&&b.onValueChanged(a)},d.on("propertyChange",function(a){b.emit("propertyChange",a)}),b._bindingHandleDocumentMousedown=b.handleDocumentMousedown.bind(b),e.on("click",this.showPopupDialog.bind(this))});Ia.prototype.formatValue=function(a){return a},Ia.prototype.showPopupDialog=function(){var a=this,b=a._dialog;if(!b){var b=a._dialog=new qc.editor.Dialog;b.on("close",function(){a.removeDialog()});var c=new qc.editor.TextArea;b.position="center",b.buttons=[{text:fa._("OK"),onClick:function(){b.hide(),a.value=c.value,a.emit("valueChangedFromPopup")}},{text:fa._("Cancel"),onClick:function(){b.hide()}}],b.title=fa._("Edit Text"),b.contentPadding=[5,5,5,5];var d=Cb(800,600);b.width=d.width,b.height=d.height,b.content=c,c.value=a._textArea.value}b.isInDOM()?b.hide():(b.show(),c.input.focus(),document.addEventListener("mousedown",a._bindingHandleDocumentMousedown))},Ia.prototype.handleDocumentMousedown=function(a){var b=this,c=b._dialog,d=a.target;c.view.contains(d)||b._popupButton.view.contains(d)||c.hide()},Ia.prototype.removeDialog=function(){delete this._dialog,document.removeEventListener("mousedown",this._bindingHandleDocumentMousedown)},b.defineProperties(Ia.prototype,{value:{get:function(){return this._textArea.value},set:function(a){this._textArea.value=a}},onValueChanged:{get:function(){return this._onValueChanged},set:function(a){this.setPropertyValue("onValueChanged",a)}},formattedValue:{get:function(){return this.formatValue(this.value)}}});var Ja=m("qc.editor.CodePane",b,function(){var a=this;a.initView(!1)},{},{view:!0,emitter:!0});Ja.prototype.onPropertyChange=function(a){var b=this,c=b._editor,d=a.property;"value"===d&&!b._editorToValue&&c&&(b._valueToEditor=!0,c.setValue(a.newValue),b._valueToEditor=!1)},Ja.prototype._initEditor=function(){var a=this,b=a.value,c=a._interactionDiv,d=a._editor=CodeMirror(c,{lineNumbers:!0,foldGutter:!0,theme:"material",continueComments:{continueLineComment:!1},autoCloseBrackets:!0,matchBrackets:!0,indentUnit:4,keyMap:"sublime",lint:!0,mode:{name:a.mode||"javascript"},gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"]});d.setSize("100%","100%"),d.setValue(b||""),d.on("change",function(){a._valueToEditor||(a._editorToValue=!0,a.value=d.getValue(),a._editorToValue=!1)})},Ja.prototype.validateImpl=function(){var a=this,b=a._editor;b||a._initEditor()},b.defineProperties(Ja.prototype,{value:{get:function(){return this._value},set:function(a){try{var b=JSON.parse(a),c=JSON.stringify(b,null,4);a=c}catch(d){}this.setPropertyValue("value",a)}},mode:{get:function(){return this._mode},set:function(a){this.setPropertyValue("mode",a)}},editor:{get:function(){return this._editor}}});var Ka=m("qc.widget.CodeViewer",qc.widget.Container,function je(){je["super"].constructor.call(this),this.eachable=!1});Ka.prototype.validateImpl=function(){var a=this;Ka["super"].validateImpl.call(this),a.view.style.background="rgb(51, 51, 51)",a.view.style.border="1px solid #888"},Ka.prototype.calculateClientWidth=function(){return this.width-2},Ka.prototype.calculateClientHeight=function(){return this.height-2};var La=m("qc.editor.PanelInteractor",qc.widget.PanelInteractor,function ke(a){var b=this;ke["super"].constructor.call(b,a)});La.prototype.handle_touchstart=function(a){var b=this;La["super"].handle_touchstart.call(b,a);var c=b._toolIndex,d=b._panel;if(null==c&&d.titleVisible){var e=B(a),f=d._interactionDiv.getBoundingClientRect(),g=e.x-f.left,h=e.y-f.top,i=d.width,j=d.titleHeight;h>=0&&j>=h&&g>=0&&i>=g&&(b._clientPoint=e,b._titleActive=!0,z(b,a))}},La.prototype.handle_touchend=function(a){var b=this;La["super"].handle_touchend.call(b,a);var c=b._titleActive,d=b._panel,e=b._clientPoint,f=B(a);if(c&&y(e,f)<2){var g=d._state;d.state="collapse"===g?"normal":"collapse"}},La.prototype.handleWindowTouchEnd=function(a){{var b=this;b._panel}La["super"].handleWindowTouchEnd.call(b,a),b._titleActive&&(b._clientPoint=null,b._titleActive=!1)},La.prototype._calcToolIndex=function(a){var b=this,c=b._panel;a=k.checkTouch(a);var d=c._interactionDiv.getBoundingClientRect(),e=a.clientX-d.left,f=a.clientY-d.top,g=c.titleHeight,h=c.checkable,i=c.removable,j=c.refreshable,l=c.lockable;if(c.titleVisible){if(f>=4&&4+g-8>=f&&2+g-8>e&&e>2)return 0;if(h){var m=c._checkIconRect;if(m&&v(m,{x:e,y:f}))return 1}var n=d.width;if(l){var o={x:n-=24,y:4,width:g-8,height:g-8};if(v(o,{x:e,y:f}))return 4}if(i){var p={x:n-=24,y:4,width:g-8,height:g-8};if(v(p,{x:e,y:f}))return 2}if(j){var q={x:n-=24,y:4,width:g-8,height:g-8};if(v(q,{x:e,y:f}))return 3}}};var Ma=m("qc.editor.Panel",qc.widget.Panel,function(a){var b=this;qc.widget.Panel["super"].constructor.call(b),b.layout=null,b._interactor=new La(b),b.target=a;var c=new qc.widget.Container;c.layout=new qc.widget.layout.VBoxLayout(c),c.layout.padding=0,c.layout.gap=0,c.scrollBarMode="off",b.content=c,b.scrollBarModel="off",b.paint(),delete b._invalidateFlag,c.setItems(b._getContainerViews()),b.initChildrenListener(),b.initCompValueChangeListener(),b.on("propertyChange",function(a){"checked"===a.property&&(a.newValue?(b.emit("enable",{source:b}),b.onEnable&&b.onEnable()):(b.emit("disable",{source:b}),b.onDisable&&b.onDisable()))})});Ma.prototype.indent=30,Ma.prototype.divideColor=14935011,Ma.prototype._checkable=!0,Ma.prototype._removable=!0,Ma.prototype._refreshable=!1,Ma.prototype._titleHeight=24,Ma.prototype._contentPadding=[2,0,0,0],Ma.prototype._titleBackground="rgb(194, 194, 194)",Ma.prototype._activeTitleBackground="rgb(155, 155, 155)",Ma.prototype._getContainerViews=function(){var a=_.containers,b=[];if(a)for(var c=0;c<a.length;c++){var d=new qc.widget.Container;d.layout=new qc.widget.layout.TableLayout(d),d.layout.cellPadding=1,d.layout.padding=[0,6,0,0],d.layout.rowHeight=20,d.scrollBarMode="off",d.setItems(a[c]),b.push(d)}return b},Ma.prototype.removeSelf=function(){var a=this;kb(fa._("Sure to remove this component?"),fa._("Warning"),function(){var b=a.parent;fa.inspector.propertyView.emit("remove",{source:a}),a.target.destroy(),b.inspect(b.target)},null,{icon:"alert"})},Ma.prototype.handleToolClick=function(a,b){var c=this;if(0===a){var d=this.state;c.state="collapse"!==d?"collapse":"normal"}else 1===a?(c.checked=!this.checked,fa.inspector.propertyView.emit("checkChanged",{source:c})):2===a?(c.emit("remove",{source:c}),c.onRemove&&c.onRemove()):3===a?c.repaint():4===a&&(c.target.__lock=!c.target.__lock);c.emit("toolClick",{tool:a,event:b})},Ma.prototype.drawTitleBackground=function(a,b,c,d,e){var f,g=this,h=this._interactor,i=g.titleNinePatchImage,j=g.titleNinePatchBorder||[],l=g.titleTextNinePatchImage,m=g.titleTextNinePatchBorder||[],n=h._titleActive;if(i)k.drawNinePatchImage(a,i,b,c,d,e,j[0],j[1],j[2],j[3]),l&&k.drawNinePatchImage(a,l,b+e-6,c+2,d,e-4,m[0],m[1],m[2],m[3]);else{f=n?g._activeTitleBackground:g._titleBackground,a.beginPath();var o={x:b,y:c,width:d,height:e};a.fillStyle=f,a.rect(o.x,o.y,o.width,o.height),a.fill()}},Ma.prototype.drawTitle=function(a,b,c,d,e){var f=this;f.drawTitleBackground(a,b,c,d,e);var g=f.icon,h=f.title,i=f.titleFont,j=f.titleColor,l=f.checkable,m=f.checked,n=f.removable,o=f.refreshable,p=f.lockable;a.beginPath(),a.rect(b,c,d,1),a.fillStyle=f._titleLineColor,a.fill(),a.beginPath(),b+=2,this.drawTool(a,"collapse",b,4,e-8,e-8),b+=e-8,g&&(k.drawImage(a,g,null,b+=2,4,e-8,e-8),b+=e-8),l?(f._checkIconRect={x:b+2,y:4,width:e-8,height:e-8},k.drawImage(a,m?"checkIcon":"uncheckIcon",null,b+=2,4,e-8,e-8),b+=e-8):f._checkIconRect=null,h&&k.drawText(a,h,i,j,b,0,0,e);var q=d;p&&k.drawImage(a,f.target.__lock?"lock":"unlock",null,q-=24,4,e-8,e-8),n&&k.drawImage(a,"delete",null,q-=24,4,e-8,e-8),o&&k.drawImage(a,"refresh",null,q-=24,4,e-8,e-8)},Ma.prototype.drawTool=function(a,b,c,d,e,f){var g=this.state;"collapse"===b&&("collapse"===g?k.drawImage(a,"treeCollapse",null,c,d,e,f):k.drawImage(a,"treeExpand",null,c,d,e,f))},Ma.prototype.validate=function(){var a=this;Ma["super"].validate.call(a);var b=a._disabledDiv;if(b){var c=a._titleHeight,d=a.clientWidth,e=a.clientHeight;k.layout(b,0,c,d,e-c)}},Ma.prototype.paint=function(){},Ma.prototype.repaint=function(){var a=this;a._invalidateFlag||(a._invalidateFlag=!0,U(function(){a._invalidateFlag&&(delete a._invalidateFlag,a.target&&(a.content.setItems(null),a.paint(),a.content.setItems(a._getContainerViews()),a.initChildrenListener(),a.initCompValueChangeListener()))}))},Ma.prototype.initCompValueChangeListener=function(){var a=this;a.eachChildren(function(b){b instanceof qc.editor.Label||b instanceof qc.editor.Text||b.on&&b.on("propertyChange",function(c){fa.inspector&&!fa.inspector._updating&&(b instanceof qc.widget.ToggleButton?"selected"===c.property&&fa.inspector.propertyView.emit(fa.e.INSPECTOR_COMP_VALUE_CHANGE,{node:a.target,field:b.bind}):"value"===c.property&&fa.inspector.propertyView.emit(fa.e.INSPECTOR_COMP_VALUE_CHANGE,{node:a.target,field:b.bind}))})})},Ma.prototype.initChildrenListener=function(){var a=this;a.eachChildren(function(b){b instanceof qc.editor.Label||b instanceof qc.editor.Text?b["for"]&&!b.disabled&&(b.cursor="ew-resize"):b.bind&&(b.on("propertyChange",a.onChildPropertyChange.bind(a,b)),b instanceof Aa&&(b.input.addEventListener("focus",a.onInputFocus.bind(a,b)),b.input.addEventListener("blur",a.onInputBlur.bind(a,b))))})},Ma.prototype.onChildPropertyChange=function(a,b){var c=this;if(!fa.inspector._updating&&("value"===b.property||"selected"===b.property)){var d;if(d=a.toGameValue?a.toGameValue():a.formattedValue,a.syncToGame)a.syncToComp(d);else if(a instanceof Ca);else if(a instanceof Da&&isNaN(d));else{var e=c.target;a.bindTarget&&(e=a.bindTarget),c.setTargetProperty(e,a.bind,d)}}},Ma.prototype.createInputUndoFunc=function(a,b,c,d){return function(){a(b,c,d)}},Ma.prototype.onInputFocus=function(a){var b=this,c=b.target;a.bindTarget&&(c=a.bindTarget);var d=b.getTargetProperty(c,a.bind);a._undoValue=d;var e=b.createInputUndoFunc,f=b.setTargetProperty;a._undo=e(f,c,a.bind,d)},Ma.prototype.onInputBlur=function(a){var b=this;if(a._undo){var c=b.target;a.bindTarget&&(c=a.bindTarget);var d=b.getTargetProperty(c,a.bind);if(d!==a._undoValue){var e=b.createInputUndoFunc,f=b.setTargetProperty,g=e(f,c,a.bind,d);fa.undo.add(a._undo,g)}delete a._undo,delete a._undoValue}},Ma.prototype.updateChildrenValue=function(){var a=this;this.eachChildren(function(b){if(b.bind){var c=a.target;b.bindTarget&&(c=b.bindTarget);var d=!1;if(d=b.hasFocus?b.hasFocus():b.view.contains(document.activeElement),c&&!d)if(b instanceof Ca){var e=b.bind;if("texture"===b.objectType){var f,g;e.indexOf("/")>0?(f=e.substring(0,e.indexOf("/")),g=e.substring(e.indexOf("/")+1)):f=e,g?b.setTextureObjectValue(c[f],c[g]):b.setTextureObjectValue(c[f])}else b.setObjectValue(c[e])}else{var h=a.getTargetProperty(c,b.bind);b.syncToComp?b.syncToComp(h):b instanceof qc.widget.ToggleButton&&!(b.parent instanceof qc.widget.ButtonGroup)?b.selected=h:b.value=b.toCompValue?b.toCompValue(h):h}}})},Ma.prototype.setTargetProperty=function(a,b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++)if(e=e[d[f]],!e)return;e[d[d.length-1]]=c},Ma.prototype.getTargetProperty=function(a,b){for(var c=b.split("."),d=a,e=0;e<c.length-1;e++)if(d=d[c[e]],!d)return"";return d[c[c.length-1]]},Ma.prototype.eachChildren=function(a,b){var c=this,d=(b||c).children;if(d)for(var e=0;e<d.length;e++){var f=d[e];if(f.eachable!==!1){var g=c.eachChildren(a,f);if(g)return g}if(a(f))return f}},Ma.prototype.disableTitle=function(){var a=this;U(function(){var b=a._disabledTitleDiv=p(),c=a._titleHeight,d=a.clientWidth;b.style.background=k.Color.disabledBackground,a.view.appendChild(b),k.layout(b,0,0,d-(a.lockable?28:0),c)})},Ma.prototype.enableTitle=function(){var a=this,b=a._disabledTitleDiv;b&&b.parentNode&&a.view.removeChild(b),delete a._disabledTitleDiv},b.defineProperties(Ma.prototype,{target:{get:function(){return this._target},set:function(a){this._target=a}},checked:{get:function(){return this._checked},set:function(a){this.setPropertyValue("checked",a)}},checkable:{get:function(){return this._checkable},set:function(a){this.setPropertyValue("checkable",a)}},removable:{get:function(){return this._removable},set:function(a){this.setPropertyValue("removable",a)}},lockable:{get:function(){return this._lockable},set:function(a){this.setPropertyValue("lockable",a)}},refreshable:{get:function(){return this._refreshable},set:function(a){this.setPropertyValue("refreshable",a)}}});var Na=m("qc.editor.Dialog",qc.widget.Dialog,function(a){var b=this;b._initLayout(a),b._interactor=new Oa(b),b.on("show",function(){b.handleShow()}),b.on("close",function(){b.handleClose()}),b._bindingHide=b.hide.bind(b)},{_buttonPadding:[2,8,2,8]},{properties:["closeNinePatchImage","closeNinePatchBorder","buttonNinePatchImage","buttonNinePatchBorder","buttonActiveNinePatchImage","buttonActiveNinePatchBorder","buttonFont","buttonColor","buttonPadding"]});Na.prototype.handleShow=function(){fa.windowFocused&&fa.e.on(fa.e.JS_CHANGED,this._bindingHide)},Na.prototype.handleClose=function(){fa.e.off(fa.e.JS_CHANGED,this._bindingHide)},Na.prototype._createButton=function(a){var b=this,c=new qc.widget.Button(a);return c.ninePatchImage=b.buttonNinePatchImage,c.ninePatchBorder=b.buttonNinePatchBorder,c.hoverNinePatchImage=b.buttonNinePatchImage,c.hoverNinePatchBorder=b.buttonNinePatchBorder,c.activeNinePatchImage=b.buttonActiveNinePatchImage,c.activeNinePatchBorder=b.buttonActiveNinePatchBorder,c.padding=b.buttonPadding,c.textFont=b.buttonFont,c.textColor=b.buttonColor,c.borderWidth=0,c},Na.prototype.drawTool=function(a,b,c,d,e,f,g){if("close"===b){var h=this,i=h.closeNinePatchImage,j=h.closeNinePatchBorder,f=h.titleHeight,g=f;d=h.width-f,e=0,k.drawNinePatchImage(a,i,d,e,f,g,j[0],j[1],j[2],j[3]),k.drawImage(a,this._closeIcon,null,d,e,f,g)}else Na["super"].drawTool.call(this,a,b,c,d,e,f,g)},Na.prototype.validateImpl=function(){{var a=this;a._container.layout.bottomView.children}Na["super"].validateImpl.call(a)};var Oa=m("qc.editor.DialogInteractor","qc.widget.DialogInteractor",function(a){var b=this;Oa["super"].constructor.call(b,a)},{_calcToolIndex:function(a){var b=this,c=b._panel,d=c.tools;if(d&&d.indexOf("close")>=0){a=k.checkTouch(a);var e=c._interactionDiv.getBoundingClientRect(),f=a.clientX-e.left,g=a.clientY-e.top,h=c.titleHeight,i={x:e.width-h,y:0,width:h,height:h};if(k.containsPoint(i,{x:f,y:g}))return 0}}}),Pa=m("qc.editor.LayoutContainer",qc.widget.Container,function le(a){var b=this;le["super"].constructor.call(b,a),b.layout=new qc.widget.layout.SplitLayout(b),b.orientation="Landscape",fa.e.on(fa.e.ORIENTATION_CHANGE,function(a){b.orientation=a.newValue})});Pa.TOP_MENU=1,Pa.TOP_LEFT=2,Pa.TOP_RUN=3,Pa.TOP_MIDDLE=4,Pa.TOP_RIGHT=5,Pa.SCENE=6,Pa.HIERARCHY=7,Pa.PROJECT=8,Pa.INSPECTOR=9,Pa.DIALOG=10,b.defineProperties(Pa.prototype,{orientation:{get:function(){return this._orientation},set:function(a){var b=this,c=b.orientation;b.setPropertyValue("orientation",a),c!==a&&("Portrait"===a?b._setPortrait():"Landscape"===a&&b._setLandscape())}}}),Pa.prototype.getRegionContainer=function(a){var b=this,c=b["_container"+a];return c||(c=new qc.widget.Container,c.scrollBarMode="off",b["_container"+a]=c),c},Pa.prototype.add=function(a,b,c){var d=this,e=d["_container"+b];if(c&&!c.isChildOf(e)){c.id=a;var f=e.children;if(f&&0!==f.length){var g=f[0];if(g instanceof qc.widget.Tabs){var h=d._createTab(c);g.tabModel.add(h),g.select(h)}else{var i=new qc.widget.Tabs,j=d._createTab(g),h=d._createTab(c);i.tabModel.add(j),i.tabModel.add(h),i.select(h),e.setItems(i)}}else if(null==c.title)e.setItems(c);else{var i=new qc.widget.Tabs,h=d._createTab(c);i.tabModel.add(h),i.select(h),e.setItems(i)}}},Pa.prototype.find=function(a){return this.findViewById(a)},Pa.prototype.remove=function(a){var b=this;if("string"==typeof a&&(a=b.find(a)),a){for(var c,d=1;8>=d;d++){var e=b["_container"+d];if(a.isChildOf(e)){c=d;break}}c&&b._removeImpl(a,c)}},Pa.prototype._removeImpl=function(a,b){var c=this,d=c["_container"+b],e=d.children;if(e&&e.length>0){var f=e[0];if(f instanceof qc.widget.Tabs)for(var g=f.tabModel._roots,h=0;h<g.length;h++){var i=g[h];if(i.element===a){f.remove(h),0===f.tabModel.length&&d.setItems(null);break}}else a===f&&d.setItems(null)}},Pa.prototype._findComp=function(a,b){var c=a.children[0];if(c instanceof b)return c;if(c instanceof qc.widget.Tabs)for(var d=c.tabModel.datas,e=0;e<d.length;e++){var f=d[e];if(f.element instanceof b)return f.element}},Pa.prototype.serialize=function(){for(var a=this,b=[],c=6;9>=c;c++){var d=a.getRegionContainer(c),e={regionId:c,position:d.parent.layout.position};if(c===Pa.PROJECT){var f=a._findComp(d,qc.editor.Project);e.leftWidth=f.layout.leftWidth}else if(c===Pa.INSPECTOR){var g=a._findComp(d,qc.editor.Inspector);e.bottomHeight=g.layout.bottomHeight}b.push(e)}return JSON.stringify(b)},Pa.prototype.deserialize=function(a){var b=this;k.isString(a)&&(a=JSON.parse(a)),a.forEach(function(a){var c=b.getRegionContainer(a.regionId);if(c.parent.layout.position=a.position,a.regionId===Pa.PROJECT&&null!=a.leftWidth){var d=b._findComp(c,qc.editor.Project);d.layout.leftWidth=a.leftWidth}else if(a.regionId===Pa.INSPECTOR&&null!=a.bottomHeight){var e=b._findComp(c,qc.editor.Inspector);e.layout.bottomHeight=a.bottomHeight}})},Pa.prototype._createTab=function(a){var b=new qc.widget.Tab;return b.name=a.title,b.icon=a.icon,b.element=a,b},Pa.prototype._setLandscape=function(){var a=this,b=a.layout;b.orientation="v",b.position=34,b.minSize=10,b.splitterSize=0,b.positionType="absoluteLeft";var c=a.getRegionContainer("1"),d=a.getRegionContainer("2"),e=a.getRegionContainer("3"),f=a.getRegionContainer("4"),g=a.getRegionContainer("5"),h=a.getRegionContainer("6"),i=a.getRegionContainer("7"),j=a.getRegionContainer("8"),k=a.getRegionContainer("9"),l=new qc.widget.Container;l.layout=new qc.widget.layout.TableLayout(l),l.layout.cellPadding=0,l.scrollBarModel="off",l.setItems([{height:.1,widths:[236,160,.1,180],cells:[{element:d},{element:e},{element:f},{element:g}]}]);var m=new qc.widget.Container;m.layout=new qc.widget.layout.SplitLayout(m),m.layout.position=260,m.layout.positionType="absoluteRight",m.setItems([h,i]);var n=new qc.widget.Container;n.layout=new qc.widget.layout.SplitLayout(n),n.layout.orientation="v",n.layout.position=.65,n.setItems([m,j]);var o=new qc.widget.Container;o.layout=new qc.widget.layout.SplitLayout(o),o.layout.position=280,o.layout.positionType="absoluteRight",o.setItems([n,k]);var p=new qc.widget.Container;p.layout=new qc.widget.layout.SplitLayout(p),p.layout.orientation="v",p.layout.position=34,p.layout.minSize=10,p.layout.splitterSize=0,p.layout.positionType="absoluteLeft",p.setItems([l,o]),b.resetItems([c,p])},Pa.prototype._setPortrait=function(){var a=this,b=a.layout;b.orientation="v",b.position=34,b.minSize=10,b.splitterSize=0,b.positionType="absoluteLeft";var c=a.getRegionContainer("1"),d=a.getRegionContainer("2"),e=a.getRegionContainer("3"),f=a.getRegionContainer("4"),g=a.getRegionContainer("5"),h=a.getRegionContainer("6"),i=a.getRegionContainer("7"),j=a.getRegionContainer("8"),k=a.getRegionContainer("9"),l=new qc.widget.Container;l.layout=new qc.widget.layout.TableLayout(l),l.layout.cellPadding=0,l.scrollBarModel="off",l.setItems([{height:.1,widths:[236,160,.1,180],cells:[{element:d},{element:e},{element:f},{element:g}]}]);var m=new qc.widget.Container;m.layout=new qc.widget.layout.SplitLayout(m),m.layout.position=.36,m.setItems([i,j]);var n=new qc.widget.Container;n.layout=new qc.widget.layout.SplitLayout(n),n.setItems([h,m]);var o=new qc.widget.Container;o.layout=new qc.widget.layout.SplitLayout(o),o.layout.position=280,o.layout.positionType="absoluteRight",o.setItems([n,k]);var p=new qc.widget.Container;p.layout=new qc.widget.layout.SplitLayout(p),p.layout.orientation="v",p.layout.position=34,p.layout.minSize=10,p.layout.splitterSize=0,p.layout.positionType="absoluteLeft",p.setItems([l,o]),b.resetItems([c,p])};var Qa=m("qc.editor.Painter",b,function(){var a=this;a.initView(!1,!0),new qc.editor.PainterInteractor(a)},{_borderWidth:0},{view:!0,emitter:!0,painter:!0});b.defineProperties(Qa.prototype,{background:{get:function(){return this._background},set:function(a){this.setPropertyValue("background",a)}},borderColor:{get:function(){return this._borderColor},set:function(a){this.setPropertyValue("borderColor",a)}},borderWidth:{get:function(){return this._borderWidth},set:function(a){this.setPropertyValue("borderWidth",a)}}}),Qa.prototype.onPropertyChange=function(){this.iv()},Qa.prototype.drawBackground=function(a){var b=this,c=b.background;c&&(a.beginPath(),a.rect(0,0,b.width,b.height),a.fillStyle=c,a.fill())},Qa.prototype.drawBorder=function(){var a,b=this,c=b.borderWidth;a=c?c+"px solid "+b.borderColor:"",b.view.style.border=a},Qa.prototype.validateImpl=function(){this.drawBorder();var a=this,b=a._canvas,c=a.clientWidth,d=a.clientHeight;t(b,c,d);var e=s(b,0,0,1);a.drawBackground(e),a.drawBottomPainters(e),a.drawTopPainters(e)},Qa.prototype.calculateClientWidth=function(){var a=this.borderWidth,b=this.width;return a?b-2*a:b},Qa.prototype.calculateClientHeight=function(){var a=this.borderWidth,b=this.height;return a?b-2*a:b},m("qc.editor.PainterInteractor",b,function(a){this._painter=a,this.addListeners()},{handle_mousewheel:function(a){Y(a)},handle_DOMMouseScroll:function(a){Y(a)}},{interactor:!0},{view:{get:function(){return this._painter}}});var Ra=m("qc.editor.ProgressBar",Qa,function me(){me["super"].constructor.call(this),this.addTopPainter(this.drawImpl)},{_percent:0,_backgroundColor:"rgb(232, 232, 232)",_foregroundColor:"rgb(6, 172, 48)",_textFont:"12px Arial",_textColor:"black"},{properties:["foregroundColor","backgroundColor","percent","text","textFont","textColor"]});Ra.prototype.drawImpl=function(a){var b=this,c=b.clientWidth,d=b.clientHeight,e=b.percent,f=b.text,g=b.textFont,h=b.textColor,i=b.foregroundColor,j=b.backgroundColor;a.beginPath(),a.fillStyle=j,a.rect(0,0,c,d-20),a.fill(),a.beginPath(),a.fillStyle=i,a.rect(0,0,e/100*c,d-20),a.fill(),a.beginPath(),k.drawText(a,f,g,h,0,d-20,c,20,"left")};var Sa=(m("qc.editor.ProgressDialog",Na,function ne(){ne["super"].constructor.call(this);var a=new qc.widget.Container,b=this.progressBar=new Ra;b.preferredSize={height:50},a.scrollbarMode="off",a.layout=new qc.widget.layout.TableLayout(a),a.setItems([{height:.1,widths:[.1],cells:[{fill:"horizontal",vAlign:"middle",element:b}]}]),a.background="rgb(44, 53, 74)",this.contentPadding=[10,10,10,10],this.content=a}),m("qc.editor.Divider",Qa,function oe(){var a=this;oe["super"].constructor.call(a),a.view.style.background="rgba(0, 0, 0, 0)",a.view.style.border="0px",a.color=14935011,a.size=1}));b.defineProperties(Sa.prototype,{color:{get:function(){return this._color},set:function(a){this.setPropertyValue("color",a)}},size:{get:function(){return this._size},set:function(a){this.setPropertyValue("size",a)}}}),Sa.prototype.validateImpl=function(){var a=this,b=a._canvas,c=a.clientWidth,d=a.clientHeight,e=a.size;t(b,c,d);var f=s(b,0,0,1);f.beginPath(),f.rect(0,(d-e)/2,c,e),f.fillStyle=this.color,f.fill()},Sa.prototype.calculateClientWidth=function(){return this.width},Sa.prototype.calculateClientHeight=function(){return this.height},k.Vector.gameCurveShape=function(a,b,c,d,e){if(c&&c.curve){var f=c.curve.func(d,e);if(f&&0!==f.keys.length){for(var g=f.keys,h=g[0].time,i=g[g.length-1].time,j=g[0].value,k=g[0].value,l=1/b.width,m=h;(m+=l)<i;){var n=f.evaluate(m);j=Math.min(j,n),k=Math.max(k,n)}var n=f.evaluate(i);j=Math.min(j,n),k=Math.max(k,n),3e-8>k-j&&(k=j);var o=1,p=1,q=b.height/(k===j?1:k-j),r=b.width/(i===h?1:i-h),s=b.height*(k===j?.5:(k-0)/(k-j)),t=-h*r,u=function(a){return t+a*r+o},v=function(a){return s-a*q+p};a.lineWidth=1,s>=0&&s<=b.height&&(a.strokeStyle="rgb(0, 0, 0)",a.beginPath(),a.moveTo(0,s),a.lineTo(b.width,s),a.stroke(),a.closePath()),a.strokeStyle="rgb(0, 255, 0)",a.beginPath();var m=h;for(a.moveTo(u(m),v(f.evaluate(m)));(m+=1/r)<=i;){var w=f.evaluate(m);w=Math.min(k,Math.max(j,w)),a.lineTo(u(m),v(w))}a.lineTo(u(i),v(f.evaluate(i))),a.stroke(),a.closePath()}}};var Ta={width:60,height:60,comps:[{type:"rect",rect:[0,0,60,60],background:{func:function(a,b){return b._imageBackground}}},{type:"gameCurveShape",rect:[1,1,58,58],curve:{func:function(a,b){return b&&b.bezierCurve||null}}},{type:"border",rect:[0,0,60,60],borderWidth:1,borderColor:{func:function(a,b){return b._imageBorderColor}}}]},Ua=m("qc.editor.CurveButton",qc.widget.Button,function pe(a){var b=this;pe["super"].constructor.call(b,a),b.on("click",b.handleClick,b),b._bindingHandleDocumentMousedown=b.handleDocumentMousedown.bind(b);var c="rgba(0, 0, 0, 0)";b.background=c,b.gradientColor=c,b.hoverBackground=c,b.hoverGradientColor=c,b.activeBackground=c,b.activeGradientColor=c,b.preferredSize={width:60,height:60},b.iconWidth=60,b.iconHeight=60,
b.borderWidth=0});b.defineProperties(Ua.prototype,{icon:{get:function(){return Ta}},bezierCurve:{get:function(){return this._bezierCurve},set:function(a){this.setPropertyValue("bezierCurve",a)}}}),Ua.prototype.handleClick=function(){var b=this,c=b._curvePainterDialog,d=b._curvePainter,e=b._curveList;if(!c){c=b._curvePainterDialog=new qc.editor.Dialog,c.on("close",function(){b.removeDialog()}),d=b._curvePainter=new Xa,e=b._curveList=a.liyk=new Va,e.painter=d;var f=new qc.widget.Container;f.layout=new qc.widget.layout.BorderLayout(f),f.layout.centerView=d,f.layout.bottomView=e,f.layout.splitterSize=0,f.layout.bottomHeight=70,c.title=fa._("Curve Editor"),c.contentPadding=2,c.content=f,d.on("propertyChange",b.handleCurvePainterPropertyChange,b)}if(c.isInDOM())b.removeDialog();else{d.bezierCurve=b.bezierCurve;var g=Cb(610,530);c.width=g.width,c.height=g.height,c.show(),d.adjustCurve(),document.addEventListener("mousedown",b._bindingHandleDocumentMousedown)}},Ua.prototype.handleCurvePainterPropertyChange=function(){var a=this;a.iv()},Ua.prototype.handleDocumentMousedown=function(a){var b=this,c=b._curvePainterDialog,d=b._curvePainter,e=b._curveList,f=a.target;c.view.contains(f)||b.view.contains(f)||d._contextMenu.view.contains(f)||e._contextMenu.view.contains(f)||b.removeDialog()},Ua.prototype.removeDialog=function(){var a=this._curvePainterDialog,b=this._curvePainter;b._contextMenu.dispose(),this._curveList._contextMenu.dispose(),b.off("propertyChange",this.handleCurvePainterPropertyChange,this),a.hide(),delete this._curvePainterDialog,delete this._curvePainter,delete this._curveList,document.removeEventListener("mousedown",this._bindingHandleDocumentMousedown)},Ua.prototype.calculateClientWidth=function(){return this.width},Ua.prototype.calculateClientHeight=function(){return this.height};var Va=(m("qc.editor.CurveNode",qc.editor.ItemNode,function qe(a){var b=this;qe["super"].constructor.call(b,a),b.image={width:60,height:60,comps:[{type:"rect",rect:[0,0,60,60],background:{func:function(){return"rgb(30, 30, 30)"}}},{type:"gameCurveShape",rect:[1,1,58,58],curve:{func:function(){return b.curve}}},{type:"border",rect:[0,0,60,60],borderWidth:1,borderColor:{func:function(){return"rgb(10, 10, 10)"}}}]}}),m("qc.editor.CurveList",qc.editor.ItemList,function re(){var a=this;re["super"].constructor.call(a),a.pannable=!1,a._initMenu(),a.itemWidth=60,a.itemHeight=60,a.itemGap=5,a.loadCurve()}));Va.prototype._initMenu=function(){var a=this,b=new qc.editor.ContextMenu([{label:fa._("Save as New Curve"),disabled:function(){return!a.painter||!a.painter.bezierCurve},action:function(){var b=new qc.editor.CurveNode;b.curve=a.painter.bezierCurve.clone(),a.addCurveNode(b),a.saveCurve()}},{label:fa._("Delete Curve"),disabled:function(){return 0===a.selection.length},action:function(){a.handleDelete(),a.saveCurve()}},{label:fa._("Add Default Curves"),action:function(){a.addDefaultCurve(),a.saveCurve()}}]);a._contextMenu=b,b.addTo(a)},Va.prototype.saveCurve=function(){for(var a=this,b=a.dataModel.datas,c=[],d=0;d<b.length;d++)b[d]&&b[d].curve&&c.push(b[d].curve.toJson());fa.config.editor.curveTemplate=c,qc.editor.Operation.UPDATE_EDITOR_SETTINGS(fa.config.editor)},Va.prototype.loadCurve=function(){var a=this;if(fa.config.editor.curveTemplate){for(var b=fa.config.editor.curveTemplate,c=0;c<b.length;c++)if(b[c]){var d=new qc.BezierCurve;d.fromJson(b[c]);var e=new qc.editor.CurveNode;e.curve=d,a.addCurveNode(e)}}else a.addDefaultCurve()},Va.prototype.handleDelete=function(){var a=this,b=a.selection.slice(0);b.forEach(function(b){a.dataModel.remove(b)})},Va.prototype.onDataClick=function(a){var b=this.painter.bezierCurve;b._keys=a.curve.clone().keys,this.painter.epc("bezierCurve",0,1)},Va.prototype.onDataDoubleClick=function(){},Va.prototype.addCurveNode=function(a){this.dataModel.add(a)},Va.prototype.addDefaultCurve=function(){var a=new qc.BezierCurve(new qc.Keyframe(0,0,0,0),new qc.Keyframe(1,0,0,0)),b=new qc.editor.CurveNode;b.curve=a,this.addCurveNode(b);var a=new qc.BezierCurve(new qc.Keyframe(0,0,1,1),new qc.Keyframe(1,1,1,1)),b=new qc.editor.CurveNode;b.curve=a,this.addCurveNode(b),a=new qc.BezierCurve(new qc.Keyframe(0,0,.5,.5),new qc.Keyframe(1,1,2,2)),b=new qc.editor.CurveNode,b.curve=a,this.addCurveNode(b),a=new qc.BezierCurve(new qc.Keyframe(0,0,2,2),new qc.Keyframe(1,1,.5,.5)),b=new qc.editor.CurveNode,b.curve=a,this.addCurveNode(b),a=new qc.BezierCurve(new qc.Keyframe(0,0,1,1),new qc.Keyframe(1,0,1,1)),b=new qc.editor.CurveNode,b.curve=a,this.addCurveNode(b),a=new qc.BezierCurve(new qc.Keyframe(0,0,0,0),new qc.Keyframe(1,1,0,0)),b=new qc.editor.CurveNode,b.curve=a,this.addCurveNode(b)};var Wa=m("qc.editor.CurvePainterInteractor",b,function(a){var b=this;b._painter=a,b.addListeners(),b._handleDocumentMouseDown=function(b){var c=a._contextMenu;c&&c.view&&!c.view.contains(b.target)&&c.hide()}},{handle_mousedown:function(a){0===a.button&&this.handle_touchstart(a)},handle_touchstart:function(a){Y(a),z(this,a);var b=this,c=b._painter,d=c.lp(a);b.onTouchStart(d,a)},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(a){Y(a),this.onTouchEnd()},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){this.onTouchMove(this._painter.lp(a))},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(a){Y(a),this.onTouchEnd()},handle_contextmenu:function(a){Y(a),this.showContextMenu(this._painter.lp(a),a)},handle_mousewheel:function(a){this.handleScroll(a,(a.wheelDeltaX||0)/40,a.wheelDelta/40)},handle_DOMMouseScroll:function(a){this.handleScroll(a,0,-a.detail)},handleScroll:function(a,b,c){this.view;Y(a),this.onZoom(this._painter.lp(a),b,c)}},{interactor:!0},{view:{get:function(){return this._painter}}});Wa.KEY_HITAREA=36,Wa.LINE_HITAREA=4,Wa.prototype.showContextMenu=function(a,b){for(var c=this,d=c._painter,e=d._contextMenu,f=d.bezierCurve,g=f.keys,h=-1,i=0;i<g.length;++i){var j=d.xPos(g[i].time),k=d.yPos(g[i].value);if(Math.pow(a.x-j,2)*Math.pow(a.y-k,2)<=Wa.KEY_HITAREA){h=i;break}}if(0>h){var k=d.yPos(f.evaluate(d.xPrecisionValue(a.x)));if(Math.abs(k-a.y)<=Wa.LINE_HITAREA)return;e.items=[{label:fa._("Add Key"),action:function(){var b=d.xPrecisionValue(a.x),e=f.evaluateDerivative(b);f.addKey(b,f.evaluate(b),e,e),c._repaintPainter()}},{label:fa._("Reset View"),action:function(){d.adjustCurve(255)}}]}else{var l=g[h];e.items=[{label:fa._("Delete Key"),action:function(){var a=f._downKey===f.keys[h];f.removeKey(h),a&&(f._downKey=null),c._repaintPainter()}},{label:fa._(l.type===qc.Keyframe.AUTO?"√ Auto":"Auto"),action:function(){l.type=qc.Keyframe.AUTO,f.makeKeyframeAuto(h),c._repaintPainter()}},{label:fa._(l.type===qc.Keyframe.FREE_SMOOTH||l.outTangent===l.inTangent?"√ Free Smooth":"Free Smooth"),action:function(){l.type=qc.Keyframe.FREE_SMOOTH,f.makeKeyframeSmooth(h),c._repaintPainter()}},{label:fa._(l.type===qc.Keyframe.FLAT||l.outTangent===l.inTangent&&0===l.inTangent?"√ Flat":"Flat"),action:function(){l.type=qc.Keyframe.FLAT,f.makeKeyframeFlat(h),c._repaintPainter()}},{label:fa._(l.type===qc.Keyframe.BROKEN?"√ Broken":"Broken"),action:function(){l.type=qc.Keyframe.BROKEN,c._repaintPainter()}}]}document.addEventListener("mousedown",c._handleDocumentMouseDown),e.on("hide",function(){document.removeEventListener("mousedown",c._handleDocumentMouseDown)}),e.show(b.pageX,b.pageY)},Wa.prototype.showWrapContextMenu=function(a,b,c){var d=this,e=d._painter,f=e._contextMenu,g=e.bezierCurve,h=c?g.preWrapMode:g.postWrapMode;f.items=[{label:fa._(h===qc.BezierCurve.WRAP_PINGPONG?"√ Ping Pong":"Ping Pong"),action:function(){c?g.preWrapMode=qc.BezierCurve.WRAP_PINGPONG:g.postWrapMode=qc.BezierCurve.WRAP_PINGPONG,d._repaintPainter()}},{label:fa._(h===qc.BezierCurve.WRAP_LOOP?"√ Loop":"Loop"),action:function(){c?g.preWrapMode=qc.BezierCurve.WRAP_LOOP:g.postWrapMode=qc.BezierCurve.WRAP_LOOP,d._repaintPainter()}},{label:fa._(h===qc.BezierCurve.WRAP_CLAMP?"√ Clamp":"Clamp"),action:function(){c?g.preWrapMode=qc.BezierCurve.WRAP_CLAMP:g.postWrapMode=qc.BezierCurve.WRAP_CLAMP,d._repaintPainter()}}],document.addEventListener("mousedown",d._handleDocumentMouseDown),f.on("hide",function(){document.removeEventListener("mousedown",d._handleDocumentMouseDown)}),setTimeout(function(){f.show(b.pageX,b.pageY)},20)},Wa.prototype.onTouchStart=function(a,b){var c=this,d=c._painter,e=d.bezierCurve,f=e.keys,g=(new Date).valueOf();(!c._lastClickTime||c._lastClickTime+300<g)&&(c._clickCount=0),c._clickCount=1+(c._clickCount||0),c._lastClickTime=g;for(var h=0;h<f.length;++h){var i=d.xPos(f[h].time),j=d.yPos(f[h].value);if(Math.pow(a.x-i,2)+Math.pow(a.y-j,2)<=Wa.KEY_HITAREA)return c._editorTarget={type:0,idx:h,offX:a.x-i,offY:a.y-j},c._downKey=f[h],void c._repaintPainter()}for(var h=0;h<f.length;h++){if(0!==h){var k=Math.atan(f[h].inTangent);k=Math.atan2(Math.sin(k)*d.zoomY,Math.cos(k)*d.zoomX);var l=d.controlLength*Math.cos(k),m=d.controlLength*Math.sin(k),i=d.xPos(f[h].time)-l,j=d.yPos(f[h].value)+m;if(Math.pow(a.x-i,2)+Math.pow(a.y-j,2)<=Wa.KEY_HITAREA)return c._editorTarget={type:1,idx:h,offX:a.x-i,offY:a.y-j},void c._repaintPainter()}if(h!==f.length-1){var k=Math.atan(f[h].outTangent);k=Math.atan2(Math.sin(k)*d.zoomY,Math.cos(k)*d.zoomX);var l=d.controlLength*Math.cos(k),m=d.controlLength*Math.sin(k),i=d.xPos(f[h].time)+l,j=d.yPos(f[h].value)-m;if(Math.pow(a.x-i,2)+Math.pow(a.y-j,2)<=Wa.KEY_HITAREA)return c._editorTarget={type:2,idx:h,offX:a.x-i,offY:a.y-j},void c._repaintPainter()}}var j=d.yPos(e.evaluate(d.xPrecisionValue(a.x)));if(Math.abs(j-a.y)<=Wa.LINE_HITAREA){if(c._clickCount>1){var n=d.xPrecisionValue(a.x),o=e.evaluateDerivative(n),p=e.addKey(n,e.evaluate(n),o,o);c._repaintPainter(),c._clickCount=0,c._downKey=e.keys[p]}else c._editorTarget={type:3,preX:a.x,preY:a.y};return void c._repaintPainter()}var q=function(a,b){return b.x>=a.x&&b.y>=a.y&&b.x<=a.x+a.width&&b.y<=a.y+a.height},r=d.drawInfo;if(r)if(q({x:r.hScrollSlider.x-1.5*r.scrollSize,y:r.hScrollSlider.y,width:r.hScrollSlider.width+3*r.scrollSize,height:r.scrollSize},a)){if(c._clickCount>1)return void d.adjustCurve(1);c._editorTarget=a.x<r.hScrollSlider.x-.5*r.scrollSize?{type:5,preX:a.x,preY:a.y,axis:"x",dir:-1}:a.x<r.hScrollSlider.x+r.hScrollSlider.width+.5*r.scrollSize?{type:4,preX:a.x,preY:a.y,axis:"x"}:{type:5,preX:a.x,preY:a.y,axis:"x",dir:1}}else if(q({x:r.vScrollSlider.x,y:r.vScrollSlider.y-1.5*r.scrollSize,width:r.scrollSize,height:r.vScrollSlider.height+3*r.scrollSize},a)){if(c._clickCount>1)return void d.adjustCurve(2);c._editorTarget=a.y<r.vScrollSlider.y-.5*r.scrollSize?{type:5,preX:a.x,preY:a.y,axis:"y",dir:-1}:a.y<r.vScrollSlider.y+r.vScrollSlider.height+.5*r.scrollSize?{type:4,preX:a.x,preY:a.y,axis:"y"}:{type:5,preX:a.x,preY:a.y,axis:"y",dir:1}}var s=d.wrapDrawInfo;s&&(q(s[0],a)?c.showWrapContextMenu(a,b,!0):q(s[1],a)&&c.showWrapContextMenu(a,b,!1)),!c._editorTarget&&q({x:0,y:0,width:r.vScrollSlider.x-5,height:r.hScrollSlider.y-5},a)&&(c._editorTarget={type:9,preX:a.x,preY:a.y})},Wa.prototype._repaintPainter=function(){this._painter.epc("bezierCurve",0,1)},Wa.prototype.onTouchEnd=function(){this._editorTarget=null,this._repaintPainter()},Wa.prototype.getMovingKey=function(){var a=this,b=a._painter,c=a._editorTarget;if(c){var d=b.bezierCurve,e=d.keys;return 0===c.type?[e[c.idx]]:3===c.type?e:[]}},Wa.prototype.onTouchMove=function(a){var b=this,c=b._painter,d=b._editorTarget;if(d){var e=c.bezierCurve,f=e.keys;if(3===d.type){for(var g=c.xPrecisionValue(a.x)-c.xPrecisionValue(d.preX),h=c.xPrecisionValue(d.preY)-c.xPrecisionValue(a.y),i=0;i<f.length;++i)f[i].time+=g,f[i].value+=h;return d.preX=a.x,d.preY=a.y,void b._repaintPainter()}if(0===d.type){var j=f[d.idx];e.removeKey(d.idx),j.time=c.xPrecisionValue(a.x-d.offX),j.value=c.yPrecisionValue(a.y-d.offY),d.idx=e.addKey(j);for(var i=-1;++i<f.length;)f[i].type===qc.Keyframe.AUTO&&e.makeKeyframeAuto(i);return void b._repaintPainter()}if(1===d.type){var j=f[d.idx];if(j.type===qc.Keyframe.AUTO||j.type===qc.Keyframe.FLAT)return;var k=c.xPrecisionValue(a.x-d.offX),l=c.yPrecisionValue(a.y-d.offY),m=Math.atan2(j.value-l,j.time-k);return m=m<-Math.PI/2?-Math.PI/2:m,m=m>Math.PI/2?Math.PI/2:m,j.inTangent=Math.tan(m),j.type===qc.Keyframe.FREE_SMOOTH&&(j.outTangent=j.inTangent),void b._repaintPainter()}if(2===d.type){var j=f[d.idx];if(j.type===qc.Keyframe.AUTO||j.type===qc.Keyframe.FLAT)return;var k=c.xPrecisionValue(a.x-d.offX),l=c.yPrecisionValue(a.y-d.offY),m=Math.atan2(l-j.value,k-j.time);return m=m<-Math.PI/2?-Math.PI/2:m,m=m>Math.PI/2?Math.PI/2:m,j.outTangent=Math.tan(m),j.type===qc.Keyframe.FREE_SMOOTH&&(j.inTangent=j.outTangent),void b._repaintPainter()}if(4===d.type){var n=c.drawInfo,o=d.axis,p=0;if("x"===o&&(p=n.hScrollBounds.width-n.hScrollSlider.width)>0){var q=n.hScrollSlider.x-n.hScrollBounds.x+(a.x-d.preX);q=0>q?0:q>p?p:q;var r=q-n.hScrollSlider.x+n.hScrollBounds.x;0!==r&&(c.offX+=r*(n.bounds.width-n.showRect.width)/p)}else if("y"===o&&(p=n.vScrollBounds.height-n.vScrollSlider.height)>0){var q=n.vScrollSlider.y-n.vScrollBounds.y+(a.y-d.preY);q=0>q?0:q>p?p:q;var r=q-n.vScrollSlider.y+n.vScrollBounds.y;0!==r&&(c.offY+=r*(n.bounds.height-n.showRect.height)/p)}return d.preX=a.x,d.preY=a.y,void b._repaintPainter()}if(5===d.type){var n=c.drawInfo,o=d.axis;return"x"===o?c.changeHScrollInfo(d.dir<0?a.x-d.preX:0,d.dir>0?a.x-d.preX:0):c.changeVScrollInfo(d.dir<0?a.y-d.preY:0,d.dir>0?a.y-d.preY:0),d.preX=a.x,d.preY=a.y,void b._repaintPainter()}return 9===d.type?(c.offX-=a.x-d.preX,c.offY-=a.y-d.preY,d.preX=a.x,d.preY=a.y,void b._repaintPainter()):void 0}},Wa.prototype.onZoom=function(a,b,c){var d=this,e=d._painter,f={x:e.xPrecisionValue(a.x),y:e.yPrecisionValue(a.y)};c>0?(e.zoomX*=1.05,e.zoomY*=1.05):0>c&&(e.zoomX/=1.05,e.zoomY/=1.05),e.offX=e.paddingLeft+e.zeroX+f.x*e.zoomX-a.x,e.offY=e.paddingTop+e.zeroY-f.y*e.zoomY-a.y,d._repaintPainter()};var Xa=m("qc.editor.CurvePainter",qc.editor.Painter,function se(a){var b=this;b._contextMenu=new qc.editor.ContextMenu,se["super"].constructor.call(b,a),b.addBottomPainter(b.draw.bind(b)),b.interactor=new qc.editor.CurvePainterInteractor(b),b.paddingTop=20,b.paddingBottom=35,b.paddingLeft=50,b.paddingRight=65,b.background=null,b.scrollSize=10,b.maxZoom=1e4});b.defineProperties(Xa.prototype,{bezierCurve:{get:function(){return this._bezierCurve},set:function(a){this.setPropertyValue("bezierCurve",a)}},curveShowRect:{get:function(){return{x:this.paddingLeft,y:this.paddingTop,width:(this.clientWidth||this.getPreferredSize().width)-this.paddingLeft-this.paddingRight,height:(this.clientHeight||this.getPreferredSize().height)-this.paddingTop-this.paddingBottom}}},zeroX:{get:function(){return isNaN(this._zeroX)?0:this._zeroX},set:function(a){this._zeroX=a}},zeroY:{get:function(){return isNaN(this._zeroY)?this.curveShowRect.height:this._zeroY},set:function(a){this._zeroY=a}},zoomX:{get:function(){var a=isNaN(this._zoomX)?this.curveShowRect.width:this._zoomX;return a},set:function(a){isNaN(a)||a===1/0||a===-(1/0)||0>a||(this._zoomX=a)}},zoomY:{get:function(){var a=isNaN(this._zoomY)?this.curveShowRect.height:this._zoomY;return a},set:function(a){isNaN(a)||a===1/0||a===-(1/0)||0>a||(this._zoomY=a)}},offX:{get:function(){return isNaN(this._offX)?0:this._offX},set:function(a){this._offX=a}},offY:{get:function(){return isNaN(this._offY)?0:this._offY},set:function(a){this._offY=a}},controlLength:{get:function(){return isNaN(this._controlLength)?50:this._controlLength},set:function(a){this._controlLength=a}},drawInfo:{get:function(){return this._drawInfo}},wrapDrawInfo:{get:function(){return this._wrapDrawInfo}},horScrollBounds:{get:function(){var a=5;return{x:a+1.5*this.scrollSize,y:(this.clientHeight||this.getPreferredSize().height)-a-this.scrollSize,width:Math.max(this.scrollSize,(this.clientWidth||this.getPreferredSize().width)-2*a-4*this.scrollSize),height:this.scrollSize}}},verScrollBounds:{get:function(){var a=5;return{x:(this.clientWidth||this.getPreferredSize().width)-a-this.scrollSize,y:a+1.5*this.scrollSize,width:this.scrollSize,height:Math.max((this.clientHeight||this.getPreferredSize().height)-2*a-4*this.scrollSize,this.scrollSize)}}}}),Xa.prototype._stepCalc=function(a){a=Math.abs(a);for(var b=0;a>10;)a/=10,b++;for(;1>a;)a=10*a,b--;return Math.pow(10,b)},Xa.prototype.getMinStepX=function(){return this._stepCalc(20/this.zoomX)},Xa.prototype.getMinStepY=function(){return this._stepCalc(10/this.zoomY)},Xa.prototype.getPrecisionX=function(){var a=this,b=a.curveShowRect,c=2*Math.abs((a.xValue(b.x+b.width)-a.xValue(b.x))/b.width),d=a._stepCalc(c),e=c/d;return e>5?10*d:e>2?5*d:2*d},Xa.prototype.getPrecisionY=function(){var a=this,b=a.curveShowRect,c=2*Math.abs((a.yValue(b.y+b.height)-a.yValue(b.y))/b.height),d=a._stepCalc(c),e=c/d;return 2>e?d:5>e?2*d:5*d},Xa.prototype.xPos=function(a){var b=this,c=b.paddingLeft+b.zeroX+a*b.zoomX-b.offX;return c},Xa.prototype.yPos=function(a){var b=this,c=b.paddingTop+b.zeroY-a*b.zoomY-b.offY;return c},Xa.prototype.xValue=function(a){var b=this;return(a-b.zeroX-b.paddingLeft+b.offX)/b.zoomX},Xa.prototype.yValue=function(a){var b=this;return(b.paddingTop+b.zeroY-b.offY-a)/b.zoomY},Xa.prototype.xPrecisionValue=function(a){var b=this,c=b.getPrecisionX(),d=(a-b.zeroX-b.paddingLeft+b.offX)/b.zoomX;return Math.round(Math.round(d/c)*c*1e4)/1e4},Xa.prototype.yPrecisionValue=function(a){var b=this,c=b.getPrecisionY(),d=(b.paddingTop+b.zeroY-b.offY-a)/b.zoomY;return Math.round(Math.round(d/c)*c*1e4)/1e4},Xa.prototype.draw=function(a){var b=this,c=b.bezierCurve;c&&(this.drawGrid(a),this.drawWrapCurve(a,c),this.drawCurve(a,c,b.zoomX,b.zoomY,b.xPos.bind(b),b.yPos.bind(b),b.xValue.bind(b),b.yValue.bind(b)),this.drawControl(a,c,b.controlLength,b.zoomX,b.zoomY,b.xPos.bind(b),b.yPos.bind(b),b.xValue.bind(b),b.yValue.bind(b)),this.drawCurveInfo(a,c),this.drawScroll(a))},Xa.prototype.drawGrid=function(a){var b=this.getMinStepX(),c=this.getMinStepY(),d=this.xValue(0),e=this.yValue(0),f=this.xValue(this.clientWidth||this.getPreferredSize().width),g=this.yValue(this.clientHeight||this.getPreferredSize().height);d=Math.floor(d/b)*b,e=Math.floor(e/c)*c,f=Math.ceil(f/b)*b,g=Math.ceil(g/c)*c,a.strokeStyle="rgba(117, 117, 117, 0.3)",a.lineWidth=.3,a.beginPath();for(var h=e;h>=g;h-=c)5===Math.abs(Math.round(h/c%10))&&(a.moveTo(this.xPos(d),this.yPos(h)),a.lineTo(this.xPos(f),this.yPos(h)));for(var i=d;f>=i;i+=b)5===Math.abs(Math.round(i/b%10))&&(a.moveTo(this.xPos(i),this.yPos(e)),a.lineTo(this.xPos(i),this.yPos(g)));a.stroke(),a.closePath(),a.strokeStyle="rgba(117, 117, 117, 0.5)",a.lineWidth=1,a.beginPath();for(var h=e;h>=g;h-=c)0===Math.abs(Math.round(h/c)%10)&&(a.moveTo(this.xPos(d),this.yPos(h)),a.lineTo(this.xPos(f),this.yPos(h)));for(var i=d;f>=i;i+=b)0===Math.abs(Math.round(i/b)%10)&&(a.moveTo(this.xPos(i),this.yPos(e)),a.lineTo(this.xPos(i),this.yPos(g)));a.stroke(),a.closePath(),a.font="12px",a.fillStyle="rgba(117, 117, 117, 0.8)";var j=Math.ceil(25/(c*this.zoomY*5)),k=Math.ceil(50/(b*this.zoomX*5));j=5*(1===j?j:2*Math.ceil(j/2)),k=5*(1===k?k:2*Math.ceil(k/2)),a.textAlign="left",a.textBaseline="bottom";for(var h=e;h>=g;h-=c)0===Math.abs(Math.round(h/c)%j)&&a.fillText(Math.round(1e4*h)/1e4,5,this.yPos(h));for(var i=d;f>=i;i+=b)0===Math.abs(Math.round(i/b)%k)&&a.fillText(Math.round(1e4*i)/1e4,this.xPos(i),(this.clientHeight||this.getPreferredSize().height)-25)},Xa.prototype.drawWrapCurve=function(a,b){if(0!==b.keys.length){var c=0,d=this.xValue(c),e=b.evaluate(d),f=b.totalTime;for(a.strokeStyle="rgb(175, 175, 175)",a.lineWidth=1,a.beginPath(),a.moveTo(this.xPos(d),this.yPos(e));++c<=this.clientWidth;){var g=this.xValue(c),h=(g-b.startTime)%f;h=0>h?h+f:h;var i=(d-b.startTime)%f;i=0>i?i+f:i,i>h&&(d=b.startTime+Math.floor((g-b.startTime)/f)*f,e=b.evaluate(d,!0),a.lineTo(this.xPos(d),this.yPos(e))),d=g,e=b.evaluate(d,!0),a.lineTo(this.xPos(d),this.yPos(e))}a.stroke(),a.closePath()}},Xa.prototype.drawCurve=function(a,b,c,d,e,f){this._curveField=null;var g=1/c,h=b.keys;if(!(h.length<=0)){var i=this.interactor&&this.interactor._editorTarget,j=h[0].time,k=h[h.length-1].time,l=j,m=h[0].value,n=j,o=h[0].value;a.strokeStyle=i&&3===i.type?"rgb(121, 255, 121)":"rgb(0, 200, 0)",a.lineWidth=1,a.beginPath(),a.moveTo(e(j),f(q));for(var p=j;k>p;p+=g){var q=b.evaluate(p);a.lineTo(e(p),f(q)),l=Math.min(p,l),n=Math.max(p,n),m=Math.min(q,m),o=Math.max(q,o)}var q=h[h.length-1].value;l=Math.min(k,l),n=Math.max(k,n),m=Math.min(q,m),o=Math.max(q,o),a.lineTo(e(k),f(q)),a.stroke(),a.closePath(),a.fillStyle="rgb(0, 255, 0)",a.lineWidth=1,a.beginPath();for(var r=0;r<h.length;r++)a.moveTo(e(h[r].time),f(h[r].value)),a.arc(e(h[r].time),f(h[r].value),2,0,2*Math.PI);return a.fill(),a.closePath(),this._curveField=[l,n,m,o],this._curveField}},Xa.prototype.drawControl=function(a,b,c,d,e,f,g){for(var h=b.keys,i=this.interactor&&this.interactor._downKey,j=this.interactor&&this.interactor._editorTarget,k=j&&j.type>=0&&j.type<=2?j.idx:-1,l=j?j.type:-1,m=0;m<h.length;m++)i&&i===h[m]&&(a.fillStyle=k===m?"rgba(230, 230, 230, 1)":"rgba(212, 212, 212, 0.8)",a.lineWidth=1,a.beginPath(),a.moveTo(f(h[m].time),g(h[m].value)),a.arc(f(h[m].time),g(h[m].value),2.5,0,2*Math.PI),a.fill(),a.closePath());for(var m=0;m<h.length;m++)if(i&&i===h[m]&&h[m].type!==qc.Keyframe.AUTO){if(a.strokeStyle=k===m&&1===l?"rgba(230, 230, 230, 1)":"rgba(212, 212, 212, 0.8)",a.lineWidth=1,a.beginPath(),0!==m){a.moveTo(f(h[m].time),g(h[m].value));var n=Math.atan(h[m].inTangent);n=Math.atan2(Math.sin(n)*e,Math.cos(n)*d);var o=c*Math.cos(n),p=c*Math.sin(n);a.lineTo(f(h[m].time)-o,g(h[m].value)+p),a.arc(f(h[m].time)-o,g(h[m].value)+p,1.5,0,2*Math.PI)}if(a.stroke(),a.closePath(),a.strokeStyle=k===m&&2===l?"rgba(230, 230, 230, 1)":"rgba(212, 212, 212, 0.8)",a.beginPath(),m!==h.length-1){a.moveTo(f(h[m].time),g(h[m].value));var n=Math.atan(h[m].outTangent);n=Math.atan2(Math.sin(n)*e,Math.cos(n)*d);var o=c*Math.cos(n),p=c*Math.sin(n);a.lineTo(f(h[m].time)+o,g(h[m].value)-p),a.arc(f(h[m].time)+o,g(h[m].value)-p,1.5,0,2*Math.PI)}a.stroke(),a.closePath()}},Xa.prototype.drawCurveInfo=function(a,b){var c=this,d=c.interactor&&c.interactor.getMovingKey();if(a.fillStyle="rgba(212, 212, 212, 0.8)",a.font="24px",d)for(var e=d.length;e--;){var f=d[e];a.textAlign="center",a.textBaseline="bottom",a.fillText("("+f.time+","+f.value+")",this.xPos(f.time),this.yPos(f.value))}var g=b.keys;if(g.length>0){var h=["Clamp","Loop","PingPong"];a.textAlign="right",a.textBaseline="top",a.fillText(h[b.preWrapMode],this.xPos(g[0].time),this.yPos(g[0].value));var i=a.measureText(h[b.preWrapMode]);a.textAlign="left",a.fillText(h[b.postWrapMode],this.xPos(g[g.length-1].time),this.yPos(g[g.length-1].value));var j=a.measureText(h[b.postWrapMode]);this._wrapDrawInfo=[{x:this.xPos(g[0].time)-i.width,y:this.yPos(g[0].value),width:i.width,height:24},{x:this.xPos(g[g.length-1].time),y:this.yPos(g[g.length-1].value),width:j.width,height:24}]}else this._wrapDrawInfo=null},Xa.prototype.drawScroll=function(a){var b=this,c=this._curveField;if(c){var d=this.scrollSize,e=b.curveShowRect,f=b.horScrollBounds,g=b.verScrollBounds,h={x:Math.min(e.x,this.xPos(c[0])),y:Math.min(e.y,this.yPos(c[3])),width:Math.max(e.x+e.width,this.xPos(c[1]))-Math.min(e.x,this.xPos(c[0])),height:Math.max(e.y+e.height,this.yPos(c[2]))-Math.min(e.y,this.yPos(c[3]))},i={width:f.width*e.width/h.width,height:f.height,x:f.x,y:f.y};if(h.x!==e.x&&h.width>e.width&&i.width<f.width){var j=(e.x-h.x)*(f.width-i.width)/(h.width-e.width);i.x+=Math.max(j,0)}var k={width:g.width,height:g.height*e.height/h.height,x:g.x,y:g.y};if(h.y!==e.y&&h.height>e.height&&k.height<g.height){var l=(e.y-h.y)*(g.height-k.height)/(h.height-e.height);k.y+=Math.max(l,0)}a.fillStyle="rgb(29, 28, 29)",a.fillRect(i.x-.5*d,i.y,i.width+d,i.height),a.fillRect(k.x,k.y-.5*d,k.width,k.height+d),a.fillStyle="rgb(61, 61, 61)",a.lineWidth=1,a.beginPath(),a.moveTo(i.x-d,i.y+d/2),a.arc(i.x-d,i.y+d/2,d/2,0,2*Math.PI),a.rect(i.x-d,i.y,d/2,d),a.moveTo(i.x+i.width+d,i.y+d/2),a.arc(i.x+i.width+d,i.y+d/2,d/2,0,2*Math.PI),a.rect(i.x+i.width+.5*d,i.y,d/2,d),a.moveTo(k.x+d/2,k.y-d),a.arc(k.x+d/2,k.y-d,d/2,0,2*Math.PI),a.rect(k.x,k.y-d,d,d/2),a.moveTo(k.x+d/2,k.y+k.height+d),a.arc(k.x+d/2,k.y+k.height+d,d/2,0,2*Math.PI),a.rect(k.x,k.y+k.height+.5*d,d,d/2),a.fill(),a.closePath(),a.strokeStyle="rgb(15, 15, 15)",a.lineWidth=1,a.beginPath(),a.moveTo(i.x-d,i.y),a.lineTo(i.x+i.width+d,i.y),a.moveTo(i.x-d,i.y+d),a.lineTo(i.x+i.width+d,i.y+d),a.moveTo(i.x-d,i.y+d),a.arc(i.x-d,i.y+d/2,d/2,.5*Math.PI,1.5*Math.PI),a.moveTo(i.x+i.width+d,i.y),a.arc(i.x+i.width+d,i.y+d/2,d/2,-.5*Math.PI,.5*Math.PI),a.moveTo(k.x,k.y-d),a.lineTo(k.x,k.y+k.height+d),a.moveTo(k.x+d,k.y-d),a.lineTo(k.x+d,k.y+k.height+d),a.moveTo(k.x,k.y-d),a.arc(k.x+d/2,k.y-d,d/2,Math.PI,2*Math.PI),a.moveTo(k.x+d,k.y+k.height+d),a.arc(k.x+d/2,k.y+k.height+d,d/2,0,Math.PI),a.stroke(),a.closePath(),this._drawInfo={showRect:e,bounds:h,vScrollBounds:g,hScrollBounds:f,vScrollSlider:k,hScrollSlider:i,scrollSize:d}}},Xa.prototype.changeScroll=function(a,b,c,d,e,f){if(0!==e){if(0>e&&d.start<=c.start)return;if(e>0&&b.start>a.start)b.start=Math.max(b.start-e,a.start),b.len=b.end-b.start;else{if(d.start+=e,d.start=Math.max(d.start,c.start),d.start=Math.min(d.start,d.end),d.start===d.end)return;var g=d.start-c.start,h=c.end-d.end,i=c.len-g-h,j=b.start,k=b.end;j=a.start-a.len*g/i,b.end>=a.end&&(k=a.end+a.len*h/i),b.start=j,b.end=k,b.len=b.end-b.start}}else if(0!==f){if(f>0&&d.end>=c.end)return;if(0>f&&b.end<a.end)b.end=Math.min(b.end-f,a.end),b.len=b.end-b.start;else{if(d.end+=f,d.end=Math.min(d.end,c.end),d.end=Math.max(d.end,d.start),d.end===d.start)return;var g=d.start-c.start,h=c.end-d.end,i=c.len-g-h,j=b.start,k=b.end;k=a.end+a.len*h/i,b.start<a.start&&(j=a.start-a.len*g/i),b.start=j,b.end=k,b.len=b.end-b.start}}return b},Xa.prototype.changeHScrollInfo=function(a,b){var c=this,d=this._curveField;if(d){var e=c.curveShowRect,f=c.horScrollBounds,g=c.drawInfo.hScrollSlider,h={start:e.x,end:e.x+e.width,len:e.width},i={start:f.x,end:f.x+f.width,len:f.width},j={start:g.x,end:g.x+g.width,len:g.width},k={start:this.xPos(d[0]),end:this.xPos(d[1]),len:this.xPos(d[1])-this.xPos(d[0])};if(0!==k.len&&(this.changeScroll(h,k,i,j,a,b),0!==k.len)){var l=k.end-k.start;this.zoomX=3e-9>l?.1/Math.abs(d[1]-d[0]):(k.end-k.start)/Math.abs(d[1]-d[0]),this.offX=this.paddingLeft+this.zeroX+d[0]*this.zoomX-k.start}}},Xa.prototype.changeVScrollInfo=function(a,b){var c=this,d=this._curveField;if(d){var e=c.curveShowRect,f=c.verScrollBounds,g=c.drawInfo.vScrollSlider,h={start:e.y,end:e.y+e.height,len:e.height},i={start:f.y,end:f.y+f.height,len:f.height},j={start:g.y,end:g.y+g.height,len:g.height},k={start:this.yPos(d[3]),end:this.yPos(d[2]),len:this.yPos(d[2])-this.yPos(d[3])};if(0!==k.len&&(this.changeScroll(h,k,i,j,a,b),0!==k.len)){var l=k.end-k.start;this.zoomY=3e-9>l?.1/Math.abs(d[2]-d[3]):(k.end-k.start)/Math.abs(d[2]-d[3]),this.offY=this.paddingTop+this.zeroY-d[3]*this.zoomY-k.start}}},Xa.prototype.adjustCurve=function(a){var b=this,d=b.bezierCurve;if(a=a==c?255:a,d){var e=d.keys;if(0!==e.length){for(var f=e[0].time,g=e[e.length-1].time,h=b.curveShowRect,i=e[0].value,j=e[0].value,k=1/h.width,l=f;(l+=k)<g;){var m=d.evaluate(l);i=Math.min(i,m),j=Math.max(j,m)}var m=d.evaluate(g);i=Math.min(i,m),j=Math.max(j,m),0!==(1&a)&&(b.zoomX=h.width/(3e-9>g-f?1:g-f),b.offX=b.paddingLeft+b.zeroX+f*b.zoomX-b.paddingLeft),0!==(2&a)&&(b.zoomY=h.height/(3e-9>j-i?1:j-i),b.offY=b.paddingTop+b.zeroY-j*b.zoomY-b.paddingTop),b.iv()}}},Xa.prototype.onPropertyChange=function(){this.iv()},Xa.prototype.drawBorder=function(){},Xa.prototype.getPreferredSize=function(){return{width:600,height:400}},Xa.prototype.calculateClientWidth=function(){return this.width},Xa.prototype.calculateClientHeight=function(){return this.height};var Ya=m(null,b,function(a){var b=this;b._list=a,b.addListeners()},{clear:function(){},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this,c=b.view,d=c.lp(a),e=c.getDataAt(a);if(e){var f=c.width-c.rowHeight-8;d.x>=f&&d.x<=f+c.rowHeight-8?c.removable&&c.dataModel.remove(e):c.emit("clickData",e)}else c.focusData=null},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(){}},{interactor:!0},{view:{get:function(){return this._list}}}),Za=m("qc.editor.InspectorList",qc.widget.List,function te(a){var b=this;te["super"].constructor.call(b),k.initObject(b,a),new Ya(b),b.addTopPainter(b.drawDNDState),b.addBottomPainter(b.drawBackground.bind(b));var c=b.validateImpl;b.validateImpl=function(){b.view.style.border="1px solid "+b._borderColor,c.call(b)};var d=b.drawRow;b.drawRow=function(a,c,e,f,g,h){if(d.call(b,a,c,e,f,g,h),b.removable){a.beginPath(),a.strokeStyle="black";var i={width:h,height:h,comps:[{type:"shape",points:[0,0,h,h],segments:[1,2],borderWidth:2,borderColor:b.labelColor},{type:"shape",points:[0,h,h,0],segments:[1,2],borderWidth:2,borderColor:b.labelColor}]};k.drawImage(a,i,null,g-h-8,f+4,h-8,h-8)}}});Za.prototype.drawBackground=function(a){var b=this,c=b.clientWidth,d=b.clientHeight;a.beginPath(),a.rect(0,-b.translateY,c,d),a.fillStyle=b._background,a.fill()},Za.prototype.drawDNDState=function(a){if(this.dragInfo){var b=this.clientWidth,c=this.rowHeight,d=this.dragInfo.rowIndex,e=this.dragInfo.type;d>=0&&(a.beginPath(),"up"===e?(a.moveTo(0,d*c),a.lineTo(b,d*c)):"down"===e&&(a.moveTo(0,(d+1)*c),a.lineTo(b,(d+1)*c)),a.strokeStyle="#507aea",a.lineWidth=2,a.stroke())}},Za.prototype._clearDragInfo=function(){fa.dragAndDrop.hideTip(),this.dragInfo&&(this.dragInfo=null,this.iv())},Za.prototype._dragging=function(a){var b=this.dragInfo;if(b){var c=this.rowHeight,d=this.lp(a),e=d.y/c,f=Math.floor(e);if(f>this.rowDatas.length-1)b.rowIndex=this.rowDatas.length-1,b.type="down";else{b.rowIndex=f;var g=d.y-f*c;.3*c>g?b.type="up":g>.7*c&&(b.type="down")}this.autoScroll(a),this.iv()}},Za.prototype._endDrag=function(){var a=this.dragInfo;if(a){var b=a.rowIndex,c=a.sourceData;if(!c)return void this._clearDragInfo();this.dataModel.moveTo(c,b),this._clearDragInfo()}},Za.prototype.handleDragAndDrop=function(a,b){if(this._draggable){if("prepare"===b||"cancel"===b)return void this._clearDragInfo();if("begin"===b||"between"===b){if("begin"===b){var c=this.draggingData;c&&(this.focusData=c,this.dragInfo={sourceData:c})}this._dragging(a),fa.dragAndDrop.showTip(this.dragInfo.sourceData.name,a)}else"end"===b&&this._endDrag(a)}},b.defineProperties(Za.prototype,{draggable:{get:function(){return this._draggable},set:function(a){this.setPropertyValue("draggable",a)}},removable:{get:function(){return this._removable},set:function(a){this.setPropertyValue("removable",a)}},checkable:{get:function(){return"check"===this.checkMode},set:function(a){this.checkMode=a?"check":null}}}),Za.prototype.calculateClientWidth=function(){return this.width-2},Za.prototype.calculateClientHeight=function(){return this.height-2};var $a=m("qc.editor.Explorer",qc.widget.Container,function ue(b){var c=this;ue["super"].constructor.call(c,b);var d=c.layout=new qc.widget.layout.BorderLayout(c);d.leftToggleVisible=!1,d.bottomToggleVisible=!1,d.leftResizable=!1,d.bottomResizable=!1,d.splitterColor="rgb(143, 156, 178)",d.splitterSize=1;var e=c._favoriteTree=new qc.widget.Tree;e.enableToolTip();var f=new qc.widget.Data;f.name=fa._("Favorites"),f.isTitle=!0,e.dataModel.add(f),e.onDataClick=function(a){c.handleTreeDataClick(a)};var g;try{g=JSON.parse(a.localStorage.getItem("favoriteFolders"))}catch(h){}if(!g){var i=fa.userHome;"win32"===fa.platform&&(i=i.replace(/\\/gi,"//")),g=[{name:"Desktop",path:i+"/Desktop"},{name:"Documents",path:i+"/Documents"},{name:"Downloads",path:i+"/Downloads"}],a.localStorage&&a.localStorage.setItem("favoriteFolders",JSON.stringify(g))}g.forEach(function(a){var b=new qc.widget.Data;b.name=a.name,b.parent=f,b.toolTip=a.path,b.a("path",a.path),e.dataModel.add(b)});var j=new qc.widget.Data;j.name=fa._("My Computer"),j.a("path",""),j.isTitle=!0,e.dataModel.add(j);var k=function(a,b){var c=new qc.widget.Data;c.name=b||a,c.a("path",a),a&&(c.toolTip=a),c.parent=j,j.dataModel.add(c);

};"win32"===fa.platform?(k(fa.userHome.replace(/\\/gi,"//"),fa._("Home")),qc.editor.Operation.LIST_DIR("",function(a){a.sub.forEach(function(a){k(a)})})):(k("","/"),k(fa.userHome,fa._("Home")),qc.editor.Operation.LIST_DIR("/Volumes",function(a){a.sub.forEach(function(b){"Macintosh HD"!==b&&k(a.path+"/"+b,b)})})),e.expandAll();var l=new qc.widget.Slider({min:1,max:100});l.preferredSize={width:70,height:26};var m=c._fileList=new qc.editor.ItemList,n=new qc.widget.Container;if(n.layout=new qc.widget.layout.TableLayout(n),n.setItems([{height:"100+0.1",widths:[.1],cells:[{element:m}]},{height:26,cells:[{element:l,align:"right",vAlign:"middle",fill:"none"}]}]),m.onDataDoubleClick=function(a){c.inflateDir(a.a("path"))},m.onBackgroundDoubleClick=function(){var a=c.getParentPath(m.currPath);c.inflateDir(a)},l.onValueChange=function(b){16>=b?1===b?m.layout="list":l.value=1:(m.layout="tile",m.itemWidth=m.itemHeight=40+Math.round(.5*b-8)),a.localStorage&&a.localStorage.setItem("explorerSliderValue",b)},m.selectionModel.on("selectionChange",function(){var a=m.selectionModel.lastData;r.value=a?a.a("path"):m.currPath,r.value||"win32"===fa.platform||(r.value="/")}),a.localStorage){var o=a.localStorage.getItem("explorerSliderValue");o&&(l.value=parseInt(o))}else l.value=32;l.disableToolTip();var p=new qc.widget.Container;p.layout=new qc.widget.layout.TableLayout(p);var q=new za({text:fa._("Path")+":"}),r=c._txtPath=new Aa,s=new qc.editor.InspectorButton({text:fa._("OK")}),t=new qc.editor.InspectorButton({text:fa._("Cancel")});p.setItems([{height:30,widths:[100,.1,60,60],cells:[{element:q},{element:r},{element:s},{element:t}]}]),s.on("click",function(){c.emit("clickOk",c._txtPath.value)}),t.on("click",function(){c.emit("clickCancel",c._txtPath.value)}),c.setItems([{region:"left",element:e,width:190},{region:"center",element:n},{region:"bottom",element:p}]),c.inflateDir("");var u=new qc.widget.ContextMenu;u.items=[{label:fa._("Add to Favorites"),action:function(){var b=m.selectionModel.lastData,c=b.a("path"),d=new qc.widget.Data;d.name=b.name,d.parent=f,d.toolTip=c,d.a("path",c),e.dataModel.add(d);var g=[];f.children&&f.children.forEach(function(a){g.push({name:a.name,path:a.a("path")})}),a.localStorage&&a.localStorage.setItem("favoriteFolders",JSON.stringify(g))}}],u.visibleFunc=function(){return m.selectionModel.lastData?!0:void 0},u.addTo(m),u=new qc.widget.ContextMenu,u.items=[{label:fa._("Remove from Favorites"),action:function(){var b=e.selectionModel.selection.slice(0);b.forEach(function(a){e.dataModel.remove(a)});var c=[];f.children&&f.children.forEach(function(a){c.push({name:a.name,path:a.a("path")})}),a.localStorage&&a.localStorage.setItem("favoriteFolders",JSON.stringify(c))}}],u.visibleFunc=function(){var a=e.selectionModel.lastData;return a&&a.parent===f?!0:void 0},u.addTo(e)});$a.prototype.getParentPath=function(a){return a?(a=a.substring(0,a.lastIndexOf("/")),a.lastIndexOf("/")===a.length-1&&(a=a.substring(0,a.lastIndexOf("/"))),a):void 0},$a.prototype.handleTreeDataClick=function(a){var b=this,c=a.a("path");b.inflateDir(c)},$a.prototype.inflateDir=function(a){var b=this,c=b._fileList;c.currPath=a,b._txtPath.value=a||("win32"!==fa.platform?"/":""),qc.editor.Operation.LIST_DIR(a,function(d){if(c.dataModel.clear(),a){var e=new qc.editor.ItemNode;e.image="folder",e.name="..",e.a("path",b.getParentPath(a)),c.dataModel.add(e)}var f=0;d.sub.forEach(function(b){var e=new qc.editor.ItemNode;e.image="folder",e.name=b,a?e.a("path",d.path+"/"+b):e.a("path",d.path+b),e.hasChildren=d.hasChildren[f],c.dataModel.add(e),f++})})};var _a=m("qc.editor.ProjectActionPane",qc.widget.Container,function ve(a){var b=this;ve["super"].constructor.call(b,a),b.layout=new qc.widget.layout.VBoxLayout(b),b.layout.padding=10,b.layout.gap=0,b.initUI()});_a.prototype.initUI=function(){var a=function(a){var b=new qc.widget.ToggleButton;return b.text=a,b.borderWidth=0,b.textFont="20px Arial",b.preferredSize={height:30},b.textColor="#caccd8",b.align="left",b.background=null,b.gradientColor=null,b.activeBackground="#3e4b6b",b.activeGradientColor=null,b.hoverBackground="rgb(72, 72, 72)",b.hoverGradientColor=null,b},b=this,c=a(fa._("Recent Projects")),d=a(fa._("New Project")),e=a(fa._("Open Project")),f=new qc.widget.Radios;c.on("propertyChange",b.handleRecentProjectButtonSelect.bind(b)),d.on("propertyChange",b.handleNewProjectButtonSelect.bind(b)),e.on("propertyChange",b.handleOpenFolderButtonSelect.bind(b)),f.add(c),f.add(d),f.add(e),b.setItems([c,d,e]),U(function(){c.selected=!0})},_a.prototype.handleRecentProjectButtonSelect=function(a){if("selected"===a.property&&a.newValue){var b=new bb;qc.editor.Operation.RECENT_OPEN(function(a){if(a)for(var c=0;c<a.length;c++)b.add(a[c])}),fa.mainLayout.centerView=b}},_a.prototype.handleNewProjectButtonSelect=function(b){if("selected"===b.property&&b.newValue){var c=new ab;fa.mainLayout.centerView=c,c.on("create",function(b){var c=b.path;c?qc.editor.Operation.CREATE_PROJECT(c,function(b,d){b?qc.editor.Operation.OPEN_PROJECT(c,function(b){b?(fa.storage.set("switchProject","1"),a.location.href="./index.html"):fa.notification.error(fa._("Open project failed."))}):fa.notification.error(fa._("Create project failed.")+" Reason:"+d)}):fa.notification.error(fa._("Please choose a folder to create the project"))})}},_a.prototype.handleOpenFolderButtonSelect=function(a){if("selected"===a.property&&a.newValue){var b=new cb;fa.mainLayout.centerView=b}},b.defineProperties(_a.prototype,{});var ab=m("qc.editor.CreateProjectPane",qc.widget.Container,function we(a){var b=this;we["super"].constructor.call(b,a),b.layout=new qc.widget.layout.TableLayout(b),b.initUI()});ab.prototype.initUI=function(){var a=this,b=[{height:50,widths:[a.labelWidth||140,"40+0.1",50],cells:[{colspan:3,elementConfig:{type:"label",textColor:"#caccd8",textFont:"28px Arial",text:fa._("Create a new project")}}]},{cells:[{elementConfig:{type:"label",textColor:"#caccd8",align:"left",textFont:"13px Arial",text:fa._("Project Folder")}},{elementConfig:{type:"textfield",font:"13px Arial",id:"projectDirectory"}},{elementConfig:{type:"button",id:"picker",ninePatchImage:"inspector_button.9",ninePatchBorder:[10,10,10,10],hoverNinePatchImage:"inspector_button.9",hoverNinePatchBorder:[10,10,10,10],activeNinePatchImage:"inspector_button_active.9",activeNinePatchBorder:[10,10,10,10],textColor:"#caccd8",borderWidth:0,textFont:"13px Arial",text:"..."}}]},{cells:[]},{cells:[{fill:"none",align:"right",colspan:3,elementConfig:{type:"button",id:"create",ninePatchImage:"inspector_button.9",ninePatchBorder:[10,10,10,10],hoverNinePatchImage:"inspector_button.9",hoverNinePatchBorder:[10,10,10,10],activeNinePatchImage:"inspector_button_active.9",activeNinePatchBorder:[10,10,10,10],textColor:"#caccd8",preferredSize:{width:100,height:40},borderWidth:0,textFont:"13px Arial",text:fa._("Create")}}]}];k.inflate(b,a);var c=a.findViewById("picker");c.on("click",function(){var b=new $a,c=new Na;c.modal=!0,c.title=fa._("Choose Folder"),c.content=b,c.contentPadding=2;var d=Cb(800,500);c.width=d.width,c.height=d.height,c.show(),b.on("clickOk",function(b){a.findViewById("projectDirectory").value=b,c.hide()}),b.on("clickCancel",function(){c.hide()})});var d=a.findViewById("create");d.on("click",function(){var b=a.findViewById("projectDirectory").value;a.emit("create",{path:b})})},b.defineProperties(ab.prototype,{});var bb=m("qc.editor.RecentProjectPane",qc.widget.Container,function xe(a){var b=this;xe["super"].constructor.call(b,a),b.layout=new qc.widget.layout.TableLayout(b),b.layout.padding=10,b.initUI()});bb.prototype.add=function(a){var b=this,c=b._list,d=new qc.widget.Data;d.name=a,c.dataModel.add(d)},bb.prototype.initUI=function(){var b=this,c=b._list=new qc.widget.List,d=new qc.widget.Label({text:fa._("Search:"),textColor:"#caccd8",align:"left"}),e=b._txtSearch=new qc.editor.StringInput,f=new qc.widget.Label({text:fa._("Recent Opened Projects"),textFont:"28px Arial",textColor:"#caccd8"});c.rowHeight=30,c.view.addEventListener("click",function(a){var b=c.lp(a),d=c.getDataAt(a),e=c.width;b.x>e-30&&qc.editor.Operation.REMOVE_RECENT_OPEN(d.name,function(a){a.operRet&&(c.dataModel.remove(d),fa.notification.info(fa._("Project has been removed successfully.")))})}),c.view.addEventListener("dblclick",function(b){var d=c.lp(b),e=c.getDataAt(b),f=c.width;d.x>f-30||qc.editor.Operation.OPEN_PROJECT(e.name,function(b){b?(fa.storage.set("switchProject","1"),a.location.href="./index.html"):fa.notification.error(fa._("Open project failed."))})});var g=c.drawRow,h={width:20,height:20,comps:[{type:"shape",points:[0,0,20,20],segments:[1,2],background:null,borderWidth:2,borderColor:"red"},{type:"shape",points:[0,20,20,0],segments:[1,2],background:null,borderWidth:2,borderColor:"red"}]};c.view.style.background="rgb(65, 65, 65)",c.view.style.border="1px solid rgb(32, 32, 32)",c.calculateClientWidth=function(){return this.width-2},c.calculateClientHeight=function(){return this.height-2},c.drawRowBackground=function(a,b,d,e,f,g){c.isSelected(b)?k.fillRect(a,d,e,f,g,c.getSelectBackground(b)):c._hoverData===b&&k.fillRect(a,d,e,f,g,"rgb(72, 72, 72)")},c.addEventListener("mousemove",function(a){var b=c.getDataAt(a);b!==c._hoverData&&c.iv(),c._hoverData=b}),c.drawRow=function(a,b,d,e,f,i){g.call(c,a,b,d,e,f,i),b===c._hoverData&&k.drawImage(a,h,"centerUniform",f-30,e+7,16,16,b,c)},e.onValueChanged=function(a){c.visibleFunc=a?function(b){return b.name.indexOf(a)>=0?!0:void 0}:null},b.setItems([{height:50,widths:[140,.1],cells:[{colspan:2,element:f}]},{cells:[{element:d},{element:e}]},{height:.1,cells:[{colspan:2,element:c}]}])},b.defineProperties(bb.prototype,{});var cb=m("qc.editor.OpenProjectPane",qc.widget.Container,function ye(a){var b=this;ye["super"].constructor.call(b,a),b.layout=new qc.widget.layout.TableLayout(b),b.initUI()});cb.prototype.initUI=function(){var b=this,c=[{height:50,widths:[140,"40+0.1",50],cells:[{colspan:3,elementConfig:{type:"label",textColor:"#caccd8",textFont:"28px Arial",text:fa._("Open Project")}}]},{cells:[{elementConfig:{type:"label",textColor:"#caccd8",align:"left",textFont:"13px Arial",text:fa._("Project Folder")}},{elementConfig:{type:"textfield",font:"13px Arial",id:"projectDirectory"}},{elementConfig:{type:"button",id:"picker",ninePatchImage:"inspector_button.9",ninePatchBorder:[10,10,10,10],hoverNinePatchImage:"inspector_button.9",hoverNinePatchBorder:[10,10,10,10],activeNinePatchImage:"inspector_button_active.9",activeNinePatchBorder:[10,10,10,10],textColor:"#caccd8",textFont:"13px Arial",borderWidth:0,text:"..."}}]},{cells:[]},{cells:[{fill:"none",align:"right",colspan:3,elementConfig:{type:"button",id:"open",ninePatchImage:"inspector_button.9",ninePatchBorder:[10,10,10,10],hoverNinePatchImage:"inspector_button.9",hoverNinePatchBorder:[10,10,10,10],activeNinePatchImage:"inspector_button_active.9",activeNinePatchBorder:[10,10,10,10],textColor:"#caccd8",preferredSize:{width:100,height:40},borderWidth:0,textFont:"13px Arial",text:fa._("Open")}}]}];k.inflate(c,b);var d=b.findViewById("picker");d.on("click",function(){var a=new $a,c=new Na;c.modal=!0,c.title=fa._("Choose Folder"),c.content=a,c.contentPadding=2;var d=Cb(800,500);c.width=d.width,c.height=d.height,c.show(),a.on("clickOk",function(a){b.findViewById("projectDirectory").value=a,c.hide()}),a.on("clickCancel",function(){c.hide()})});var e=b.findViewById("open");e.on("click",function(){var c=b.findViewById("projectDirectory").value;c&&qc.editor.Operation.OPEN_PROJECT(c,function(b){b?(fa.storage.set("switchProject","1"),a.location.href="./index.html"):fa.notification.error(fa._("Open project failed."))})})},b.defineProperties(cb.prototype,{});var db=m("qc.editor.FolderChooser",b,function(a){var b=this;db["super"].constructor.call(b,a)});db.prototype.openFolderChooser=function(){var a=this,b=new Na;b.contentPadding=[2,2,2,2];var c=new qc.widget.Tree;b.title=fa._("Double click to choose the folder");var d=Cb(700,500);b.width=d.width,b.height=d.height,b.content=c,b.modal=!0,c.onDataDoubleClick=function(){b.hide();var d=c.selectionModel.selection[0];d&&a.onFolderChoosed&&a.onFolderChoosed(d.path),b.hide()},c.loader={load:function(b){a.inflateDir(b.path,c,b)},isLoaded:function(a){return a.hasChildren?a.isLoaded:!0}},a.inflateDir("",c),b.show()},db.prototype.inflateDir=function(a,b,c){var d=this;c&&(c.isLoaded=!0),qc.editor.Operation.LIST_DIR(a,function(a){var e=0;a.sub.forEach(function(f){var g=new qc.widget.Data;g.icon="tree_folder",g.name=f,g.path=c?a.path+"/"+f:a.path+f,g.hasChildren=a.hasChildren[e],c&&(g.parent=c),b.dataModel.add(g),e++;var h=fa.projectPath||fa._defaultProjectPath;if(h){var i,j;k.isMac?(i=g.path.split("/"),j=h.split("/")):(i=g.path.split("//"),j=h.split("\\"));for(var l=!0,m=0;m<i.length;m++)if(i[m]!==j[m]){l=!1;break}l&&U(i.length===j.length-1?function(){b.selectionModel.selection=g,b.expand(g)}:function(){d.inflateDir(g.path,b,g)})}})})},b.defineProperties(db.prototype,{});var eb=function(a,b,c){return a instanceof qc.Node?a===a.game.world?!1:!b&&a._bone?!1:!c&&a instanceof qc.UIRoot?!1:!0:!1},fb=function(a){return!(!a||a instanceof qc.UIText||a instanceof qc.Sprite||a._bone)},gb=function(){var a=fa.hierarchy.activeNode;return a&&fb(a)?a:fa.dataModel.getDataById(fa.prefabInfo.prefab.uuid).node},hb=function(a){if(fa.prefabInfo)return gb();var b=fa.hierarchy.activeNode;if(fb(b))return b;if(!a)return fa.game.world;if(b)for(;b!=fa.game.world&&!(b instanceof qc.UIRoot);)b=b.parent;if(b instanceof qc.UIRoot)return b;for(var c=fa.dataModel.datas,d=0;d<c.length;d++)if(b=c[d].node,b instanceof qc.UIRoot)return b;return new qc.UIRoot(fa.game)},ib=function(){var a;a=fa.prefabInfo?fa.prefabInfo.treeData.name:fa.config.editor.currScene,a+="|"+fa.config.project.gameName+"|"+fa.projectPath,document.title=a},jb=function(){fa.workable&&null!=fa.config.project.backgroundColor&&(fa.game.stage.backgroundColor=new qc.Color(fa.config.project.backgroundColor))},kb=function(a,b,c,d,e){nb(a,b,[{text:fa._("OK"),key:"enter",onClick:function(){this.hide(),c&&c()}},{text:fa._("Cancel"),key:"esc",onClick:function(){this.hide(),d&&d()}}],e)},lb=function(a,b,c,d,e){var f=new qc.widget.Container;f.layout.content=a,f.layout.htmlFont="13px Arial",f.layout.htmlColor="#caccd8";var g=f.getPreferredSize(280),h=new qc.widget.TextField;h.value=b,h.preferredSize={width:50,height:20};var i=new qc.editor.Dialog;i.title=fa._("Prompt"),i.width=300,i.height=110+g.height,i.contentPadding=[10,10,10,10],i.modal=!0,i._container.layout.bottomView.layout.padding=[0,0,0,0];var j=new qc.widget.Container;if(j.layout=new qc.widget.layout.TableLayout(j),j.layout.padding=0,j.layout.cellPadding=0,j.scrollbarMode="off",j.setItems([{height:g.height,widths:[.1],cells:[{fill:"fill",element:f}]},{height:.1,cells:[{fill:"h",vAlign:"middle",element:h}]}]),i.content=j,i.tools=[],i.buttons=[{text:fa._("OK"),onClick:function(){i.hide(),c&&c(h.value)}},{text:fa._("Cancel"),onClick:function(){i.hide(),d&&d()}}],h.input.addEventListener("keydown",function(a){G(a)?(i.hide(),c&&c(h.value)):F(a)&&(i.hide(),d&&d())},!1),e)for(var k in e)i[k]=e[k];i.show(),h.input.focus()},mb=function(a){var c=function(){return this.hide(),fa.playing?void fa.notification.warn(fa._("Quit running mode first")):fa.prefabInfo?void fa.notification.warn(fa._("Stop editing prefab first")):void(fa.config.editor.currScene&&"unsavedScene"!=fa.config.editor.currScene?(qc.editor.Operation.SAVE_SCENE(fa.config.editor.currScene),a()):lb(fa._("Enter the new scene name"),"",function(c){if(c){fa.config.editor.currScene=c,qc.editor.Operation.SAVE_SCENE(c),qc.editor.Operation.UPDATE_EDITOR_SETTINGS(fa.config.editor);var d=b.keys(fa.config.scene.scene);d.push(c),qc.editor.Operation.UPDATE_SCENE_SETTINGS(d),ib(),a()}else a()},function(){a()}))};fa.sceneManager.unsaved||fa.sceneManager.dirty?nb(fa._("Do you want to save the scene?"),fa._("Confirm"),[{text:fa._("Save"),key:"enter",onClick:c},{text:fa._("Don't Save"),onClick:function(){this.hide(),a()}},{text:fa._("Cancel"),key:"esc",onClick:function(){this.hide()}}]):a()},nb=function(a,b,c,d){var e=new qc.editor.Dialog({title:b,content:a,buttons:c,modal:!0,width:300,tools:[],dialogContentPadding:[0,0,10,0]});if(d)for(var f in d)e[f]=d[f];e.show();var g,h;return c&&c.forEach(function(a){"enter"===a.key?g=a:"esc"===a.key&&(h=a)}),e.view.addEventListener("keydown",function(a){G(a)&&g?g.onClick.call(e):F(a)&&h&&h.onClick.call(e)},!1),e.requestFocus(),e},ob=function(a){var b=a.rect;return[a.toGlobal({x:b.x,y:b.y}),a.toGlobal({x:b.x+b.width,y:b.y}),a.toGlobal({x:b.x+b.width,y:b.y+b.height}),a.toGlobal({x:b.x,y:b.y+b.height})]},pb=function(a,b){if(!eb(a))return!1;var c=a.rect,d=ob(a),e=d[0],f=d[1],g=d[2],h=d[3];return v(b,e)||v(b,f)||v(b,g)||v(b,h)||w(e,f,b)||w(f,g,b)||w(g,h,b)||w(h,e,b)?!0:(e=a.toLocal({x:b.x,y:b.y}),f=a.toLocal({x:b.x+b.width,y:b.y}),g=a.toLocal({x:b.x+b.width,y:b.y+b.height}),h=a.toLocal({x:b.x,y:b.y+b.height}),v(c,e)||v(c,f)||v(c,g)||v(c,h)||w(e,f,c)||w(f,g,c)||w(g,h,c)||w(h,e,c)?!0:!1)},qb=function(a,b,c){var d=a.x,e=a.y,f=b.x,g=b.y,h=c.x,i=c.y,j={},k=f-d,l=g-e,m=Math.sqrt(k*k+l*l),n=k/m,o=l/m,p=(-d+h)*n+(-e+i)*o;return 0>=p?(j.x=d,j.y=e):p>=m?(j.x=f,j.y=g):(j.x=d+p*n,j.y=e+p*o),k=h-j.x,l=i-j.y,j.z=Math.sqrt(k*k+l*l),j},rb=function(a){var b,c=new Uint8Array(a);try{b=String.fromCharCode.apply(null,c)}catch(d){b="";for(var e=0;e<c.length;e++)b+=String.fromCharCode(c[e])}return b},sb=function(a){var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");return a.slice(Math.max(b,c)+1)},tb=function(a){var b=a.lastIndexOf("/"),c=a.lastIndexOf("\\");return a.slice(0,Math.max(b,c))},ub=function(a){var b=a.lastIndexOf(".");return a.slice(b).toLowerCase()},vb=function(a,b,c){var d=a.x,e=a.y,f=b.x,g=b.y,h=c.x,i=c.y,j={},k=f-d,l=g-e,m=Math.sqrt(k*k+l*l),n=k/m,o=l/m,p=(-d+h)*n+(-e+i)*o;return j.x=d+p*n,j.y=e+p*o,k=h-j.x,l=i-j.y,j.z=Math.sqrt(k*k+l*l),j},wb=function(a,b,c){var d={x:a.x-b.x,y:a.y-b.y};if(c){var e=Math.sqrt(d.x*d.x+d.y*d.y);d.x/=e,d.y/=e}return d},xb=function(a){return null==a?a:parseFloat(a.toFixed(3))},yb=function(a,b,c){for(var d=a.length/2,e=!1,f=-1,g=d-1;++f<d;g=f){var h=a[2*f],i=a[2*f+1],j=a[2*g],k=a[2*g+1];(c>=i&&k>c||c>=k&&i>c)&&(j-h)*(c-i)/(k-i)+h>b&&(e=!e)}return e},zb=function(a){for(var b in a){var c=a[b];if(null!=c){var d=fa.mainContainer.findViewById(b),e=d.dataModel.getDataById(k.isString(c)?c:c[0]);if("fileTree"===b&&(d.selectionModel.selection=e),"fileList"===b&&k.isArray(c)&&e.followers){for(var f,g=e.followers,h=0;h<g.length;h++){var i=g[h];if(i.name==c[1]){f=i;break}}f&&(e.expand=!0,fa.fileList.validate(),e=f)}"fileList"===b?U(function(){d.makeVisible(e),d.blink(e)}):(d.makeVisible(e),d.blink(e))}}},Ab=function(a){a.strokeStyle="rgba(0,0,0,0.15)",a.lineWidth=2,a.stroke(),a.strokeStyle="white",a.lineWidth=1,a.stroke()},Bb=function(a){if(k.isMouseEvent(a)||!document.elementFromPoint)return a.target;var b=C(a);return document.elementFromPoint(b.x,b.y)},Cb=function(a,b){var c=k.getWindowInfo(),d=c.width,e=c.height;if(a>d||b>e){var f=Math.min(d/a,e/b);a*=f,b*=f}return{width:a,height:b}},Db=function(a,b,c){return b>a?b:a>c?c:a},Eb=function(a){if(!a)return!1;var b=a.tagName;return"INPUT"===b||"TEXTAREA"===b||"SELECT"===b},Fb=function(a){var b=arguments;return b.length<=1?a:a.replace(/\{(\d+)\}/g,function(a,c){return b[parseInt(c)+1]})},Gb=function(b){var c=Fb(fa._("Exception notification"),b);fa.notification?fa.notification.error(c):a.alert(c)},Hb=function(a){a=a.replace(/\\/g,"/");for(var b=/\/\//;a.match(b);)a=a.replace(b,"/");return a},Ib=m("qc.editor.GameModel",qc.widget.DataModel,function(a){var b=this;b.game=a,Ib["super"].constructor.call(b),b._addNode(a.world),b.selectionModel.selectableFunc=function(b){return b.node!==a.world},a.world.onModelChange.add(this.handleWorldModelChange,b)});b.defineProperties(Ib.prototype,{lastEditableNode:{get:function(){for(var a=this.selectionModel.selection,b=a.length-1;b>=0;b--){var c=a[b].node;if(eb(c))return c}return null}}}),Ib.prototype.handleWorldModelChange=function(a){var b=a.type,c=a.target,d=c.parent,e=this.getDataById(c.uuid);if(e){if("name"===b)e.name=e.node.name;else if("destroy"===b)c===this.game.world?e.children.slice().forEach(this.remove,this):this.remove(e);else if("removeChildren"===b)e.children.slice().forEach(this.remove,this);else if("parent"===b)if(d){var f=this.getDataById(d.uuid);e.parent!==f&&(e.parent=f),this.moveTo(e,d.getChildIndex(c))}else this.remove(e)}else"parent"===b&&this._addNode(c)},Ib.prototype._createData=function(a){var b=new qc.widget.Data;return b.node=a,b.id=a.uuid,b.cache={},b.name=a.name,b},Ib.prototype._addNode=function(a){if(a.phaser.stage){var b=this._createData(a),c=a.parent;if(c instanceof qc.Node){var d=c.getChildIndex(a);this.getDataById(c.uuid).addChild(b,d)}this.add(b),a.children.forEach(this._addNode,this)}},Ib.prototype.getTopEditableSelection=function(a,b,c){var d=[],e=this.selectionModel.selection;if(a){e=e.slice();for(var f=e.length-1;f>=0;f--)a.isDescendantOf(e[f].node)&&e.splice(f,1)}var g={};return e.forEach(function(a){g[a.uuid]=!0}),e.forEach(function(a){if(eb(a.node,b,c)){for(var e=a.parent;e&&eb(e.node,b,c);){if(g[e.uuid]){a=null;break}e=e.parent}a&&d.push(a)}},this),d},Ib.prototype.hasLockedSelection=function(){for(var a=this.selectionModel.selection,b=0;b<a.length;b++)if(a[b].node.__lock)return!0;return!1},Ib.prototype.moveSelection=function(a,b){this.getTopEditableSelection().forEach(function(c){var d=c.node,e=d.getWorldPosition();e.x+=a,e.y+=b,e=d.parent.toLocal(e),d.x=e.x,d.y=e.y}),fa.sceneManager.dirty=!0},Ib.prototype.createRenameUndoFunc=function(a){var b=this,c=a.name;return function(){b.getDataById(a.uuid)&&(a.name=c)}},Ib.prototype.createMoveUndoFunc=function(a,b){var c=this;if(b){var d=a.x,e=a.y;return function(){c.getDataById(a.uuid)&&(a.x=d,a.y=e)}}var f=c.getTopEditableSelection(),g=[],h=[];return f.forEach(function(a){var b=a.node;h.push(b),g.push({x:b.x,y:b.y})}),function(){for(var a=0;a<h.length;a++){var b=h[a];c.getDataById(b.uuid)&&(b.x=g[a].x,b.y=g[a].y)}}},Ib.prototype.createScaleUndoFunc=function(a,b){var c=this;if(b){var d=a.scaleX,e=a.scaleY;return function(){c.getDataById(a.uuid)&&(a.scaleX=d,a.scaleY=e)}}var f=c.getTopEditableSelection(a),g=[],h=[];return f.forEach(function(a){var b=a.node;h.push(b),g.push({scaleX:b.scaleX,scaleY:b.scaleY})}),function(){for(var a=0;a<h.length;a++){var b=h[a];c.getDataById(b.uuid)&&(b.scaleX=g[a].scaleX,b.scaleY=g[a].scaleY)}}},Ib.prototype.createRotationUndoFunc=function(a,b){var c=this;if(b){var d=a.rotation;return function(){c.getDataById(a.uuid)&&(a.rotation=d)}}var e=[],f=[],g=c.getTopEditableSelection(a);return g.forEach(function(a){var b=a.node;f.push(b),e.push(b.rotation)}),function(){for(var a=0;a<f.length;a++){var b=f[a];c.getDataById(b.uuid)&&(b.rotation=e[a])}}},Ib.prototype.createPivotUndoFunc=function(a){var b=this,c={pivotX:a.pivotX,pivotY:a.pivotY,x:a.x,y:a.y};return function(){b.getDataById(a.uuid)&&(a.pivotX=c.pivotX,a.pivotY=c.pivotY,a.x=c.x,a.y=c.y)}},Ib.prototype.createResizeUndoFunc=function(a){var b=this,c={x:a.x,y:a.y,width:a.width,height:a.height};return function(){b.getDataById(a.uuid)&&(a.x=c.x,a.y=c.y,a.width=c.width,a.height=c.height)}},Ib.prototype.createAnchorUndoFunc=function(a){var b=this,c={minX:a.minAnchor.x,minY:a.minAnchor.y,maxX:a.maxAnchor.x,maxY:a.maxAnchor.y,pivotX:a.pivotX,pivotY:a.pivotY,anchoredX:a.anchoredX,anchoredY:a.anchoredY,left:a.left,right:a.right,top:a.top,bottom:a.bottom,width:a.width,height:a.height};return function(){b.getDataById(a.uuid)&&(a._minAnchor=new qc.Point(c.minX,c.minY),a._maxAnchor=new qc.Point(c.maxX,c.maxY),a.phaser.anchor=new qc.Point(c.pivotX,c.pivotY),a._anchoredX=c.anchoredX,a._anchoredY=c.anchoredY,a._minAnchor.x<a._maxAnchor.x?(a._left=c.left,a._right=c.right):a.setWidth(c.width),a._minAnchor.y<a._maxAnchor.y?(a._top=c.top,a._bottom=c.bottom):a.setHeight(c.height),a.relayout())}},Ib.prototype.createParentUndoFunc=function(a){var b=this,c=b.createParentInfo(a);return function(){b.restoreParentInfo(c)}},Ib.prototype.createParentInfo=function(a){return{node:a,x:a.x,y:a.y,rotation:a.rotation,scaleX:a.scaleX,scaleY:a.scaleY,parent:a.parent,index:a.parent.getChildIndex(a)}},Ib.prototype.restoreParentInfo=function(a){var b=a.node,c=a.parent,d=a.index;this.getDataById(b.uuid)&&this.getDataById(c.uuid)&&(b.switchParent(c),d>=0&&d<=c.children.length&&c.setChildIndex(b,d),b.x=a.x,b.y=a.y,b.rotation=a.rotation,b.scaleX=a.scaleX,b.scaleY=a.scaleY,b._calcAnchoredX(),b._calcAnchoredY(),b._calcMargin())},Ib.prototype.deleteDatasForUndo=function(a){if(a&&0!==a.length){fa.sceneManager.dirty=!0,fa.undo.clearRedo();var b=this,c=[],d=[],e=[],f=a.length,g=[];a.forEach(function(a){var b=a.node;c.push(b),d.push(b.parent),e.push(b.parent.getChildIndex(b)),g.push(b.visible),b.visible&&(b.visible=!1),b.parent=null});var h=function(){for(var a=f-1;a>=0;a--){var h=c[a],i=d[a],j=e[a];b.getDataById(i.uuid)&&(h._destroy||(j>i.children.length?(console.log(h.name+"原先位置："+j+"，当前插入到："+i.children.length),i.addChild(h)):i.addChildAt(h,j),h.visible=g[a]))}},i=function(){for(var a=0;f>a;a++){var b=c[a];b._destroy||(b.visible=!1,b.parent=null)}},j=function(){for(var a=f-1;a>=0;a--){var b=c[a];b.parent||b._destroy||(console.log("销毁节点："+b.name),b.destroyImmediately())}};fa.undo.add(h,i,j)}},Ib.prototype.addNodeForUndo=function(a){this.addDatasForUndo([this.getDataById(a.uuid)])},Ib.prototype.addDatasForUndo=function(a){if(a&&0!==a.length){fa.sceneManager.dirty=!0;var b=this,c=[],d=[],e=[],f=a.length;a.forEach(function(a){var b=a.node;c.push(b),d.push(b.parent),e.push(b.parent.getChildIndex(b))});var g=function(){for(var a=f-1;a>=0;a--){var b=c[a];b._destroy||(b.parent=null)}},h=function(){for(var a=0;f>a;a++){var g=c[a],h=d[a],i=e[a];b.getDataById(h.uuid)&&(g._destroy||(i>h.children.length?(console.log(g.name+"原先位置："+i+"，当前插入到："+h.children.length),h.addChild(g)):h.addChildAt(g,i)))}},i=function(){for(var a=f-1;a>=0;a--){var b=c[a];b.parent||b._destroy||(console.log("销毁节点："+b.name),b.destroyImmediately())}};fa.undo.add(g,h,i)}};var Jb=qc.editor.GameDebugger=function(a){var b=this;b.game=a,b.dataModel=new qc.widget.DataModel,b._colorIndex=0;var d=b.tickData={};d.lastStart=0,d.start=0,d.ms=0;var e=a.phaser,f=e.update;e.update=function(){if(fa.scene.debugEnabled){var a=X(),g=d.start,h=a-g,i=Math.round(1e3/h),j=f.apply(this,arguments);if(!j)return;b.dataModel.forEach(function(a){a.hasValue&&(a.newValue?(a.a("value",a.newValue),a.a("label",a.newValue.toFixed(1))):(a.a("value",0),a.a("label","0.0")),a.newValue=0)}),d.lastStart=g,d.start=a,d.fps=i,d.interval=h;var k=e.renderer.renderSession.drawCount,l=X()-a;d.ms=l,d.lastUpdate?a-d.lastUpdate>=1e3?(d.averageFps=(d.sumFps/d.count).toFixed(1),d.averageMs=(d.sumMs/d.count).toFixed(1),d.sumFps=i,d.sumMs=l,d.count=1,d.lastUpdate=a):(d.sumFps+=i,d.sumMs+=l,d.count++):(d.averageFps=i.toFixed(1),d.averageMs=l.toFixed(1),d.sumFps=i,d.sumMs=l,d.count=1,d.lastUpdate=a),b.debugDiv.innerHTML="fps:"+d.averageFps+"<br>ms:"+d.averageMs+"<br>dc:"+(k===c?"(N/A)":k)+"<br>n:"+fa.dataModel.length,b._debugDialog&&b._debugDialog.visible&&b.statistics.updateFrame(d)}else f.apply(this,arguments)},b._createData("preUpdate"),b._wrap("physics","preUpdate"),b._wrap("state","preUpdate"),b._wrap("plugins","preUpdate"),b._wrap("stage","preUpdate"),b._createData("update"),b._wrap("state","update"),b._wrap("stage","update"),b._wrap("tweens","update"),b._wrap("sound","update"),b._wrap("input","update"),b._wrap("physics","update"),b._wrap("particles","update"),b._wrap("plugins","update"),b._createData("postUpdate"),b._wrap("stage","postUpdate"),b._wrap("plugins","postUpdate"),b._createData("preRender"),b._wrap("state","preRender"),b._createData("render"),b._wrap("renderer","render"),b._wrap("plugins","render"),b._wrap("state","render"),b._createData("postRender"),b._wrap("plugins","postRender")};Jb.prototype._colors=["#058DC7","#50B432","#ED561B","#DDDF00","#24CBE5","#64E572","#FF9655","#FFF263","#6AF9C4","#2b908f","#90ee7e","#f45b5b","#7798BF","#aaeeee","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],Jb.prototype._createData=function(a,b){var c=new qc.widget.Data;return c.name=a,c.id=b||a,this.dataModel.add(c),c},Jb.prototype._wrap=function(a,b){var c=this,d=c._createData(a,a+"."+b);d.parent=c.dataModel.getDataById(b),d.a("value",0),d.a("label","0.0"),d.hasValue=!0,d.color=this._colors[this._colorIndex++],d.icon="rect-color";var e=c.game.phaser[a],f=e[b];e[b]=function(){if(c._debugDialog&&c._debugDialog.visible){var a=X();f.apply(e,arguments),d.newValue=X()-a}else f.apply(e,arguments)}},Jb.prototype.destroy=function(){this._debugDiv&&r(this._debugDiv),this._debugDialog&&this._debugDialog.hide()},b.defineProperties(Jb.prototype,{debugDiv:{get:function(){var a=this;if(!a._debugDiv){var b=a._debugDiv=fa.scene.createDiv(),c=b.style;c.top="10px",c.right="10px",c.width="50px",c.cursor="pointer",b.onclick=function(){a.debugDialog.visible?a.debugDialog.hide():a.debugDialog.show()}}return a._debugDiv}},debugDialog:{get:function(){if(!this._debugDialog){var a=this.tree=new qc.widget.Tree(this.dataModel);a.getLabel=function(a){return a.hasValue?a.a("label")+" - "+a.name:a.name},a.expandAll();var b=this.statistics=new Kb(this.dataModel),c=new qc.widget.Container;c.layout=new qc.widget.layout.SplitLayout(c),c.layout.orientation="v",c.layout.position=.7,c.setItems([a,b]);var d=this._debugDialog=new qc.editor.Dialog;d.title="Performance Statistics",d.width=260,d.height=300,d.content=c,d.contentPadding=2}return this._debugDialog}}}),k.setImage("rect-color",{width:10,height:10,comps:[{type:"rect",rect:[0,0,10,10],background:{func:function(a){return a.color}}}]});var Kb=m(null,b,function(a){this.dataModel=a,this.initView(!1,!0),this._bufferCanvas=q(),this._div30=this._createDiv("&nbsp;33ms (30fps)"),this._div60=this._createDiv("&nbsp;16ms (60fps)"),this.iv()},{},{properties:["maxValue","frameWidth"],view:!0,emitter:!0});Kb.prototype._maxValue=50,Kb.prototype._frameWidth=1,Kb.prototype._lastWidth=-1,Kb.prototype._lastHeight=-1,Kb.prototype._lastMaxValue=-1,Kb.prototype._lastFrameWidth=-1,Kb.prototype.onPropertyChange=function(){this.iv()},Kb.prototype._createDiv=function(a){var b=p(!1,this.view),c=b.style;return c.position="absolute",c.color="rgba(200, 200, 200, 0.6)",c.background="rgba(200, 200, 200, 0.7)",c.font=k.labelFont,c.left="0px",c.height="1px",c.cursor="default",b.innerHTML=a,b},Kb.prototype.validateImpl=function(){var a=this.clientWidth,b=this.clientHeight;if(a!==this._lastWidth||b!==this._lastHeight||this.maxValue!==this._lastMaxValue||this.frameWidth!==this._lastFrameWidth){this._lastWidth=a,this._lastHeight=b,this._lastMaxValue=this.maxValue,this._lastFrameWidth=this.frameWidth,this._unit=b/this.maxValue,t(this._canvas,a,b),t(this._bufferCanvas,a-this.frameWidth,b),s(this._canvas,0,0,1,{x:0,y:0,width:a,height:b}).restore();var c=Math.round(33*this._unit),d=Math.round(16*this._unit),e=this._div30.style;e.top=b-c+"px",e.width=a+"px",e=this._div60.style,e.top=b-d+"px",e.width=a+"px"}},Kb.prototype.updateFrame=function(a){var b=this,c=b._lastWidth,d=b._lastHeight,e=b.frameWidth,f=c-e,g=b._canvas,h=b._bufferCanvas;s(h,0,0,1,{x:0,y:0,width:f,height:d}).restore();var i=s(h,0,0,1);i.drawImage(g,e,0,f,d,0,0,f,d),i.restore(),i=s(g,0,0,1,{x:0,y:0,width:c,height:d}),i.drawImage(h,0,0);var j=d;b.dataModel.forEach(function(a){var c=a.color;if(c){var d=a.a("value");if(d>0){var g=b._unit*d;i.beginPath(),i.fillStyle=c,i.fillRect(f,j-g,e,g),j-=g}}}),i.beginPath(),i.fillStyle="rgb(0,255,0)",i.fillRect(f,d-b._unit*a.interval,e,1),i.restore()};var Lb=qc.editor.Undo=function(){this.reset()};Lb.prototype={},Lb.prototype.constructor=Lb,Lb.prototype._limit=30,Lb.prototype._checkLimit=function(){for(;this.length>0&&this.length>this.limit;){var a=this._events.splice(0,1)[0];a.destroy&&a.destroy(),this._position>=0&&this._position--}},Lb.prototype.reset=function(){if(this._events)for(var a=0;a<this._events.length;a++){var b=this._events[a];b.destroy&&b.destroy()}this._events=[],this._position=-1},Lb.prototype.canUndo=function(){return this._position>=0;

},Lb.prototype.canRedo=function(){return this._position<this.length-1},Lb.prototype.undo=function(){if(this.canUndo()){var a=this._events[this._position--];this._isUndoRedoing=!0,a.undo(),this._isUndoRedoing=!1}},Lb.prototype.redo=function(){if(this.canRedo()){var a=this._events[++this._position];this._isUndoRedoing=!0,a.redo(),this._isUndoRedoing=!1}},Lb.prototype.clearRedo=function(){for(;this.canRedo();){var a=this._events.splice(this.length-1,1)[0];a.destroy&&a.destroy()}this._position=this.length-1},Lb.prototype.add=function(a,b,c){this._isUndoRedoing||(this.clearRedo(),this._events.push({undo:a,redo:b,destroy:c}),this._position=this.length-1,this._checkLimit())},b.defineProperties(Lb.prototype,{position:{get:function(){return this._position}},length:{get:function(){return this._events.length}},limit:{get:function(){return this._limit},set:function(a){this._limit=a,this._checkLimit()}}});var Mb=qc.editor.Extend=function(){this._menus={},this._inspectors={}};Mb.prototype={},Mb.prototype.constructor=Mb,Mb.prototype.menu=function(a,b){this._menus[a]=b},Mb.prototype.deleteMenu=function(a){delete this._menus[a],fa.menu.deleteItem(a)},Mb.prototype.inspector=function(a,b){this._inspectors[a]=b},Mb.prototype.findInspector=function(a){return this._inspectors[a]},Mb.prototype.init=function(){for(var a in this._menus)fa.menu.addItem(a,this._menus[a])};var Nb=qc.editor.TexturePacker=function(){this.canvas=document.createElement("canvas")};Nb.prototype={},Nb.prototype.constructor=Nb,Nb.prototype.pack=function(a,b,c,d){var e,f,g=this,h=b.length,i=new Array(h);if(!/^\w*$/.test(a))return fa.log.trace("atlas name 不合法，期望字母跟数字组成。"),!1;for(g.option=c||{},g.option.border=g.option.border||1,f=0;h>f;f++){if(e=b[f],!e||!e.img||!e.img.complete)return fa.log.trace("frame {0} 无效，无法进行打包",b[f]),!1;i[f]={w:e.img.width+g.option.border+2,h:e.img.height+g.option.border+2,frame:e}}for(i.sort(g.sortBySize),g.fit(i),f=0;h>f;f++)if(e=i[f],!e.fit)return fa.log.trace("frame {0} 无法被塞入，打包失败",e.frame.url),!1;g.snapAndSave(a,i,d)},Nb.prototype.packAll=function(){var a=this,c={},d=0,e=0;fa.project.exploreTree(function(a){if(!(a.id.indexOf("@atlas")<0)&&a.assetType===fa.ASSET_TYPE.ASSET_ATLAS){var b=a.id;c[b]={url:b}}},fa.fileTree.dataModel._roots[0]);var f=function(){var d,e,f,g={};fa.notification.info(fa._("Images downloaded, Start to pack atlas."));for(var h in c)f=c[h],d=h.match(/([^\\\/]*)@atlas/),!d||d.length<2||(e=d[1],g[e]||(g[e]=[]),g[e].push(f));for(var h in c)fa.hiddenGame.assets.unload("tp@"+h,h);var i=b.keys(g),j=0,k=function(){var b=i[j];a.pack(b,g[b],{pot:!0},function(){return j++,j>=i.length?void fa.notification.info(fa._("All atlases has been packed.")):void k()})};k()};e=b.keys(c).length;for(var g in c)!function(a){fa.hiddenGame.assets.load("tp@"+a,a,function(b){c[a]=b,++d>=e&&f()},!0)}(g);fa.notification.info(fa._("Start to download images, count: ")+e)},Nb.prototype.snapAndSave=function(a,b,c){var d=this,e=d.canvas,f=d.option.border,g=d.root.w-f,h=d.root.h-f;d.option.pot&&(g=d.nextPowerOfTwo(g),h=d.nextPowerOfTwo(h)),e.setAttribute("width",g),e.setAttribute("height",h);var i,j,k,l,m=e.getContext("2d"),n={frames:{},meta:{app:"QCEngine",version:"1.0",image:a,format:"RGBA8888",size:{w:g,h:h},scale:"1"}},o=b.length,p=n.frames;for(i=0;o>i;i++)j=b[i],k=j.w-f-2,l=j.h-f-2,m.drawImage(j.frame.img,0,0,k,1,j.fit.x+1,j.fit.y,k,1),m.drawImage(j.frame.img,0,l-1,k,1,j.fit.x+1,j.fit.y+l+1,k,1),m.drawImage(j.frame.img,0,0,1,l,j.fit.x,j.fit.y+1,1,l),m.drawImage(j.frame.img,k-1,0,1,l,j.fit.x+k+1,j.fit.y+1,1,l),m.drawImage(j.frame.img,j.fit.x+1,j.fit.y+1,k,l),p[sb(fa.project.getImageURLByAtlas(j.frame))]={frame:{x:j.fit.x+1,y:j.fit.y+1,w:k,h:l},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:k,h:l},sourceSize:{w:k,h:l}};var q=e.toDataURL();qc.editor.Operation.SAVE_ATLAS(a,q,n,c),m.clearRect(0,0,g,h),e.setAttribute("width",1),e.setAttribute("height",1)},Nb.prototype.sortBySize=function(a,b){var c,d=Math.max(a.w,a.h),e=Math.max(b.w,b.h);if(c=e-d)return c;var f=Math.min(a.w,a.h),g=Math.min(b.w,b.h);return(c=g-f)?c:(c=b.h-a.h,c?c:b.w-a.w)},Nb.prototype.fit=function(a){var b,c,d=a.length,e=d>0?a[0].w:0,f=d>0?a[0].h:0;this.root={x:0,y:0,w:e,h:f};for(var g=0;d>g;g++)c=a[g],c.fit=(b=this.findNode(this.root,c.w,c.h))?this.spliteNode(b,c.w,c.h):this.growNode(c.w,c.h)},Nb.prototype.findNode=function(a,b,c){if(!a.used)return b<=a.w&&c<=a.h?a:null;var d=a.right,e=a.down,f=this.findNode(d,b,c)||this.findNode(e,b,c);if(f)return f;if(!d.used&&!e.used&&d.x+d.w===e.x+e.w&&d.y+d.h===e.y){var g=d.h,h=e.w;if(d.h=d.h+e.h,e.w=e.w-d.w,f=this.findNode(d,b,c)||this.findNode(e,b,c))return f;d.h=g,e.w=h}},Nb.prototype.spliteNode=function(a,b,c){return a.used=!0,a.down={x:a.x,y:a.y+c,w:a.w,h:a.h-c},a.right={x:a.x+b,y:a.y,w:a.w-b,h:c},a},Nb.prototype.nextPowerOfTwo=function(a){return a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a++,a},Nb.prototype.growNode=function(a,b){var c,d,e=this,f=e.root.h,g=e.root.w,h=f>=b,i=g>=a;if(e.option.pot){var j=e.option.border,k=e.nextPowerOfTwo(g)+j,l=e.nextPowerOfTwo(f)+j,m=g+a,n=f+b;c=h&&(k===l&&(f>=m||n>l&&k>=m)||k>l&&k>=m&&k-g>=l-f||l>k&&(n>l||k-g>=l-f)),d=i&&(k===l&&(g>=n||m>k&&l>=n)||k>l&&(m>k||l-f>=k-g)||l>k&&l>=n&&l-f>=k-g)}else c=h&&f>=g+a,d=i&&g>=f+b;return c?e.growRight(a,b):d?e.growDown(a,b):h?e.growRight(a,b):i?e.growDown(a,b):void 0},Nb.prototype.growRight=function(a,b){var c=this;c.root={used:!0,x:0,y:0,w:c.root.w+a,h:c.root.h,down:c.root,right:{x:c.root.w,y:0,w:a,h:c.root.h}};var d;return(d=c.findNode(c.root,a,b))?c.spliteNode(d,a,b):null},Nb.prototype.growDown=function(a,b){var c=this;c.root={used:!0,x:0,y:0,w:c.root.w,h:c.root.h+b,down:{x:0,y:c.root.h,w:c.root.w,h:b},right:c.root};var d;return(d=c.findNode(c.root,a,b))?c.spliteNode(d,a,b):null};var Ob=m(null,b,function(a){var b=this;b.initView(),b._view.style.background="#1a1d23",b._scene=a,b._interactionDiv.appendChild(a.view),this._hRuler=q(),this._vRuler=q(),b.iv(),fa.e.on(fa.e.GRID_VISIBLE_CHANGE,function(){b.checkEnabled()}),fa.e.on(fa.e.PLAYING_CHANGE,function(){b.checkEnabled()}),a.on("propertyChange",function(){b.iv()})},{},{properties:["enabled","color","guideColor","guideBackground","rulerSize","borderColor"],view:!0,emitter:!0});Ob.prototype._enabled=!1,Ob.prototype._lastEnabled=-1,Ob.prototype._lastWidth=-1,Ob.prototype._lastHeight=-1,Ob.prototype._lastRulerSize=-1,Ob.prototype._color="#caccd8",Ob.prototype._guideColor="#3ae3ff",Ob.prototype._guideBackground="#292a3a",Ob.prototype._borderColor="#656567",Ob.prototype._rulerSize=22,Ob.prototype.onPropertyChange=function(){this.iv()},Ob.prototype.checkEnabled=function(){this.enabled=!fa.playing&&fa.gridVisible?!0:!1},Ob.prototype.validateImpl=function(){var a=this._rulerSize,b=this.clientWidth,c=this.clientHeight,d=this.enabled;if(b!==this._lastWidth||c!==this._lastHeight||a!==this._lastRulerSize||d!==this._lastEnabled)if(this._lastWidth=b,this._lastHeight=c,this._lastRulerSize=a,this._lastEnabled=d,d){this._hRuler.parentNode||(this._interactionDiv.appendChild(this._hRuler),this._interactionDiv.appendChild(this._vRuler));var e=Math.max(0,b-a),f=Math.max(0,c-a);n(this._hRuler,a,0,e,a),n(this._vRuler,0,a,a,f),n(this._scene,a,a,e,f),t(this._hRuler,e,a),t(this._vRuler,a,f)}else this._hRuler.parentNode&&(r(this._hRuler),r(this._vRuler)),n(this._scene,0,0,b,c);this.drawRuler()},Ob.prototype.drawRuler=function(){if(fa.workable&&this.enabled){var a,b,c,d,e,f,g=this._rulerSize,h=this._scene,i=h.zoom,j=Math.log(i)/Math.log(10),k=Math.floor(j),l=100,m=10,n=l*i/Math.pow(10,k),o=n/m,p=k>1?40+10*(k-1):40,q=Math.round(h.translateX),r=Math.round(h.translateY),t={x:-q,y:-r,width:h.view.clientWidth,height:h.view.clientHeight},u=Math.floor(t.x/n),v=Math.ceil((t.x+t.width)/n),w=Math.floor(t.y/n),x=Math.ceil((t.y+t.height)/n);for(s(this._hRuler,0,0,1,{x:0,y:0,width:t.width,height:g}).restore(),d=s(this._hRuler,q,0,1),d.lineWidth=1,d.strokeStyle=this.color,d.beginPath(),a=u;v>=a;a++)e=a*n,f=k>1?(e/i).toFixed(k-1):Math.round(e/i),e=Math.round(e),d.moveTo(e,g),d.lineTo(e,0),S(d,f,null,this.color,e,0,1,g,"left");for(d.stroke(),d.beginPath(),a=u;v>=a;a++)for(c=1;m>c;c++)e=a*n+c*o,f=k>1?(e/i).toFixed(k-1):Math.round(e/i),e=Math.round(e),d.moveTo(e,g),5===c?(d.lineTo(e,g-11),S(d,f,null,this.color,e,0,1,g,"left")):(d.lineTo(e,g-5),o>p&&S(d,f,null,this.color,e,0,1,g,"left"));for(d.stroke(),d.restore(),s(this._vRuler,0,0,1,{x:0,y:0,width:g,height:t.height}).restore(),d=s(this._vRuler,0,r,1),d.lineWidth=1,d.strokeStyle=this.color,d.beginPath(),b=w;x>=b;b++)e=b*n,f=k>1?(e/i).toFixed(k-1):Math.round(e/i),e=Math.round(e),d.moveTo(g,e),d.lineTo(0,e),this.drawVerticalText(d,f,e);for(d.stroke(),d.beginPath(),b=w;x>=b;b++)for(c=1;m>c;c++)e=b*n+c*o,f=k>1?(e/i).toFixed(k-1):Math.round(e/i),e=Math.round(e),d.moveTo(g,e),5===c?(d.lineTo(g-11,e),this.drawVerticalText(d,f,e)):(d.lineTo(g-5,e),o>p&&this.drawVerticalText(d,f,e));d.stroke(),d.restore()}},Ob.prototype.drawVerticalText=function(a,b,c){a.save(),a.translate(11,c+11),a.rotate(-Math.PI/2),S(a,b,null,this.color,11,-11,0,this.rulerSize,"right"),a.restore()};var Pb=m("qc.editor.Notification",null,function(){this._showings=[]});Pb.prototype.easing=function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},Pb.prototype.info=function(){this.show(fa.log.toContent(arguments),"#78C5E7","white",4e3)},Pb.prototype.warn=function(){this.show(fa.log.toContent(arguments),"#FFEDA4","rgb(130, 98, 0)",5e3)},Pb.prototype.error=function(){this.show(fa.log.toContent(arguments),"#FF8181","white",6e3)},Pb.prototype.show=function(a,b,c,d){var e=this,f=e._showings[e._showings.length-1],g=p(),h=g.style;h.font=k.labelFont,h.padding="6px",h.borderRadius="2px",h.position="absolute",h.width="300px",h.background=b,h.color=c,document.body.appendChild(g),g.innerHTML=a;var i=g.clientHeight,j=f?f.bottom+5:5;h.top=j+"px",h.right="-300px",f=g._showing={div:g,bottom:j+i},this._showings.push(f),W({duration:300,easing:e.easing,finishFunc:function(){h.cursor="pointer",g.onclick=function(){e._hide(g)},setTimeout(function(){e._hide(g)},d)},action:function(a){g.style.right=-300+305*a+"px",g.style.opacity=Db(a,0,1)}})},Pb.prototype._hide=function(a){var b=this;a._hide||(a._hide=!0,W({duration:300,finishFunc:function(){var c=b._showings.indexOf(a._showing);b._showings.splice(c,1),r(a)},action:function(b){a.style.right=5+-305*b+"px",a.style.opacity=Db(1-b,0,1)}}))},a.onerror=function(a){Gb(a)};var Qb=m("qc.editor.Preference",null,function(){this.restore()});Qb.prototype.restore=function(){var b=a.localStorage.getItem("QICI Engine");this._data=b?JSON.parse(b):{}},Qb.prototype.query=function(a){return this._data[a]},Qb.prototype.set=function(b,c){this._data[b]=c;var d=JSON.stringify(this._data);a.localStorage.setItem("QICI Engine",d)};var Rb=qc.editor.SceneManager=function(){this._dirty=!1,this._unsaved=!1;var a=this;a._saveSceneInterval=fa.preference.query("saveSceneInterval")||10,console.log("saveSceneInterval",a._saveSceneInterval),this._timer=setInterval(function(){qc.editor.Operation.SAVE_CURR_SCENE()},1e3*a._saveSceneInterval),fa.inspector.propertyView.on(fa.e.INSPECTOR_COMP_VALUE_CHANGE,function(b){if(!fa.prefabInfo&&fa.scene.editable){var c=b.node;(c instanceof qc.Node||c instanceof qc.Behaviour)&&(console.log(fa.e.INSPECTOR_COMP_VALUE_CHANGE,b),a._dirty=!0)}}),fa.inspector.propertyView.on("checkChanged",function(b){fa.prefabInfo||fa.scene.editable&&(console.log("checkChanged",b.source),a._dirty=!0)}),fa.inspector.propertyView.on("remove",function(b){fa.prefabInfo||fa.scene.editable&&(console.log("remove",b.source),a._dirty=!0)}),fa.inspector.propertyView.on("addComponent",function(b){fa.prefabInfo||fa.scene.editable&&(console.log("addComponent",b),a._dirty=!0)})};Rb.prototype={},Rb.prototype.constructor=Rb,b.defineProperties(Rb.prototype,{dirty:{get:function(){return this._dirty},set:function(a){a&&fa.prefabInfo||(!a||fa.scene.editable)&&(this._dirty=a)}},unsaved:{get:function(){return this._unsaved},set:function(a){this._unsaved=a}}}),Rb.prototype.resetTimer=function(a){this._saveSceneInterval!=a&&(clearInterval(this._timer),this._timer=setInterval(function(){qc.editor.Operation.SAVE_CURR_SCENE()},1e3*a))};var Sb=m("qc.editor.HierarchySelectionInteractor",b,function(a){var b=this;b._hierarchy=a,b.addListeners()},{clearFileListSelection:function(){fa.fileList.selectionModel.clearSelection()},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this,c=b._hierarchy;if(b._isOnExpandIcon=null,b._startPoint=null,c.isCloseToVScrollBar(a));else{var d=c.getDataAt(a);d?(b._startPoint=B(a),b._isOnExpandIcon=c.isOnToggleIcon(a)):b.clearFileListSelection()}},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(a){var b=this,c=b._startPoint,d=B(a);!b._isOnExpandIcon&&c&&y(c,d)<2&&b.clearFileListSelection(),b._startPoint=null,b._isOnExpandIcon=null}},{interactor:!0},{view:{get:function(){return this._hierarchy}}}),Tb=m("qc.editor.Hierarchy",na,function(){var a=this;Tb["super"].constructor.call(a),fa.e.on(fa.e.DATA_MODEL_CHANGE,function(b){var c=b.oldValue,d=b.newValue;c&&c.selectionModel.off("selectionChange",a._updateActiveNode,a),d.selectionModel.on("selectionChange",a._updateActiveNode,a),a.dataModel=d,a.rootData=a.dataModel.getDataById(a.game.world.uuid),a.rootVisible=!1,a._updateActiveNode()}),new Sb(a),a._initMenu(),a.toggleOnDoubleClick=!1});b.defineProperties(Tb.prototype,{game:{get:function(){return this.dataModel.game}},activeNode:{get:function(){return this._activeNode},set:function(a){this.selection=a?this.dataModel.getDataById(a.uuid):null}}}),Tb.prototype._updateActiveNode=function(){var a=this.dataModel.lastEditableNode;if(!a){var b=this.dataModel.selectionModel.lastData;b&&(a=b.node)}var c=this._activeNode;c!==a&&(this._activeNode=a,fa.e.emit(fa.e.ACTIVE_NODE_CHANGE,{oldValue:c,newValue:a}))},Tb.prototype.blink=function(a){var b=this;if(b._anim&&(b._anim.finishFunc=function(){b._blinkData.s("blink.background",null),b._anim=null,b._blinkData=null},b._anim.stop()),a){b._blinkData=a;var c=0,d=function(){4>c?(c++,b._anim=W({duration:400,finishFunc:d,action:e})):(a.s("blink.background",null),b._anim=null,b._blinkData=null)},e=function(b){c%2===0&&(b=1-b),a.s("blink.background","rgba(255, 255, 0, "+b+")")};d()}},Tb.prototype.clearHighlight=function(){var a=this,b=a.dataModel;b.datas.forEach(function(a){a.s("blink.background",null)})},Tb.prototype.drawRowBackground=function(a,b,c,d,e,f){var g=this;Tb["super"].drawRowBackground.call(g,a,b,c,d,e,f);var h=b.s("blink.background");h&&(a.beginPath(),k.drawShape(a,"roundRect",{x:c,y:d,width:e,height:f}),a.fillStyle=h,a.fill())},Tb.prototype.getLabelColor=function(a){var b=a.node;return b._bone||!b.worldVisible?"rgb(126,126,126)":b._prefab?"rgb(73,116,190)":Tb["super"].getLabelColor.call(this,a)},Tb.prototype.onDataDoubleClick=function(a){fa.scene.focusData(a,!0)},Tb.prototype.rename=function(a,b){if(b){var c=a.node,d=this.dataModel.createRenameUndoFunc(c);b!=c.name&&(fa.sceneManager.dirty=!0),c.name=b;var e=this.dataModel.createRenameUndoFunc(c);fa.undo.add(d,e)}},Tb.prototype.isVisible=function(a){return fa.prefabInfo&&fa.prefabInfo.visibleMap[a.id]!==c?!1:this.visibleFunc?this.visibleFunc(a):!0};var Ub=m("qc.editor.HierarchyContainer",qc.widget.Container,function ze(){var a=this;ze["super"].constructor.call(a),a.layout=new qc.widget.layout.BorderLayout(a),a.layout.topToggleVisible=!1,a.layout.topResizable=!1,a.layout.leftToggleVisible=!1,a.layout.splitterSize=1,a.layout.topSplitterSize=2;var b=a._ddlType=new va;b.preferredSize={width:30,height:22},b.items=[{label:fa._("Name"),value:"name"},{label:fa._("Type"),value:"type"}],b.value="name",b.onValueChanged=function(){a.resetHierarchyVisibleFunc()};var c=a._txtSearch=new Aa;c.preferredSize={width:100,height:22},c.padding=[2,0,2,22];var d=c.input.style;d.backgroundImage='url("'+fa.assetPath+'magnifying-glass.png")',d.backgroundRepeat="no-repeat",d.backgroundSize="17px 17px",d.backgroundPosition="2px 50%",c.onValueChanged=function(){a.resetHierarchyVisibleFunc()};var e=a._hierarchy=new Tb;e._oldDrawRow=e.drawRow,e._oldValidateModel=e.validateModel,e._oldBuildChildren=e.buildChildren;var f=new qc.widget.Container;f.layout=new qc.widget.layout.TableLayout(f),f.setItems([{height:30,widths:[60,.1],cells:[{fill:"h",vAlign:"middle",element:b},{fill:"h",vAlign:"middle",element:c}]}]),a.setItems([{region:"top",element:f},{region:"center",element:e}])});Ub.prototype.resetHierarchyVisibleFunc=function(){var a=this,b=a._ddlType,d=a._txtSearch,e=a._hierarchy,f=d.value,g=b.value,h=function(a,b){if(f){if("name"===g)return b?fa.prefabInfo&&fa.prefabInfo.visibleMap[a.id]!==c?!1:!0:a.name.toLowerCase().indexOf(f.toLowerCase())>=0;if(b)return fa.prefabInfo&&fa.prefabInfo.visibleMap[a.id]!==c?!1:!0;var d=a.node["class"];return d=d.replace("qc.",""),d.toLowerCase()===f.toLowerCase()}return!0};f?(e.visibleFunc=function(a){if(a.node===fa.game.world)return!1;if(fa.prefabInfo){for(var b=0;a;){if(!h(a,0===b?!1:!0))return!1;b++,a=a.parent}return!0}return h(a)},e.drawRow=qc.widget.List.prototype.drawRow,e.validateModel=qc.widget.List.prototype.validateModel,e.buildChildren=qc.widget.List.prototype.buildChildren,e.ivm(),e.iv()):(e.visibleFunc=c,e.drawRow=e._oldDrawRow,e.validateModel=e._oldValidateModel,e.buildChildren=e._oldBuildChildren,e.ivm(),e.iv())},Tb.prototype.handleCrossDrag=function(a,b,c){(c.view instanceof qc.editor.DraggableButton||c.view===fa.fileList)&&Tb["super"].handleCrossDrag.call(this,a,b,c)},Tb.prototype.handleCrossDrag=function(a,b,c){if("enter"===b){var d,e=c.view;if(e instanceof qc.editor.DraggableButton)d="draggableButton";else if(e===fa.fileList){var f=e.draggingData,g=f.master?f.master:f;if(!g.treeData)return;if(f.name.lastIndexOf(".js")===f.name.length-3)d="js";else{var h=fa.game.assets.find(g.treeData.resUUID);if(!h)return;h.meta.type===fa.ASSET_TYPE.ASSET_PREFAB?d="prefab":h.meta.type===fa.ASSET_TYPE.ASSET_ATLAS&&(d="atlas")}}d&&(Tb["super"].handleCrossDrag.call(this,a,b,c),this._crossDragInfo.crossDataType=d)}else Tb["super"].handleCrossDrag.call(this,a,b,c)},Tb.prototype._dragging=function(a,b){var c=this.rowHeight,d=this.lp(a),e=d.y/c,f=Math.floor(e),g=b.inView,h=b.crossDataType;if(g||"draggableButton"===h||"prefab"===h||"atlas"===h){if(f>this.rowDatas.length-1)b.rowIndex=this.rowDatas.length-1,b.type="down";else{var i=d.y-f*c,j=this.rowDatas[f];b.type=fb(j.node)?.25*c>i?"up":i>.75*c?"down":"parent":.5*c>i?"up":"down",b.rowIndex=f}fa.prefabInfo&&0===b.rowIndex&&"parent"!==b.type&&(b.type="parent"),this.autoScroll(a),this.iv()}else"js"===h&&this.rowDatas.length&&(b.rowIndex=f>this.rowDatas.length-1?this.rowDatas.length-1:f,b.type="parent",this.autoScroll(a),this.iv())},Tb.prototype._endCrossDrag=function(a,b){if(this._crossDragInfo){var c,d,e=b.view,f=this._crossDragInfo.type,g=this.rowDatas[this._crossDragInfo.rowIndex];if(g)if(d=g.node,"parent"===f)c=d.children.length;else{if(c=d.parent.getChildIndex(d),d=d.parent,!fb(d))return;"down"===f&&(c+=1)}else d=this.game.world,c=d.children.length;var h=null;if(e instanceof qc.editor.DraggableButton){var i=b.tip;"EmptyNode"===i?h=fa.menu.createNode(d):"Image"===i?h=fa.menu.createImage(d):"Sprite"===i?h=fa.menu.createSprite(d):"Text"===i?h=fa.menu.createText(d):"Button"===i?h=fa.menu.createButton(d):"Toggle"===i?h=fa.menu.createToggle(d):"ScrollBar"===i?h=fa.menu.createScrollBar(d):"ScrollView"===i?h=fa.menu.createScrollView(d):"Slider"===i?h=fa.menu.createSlider(d):"Dom"===i?h=fa.menu.createDom(d):"ProgressBar"===i?h=fa.menu.createProgressBar(d):"InputField"===i?h=fa.menu.createInputField(d):"Sound"===i?h=fa.menu.createSound(d):"Tilemap"===i&&(h=fa.menu.createTilemap(d))}else{if(e!==fa.fileList)return;var j=e.draggingData,k=j.master||j;if(!k.treeData)return;if(j.name.lastIndexOf(".js")===j.name.length-3){var l=j.treeData.id;return void qc.editor.Operation.SOURCE(l,function(a){var b=a.source,c=b.match(/qc.defineBehaviour[\(\s]*['"](.*)['"]/);c&&(c=c[1],qc._userScripts[c]&&"parent"===f&&d&&d.addScript(c)&&(fa.inspector.propertyView.emit("addComponent",c),fa.notification.info(fa._("Script added."))))})}var m=fa.game.assets.find(k.treeData.resUUID);if(!m)return;if(m.meta.type===fa.ASSET_TYPE.ASSET_PREFAB){if(m.hasUnloadedDependence(fa.game))return void fa.notification.warn(fa._("Asset is not loaded, please try later."));h=this.game.add.clone(m,d)}else m.meta.type===fa.ASSET_TYPE.ASSET_ATLAS&&(h=fa.menu.createImage(d),h.texture=m,j.master&&(h.frame=j.name))}h&&(d.setChildIndex(h,c),fa.dataModel.addNodeForUndo(h),fa.hierarchy.activeNode=h)}},Tb.prototype._endDrag=function(a,b){var c=b.rowIndex,d=b.type,e=this.rowDatas[c];if(e){var f=e.node;if("parent"===d){if(!fb(f))return}else if(!fb(f.parent))return;var g=[],h=[];this.isSelected(this.draggingData)?this.topRowOrderSelection.forEach(function(a){this._dropData(d,a,e,g,h)},this):this._dropData(d,this.draggingData,e,g,h);var i=g.length;if(i){var j=this.dataModel,k=function(){for(var a=i-1;a>=0;a--)j.restoreParentInfo(g[a])},l=function(){for(var a=0;i>a;a++)j.restoreParentInfo(h[a])};fa.undo.add(k,l)}}},Tb.prototype._dropData=function(a,b,c,d,e){var f,g,h=this.dataModel,i=b.node,j=c.node;if(eb(i,!1,!0)){if("parent"===a)try{f=h.createParentInfo(i),i.switchParent(j),g=h.createParentInfo(i),this.expand(c)}catch(k){console.error("不合法的父子切换：",k),Gb(k.message)}else if(j!==this.game.world){var l=c.parent.node;try{f=h.createParentInfo(i),i.parent!==l&&i.switchParent(l);var m=l.getChildIndex(j),n=l.getChildIndex(i);"down"===a&&m++,m>n&&m--,l.setChildIndex(i,m),g=h.createParentInfo(i)}catch(k){console.error("不合法的父子切换：",k),Gb(k.message)}}f&&g&&(d.push(f),e.push(g))}},Tb.prototype._initMenu=function(){var a=this,b=new qc.editor.ContextMenu([{label:fa._("Cut"),func:"handleCut",disabled:function(){if(0===a.selection.length)return!0;if(fa.prefabInfo&&a.activeNode)for(var b=a.selectionModel.selection,c=0;c<b.length;c++){var d=b[c];if(d.id===fa.prefabInfo.prefab.uuid)return!0}}},{label:fa._("Copy"),func:"handleCopy",disabled:function(){if(0===a.selection.length)return!0;if(fa.prefabInfo&&a.activeNode)for(var b=a.selectionModel.selection,c=0;c<b.length;c++){var d=b[c];if(d.id===fa.prefabInfo.prefab.uuid)return!0}}},{label:fa._("Paste"),func:"handlePaste"},{type:"-"},{label:fa._("Create"),items:[{label:fa._("Empty Node"),func:function(){fa.menu.createNode()}},{label:fa._("Image"),func:function(){fa.menu.createImage()}},{label:fa._("Sprite"),func:function(){fa.menu.createSprite()}},{label:fa._("Text"),func:function(){fa.menu.createText()}},{label:fa._("Button"),func:function(){fa.menu.createButton()}},{label:fa._("Toggle"),func:function(){fa.menu.createToggle()}},{label:fa._("ScrollBar"),func:function(){fa.menu.createScrollBar()}},{label:fa._("ScrollView"),func:function(){fa.menu.createScrollView()}},{label:fa._("ProgressBar"),func:function(){fa.menu.createProgressBar()}},{label:fa._("Slider"),func:function(){fa.menu.createSlider()}},{label:fa._("Input Field"),func:function(){fa.menu.createInputField()}},{label:fa._("Sound"),func:function(){fa.menu.createSound()}},{label:fa._("Dom"),func:function(){fa.menu.createDom()}},{label:fa._("Graphics"),func:function(){fa.menu.createGraphics()}},{label:fa._("Tilemap"),func:function(){fa.menu.createTilemap()}}]},{label:fa._("Duplicate"),func:"handleDuplicate",disabled:function(){if(0===a.selection.length)return!0;if(fa.prefabInfo&&a.activeNode)for(var b=a.selectionModel.selection,c=0;c<b.length;c++){var d=b[c];if(d.id===fa.prefabInfo.prefab.uuid)return!0}}},{label:fa._("Delete"),func:"handleDelete",disabled:function(){if(0===a.selection.length)return!0;if(fa.prefabInfo&&a.activeNode)for(var b=a.selectionModel.selection,c=0;c<b.length;c++){var d=b[c];if(d.id===fa.prefabInfo.prefab.uuid)return!0}}},{label:fa._("Rename"),func:"handleRename",disabled:function(){return 1!==a.selection.length}},{type:"-"},{label:fa._("Expand"),func:"handleExpand"},{label:fa._("Collapse"),func:"handleCollapse"},{label:fa._("Show Retainers"),func:"showRetainers"}]);b.on("action",function(b){b.item.func&&("function"==typeof b.item.func?b.item.func():a[b.item.func](b))}),b.addTo(a)},Tb.prototype.handleExpand=function(){var a=this.selectionModel.lastData;this.expandAll(a)},Tb.prototype.handleCollapse=function(){var a=this.selectionModel.lastData;this.collapseAll(a)},Tb.prototype.handleCopy=function(){var a=this.dataModel.getTopEditableSelection(null,!1,!0),b=[];return a.forEach(function(a){var c={},d=fa.game.serializer.buildBundle(a.node,c);d.dependences=fa.game.serializer.combineDependence(c),b.push(d)}),b.length&&(fa.clipboard.data=b,fa.clipboard.type="node"),a},Tb.prototype.handlePaste=function(){if("node"===fa.clipboard.type){var a=[],b=fa.hierarchy.activeNode?fa.hierarchy.activeNode.parent:null;fa.clipboard.data.forEach(function(c){var d=fa.game.serializer.restoreBundle(c,b);a.push(this.dataModel.getDataById(d.uuid))},this),this.selection=a,this.dataModel.addDatasForUndo(a)}},Tb.prototype.handleDuplicate=function(){var a=[];this.dataModel.getTopEditableSelection(null,!1,!0).forEach(function(b){var c=b.node;c=fa.game.add.clone(c,c.parent),a.push(this.dataModel.getDataById(c.uuid))},this),this.selection=a,this.dataModel.addDatasForUndo(a)},Tb.prototype.handleRename=function(){var a=this.selectionModel.lastData;a&&this.beginEditing(a)},Tb.prototype.handleCut=function(){var a=this.handleCopy();this.dataModel.deleteDatasForUndo(a)},Tb.prototype.handleDelete=function(){var a=this.dataModel,b=a.getTopEditableSelection(null,!1,!0),c=b.length;if(0!==c){if(fa.prefabInfo)for(var d=0;d<b.length;d++){var e=b[d];if(e.node.uuid===fa.prefabInfo.prefab.uuid)return void fa.notification.info(fa._("Prefab cannot be removed"))}kb(fa._("Sure to remove this node?"),fa._("Warning"),function(){a.deleteDatasForUndo(b)},null,{icon:"alert"})}},Tb.prototype.showRetainers=function(){var a=this.selectionModel.lastData;if(a){var b=a.node,c=[],d=function(a){for(var e=a.children,f=0;f<e.length;f++){var g=e[f],h=g.getMeta();for(var i in h)18===h[i]&&g[i]===b?c.push({node:g,property:i}):19===h[i]&&g[i]&&g[i].indexOf(b)>=0&&c.push({node:g,property:i});for(var j=g.scripts,k=0;k<j.length;k++){var l=j[k];h=l.getMeta();for(var i in h)18===h[i]&&l[i]===b?c.push({node:g,script:l,property:i}):19===h[i]&&l[i]&&l[i].indexOf(b)>=0&&c.push({node:g,script:l,property:i})}d(g)}},e=fa.game.world;d(e),fa.inspector.propertyView.inspect(b,"Panel:ReferencePanel",c)}};var Vb=m("qc.editor.Scene",b,function(){var a=this;a.initView(),a._view.style.background="#272727",a._view._dropView=a,a._activable=!0;var b=a._iframe=document.createElement("iframe");k.setBorder(b,null,0),b.style.position="absolute",b.style.width="100%",b.style.height="100%",a._interactionDiv.appendChild(b),a._editorCanvas=q(),a._interactionDiv.appendChild(a._editorCanvas),a._interactionState={},fa.e.on(fa.e.EDIT_MODE_CHANGE,function(b){a.editMode=b.newValue}),fa.e.on(fa.e.EDITOR_HITAREA_ENABLED_CHANGE,function(b){a.editHitAreaEnabled=b.newValue}),fa.e.on(fa.e.DATA_MODEL_CHANGE,function(b){a.dataModel=b.newValue}),fa.e.on(fa.e.GAME_SIZE_CHANGE,this._handleGameSizeAndOrientationChange,a),fa.e.on(fa.e.ORIENTATION_CHANGE,this._handleGameSizeAndOrientationChange,a),fa.e.on(fa.e.GRID_VISIBLE_CHANGE,function(){a.iv()}),fa.e.on(fa.e.PLAYING_CHANGE,function(a){a.newValue?fa.workable?qc.editor.Operation.SAVE_CURR_SCENE(function(){fa.scene.editable=!1,fa.playing&&fa.scene.play("StartGame.html")}):fa.scene.play("StartGame.html"):(fa.scene.editable=!0,fa.scene.play("StartScene.html"))})},{},{properties:["editParentEnabled","editRotationEnabled","editScaleEnabled","editPivotEnabled","editCornerEnabled","editEdgeEnabled","editMoveEnabled","editRectTransformEnabled","editHitAreaEnabled"],view:!0,emitter:!0});Vb.prototype._debugEnabled=!1,Vb.prototype.handleCrossDrag=function(a,b,c){var d=c.view,e=function(a){if(fa.prefabInfo)return fa.dataModel.getDataById(fa.prefabInfo.prefab.uuid).node;if(!a)return fa.game.world;for(var b,c=fa.dataModel.datas,d=0;d<c.length;d++)if(b=c[d].node,b instanceof qc.UIRoot)return b;return new qc.UIRoot(fa.game)};if("enter"===b||"over"===b);else if("drop"===b){if(d instanceof qc.editor.DraggableButton){var f,g=c.tip;"EmptyNode"===g?f=fa.menu.createNode(e()):"Image"===g?f=fa.menu.createImage(e(!0)):"Sprite"===g?f=fa.menu.createSprite(e()):"Text"===g?f=fa.menu.createText(e(!0)):"Button"===g?f=fa.menu.createButton(e(!0)):"Toggle"===g?f=fa.menu.createToggle(e(!0)):"ScrollBar"===g?f=fa.menu.createScrollBar(e(!0)):"ScrollView"===g?f=fa.menu.createScrollView(e(!0)):"Slider"===g?f=fa.menu.createSlider(e(!0)):"Dom"===g?f=fa.menu.createDom(e()):"ProgressBar"===g?f=fa.menu.createProgressBar(e(!0)):"InputField"===g?f=fa.menu.createInputField(e(!0)):"Sound"===g?f=fa.menu.createSound(e()):"Tilemap"===g&&(f=fa.menu.createTilemap(e()))}else{if(d!==fa.fileList)return;var h=d.draggingData,i=h.master||h;if(!i.treeData)return;var j=fa.game.assets.find(i.treeData.resUUID);if(!j)return;j.meta.type===fa.ASSET_TYPE.ASSET_ATLAS&&(f=fa.menu.createImage(e(!0)),f.texture=j,h.master&&(f.frame=h.name))}if(f){var k=f.parent.getScript("qc.ScaleAdapter");k&&k.preUpdate();var l=fa.scene.interactors[0].toGlobal(a);l=f.parent.toLocal(l),f.anchoredX=l.x,f.anchoredY=l.y,fa.dataModel.addNodeForUndo(f),fa.hierarchy.activeNode=f}}},Vb.prototype._handleGameSizeAndOrientationChange=function(){var a;if(fa.gameSize){var b=Math.min(fa.gameSize.width,fa.gameSize.height),c=Math.max(fa.gameSize.width,fa.gameSize.height);a="Portrait"===fa.orientation?{width:b,height:c}:{width:c,height:b}}this.gameSize=a},Vb.prototype.setTranslate=function(a,b,c){if(fa.workable){var d=this;if(c=V(c)){d._translateAnim&&d._translateAnim.stop(!0);var e=d.translateX,f=d.translateY;c.action=function(c){d.setTranslate(e+(a-e)*c,f+(b-f)*c)},c.innerFunc=function(){delete d._translateAnim},d._translateAnim=W(c)}else d.translateX=a,d.translateY=b}},Vb.prototype.play=function(a){fa.windowDisabled=!0,this._iframe.src=a},Vb.prototype.reload=function(){fa.shutdown(),this.play(this._iframe.src)},Vb.prototype.handleDelete=function(){fa.hierarchy.handleDelete()},Vb.prototype.handleCut=function(){fa.hierarchy.handleCut()},Vb.prototype.handleCopy=function(){fa.hierarchy.handleCopy()},Vb.prototype.handlePaste=function(){fa.hierarchy.handlePaste()},Vb.prototype.handleDuplicate=function(){fa.hierarchy.handleDuplicate()},Vb.prototype.reset=function(a){var b=this;b.editable&&fa.workable&&(a?b.setZoom(1,{finishFunc:function(){b.setTranslate(0,0,a)}}):(b.setZoom(1),b.setTranslate(0,0)))},Vb.prototype.fitContent=function(a){var b=this;if(b.editable&&fa.workable){var c=b.game.world.rect,d=c.x+c.width/2,e=c.y+c.height/2,f=b.clientWidth,g=b.clientHeight,h=Math.min(f/(c.width+4),g/(c.height+4)),i=-d*b.zoom+f/2,j=-e*b.zoom+g/2;a?b.setTranslate(i,j,{finishFunc:function(){b.setZoom(h,a)}}):(b.setTranslate(i,j),b.setZoom(h))}},Vb.prototype.focusData=function(a,b){var c=this;if(c.editable&&fa.workable){var d=c.game.world,e=ob(a.node);e[0]=d.toLocal(e[0]),e[1]=d.toLocal(e[1]),e[2]=d.toLocal(e[2]),e[3]=d.toLocal(e[3]);var f=u(e);f.width||(f.width=50),f.height||(f.height=50);var g=f.x+f.width/2,h=f.y+f.height/2,i=c.clientWidth,j=c.clientHeight,k=Math.min(i/(2.5*f.width),j/(2.5*f.height)),l=-g*c.zoom+i/2,m=-h*c.zoom+j/2;b?c.setTranslate(l,m,{finishFunc:function(){c.setZoom(k,b)}}):(c.setTranslate(l,m),c.setZoom(k))}},Vb.prototype.validateImpl=function(){if(fa.workable){var a=this.game.phaser.scale,b=this.clientWidth,c=this.clientHeight;if((this._lastClientWidth!==b||this._lastClientHeight!==c)&&(this._lastClientWidth=b,this._lastClientHeight=c,this.editable||this._resetPlayScaleMode(),this.game.updateScale()),this.editable){var d=this._editorCanvas;(b!==d.clientWidth||c!==d.clientHeight)&&(t(d,b,c),this._resetEditScaleMode());var e=s(d,0,0,1,{x:0,y:0,width:b,height:c});e.restore(),e=s(d,a.margin.left,a.margin.top,a.scaleFactorInversed.x),this.interactors&&this.interactors.forEach(function(a){a.draw(e)}),e.restore()}}},Vb.prototype.createDiv=function(){var a=p(),b=a.style;return b.color="white",b.background="rgba(0,0,0,0.3)",b.font=k.labelFont,b.padding="6px",b.borderRadius="4px",
b.position="absolute",this._interactionDiv.appendChild(a),a},b.defineProperties(Vb.prototype,{dataModel:{get:function(){return this._dataModel},set:function(a){var b=this;if(!(a instanceof Ib))throw Error("dataModel对象必须是qc.editor.GameModel类型");b._dataModel&&b._dataModel.selectionModel.off("selectionChange",b.updateEditorCanvas,b),b._dataModel=a,a.selectionModel.on("selectionChange",b.updateEditorCanvas,b),b.editable=b.editable,b.gameSize=b.gameSize,b.debugEnabled=b.debugEnabled}},selectionModel:{get:function(){return this.dataModel.selectionModel}},game:{get:function(){return this.dataModel?this.dataModel.game:null}},gameSize:{get:function(){return this._gameSize},set:function(a){var b=this._gameSize;if(this._gameSize=a,fa.workable&&!this._editable&&this._resetPlayScaleMode(),this.epc("gameSize",b,a),fa.workable&&this._editable){var d=this.game.world;d._editorWidth=a?a.width:c,d._editorHeight=a?a.height:c,d.relayout()}}},translateX:{get:function(){return-this.game.camera.x},set:function(a){if(this.editable&&fa.workable){var b=this.translateX;this.game.camera.x=-a,this.game.world.x=a,this.epc("translateX",b,a)}}},translateY:{get:function(){return-this.game.camera.y},set:function(a){if(this.editable&&fa.workable){var b=this.translateY;this.game.camera.y=-a,this.game.world.y=a,this.epc("translateY",b,a)}}},debugEnabled:{get:function(){return this._debugEnabled},set:function(a){this._debugEnabled=a;var b=fa.gameDebugger;b&&(a?b.debugDiv.parentNode||this._interactionDiv.appendChild(b.debugDiv):(b.debugDiv.parentNode&&r(b.debugDiv),b._debugDialog&&b._debugDialog.hide()))}}}),Vb.prototype._editable=!0,Vb.prototype._editParentEnabled=!0,Vb.prototype._editRotationEnabled=!0,Vb.prototype._editScaleEnabled=!0,Vb.prototype._editPivotEnabled=!0,Vb.prototype._editCornerEnabled=!0,Vb.prototype._editEdgeEnabled=!0,Vb.prototype._editMoveEnabled=!0,Vb.prototype._editRectTransformEnabled=!0,Vb.prototype._editHitAreaEnabled=!1,Vb.prototype._editSelectionEnabled=!0,Vb.prototype._resetEditScaleMode=function(){var a=this.game.phaser.scale;a.scaleMode=Phaser.ScaleManager.NO_SCALE;var b=this.clientWidth||1,c=this.clientHeight||1;a.setGameSize(b,c);var d=this.game.camera;d.bounds.setTo(-(1/0),-(1/0),1/0,1/0),d.view.width=b/this.zoom,d.view.height=c/this.zoom},Vb.prototype._resetPlayScaleMode=function(){var a=this.game.phaser.scale;a.scaleMode=Phaser.ScaleManager.SHOW_ALL;var b=this.gameSize,c=this.clientWidth||1,d=this.clientHeight||1,e=b?b.width:c,f=b?b.height:d,g=e/f;c/d>g?a.setGameSize(d*g,d):a.setGameSize(c,c/g)},b.defineProperties(Vb.prototype,{interactors:{get:function(){return this._interactors},set:function(a){var b=this._interactors;b&&b.forEach(function(a){a.tearDown()}),this._interactors=a,a&&a.forEach(function(a){a.setUp()})}},editable:{get:function(){return this._editable},set:function(a){var b=this,c=b.game;if(fa.workable){var d=c.phaser.scale;this.dataModel.selectionModel.clearSelection(),b.translateX=0,b.translateY=0,b.zoom=1,d.pageAlignHorizontally=!0,d.pageAlignVertically=!0,d.minWidth=null,d.minHeight=null,d.maxWidth=null,d.maxHeight=null,a?(b._resetEditScaleMode(),c.canvas.style.position="absolute",c.canvas.style.margin=0,c.input.enable=!1,this.interactors=[new $b(b),new _b(b),new Yb(b),new Zb(b),new Xb(b)],b._editorCanvas.style.display="block"):(b._resetPlayScaleMode(),c.input.enable=!0,b.interactors=null,b._editorCanvas.style.display="none")}var e=b._editable;b._editable=a,b.epc("editable",e,a),b.updateEditorCanvas()}},editMode:{get:function(){return this._editMode},set:function(a){fa.editHitAreaEnabled=!1,this._editMode=a,this.editParentEnabled=!1,this.editRotationEnabled=!1,this.editScaleEnabled=!1,this.editPivotEnabled=!1,this.editCornerEnabled=!1,this.editEdgeEnabled=!1,this.editMoveEnabled=!1,this.editRectTransformEnabled=!1,this.editSelectionEnabled=!1,"pan"===a||("default"===a?(this.editRotationEnabled=!0,this.editPivotEnabled=!0,this.editMoveEnabled=!0,this.editSelectionEnabled=!0):"scale"===a?(this.editParentEnabled=!0,this.editScaleEnabled=!0,this.editPivotEnabled=!0,this.editMoveEnabled=!0,this.editSelectionEnabled=!0):"rectTransform"===a&&(this.editCornerEnabled=!0,this.editEdgeEnabled=!0,this.editRectTransformEnabled=!0,this.editSelectionEnabled=!0))}}}),Vb.prototype._zoom=1,Vb.prototype._minZoom=1e-5,Vb.prototype._maxZoom=1e8,Vb.prototype.scrollZoomIn=function(a){this._setZoomImpl(1.05*this.zoom,a)},Vb.prototype.scrollZoomOut=function(a){this._setZoomImpl(this.zoom/1.05,a)},Vb.prototype.pinchZoomIn=function(a){this._setZoomImpl(1.08*this.zoom,a)},Vb.prototype.pinchZoomOut=function(a){this._setZoomImpl(this.zoom/1.08,a)},Vb.prototype.adjustZoom=function(a){return a<this.minZoom?this.minZoom:a>this.maxZoom?this.maxZoom:a},Vb.prototype.setZoom=function(a,b,c){var d=this;if(d.editable&&fa.workable)if(b=V(b)){d._zoomAnim&&d._zoomAnim.stop(!0);var e=d.zoom;b.action=function(b){d._setZoomImpl(e+(a-e)*b,c)},b.innerFunc=function(){delete d._zoomAnim},d._zoomAnim=W(b)}else d._setZoomImpl(a,c)},Vb.prototype._setZoomImpl=function(a,b){var c=this;if(c.editable&&fa.workable){var d=c.zoom;if(a=c.adjustZoom(a),a!==d&&0!==a&&!isNaN(a)){b&&(b=c.game.world.toLocal(b));var e=c.zoom,f=c.game.camera.view,g={x:f.x/e,y:f.y/e,width:f.width,height:f.height};b=b?b:{x:g.x+g.width/2,y:g.y+g.height/2},c.translateX=(b.x-g.x)*d-b.x*a,c.translateY=(b.y-g.y)*d-b.y*a,c.game.world.scaleX=a,c.game.world.scaleY=a,c._resetEditScaleMode(),c.epc("zoom",d,a)}}},b.defineProperties(Vb.prototype,{zoom:{get:function(){return this.game.world.scaleX},set:function(a){this._setZoomImpl(a)}},maxZoom:{get:function(){return this._maxZoom},set:function(a){var b=this._maxZoom;this._maxZoom=a,this.epc("maxZoom",b,a),this._setZoomImpl(a)}},minZoom:{get:function(){return this._minZoom},set:function(a){var b=this._minZoom;this._minZoom=a,this.epc("minZoom",b,a),this._setZoomImpl(a)}}}),Vb.prototype.onPropertyChange=function(){this.updateEditorCanvas()},Vb.prototype.updateEditorCanvas=function(){this.editable&&this.iv()},Vb.prototype.checkForUpdate=function(){if(this.editable){var a=this.dataModel.selectionModel.selection,b=a.length;if(b>30)this.iv();else{for(var c=this._checkCurrentEditNode(),d=0;b>d;d++){var e=a[d],f=e.node,g=e.cache,h=f.phaser.worldTransform;c||(g.a!==h.a||g.b!==h.b||g.c!==h.c||g.d!==h.d||g.tx!==h.tx||g.ty!==h.ty||g.width!==f.width||g.height!==f.height||g.pivotX!==f.pivotX||g.pivotY!==f.pivotY)&&(c=!0),c&&(g.a=h.a,g.b=h.b,g.c=h.c,g.d=h.d,g.tx=h.tx,g.ty=h.ty,g.width=f.width,g.height=f.height,g.pivotX=f.pivotX,g.pivotY=f.pivotY)}c&&this.iv()}this.validate()}},Vb.prototype._checkCurrentEditNode=function(){var a=!1,b=fa.currentEditNode;if(!b)return a;var c=this.dataModel.getDataById(b.uuid);if(!c)return a;var d=c.cache;if(a||(d.minAnchorX!==b.minAnchor.x||d.minAnchorY!==b.minAnchor.y||d.maxAnchorX!==b.maxAnchor.x||d.maxAnchorY!==b.maxAnchor.y)&&(a=!0),a&&(d.minAnchorX=b.minAnchor.x,d.minAnchorY=b.minAnchor.y,d.maxAnchorX=b.maxAnchor.x,d.maxAnchorY=b.maxAnchor.y),fa.editHitAreaEnabled){var e=d.hitArea,f=b.hitArea;a||(!e&&f?a=!0:e&&!f?a=!0:e&&f&&(e.x!==f.x||e.y!==f.y||e.width!==f.width||e.height!==f.height||e["class"]!==f["class"])&&(a=!0)),a&&(d.hitArea=f?{x:f.x,y:f.y,width:f.width,height:f.height,"class":f["class"]}:null)}return a};var Wb=m(null,b,function(a){this._scene=a},{draw:function(){},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},toData:function(a){return a?this.dataModel.getDataById(a.uuid):null}},{interactor:!0},{view:{get:function(){return this.scene._interactionDiv}},game:{get:function(){return this.scene.game}},dataModel:{get:function(){return this.scene.dataModel}},selectionModel:{get:function(){return this.dataModel.selectionModel}},scene:{get:function(){return this._scene}},interactionState:{get:function(){return this.scene._interactionState}}});Wb.prototype.toGlobal=function(a){var b,c,d=this.game.phaser.scale.scaleFactor,e=this.view.getBoundingClientRect();return 2===arguments.length?(b=arguments[0],c=arguments[1]):(a=this._checkTouch(a),b=a.clientX,c=a.clientY),{x:(b-e.left)*d.x,y:(c-e.top)*d.y}},Wb.prototype._iterateChildren=function(a,b){b.visible&&!b._bone&&(b instanceof qc.UIRoot||a.push(b),b.children.forEach(function(b){this._iterateChildren(a,b)},this))},Wb.prototype.getNodeAt=function(a){var b=this,c=this.toGlobal(a),d=[];this.game.world.children.forEach(function(a){b._iterateChildren(d,a)});for(var e=d.length-1;e>=0;e--){var f=d[e],g=f.toLocal(c),h=f.width*-f.pivotX,i=f.height*-f.pivotY,j=f.width,k=f.height;0>j&&(j=-j,h-=j),0>k&&(k=-k,i-=k);var l=new Phaser.Rectangle(h,i,j,k);if(l.contains(g.x,g.y))return f}return null},Wb.prototype._checkTouch=function(a){if(!this._isMouseEvent(a)){var b=a.touches[0];if(b)return b;if(b=a.changedTouches,b&&b[0])return b[0]}return a},Wb.prototype._isMouseEvent=function(a){return a instanceof MouseEvent||0===a.type.indexOf("mouse")};var Xb=m(null,Wb,function(a){Xb["super"].constructor.call(this,a)},{handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){a.preventDefault(),this.scene.requestFocus(),M(a)>1||this.interactionState.editing||this.scene.editSelectionEnabled&&this.getNodeAt(a)||N(a)&&!P(a)&&(this.translateX=this.scene.translateX,this.translateY=this.scene.translateY,this.lastGlobalPoint=this.toGlobal(a),z(this,a))},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(){this.interactionState.panning&&delete this.interactionState.panning,this.translateX=this.translateY=this.lastGlobalPoint=null},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){this.interactionState.panning=!0;var b=this.toGlobal(a);this.scene.setTranslate(this.translateX+b.x-this.lastGlobalPoint.x,this.translateY+b.y-this.lastGlobalPoint.y)},handle_mousewheel:function(a){this.handleScroll(a,a.wheelDelta)},handle_DOMMouseScroll:function(a){2===a.axis&&this.handleScroll(a,-a.detail)},handleScroll:function(a,b){a.preventDefault(),b>0?this.scene.scrollZoomIn(this.toGlobal(a)):0>b&&this.scene.scrollZoomOut(this.toGlobal(a))},handle_keydown:function(a){if(Y(a),D(a))this.selectionModel.selectAll();else if(E(a))fa.hierarchy.handleDelete();else if(!this.dataModel.hasLockedSelection()&&(J(a)||K(a)||H(a)||I(a))){var b=0,c=0;H(a)?b=-1:I(a)?b=1:J(a)?c=-1:K(a)&&(c=1),this.dataModel.moveSelection(b,c)}}}),Yb=m(null,Wb,function(a){Yb["super"].constructor.call(this,a)},{clearFileListSelection:function(){fa.fileList.selectionModel.clearSelection()},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this;if(delete b.downPoint,this.scene.editSelectionEnabled&&!(M(a)>1||b.interactionState.editing)){b.clearFileListSelection();var c=b.selectionModel,d=b.getNodeAt(a),e=b.toData(d);e?(fa.editHitAreaEnabled=!1,P(a)?c.isSelected(e)?c.removeSelection(e):c.appendSelection(e):c.isSelected(e)||(c.selection=e)):P(a)?N(a)&&(P(a)||c.clearSelection(),b.interactionState.selecting=!0,b.startGlobalPoint=b.toGlobal(a),z(b,a)):b.downPoint=B(a)}},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(a){this.downPoint&&(y(this.downPoint,B(a))<=1&&(this.selectionModel.clearSelection(),fa.editHitAreaEnabled=!1),delete this.downPoint)},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(){this.downPoint=null,this.startGlobalPoint&&(this.mask&&r(this.mask),this.startGlobalPoint=this.mask=this.oldSelection=null,delete this.interactionState.selecting)},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=this;b.mask||(b.oldSelection=b.selectionModel.selection.slice(),b.mask=p(!1,b.view),b.mask.style.border="rgba(255,255,255,0.7) solid 1px",b.mask.style.background="rgba(200,200,255,0.3)");var c=u(b.startGlobalPoint,b.toGlobal(a));n(b.mask,c);var d={};b.dataModel.forEach(function(a){pb(a.node,c)&&(d[a.uuid]=a)});var e=[];b.oldSelection.forEach(function(a){d[a.uuid]?delete d[a.uuid]:e.push(a)});for(var f in d)e.push(d[f]);b.selectionModel.selection=e}}),Zb=m(null,Wb,function(a){Zb["super"].constructor.call(this,a)},{handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){if(!(M(a)>1||!N(a)||this.interactionState.editing)){var b=this.getNodeAt(a);b&&(this.lastGlobalPoint=this.toGlobal(a),z(this,a))}},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(){this.undo&&fa.undo.add(this.undo,this.dataModel.createMoveUndoFunc()),this.undo=this.interactionState.moving=this.lastGlobalPoint=this.globalPoint=null,this.scene.updateEditorCanvas()},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){if(!this.dataModel.hasLockedSelection()){var b=this.toGlobal(a),c=b.x-this.lastGlobalPoint.x,d=b.y-this.lastGlobalPoint.y;if((!this.interactionState.moving||"pending"===this.interactionState.moving)&&Math.abs(c)<=2&&Math.abs(d)<=2)return void(this.interactionState.moving="pending");this.interactionState.moving=!0,this.undo||(this.undo=this.dataModel.createMoveUndoFunc()),this.dataModel.moveSelection(c,d),this.lastGlobalPoint=b}}}),$b=m(null,Wb,function(a){$b["super"].constructor.call(this,a)},{handle_touchstart:function(a){if(2===M(a)){a.preventDefault(),z(this,a);var b={x:a.touches[0].clientX,y:a.touches[0].clientY},c={x:a.touches[1].clientX,y:a.touches[1].clientY};this.lastDistance=y(b,c)}},handleWindowTouchEnd:function(){self.lastDistance=null},handleWindowTouchMove:function(a){if(2===M(a)){var b={x:event.touches[0].clientX,y:event.touches[0].clientY},c={x:event.touches[1].clientX,y:event.touches[1].clientY},d=y(b,c),e=this.toGlobal((b.x+c.x)/2,(b.y+c.y)/2);this.lastDistance<d?this.scene.pinchZoomIn(e):this.scene.pinchZoomOut(e),this.lastDistance=d}}}),_b=m(null,Wb,function(a){_b["super"].constructor.call(this,a)},{RESIZE_TYPE_MAP:{resize:!0,left:!0,top:!0,bottom:!0,right:!0},ANCHOR_TYPE_MAP:{A0:!0,A1:!0,A2:!0,A3:!0,A:!0},handle_mousemove:function(a){this.handle_touchmove(a)},handle_touchmove:function(a){!A()&&N(a)&&this.checkEdit(a)},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){N(a)&&this.checkEdit(a)&&(z(this,a),this.isDragging=!0)},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(){var a=this.dataModel,b=this.editInfo;if(b){var c,d=b.type,e=b.node,f=b.undo;if(f)this.RESIZE_TYPE_MAP[d]?c=a.createResizeUndoFunc(e):this.ANCHOR_TYPE_MAP[d]?c=a.createAnchorUndoFunc(e):"move"===d||"axisX"===d||"axisY"===d?c=a.createMoveUndoFunc(e):"pivot"===d?c=a.createPivotUndoFunc(e):"rotation"===d?c=a.createRotationUndoFunc(e):("scaleX"===d||"scaleY"===d)&&(c=a.createScaleUndoFunc(e)),c&&fa.undo.add(f,c);else if("parent"===d){var g=b.targetNode;if(fb(g))try{f=a.createParentUndoFunc(e),b.node.switchParent(g),c=a.createParentUndoFunc(e),fa.undo.add(f,c),this.selectionModel.clearSelection(),this.selectionModel.selection=this.toData(b.node)}catch(h){console.error("不合法的父子切换：{0}",h),Gb(h.message)}}}this.cursor="",delete this.editInfo,delete this.isDragging,delete this.interactionState.editing,this.scene.updateEditorCanvas()},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){this.handleEdit(a)},draw:function(a){this.drawEdit(a)}});_b.prototype.drawEdit=function(a){this.node=this.resizePoints=this.position=this.parentPoint=this.rotationPoint=this.axisXPoint=this.axisYPoint=this.movePoints=this.anchorInfo=this.hitPoints=null,this.drawGrid(a),this.drawGameBounds(a),this.drawEdges(a),this.node=fa.currentEditNode=this.dataModel.lastEditableNode,this.node&&(this.position=this.node.getWorldPosition(),this.resizePoints=ob(this.node),this.node.__lock&&(a.globalAlpha=.5),this.drawRectTransform(a),this.scene.editHitAreaEnabled?this.drawHitArea(a):(this.drawResizeCorner(a),this.drawAxisX(a),this.drawAxisY(a),this.drawMoveRect(a),this.drawPivot(a),this.drawChangingParent(a)),this.node.__lock&&(a.globalAlpha=1))},_b.prototype.drawGameBounds=function(a){var b=this.game.world,c=b.rect,d=b.toGlobal({x:0,y:0}),e=b.toGlobal({x:c.width,y:c.height});a.beginPath(),a.rect(Math.round(d.x),Math.round(d.y),Math.round(e.x-d.x),Math.round(e.y-d.y)),Ab(a)},_b.prototype.drawHitArea=function(a){var b=this.node,c=b.hitArea;if(c){if(!(c instanceof qc.Rectangle||c instanceof qc.Ellipse))return void console.error("hitArea只支持qc.Rectangle和qc.Ellipse类型，不支持：{0}",c);var d=c.x,e=c.y,f=c.width,g=c.height,h=b.worldTransform;a.save();var i=l;a.setTransform(h.a*i,h.b*i,h.c*i,h.d*i,h.tx*i,h.ty*i),a.beginPath(),c instanceof qc.Ellipse?T(a,d+f/2,e+g/2,0,j,f/2,g/2,!1):a.rect(d,e,f,g),a.closePath(),a.fillStyle="rgba(0,255,0,0.3)",a.fill(),a.restore(),this.hitPoints=[b.toGlobal({x:d+f/2,y:e}),b.toGlobal({x:d+f,y:e+g/2}),b.toGlobal({x:d+f/2,y:e+g}),b.toGlobal({x:d,y:e+g/2})],a.fillStyle="#00FF00",a.strokeStyle="white",a.lineWidth=1,this.hitPoints.forEach(function(b){a.beginPath(),a.arc(b.x,b.y,3,0,j,!0),a.fill(),a.stroke()})}},_b.prototype.drawPivot=function(a){this.scene.editPivotEnabled?(a.beginPath(),a.arc(this.position.x,this.position.y,4,0,j,!0),a.strokeStyle="white",a.lineWidth=5,a.stroke(),a.strokeStyle="#3498DB",a.lineWidth=3,a.stroke()):(a.fillStyle="#FF0000",a.strokeStyle="white",a.lineWidth=1,a.beginPath(),a.arc(this.position.x,this.position.y,2,0,j,!0),a.fill(),a.stroke())},_b.prototype.drawEdges=function(a){this.dataModel.selectionModel.forEach(function(b){var c=b.node;if(eb(c,!0,!0)){var d=ob(c);a.beginPath(),a.moveTo(d[0].x,d[0].y),a.lineTo(d[1].x,d[1].y),a.lineTo(d[2].x,d[2].y),a.lineTo(d[3].x,d[3].y),a.closePath(),a.strokeStyle=c._bone?"#7A7A7A":"#FFFC3A",a.lineWidth=1,a.stroke()}},this)},_b.prototype.drawResizeCorner=function(a){this.scene.editCornerEnabled&&(a.fillStyle="#3498DB",a.strokeStyle="white",a.lineWidth=1,this.resizePoints.forEach(function(b){a.beginPath(),a.arc(b.x,b.y,4,0,j,!0),a.fill(),a.stroke()}))},_b.prototype.drawAxisX=function(a){var b=this.node,c=this.position,d=b.parent.toGlobal({x:b.x+Math.cos(b.rotation),y:b.y+Math.sin(b.rotation)}),e=y(c,d);if(e){var f={x:(d.x-c.x)/e,y:(d.y-c.y)/e};if(this.scene.editMoveEnabled){var g=this.scene.editPivotEnabled?4:1;a.beginPath(),a.moveTo(c.x+f.x*g,c.y+f.y*g),a.lineTo(c.x+80*f.x,c.y+80*f.y),a.lineWidth=2,a.strokeStyle="red",a.stroke()}d=this.axisXPoint={x:c.x+80*f.x,y:c.y+80*f.y},a.save(),a.translate(d.x,d.y),a.rotate(Math.atan2(f.y,f.x)),a.fillStyle="red",a.beginPath(),this.scene.editScaleEnabled?(a.rect(-3,-5,6,10),a.strokeStyle="white",a.lineWidth=1,a.fill(),a.stroke()):this.scene.editMoveEnabled&&(a.moveTo(-10,-5),a.lineTo(10,0),a.lineTo(-10,5),a.closePath(),a.fill()),a.restore(),this.scene.editRotationEnabled&&(d=this.rotationPoint={x:c.x+40*f.x,y:c.y+40*f.y},a.beginPath(),a.arc(d.x,d.y,4,0,j,!0),a.fillStyle="red",a.strokeStyle="white",a.lineWidth=1,a.fill(),a.stroke())}},_b.prototype.drawAxisY=function(a){var b=this.node,c=this.position,d=b.parent.toGlobal({x:b.x-Math.sin(b.rotation),y:b.y+Math.cos(b.rotation)}),e=y(c,d);if(e){var f={x:(d.x-c.x)/e,y:(d.y-c.y)/e};if(this.scene.editMoveEnabled){var g=this.scene.editPivotEnabled?4:1;a.beginPath(),a.moveTo(c.x+f.x*g,c.y+f.y*g),a.lineTo(c.x+80*f.x,c.y+80*f.y),a.lineWidth=2,a.strokeStyle="#00FF00",a.stroke()}d=this.axisYPoint={x:c.x+80*f.x,y:c.y+80*f.y},a.save(),a.translate(d.x,d.y),a.rotate(Math.atan2(f.y,f.x)),a.beginPath(),a.fillStyle="#00FF00",this.scene.editScaleEnabled?(a.rect(-3,-5,6,10),a.strokeStyle="white",a.lineWidth=1,a.fill(),a.stroke()):this.scene.editMoveEnabled&&(a.moveTo(-10,-5),a.lineTo(10,0),a.lineTo(-10,5),a.closePath(),a.fill()),a.restore(),this.scene.editParentEnabled&&(d=this.parentPoint={x:c.x+40*f.x,y:c.y+40*f.y},a.save(),a.translate(d.x,d.y),a.rotate(Math.atan2(f.y,f.x)),a.beginPath(),a.moveTo(4,0),a.lineTo(-4,5),a.lineTo(-4,-5),a.closePath(),a.fillStyle="#3498DB",a.strokeStyle="white",a.lineWidth=1,a.fill(),a.stroke(),a.restore())}},_b.prototype.drawMoveRect=function(a){if(this.scene.editMoveEnabled&&this.axisYPoint&&this.axisYPoint){var b=this.position,c={x:b.x+(this.axisXPoint.x-b.x)/4,y:b.y+(this.axisXPoint.y-b.y)/4},d={x:b.x+(this.axisYPoint.x-b.x)/4,y:b.y+(this.axisYPoint.y-b.y)/4},e={x:(c.x+d.x)/2,y:(c.y+d.y)/2},f={x:b.x+2*(e.x-b.x),y:b.y+2*(e.y-b.y)};a.beginPath(),a.moveTo(b.x,b.y),a.lineTo(c.x,c.y),a.lineTo(f.x,f.y),a.lineTo(d.x,d.y),a.closePath(),a.fillStyle="rgba(0, 0, 255, 0.2)",a.strokeStyle="#0F78FF",a.lineWidth=1,a.fill(),a.stroke(),this.movePoints=[b.x,b.y,c.x,c.y,f.x,f.y,d.x,d.y,b.x,b.y]}},_b.prototype.drawChangingParent=function(a){var b=this.editInfo;if(b&&"parent"===b.type){if(b.targetNode){var c=ob(b.targetNode);a.beginPath(),a.moveTo(c[0].x,c[0].y),a.lineTo(c[1].x,c[1].y),a.lineTo(c[2].x,c[2].y),a.lineTo(c[3].x,c[3].y),a.closePath(),a.fillStyle="rgba(0,0,0,0.3)",a.fill(),a.strokeStyle="white",a.lineWidth=1,a.stroke()}a.beginPath(),a.moveTo(b.sourcePoint.x,b.sourcePoint.y),a.lineTo(b.targetPoint.x,b.targetPoint.y),a.lineWidth=3,a.strokeStyle="white",a.stroke(),a.lineWidth=1,a.strokeStyle="#3498DB",a.stroke()}},_b.prototype.drawGrid=function(a){if(fa.gridVisible){var b,c,d,e,f=this.scene,g=f.zoom,h=Math.log(g)/Math.log(10),i=Math.floor(h),j=100,k=10,m=Math.pow(10,i),n=j*g/m,o=n/k,p=Math.round(f.translateX),q=Math.round(f.translateY),r={x:-p,y:-q,width:f.view.clientWidth,height:f.view.clientHeight},s=Math.floor(r.x/n),t=Math.ceil((r.x+r.width)/n),u=Math.floor(r.y/n),v=Math.ceil((r.y+r.height)/n);a.lineWidth=1,a.save();var w=l;for(a.setTransform(w,0,0,w,p*w,q*w),a.beginPath(),b=s;t>=b;b++)e=Math.round(b*n),a.moveTo(e,u*n),a.lineTo(e,v*n);for(c=u;v>=c;c++)e=Math.round(c*n),a.moveTo(s*n,e),a.lineTo(t*n,e);for(a.strokeStyle="rgba(120,120,120,0.7)",a.stroke(),a.beginPath(),b=s;t>=b;b++)for(d=1;k>d;d++)e=Math.round(b*n+d*o),a.moveTo(e,u*n),a.lineTo(e,v*n);for(c=u;v>=c;c++)for(d=1;k>d;d++)e=Math.round(c*n+d*o),a.moveTo(s*n,e),a.lineTo(t*n,e);var x=(g-m)/(Math.pow(10,i+1)-m);a.strokeStyle="rgba(120,120,120,"+x+")",a.stroke(),a.restore()}},_b.prototype.drawRectTransform=function(a){if(this.scene.editRectTransformEnabled){var b=this.node,c=b.parent,d=b.minAnchor,e=b.maxAnchor,f=ob(c),g=f[0],h=f[1],i=f[2],j=f[3],k={x:g.x+(j.x-g.x)*d.y,y:g.y+(j.y-g.y)*d.y},l={x:h.x+(i.x-h.x)*d.y,y:h.y+(i.y-h.y)*d.y},m={x:g.x+(j.x-g.x)*e.y,y:g.y+(j.y-g.y)*e.y},n={x:h.x+(i.x-h.x)*e.y,y:h.y+(i.y-h.y)*e.y},o={x:g.x+(h.x-g.x)*d.x,y:g.y+(h.y-g.y)*d.x},p={x:j.x+(i.x-j.x)*d.x,y:j.y+(i.y-j.y)*d.x},q={x:g.x+(h.x-g.x)*e.x,y:g.y+(h.y-g.y)*e.x},r={x:j.x+(i.x-j.x)*e.x,y:j.y+(i.y-j.y)*e.x},s={x:o.x+(p.x-o.x)*d.y,y:o.y+(p.y-o.y)*d.y},t={x:q.x+(r.x-q.x)*d.y,y:q.y+(r.y-q.y)*d.y},u={x:q.x+(r.x-q.x)*e.y,y:q.y+(r.y-q.y)*e.y},v={x:o.x+(p.x-o.x)*e.y,y:o.y+(p.y-o.y)*e.y};if(a.beginPath(),a.moveTo(g.x,g.y),a.lineTo(h.x,h.y),a.lineTo(i.x,i.y),a.lineTo(j.x,j.y),a.closePath(),Ab(a),this.interactionState.moving||this.isDragging){Q(a,[4]);var w=b.rect,x=c.toGlobal({x:w.x+b.x,y:w.y+b.y}),y=c.toGlobal({x:w.x+w.width+b.x,y:w.y+b.y}),z=c.toGlobal({x:w.x+w.width+b.x,y:w.y+w.height+b.y}),A=c.toGlobal({x:w.x+b.x,y:w.y+w.height+b.y});a.beginPath(),a.moveTo(x.x,x.y),a.lineTo(y.x,y.y),a.lineTo(z.x,z.y),a.lineTo(A.x,A.y),a.closePath(),Ab(a),(this.interactionState.moving||this.RESIZE_TYPE_MAP[this.editInfo.type]||this.ANCHOR_TYPE_MAP[this.editInfo.type])&&(a.beginPath(),a.moveTo(k.x,k.y),a.lineTo(l.x,l.y),a.moveTo(m.x,m.y),a.lineTo(n.x,n.y),a.moveTo(o.x,o.y),a.lineTo(p.x,p.y),a.moveTo(q.x,q.y),a.lineTo(r.x,r.y),Ab(a),b.minAnchor.x===b.maxAnchor.x?this.drawLineText(a,b.anchoredX,this.position,i,j,q,r):(this.drawLineText(a,b.left,{x:(x.x+A.x)/2,y:(x.y+A.y)/2},i,j,o,p),this.drawLineText(a,b.right,{x:(y.x+z.x)/2,y:(y.y+z.y)/2},i,j,q,r)),b.minAnchor.y===b.maxAnchor.y?this.drawLineText(a,b.anchoredY,this.position,g,j,k,l):(this.drawLineText(a,b.top,{x:(x.x+y.x)/2,y:(x.y+y.y)/2},g,j,k,l),this.drawLineText(a,b.bottom,{x:(z.x+A.x)/2,y:(z.y+A.y)/2},g,j,m,n))),R(a,[4])}this.anchorInfo={},this.drawAnchorTriangle(a,"A0",s,o,p,k,l),this.drawAnchorTriangle(a,"A1",t,q,r,l,k),this.drawAnchorTriangle(a,"A2",u,n,m,r,q),this.drawAnchorTriangle(a,"A3",v,m,n,p,o),d.x===e.x&&d.y===e.y&&(this.anchorInfo.A=s)}},_b.prototype.drawAnchorTriangle=function(a,b,c,d,e,f,g){var h=wb(d,e,!0),i=wb(f,g,!0),j={x:(h.x+i.x)/2,y:(h.y+i.y)/2},k=Math.atan2(j.y,j.x);a.save(),a.translate(c.x,c.y),a.rotate(k),a.beginPath(),a.moveTo(0,0),a.lineTo(12,5),a.lineTo(12,-5),a.closePath(),Ab(a),a.restore(),j=wb(j,{x:0,y:0},!0),j.x*=8,j.y*=8,j.x+=c.x,j.y+=c.y,this.anchorInfo[b]=j},_b.prototype.drawLineText=function(a,b,c,d,e,f,g){var h=x(f.x,f.y,g.x,g.y,c.x,c.y,c.x+e.x-d.x,c.y+e.y-d.y);if(h){var i=c.x,j=c.y,k=h[0],l=h[1];a.beginPath(),a.moveTo(i,j),a.lineTo(k,l),Ab(a);var m=(i+k)/2,n=(j+l)/2;a.save(),a.translate(m,n),a.rotate(k>i?Math.atan2(l-j,k-i):Math.atan2(j-l,i-k)),a.translate(-m,-n),S(a,xb(b),null,"black",m+1,n+1,0,0,"center","middle"),S(a,xb(b),null,"white",m,n,0,0,"center","middle"),a.restore()}},_b.prototype.checkEdit=function(a){if(this.cursor="",delete this.editInfo,delete this.interactionState.editing,this.node&&!this.node.__lock){var b=this.toGlobal(a);if(this.scene.editHitAreaEnabled){if(this.checkHitArea(b))return!0}else{if(this.checkPivot(b))return!0;if(this.checkRotation(b))return!0;if(this.checkParent(b))return!0;if(this.checkScale(b))return!0;if(this.checkOnAxis(b))return!0;if(this.checkResize(b))return!0}if(this.checkAnchor(b))return!0}return!1},_b.prototype.checkHitArea=function(a){if(this.hitPoints){for(var b=this.hitPoints.length-1;b>=0;b--)if(y(a,this.hitPoints[b])<=6)return this.editInfo={node:this.node,type:"hitAreaResize",index:b},this.cursor="crosshair",this.interactionState.editing=!0,!0;var c=this.node.toLocal(a);if(isNaN(c.x)||isNaN(c.y))return;if(this.node.hitArea.contains(c.x,c.y))return this.editInfo={node:this.node,type:"hitAreaMove",localPoint:c},this.cursor="move",this.interactionState.editing=!0,!0}return!1},_b.prototype.checkPivot=function(a){return this.scene.editPivotEnabled&&this.position&&y(a,this.position)<=6?(this.editInfo={node:this.node,type:"pivot"},this.cursor="crosshair",this.interactionState.editing=!0,!0):!1},_b.prototype.checkRotation=function(a){return this.rotationPoint&&y(a,this.rotationPoint)<=6?(this.editInfo={node:this.node,type:"rotation"},this.cursor="crosshair",this.interactionState.editing=!0,!0):!1},_b.prototype.checkParent=function(a){return this.parentPoint&&y(a,this.parentPoint)<=6?(this.editInfo={node:this.node,type:"parent",sourcePoint:this.parentPoint,targetPoint:a},this.cursor="crosshair",this.interactionState.editing=!0,!0):!1},_b.prototype.checkScale=function(a){var b=this.node;return this.scene.editScaleEnabled&&this.axisXPoint&&y(a,this.axisXPoint)<=6?(this.editInfo={node:b,type:"scaleX",scaleX:b.scaleX,position:b.getWorldPosition()},this.cursor="crosshair",this.interactionState.editing=!0,!0):this.scene.editScaleEnabled&&this.axisYPoint&&y(a,this.axisYPoint)<=6?(this.editInfo={node:b,type:"scaleY",scaleY:b.scaleY,position:b.getWorldPosition()},this.cursor="crosshair",this.interactionState.editing=!0,!0):!1},_b.prototype.checkOnAxis=function(a){if(this.scene.editMoveEnabled){if(this.movePoints&&yb(this.movePoints,a.x,a.y))return this.editInfo={node:this.node,type:"move",lastGlobalPoint:a},this.cursor="move",this.interactionState.editing=!0,!0;if(this.axisXPoint&&qb(this.position,this.axisXPoint,a).z<3)return this.editInfo={node:this.node,type:"axisX",lastGlobalPoint:a},this.cursor="move",this.interactionState.editing=!0,!0;if(this.axisYPoint&&qb(this.position,this.axisYPoint,a).z<3)return this.editInfo={node:this.node,type:"axisY",lastGlobalPoint:a},this.cursor="move",this.interactionState.editing=!0,!0}return!1},_b.prototype.checkResize=function(a){var b=this.resizePoints;if(b){if(this.scene.editCornerEnabled)for(var c=b.length-1;c>=0;c--)if(y(a,b[c])<=6)return this.editInfo={node:this.node,type:"resize",index:c},this.cursor="crosshair",this.interactionState.editing=!0,!0;if(this.scene.editEdgeEnabled){var d;if(qb(b[0],b[1],a).z<3?d="top":qb(b[1],b[2],a).z<3?d="right":qb(b[2],b[3],a).z<3?d="bottom":qb(b[3],b[0],a).z<3&&(d="left"),d)return this.editInfo={node:this.node,type:d},this.cursor="crosshair",this.interactionState.editing=!0,!0}}return!1},_b.prototype.checkAnchor=function(a){var b=this.anchorInfo;if(b){var c;if(b.A&&y(b.A,a)<4?c="A":y(b.A0,a)<=8?c="A0":y(b.A1,a)<=8?c="A1":y(b.A2,a)<=8?c="A2":y(b.A3,a)<=8&&(c="A3"),c)return this.editInfo={node:this.node,type:c},this.cursor="A"===c?"move":"crosshair",this.interactionState.editing=!0,!0}return!1},_b.prototype.handleEdit=function(a){this.scene.updateEditorCanvas();var b=this.editInfo;if(b){fa.sceneManager.dirty=!0;var c=this.dataModel,d=b.node,e=b.type,f=this.toGlobal(a);if("scaleX"===e)return b.undo||(b.undo=c.createScaleUndoFunc(d)),void this.handleScaleX(a,f,d);if("scaleY"===e)return b.undo||(b.undo=c.createScaleUndoFunc(d)),void this.handleScaleY(a,f,d);if("parent"===e)return void this.handleParent(a,f,d);if("move"===e)return b.undo||(b.undo=c.createMoveUndoFunc(d)),void this.handleMove(a,f);if("axisX"===e||"axisY"===e)return b.undo||(b.undo=c.createMoveUndoFunc(d)),void this.handleAxis(a,f,d);var g=d.toLocal(f);if(!isNaN(g.x)&&!isNaN(g.y))return"pivot"===e?(b.undo||(b.undo=c.createPivotUndoFunc(d)),void this.handlePivot(a,f,d,g)):"rotation"===e?(b.undo||(b.undo=c.createRotationUndoFunc(d)),void this.handleRotation(a,f,d,g)):this.RESIZE_TYPE_MAP[e]?(b.undo||(b.undo=c.createResizeUndoFunc(d)),void this.handleResize(a,f,d,g)):this.ANCHOR_TYPE_MAP[e]?(b.undo||(b.undo=c.createAnchorUndoFunc(d)),void this.handleAnchor(a,f,d)):"hitAreaResize"===e?void this.handleHitAreaResize(a,f,d,g):"hitAreaMove"===e?void this.handleHitAreaMove(a,f,d,g):void 0}},_b.prototype.handleScaleX=function(a,b,c){if(c.scaleX){var d=this.position,e=this.axisXPoint.x-d.x,f=this.axisXPoint.y-d.y,g=b.x-d.x,h=b.y-d.y,i=e*g+f*h,j=this.editInfo.scaleX*i/6400/c.scaleX;this.dataModel.getTopEditableSelection(c).forEach(function(b){b.node.scaleX*=j,O(a)&&(b.node.scaleY*=j)})}},_b.prototype.handleScaleY=function(a,b,c){if(c.scaleY){var d=this.position,e=this.axisYPoint.x-d.x,f=this.axisYPoint.y-d.y,g=b.x-d.x,h=b.y-d.y,i=e*g+f*h,j=this.editInfo.scaleY*i/6400/c.scaleY;this.dataModel.getTopEditableSelection(c).forEach(function(b){b.node.scaleY*=j,O(a)&&(b.node.scaleX*=j)})}},_b.prototype.handleParent=function(a,b,c){this.editInfo.targetPoint=b;var d=this.getNodeAt(a);this.editInfo.targetNode=!d||d===c||d.isDescendantOf(c)?null:d},_b.prototype.handleAxis=function(a,b){var c=this.editInfo,d="axisX"===c.type?this.axisXPoint:this.axisYPoint,e=b.x-c.lastGlobalPoint.x,f=b.y-c.lastGlobalPoint.y;this.dataModel.getTopEditableSelection().forEach(function(a){var b=a.node,c=b.getWorldPosition();c.x+=e,c.y+=f;var g=b.getWorldPosition(),h={x:g.x+d.x-this.position.x,y:g.y+d.y-this.position.y};c=vb(g,h,c),c=b.parent.toLocal(c),b.x=c.x,b.y=c.y},this),c.lastGlobalPoint=b},_b.prototype.handleMove=function(a,b){var c=b.x-this.editInfo.lastGlobalPoint.x,d=b.y-this.editInfo.lastGlobalPoint.y;this.dataModel.moveSelection(c,d),this.editInfo.lastGlobalPoint=b},_b.prototype.handlePivot=function(a,b,c,d){var e=c.rect;if(e.width&&e.height){c.pivotX=(d.x-e.x)/e.width,c.pivotY=(d.y-e.y)/e.height;var f=c.parent.toLocal(b);c.x=f.x,c.y=f.y}},_b.prototype.handleRotation=function(a,b,c,d){var c=this.node,e=Math.atan2(d.y*c.scaleY,d.x*c.scaleX);this.dataModel.getTopEditableSelection(c).forEach(function(a){a.node.rotation+=e})},_b.prototype.handleResize=function(a,b,c,d){var e,f,g=this.editInfo.type,h=this.editInfo.index,i=c.rect,j=i.x,k=i.y,l=i.width,m=i.height;"resize"===g?0===h?(e=Math.max(j+l-d.x,0),f=Math.max(k+m-d.y,0),j=j+l-e,k=k+m-f):1===h?(e=Math.max(d.x-j,0),f=Math.max(k+m-d.y,0),k=k+m-f):2===h?(e=Math.max(d.x-j,0),f=Math.max(d.y-k,0)):3===h&&(e=Math.max(j+l-d.x,0),f=Math.max(d.y-k,0),j=j+l-e):"left"===g?(e=Math.max(j+l-d.x,0),f=m,j=j+l-e):"right"===g?(e=Math.max(d.x-j,0),f=m):"top"===g?(e=l,f=Math.max(k+m-d.y,0),k=k+m-f):"bottom"===g&&(e=l,f=Math.max(d.y-k,0));var n=c.parent.toLocal(c.toGlobal({x:j+c.pivotX*e,y:k+c.pivotY*f}));c.x=n.x,c.y=n.y,c.width=e,c.height=f},
_b.prototype.handleHitAreaResize=function(a,b,c,d){var e,f,g=this.editInfo.index,h=this.node.hitArea,i=h.x,j=h.y,k=h.width,l=h.height;0===g?(e=k,f=Math.max(j+l-d.y,0),j=j+l-f):1===g?(e=Math.max(d.x-i,0),f=l):2===g?(e=k,f=Math.max(d.y-j,0)):3===g&&(e=Math.max(i+k-d.x,0),f=l,i=i+k-e),h.x=i,h.y=j,h.width=e,h.height=f,this.node.hitArea=h},_b.prototype.handleHitAreaMove=function(a,b,c,d){var e=c.hitArea;e.x+=d.x-this.editInfo.localPoint.x,e.y+=d.y-this.editInfo.localPoint.y,this.node.hitArea=e,this.editInfo.localPoint=d},_b.prototype.handleAnchor=function(a,b,c){var d=this.editInfo.type,e=c.parent.toLocal(b),f=c.parent.rect,g=c.minAnchor,h=c.maxAnchor,i=(e.x-f.x)/f.width,j=(e.y-f.y)/f.height,k=!O(a);"A"===d?c.setAnchor(new qc.Point(i,j),new qc.Point(i,j),k):"A0"===d?(i>h.x&&(i=h.x),j>h.y&&(j=h.y),c.setAnchor(new qc.Point(i,j),h,k)):"A1"===d?(i<g.x&&(i=g.x),j>h.y&&(j=h.y),c.setAnchor(new qc.Point(g.x,j),new qc.Point(i,h.y),k)):"A2"===d?(i<g.x&&(i=g.x),j<g.y&&(j=g.y),c.setAnchor(g,new qc.Point(i,j),k)):"A3"===d&&(i>h.x&&(i=h.x),j<g.y&&(j=g.y),c.setAnchor(new qc.Point(i,g.y),new qc.Point(h.x,j),k))};var ac=[{id:"editMode",type:"buttongroup",children:[{value:"pan",type:"togglebutton",background:null,hoverBackground:null,activeNinePatchImage:"banner_button_active_left.9",activeNinePatchBorder:[8,8,8,8],preferredSize:{width:32},borderWidth:0,icon:"pan",activeIcon:"pan_active",iconWidth:null,iconHeight:null,toolTip:"Pan Mode"},{value:"default",type:"togglebutton",background:null,hoverBackground:null,activeNinePatchImage:"banner_button_active.9",activeNinePatchBorder:[8,8,8,8],preferredSize:{width:32},borderWidth:0,icon:"move",activeIcon:"move_active",iconWidth:null,iconHeight:null,toolTip:"Move Mode"},{value:"scale",type:"togglebutton",background:null,hoverBackground:null,activeNinePatchImage:"banner_button_active.9",activeNinePatchBorder:[8,8,8,8],preferredSize:{width:32},borderWidth:0,icon:"scale",activeIcon:"scale_active",iconWidth:null,iconHeight:null,toolTip:"Scale Mode"},{value:"rectTransform",type:"togglebutton",background:null,hoverBackground:null,activeNinePatchImage:"banner_button_active_right.9",activeNinePatchBorder:[8,8,8,8],preferredSize:{width:32},borderWidth:0,icon:"transform",activeIcon:"transform_active",iconWidth:null,iconHeight:null,toolTip:"Transform Mode"}]},{id:"sceneHandler",type:"toolbar",layout:{type:"hbox",padding:0,gap:0},children:[{id:"fitContent",type:"button",icon:"fitContent",activeIcon:"fitContent_active",iconWidth:null,iconHeight:null,background:null,hoverBackground:null,padding:0,activeNinePatchImage:"banner_button_active_left.9",activeNinePatchBorder:[8,8,8,8],preferredSize:{width:32},borderWidth:0,toolTip:"Fit Content"},{id:"grid",type:"togglebutton",icon:"grid",activeIcon:"grid_active",iconWidth:null,iconHeight:null,background:null,hoverBackground:null,padding:0,activeNinePatchImage:"banner_button_active.9",activeNinePatchBorder:[8,8,8,8],preferredSize:{width:32},borderWidth:0,toolTip:"Show/Hide Grid"}]}],bc=(m("qc.editor.LeftBanner",qc.widget.Container,function Ae(a){var b=this;Ae["super"].constructor.call(b,a),b.layout=new qc.widget.layout.HBoxLayout(b),o(ac,b),b.layout.padding=5,b.layout.gap=20,b.scrollBarMode="off",b.findViewById("sceneHandler").children.forEach(function(a){a.toolTip=fa._(a.toolTip),a.enableToolTip()});var c=b.findViewById("editMode");c.children.forEach(function(a){a.toolTip=fa._(a.toolTip),a.enableToolTip()}),c.on("propertyChange",function(a){"value"===a.property&&(fa.editMode=a.newValue)}),fa.e.on(fa.e.EDIT_MODE_CHANGE,function(a){c.value=a.newValue});var d=b.findViewById("fitContent");d.on("click",function(){fa.scene.fitContent(!0)});var e=b.findViewById("grid");e.on("propertyChange",function(a){"selected"===a.property&&(fa.gridVisible=a.newValue)}),fa.e.on(fa.e.GRID_VISIBLE_CHANGE,function(a){e.selected=a.newValue});var f=new qc.widget.Mousetrap;f.bind("q",function(){c.value="pan"}),f.bind("w",function(){c.value="default"}),f.bind("e",function(){c.value="scale"}),f.bind("r",function(){c.value="rectTransform"}),f.bind("t",function(){d.emit("click",null)}),f.bind("y",function(){e.selected=!e.selected}),f.bind("u",function(){})},{},{properties:[]},{}),[{id:"CreateEmptyNode",type:"qc.editor.DraggableButton",background:null,hoverBackground:null,activeBackground:null,activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},icon:"inspector_node",toolTip:"Empty Node",iconWidth:null,iconHeight:null},{id:"CreateImage",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_image",toolTip:"Image",iconWidth:null,iconHeight:null},{id:"CreateSprite",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_sprite",toolTip:"Sprite",iconWidth:null,iconHeight:null},{id:"CreateText",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_text",toolTip:"Text",iconWidth:null,iconHeight:null},{id:"CreateInputField",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_inputfield",toolTip:"Input Field",iconWidth:null,iconHeight:null},{id:"CreateToggle",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_toggle",toolTip:"Toggle",iconWidth:null,iconHeight:null},{id:"CreateButton",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_button",toolTip:"Button",iconWidth:null,iconHeight:null},{id:"CreateScrollBar",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_scrollbar",toolTip:"ScrollBar",iconWidth:null,iconHeight:null},{id:"CreateScrollView",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_scrollview",toolTip:"ScrollView",iconWidth:null,iconHeight:null},{id:"CreateProgressBar",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_progressbar",toolTip:"ProgressBar",iconWidth:null,iconHeight:null},{id:"CreateSlider",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_slider",toolTip:"Slider",iconWidth:null,iconHeight:null},{id:"CreateDom",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_dom",toolTip:"Dom",iconWidth:null,iconHeight:null},{id:"CreateSound",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_sound",toolTip:"Sound",iconWidth:null,iconHeight:null},{id:"CreateTilemap",type:"qc.editor.DraggableButton",activeNinePatchImage:"banner_creator_active.9",activeNinePatchBorder:[10,10,10,10],preferredSize:{width:32},background:null,hoverBackground:null,activeBackground:null,icon:"inspector_tilemap",toolTip:"Tilemap",iconWidth:null,iconHeight:null}]),cc=m("qc.editor.MiddleBanner",qc.widget.ButtonGroup,function Be(a){var b=this;Be["super"].constructor.call(b,a),b.layout=new qc.widget.layout.HBoxLayout(b),o(bc,b),b.layout.padding=[5,5,5,10],b.layout.gap=0,b.scrollBarMode="off",b.initCreatorHandler()},{},{properties:[]},{});cc.prototype.initCreatorHandler=function(){var a=this;a.children.forEach(function(a){a.toolTip=fa._(a.toolTip),a.enableToolTip()});var b=fa.menu;a.findViewById("CreateEmptyNode").on("click",function(){b.createNode()}),a.findViewById("CreateImage").on("click",function(){b.createImage()}),a.findViewById("CreateSprite").on("click",function(){b.createSprite()}),a.findViewById("CreateText").on("click",function(){b.createText()}),a.findViewById("CreateButton").on("click",function(){b.createButton()}),a.findViewById("CreateToggle").on("click",function(){b.createToggle()}),a.findViewById("CreateScrollBar").on("click",function(){b.createScrollBar()}),a.findViewById("CreateScrollView").on("click",function(){b.createScrollView()}),a.findViewById("CreateProgressBar").on("click",function(){b.createProgressBar()}),a.findViewById("CreateSlider").on("click",function(){b.createSlider()}),a.findViewById("CreateInputField").on("click",function(){b.createInputField()}),a.findViewById("CreateDom").on("click",function(){b.createDom()}),a.findViewById("CreateSound").on("click",function(){b.createSound()}),a.findViewById("CreateTilemap").on("click",function(){b.createTilemap()})};var dc=[{id:"gameSize",type:"qc.editor.DropDownList",background:null,ninePatchImage:null,textColor:"#caccd8",items:[{label:"Free Aspect",value:"Free Aspect"},{label:"iPhone 4 (640x960)",value:"iPhone 4 (640x960)",size:{width:640,height:960}},{label:"iPhone 5 (640x1136)",value:"iPhone 5 (640x1136)",size:{width:640,height:1136}},{label:"iPhone 6 (750x1334)",value:"iPhone 6 (750x1334)",size:{width:750,height:1334}},{label:"iPhone 6 Plus (1242x2208)",value:"iPhone 6 Plus (1242x2208)",size:{width:1242,height:2208}},{label:"iPad Mini (768x1024)",value:"iPad Mini (768x1024)",size:{width:768,height:1024}},{label:"iPad Air(1536x2048)",value:"iPad Air(1536x2048)",size:{width:1536,height:2048}},{label:"iPad Pro (2048x2732)",value:"iPad Pro (2048x2732)",size:{width:2048,height:2732}}],value:"Free Aspect"}];m("qc.editor.RightBanner",qc.widget.ButtonGroup,function Ce(a){var b=this;Ce["super"].constructor.call(b,a),o(dc,b),b.layout.align="right",b.layout.padding=5,b.findViewById("gameSize").on("propertyChange",function(a){if("value"===a.property){var b=a.source.items;fa.gameSize=b[a.source._map[a.newValue]].size,fa.storage.set("gameSize",fa.gameSize),fa.storage.set("gameSizeValue",a.newValue),fa.scene.fitContent(!0)}})},{},{properties:[]},{}),b.defineProperty(qc.editor.RightBanner.prototype,"gameSize",{get:function(){return fa.gameSize},set:function(a){fa.gameSize=a.size,this.findViewById("gameSize").value=a.value}});var ec=[{id:"play",value:"play",type:"togglebutton",icon:"play",ninePatchImage:"banner_run.9",ninePatchBorder:[10,10,10,10],activeNinePatchImage:"banner_run_active.9",activeNinePatchBorder:[8,8,8,10],hoverNinePatchImage:"banner_run.9",hoverNinePatchBorder:[10,10,10,10],background:null,hoverBackground:null,activeBackground:null,borderWidth:0,preferredSize:{width:52},activeIcon:"play_active",iconWidth:null,iconHeight:null,toolTip:"Play"},{id:"pause",value:"pause",type:"togglebutton",icon:"pause",ninePatchImage:"banner_pause.9",ninePatchBorder:[8,8,8,8],activeNinePatchImage:"banner_pause_active.9",activeNinePatchBorder:[8,8,8,8],hoverNinePatchImage:"banner_pause.9",hoverNinePatchBorder:[8,8,8,8],background:null,hoverBackground:null,activeBackground:null,borderWidth:0,preferredSize:{width:52},activeIcon:"pause_active",iconWidth:null,iconHeight:null,toolTip:"Pause"},{id:"step",value:"step",type:"button",icon:"step",ninePatchImage:"banner_nextframe.9",ninePatchBorder:[10,10,10,10],activeNinePatchImage:"banner_nextframe_active.9",activeNinePatchBorder:[10,10,10,10],hoverNinePatchImage:"banner_nextframe.9",hoverNinePatchBorder:[10,10,10,10],background:null,hoverBackground:null,activeBackground:null,borderWidth:0,preferredSize:{width:52},activeIcon:"step_active",iconWidth:null,iconHeight:null,toolTip:"Next Frame"}];m("qc.editor.RunBanner",qc.widget.ButtonGroup,function De(a){var b=this;De["super"].constructor.call(b,a),o(ec,b),b.layout.align="center",b.layout.padding=1,b.selectionMode="multiple",b.children.forEach(function(a){a.toolTip=fa._(a.toolTip),a.enableToolTip()});var c=b.findViewById("play"),d=b.findViewById("pause"),e=b.findViewById("step");fa.e.on(fa.e.PLAYING_CHANGE,function(a){var e=a.newValue;b._updatingFromGlobal=!0,c.selected=e,d.selected=!1,b._updatingFromGlobal=!1}),c.on(fa.e.PROPERTY_CHANGE,function(a){"selected"!==a.property||b._updatingFromGlobal||(fa.playing=a.newValue)}),d.on(fa.e.PROPERTY_CHANGE,function(a){if(fa.workable){var c=a.newValue;"selected"!==a.property||b._updatingFromGlobal||b._updatingStep||(fa.game.paused=c),c||fa.game.disableStep()}}),e.on("click",function(){fa.workable&&(b._updatingStep=!0,d.selected=!0,fa.game.paused=!1,fa.game.stepping?fa.game.step():fa.game.enableStep(),b._updatingStep=!1)})},{},{properties:[]},{});var fc=[{region:"top",elementConfig:{type:"container",layout:"table",children:[{widths:[.1,105],cells:[{elementConfig:{type:"container",layout:"hbox",children:[{type:"button",text:"Clear"},{type:"button",text:"Collapse"},{type:"button",text:"Clear on play"},{type:"button",text:"Error pause"}]}},{elementConfig:{type:"container",layout:{type:"hbox",align:"right"},children:[{type:"togglebutton",text:"0",icon:fa.assetPath+"info.png"},{type:"togglebutton",text:"0",icon:fa.assetPath+"warn.png"},{type:"togglebutton",text:"0",icon:fa.assetPath+"error.png"}]}}]}]}},{region:"center",elementConfig:{type:"textarea"}}];m("qc.editor.Console",qc.widget.Container,function Ee(a){var b=this;Ee["super"].constructor.call(b,a),b.layout=new qc.widget.layout.BorderLayout(b),o(fc,b),b.layout.topToggleVisible=!1,b.layout.topResizable=!1,b.layout.splitterSize=1},{_background:"rgb(255, 255, 255)",_gradientColor:"rgb(211, 211, 211)"},{properties:[]},{});var gc=[{widths:[.1],height:22,cells:[{elementConfig:{type:"qc.editor.StringInput",id:"filter",padding:[2,0,2,22]}}]},{height:22,cells:[{elementConfig:{type:"label",text:"Components",id:"compsTitle",preferredSize:{width:200,height:26}}}]},{height:.1,cells:[{elementConfig:{type:"qc.editor.ComponentsList",id:"compsList"}}]}],hc=m("qc.editor.ComponentsList",qc.widget.List,function Fe(a){var b=this;Fe["super"].constructor.call(b,a),b.selectionModel.selectionMode="single",b.view.addEventListener("mousemove",function(a){var c=b.getDataAt(a);c&&(b.selectionModel.selection=c)});var c=b.drawRowBackground;b.drawRowBackground=function(a,d,e,f,g,h){c.call(b,a,d,e,f,g,h);var i=d.a("item"),j=b.selectionModel;if(i.items){var l={width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:j.isSelected(d)?"white":"#868686",rotation:Math.PI/2}]};k.drawImage(a,l,"centerUniform",b.width-24,f,16,b.rowHeight,null,b)}},b.on("propertyChange",function(a){"items"===a.property&&b.switchToRoot()})});hc.prototype.forEach=function(a,b,c){var d=this,e=c?c.items:d._items;if(e)for(var f=0;f<e.length;f++){var g=e[f];a.call(b||d,g),d.forEach(a,b,g)}},hc.prototype.findParent=function(a){var b,c=this;return c.forEach(function(c){c&&c.items&&c.items.indexOf(a)>=0&&(b=c)}),b},hc.prototype.switchToFilter=function(a){var b=this,c=[];a&&(a=a.toLowerCase(),b.forEach(function(b){b.label.toLowerCase().indexOf(a)>=0&&!b.items&&c.push(b)}),b._switchItems(c),this._displayedItem="filter")},hc.prototype.switchToRoot=function(){this._switchItems(this.items),this._displayedItem="root"},hc.prototype.switchToItem=function(a){var b=this;a&&(b._switchItems(a.items),this._displayedItem=a)},hc.prototype._switchItems=function(a){var b=this,c=b.dataModel;if(c.clear(),a)for(var d=0;d<a.length;d++){var e=a[d],f=new qc.widget.Data;f.name=e.label,f.icon=e.icon,f.a("item",e),c.add(f)}},b.defineProperties(hc.prototype,{items:{get:function(){return this._items},set:function(a){var b=this;b.setPropertyValue("items",a)}},displayedItem:{get:function(){return this._displayedItem}}});var ic=m("qc.editor.ComponentsPanel",qc.widget.Container,function Ge(a){var b=this;Ge["super"].constructor.call(b,a),b.scrollBarMode="off";var c=new qc.widget.layout.TableLayout(b);b.layout=c,c.cellPadding=0,o(gc,b);var d=b.findViewById("filter"),e=d.getInput().style;e.backgroundImage='url("'+fa.assetPath+'magnifying-glass.png")',e.backgroundRepeat="no-repeat",e.backgroundSize="17px 17px",e.backgroundPosition="2px 50%",d.addEventListener("keydown",b.handleFilterKeydown.bind(b)),d.onValueChanged=b.filterList.bind(b);var f=b.findViewById("compsTitle");f.addEventListener("click",b.handleCompsTitleClick.bind(b)),f.background=b._titleBackground,f.gradientColor=null,f._oldDrawBackground=f.drawBackground,f.drawBackground=b.drawCompsTitleBackground.bind(b);var g=b.findViewById("compsList");g.switchToRoot(),g.addEventListener("click",b.handleCompsListClick.bind(b)),b.view.style.background=b._background,b.view.style.border="1px solid "+b._borderColor});ic.prototype.filterList=function(){var a=this,b=a.findViewById("filter"),c=a.findViewById("compsList"),d=a.findViewById("compsTitle"),e=b.value;e?(d.text="Search",c.switchToFilter(e)):(d.text="Component",c.switchToRoot())},ic.prototype.handleCompsTitleClick=function(){var a=this,b=a.findViewById("compsList"),c=a.findViewById("compsTitle"),d=b.displayedItem;if("root"!==d&&"filter"!==d){var e=b.findParent(d);e?(b.switchToItem(e),c.text=e.label):(c.text=fa._("Components"),b.switchToRoot())}},ic.prototype.drawCompsTitleBackground=function(a,b,c,d,e){var f=this,g=f.findViewById("compsList"),h=f.findViewById("compsTitle"),i=g.displayedItem;if(h._oldDrawBackground.call(h,a,b,c,d,e),a.beginPath(),"root"!==i&&"filter"!==i){var j={width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:"#868686",rotation:-Math.PI/2}]};k.drawImage(a,j,"centerUniform",5,0,16,h.height,null,f)}},ic.prototype.handleFilterKeydown=function(a){var b,c=this,d=(c.findViewById("filter"),c.findViewById("compsTitle")),e=c.findViewById("compsList"),f=e.selectionModel,g=e.checkMode;if(b=g?e.focusData:f.lastData,k.isUp(a)||k.isDown(a)){a.preventDefault();var h=e.rowDatas;if(b&&e.getRowIndex(b)>=0){var i=e.getRowIndex(b);k.isUp(a)?0!==i&&(b=h[i-1],g?e.focusData=b:f.selection=b):i!==h.length-1&&(b=h[i+1],g?e.focusData=b:f.selection=b)}else h.length&&(b=h[0],g?e.focusData=b:f.selection=b)}else if(k.isEnter(a)){if(b){var j=b.a("item");j.items?(e.switchToItem(j),d.text=b.name):(j.action&&j.action.call(c,j,a),c.emit(fa.e.SELECT_COMPONENT,j))}}else k.isDelete(a)&&c.handleCompsTitleClick(a)},ic.prototype.handleCompsListClick=function(a){var b=this,c=b.findViewById("compsList"),d=b.findViewById("compsTitle"),e=c.getDataAt(a);if(e){var f=e.a("item");f.items?(c.switchToItem(f),d.text=e.name):(f.action&&f.action.call(b,f,a),b.emit(fa.e.SELECT_COMPONENT,f))}},b.defineProperties(ic.prototype,{preferredSize:{get:function(){return{width:212,height:252}}},items:{get:function(){return this.findViewById("compsList").items},set:function(a){var b=this.findViewById("compsList");b.items=a}}}),ic.prototype.calculateClientWidth=function(){return this.width-2},ic.prototype.calculateClientHeight=function(){return this.height-2};var jc=m("qc.editor.AddComponentButton",qc.widget.Button,function He(a){var b=this;He["super"].constructor.call(b,a),b._bindingHandleDocumentMousedown=b.handleDocumentMousedown.bind(b),b._bindingHandleEscKey=b.handleEscKey.bind(b),b._bindingRemovePopPanel=function(){b.removePopPanel()},b.text=fa._("Add Component"),b.disableToolTip(),b.on("click",b.handleClick,b)});jc.prototype.handleEscKey=function(a){if(27===a.keyCode){var b=this,c=b._componentsPanel;c&&c.isInDOM()&&b.removePopPanel()}},jc.prototype.handleClick=function(){var a=this,b=a.view.getBoundingClientRect(),c=a._componentsPanel;if(c||(c=a._componentsPanel=new ic,c.on(fa.e.SELECT_COMPONENT,function(b){a.removePopPanel(),a.emit(fa.e.SELECT_COMPONENT,b)})),c.isInDOM())a.removePopPanel();else{var d=c.preferredSize,e=qc.widget.Default.getWindowInfo(),f=(d.width,d.height),g=b.left,h=b.top+b.height;h+f>e.height&&(h=h-f-b.height),c.addToDOM({x:g,y:h,width:a.width,height:f}),c.items=this.items,c.findViewById("filter").input.focus(),document.addEventListener("mousedown",a._bindingHandleDocumentMousedown),document.addEventListener("keydown",a._bindingHandleEscKey),fa.e.on(fa.e.JS_CHANGED,a._bindingRemovePopPanel)}},jc.prototype.handleDocumentMousedown=function(a){var b=this,c=b._componentsPanel,d=a.target;c.view.contains(d)||b.view.contains(d)||b.removePopPanel()},jc.prototype.removePopPanel=function(){var a=this._componentsPanel;a.dispose(),delete this._componentsPanel,document.removeEventListener("mousedown",this._bindingHandleDocumentMousedown),document.removeEventListener("keydown",this._bindingHandleEscKey),fa.e.off(fa.e.JS_CHANGED,this._bindingRemovePopPanel)},jc.prototype._findItemByLabel=function(a,b){if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d.label===b)return d}},jc.prototype.addItem=function(a,b,c){for(var d=this,e=a.split("/"),f=d,g=f.items,h=0;h<e.length;h++){var i=e[h];if(g||(g=f.items=[]),f=d._findItemByLabel(g,i),!f){if(h===e.length-1){if(f={label:i,action:b},c)for(var j in c)f[j]=c[j]}else f={label:i};g.push(f)}g=f.items}d.epc("items",null,d.items)},jc.prototype.dispose=function(){},b.defineProperties(jc.prototype,{items:{get:function(){return this._items},set:function(a){this.setPropertyValue("items",a)}}});var kc={width:32,height:32,comps:{func:function(a,b){var c=[],d={type:"border",rect:[17,1,1],relative:!0,borderWidth:1,borderColor:"rgb(159, 159, 159)"},e={type:"border",rect:{func:function(a,b){var c=[.25,.25,.5,.5];if(b instanceof oc&&b.altDown){var d=a.id;/left/i.test(d)?c[0]=0:/right/i.test(d)?c[0]=.5:/hStretch/i.test(d)&&(c[0]=0,c[2]=1),/top/i.test(d)?c[1]=0:/bottom/i.test(d)?c[1]=.5:/vStretch/i.test(d)&&(c[1]=0,c[3]=1)}return c}},relative:!0,borderWidth:1,borderColor:"rgb(97, 97, 97)"},f={type:"rect",rect:[0,0,1,32],background:"rgb(200, 84, 84)",borderWidth:0,gradient:""},g={type:"rect",rect:[15.5,0,1,32],background:"rgb(200, 84, 84)",borderWidth:0,gradient:""},h={type:"rect",rect:[31,0,1,32],background:"rgb(200, 84, 84)",borderWidth:0,gradient:""},i={type:"rect",rect:[0,0,32,1],background:"rgb(200, 84, 84)",borderWidth:0,gradient:""},j={type:"rect",rect:[0,15.5,32,1],background:"rgb(200, 84, 84)",borderWidth:0,gradient:""},k={type:"rect",rect:[0,31,32,1],background:"rgb(200, 84, 84)",borderWidth:0,gradient:""},l=[{type:"shape",points:{func:function(a,b){var c=[12,13,9,16,12,19,20,13,23,16,20,19];if(b instanceof oc&&b.altDown){var d=a.id;/hStretch/i.test(d)&&(c[0]=c[0]-8,c[2]=c[2]-8,c[4]=c[4]-8,c[6]=c[6]+8,c[8]=c[8]+8,c[10]=c[10]+8,/top/i.test(d)?(c[1]=c[1]-8,c[3]=c[3]-8,c[5]=c[5]-8,c[7]=c[7]-8,c[9]=c[9]-8,c[11]=c[11]-8):/bottom/i.test(d)&&(c[1]=c[1]+8,c[3]=c[3]+8,c[5]=c[5]+8,c[7]=c[7]+8,c[9]=c[9]+8,c[11]=c[11]+8))}return c}},segments:[1,2,2,5,1,2,2,5],background:"rgb(0, 153, 204)"},{type:"rect",rect:{func:function(a,b){var c=[8,15.5,16,1];if(b instanceof oc&&b.altDown){var d=a.id;/hStretch/i.test(d)&&(c[0]=0,c[2]=32,/top/i.test(d)?c[1]-=8:/bottom/i.test(d)&&(c[1]+=8))}return c}},background:"rgb(0, 153, 204)"}],m=[{type:"shape",points:{func:function(a,b){var c=[13,12,16,9,19,12,13,20,16,23,19,20];if(b instanceof oc&&b.altDown){var d=a.id;/vStretch/i.test(d)&&(c[1]=c[1]-8,c[3]=c[3]-8,c[5]=c[5]-8,c[7]=c[7]+8,c[9]=c[9]+8,c[11]=c[11]+8,/left/i.test(d)?(c[0]=c[0]-8,c[2]=c[2]-8,c[4]=c[4]-8,c[6]=c[6]-8,c[8]=c[8]-8,c[10]=c[10]-8):/right/i.test(d)&&(c[0]=c[0]+8,c[2]=c[2]+8,c[4]=c[4]+8,c[6]=c[6]+8,c[8]=c[8]+8,c[10]=c[10]+8))}return c}},segments:[1,2,2,5,1,2,2,5],background:"rgb(0, 153, 204)"},{type:"rect",rect:{func:function(a,b){var c=[15.5,8,1,16];if(b instanceof oc&&b.altDown){var d=a.id;/vStretch/i.test(d)&&(c[1]=0,c[3]=32,/left/i.test(d)?c[0]-=8:/right/i.test(d)&&(c[0]+=8))}return c}},background:"rgb(0, 153, 204)"}],n={type:"circle",rect:{func:function(a,b){var c=[0,0,0,0],d=a.id;return/custom/i.test(d)?void 0:(b.shiftDown&&(c=[14,14,4,4]),/left/i.test(d)?(c[0]-=7,b.altDown&&(c[0]-=8)):/right/i.test(d)&&(c[0]+=7,b.altDown&&(c[0]+=8)),/top/i.test(d)?(c[1]-=7,b.altDown&&(c[1]-=8)):/bottom/i.test(d)&&(c[1]+=7,b.altDown&&(c[1]+=8)),c)}},background:"rgb(0, 153, 204)"},o={type:"rect",rect:{func:function(a,b){var c;return c=b instanceof mc?b._strValue:a.id,/leftTop/i.test(c)?[-1.5,-1.5,4,4]:/centerTop/i.test(c)?[14,-1.5,4,4]:/rightTop/i.test(c)?[29.5,-1.5,4,4]:/hStretch/i.test(c)?[0,0,0,0]:/leftMiddle/i.test(c)?[-1.5,14,4,4]:/centerMiddle/i.test(c)?[14,14,4,4]:/rightMiddle/i.test(c)?[29.5,14,4,4]:/leftBottom/i.test(c)?[-1.5,29.5,4,4]:/centerBottom/i.test(c)?[14,29.5,4,4]:/rightBottom/i.test(c)?[29.5,29.5,4,4]:void 0}},background:"rgb(153, 102, 0)",borderWidth:0,gradient:""},p=[{type:"rect",rect:{func:function(a,b){var c;return c=b instanceof mc?b._strValue:a.id,/top/i.test(c)?[31,-1.5,2,4]:/middle/i.test(c)?[31,14,2,4]:/bottom/i.test(c)?[31,29.5,2,4]:/left/i.test(c)?[-1.5,31,4,2]:/center/i.test(c)?[14,31,4,2]:/right/i.test(c)?[29.5,31,4,2]:void 0}},background:"rgb(153, 102, 0)",borderWidth:0,gradient:""},{type:"rect",rect:{func:function(){return/top/i.test(s)?[-1,-1.5,2,4]:/middle/i.test(s)?[-1,14,2,4]:/bottom/i.test(s)?[-1,29.5,2,4]:/left/i.test(s)?[-1.5,-1,4,2]:/center/i.test(s)?[14,-1,4,2]:/right/i.test(s)?[29.5,-1,4,2]:void 0}},background:"rgb(153, 102, 0)",borderWidth:0,gradient:""}],q=[],r=[[-1,-1,2,2],[31,31,2,2],[31,-1,2,2],[-1,31,2,2]];r.forEach(function(a){q.push({type:"rect",rect:a,background:"rgb(153, 102, 0)",borderWidth:0,gradient:""})}),c.push(d),c.push(e);var s;return s=b instanceof mc?b._strValue:a.id,/left/i.test(s)&&c.push(f),/center/i.test(s)&&c.push(g),/right/i.test(s)&&c.push(h),/top/i.test(s)&&c.push(i),/middle/i.test(s)&&c.push(j),/bottom/i.test(s)&&c.push(k),/hStretch/i.test(s)&&(c=c.concat(l)),/vStretch/i.test(s)&&(c=c.concat(m)),/content/i.test(s)&&(/hStretch/i.test(s)&&/vStretch/i.test(s)?c=c.concat(q):/hStretch/i.test(s)||/vStretch/i.test(s)?c=c.concat(p):c.push(o),c.push(n)),c}}},lc={width:60,height:60,comps:[{type:"text",rect:[10,0,50,10],text:{func:function(a,b){var c=b._strValue;if(c)for(var d=["left","right","center","hStretch"],e=0;e<d.length;e++){var f=d[e];if(c.indexOf(f)>=0)return"hStretch"===f?"stretch":f}return"custom"}},align:"top",color:{func:function(a,b){return b._labelColor}},font:"10px Arial"},{type:"text",rect:[0,10,10,50],text:{func:function(a,b){var c=b._strValue;if(c)for(var d=["top","bottom","middle","vStretch"],e=0;e<d.length;e++){var f=d[e],g=f;if(/custom/i.test(c)||(g=g.substr(0,1).toUpperCase()+g.substr(1)),c.indexOf(g)>=0)return"vStretch"===f?"stretch":f}return"custom"}},rotation:-Math.PI/2,align:"top",color:{func:function(a,b){return b._labelColor}},font:"10px Arial"},{type:"rect",rect:[10,10,50,50],background:{func:function(a,b){return b._imageBackground}}},{type:"border",rect:[10,10,50,50],borderWidth:1,borderColor:"rgb(129, 129, 129)"},{type:"image",name:kc,rect:[10,10,50,50]}]},mc=m("qc.editor.AnchorButton",qc.widget.Button,function Ie(a){var b=this;Ie["super"].constructor.call(b,a),b.on("click",b.handleClick,b),b._bindingHandleDocumentMousedown=b.handleDocumentMousedown.bind(b),b._bindingHandleDocumentKeydown=b.handleDocumentKeydown.bind(b),b._bindingRemovePopPanel=function(){b.removePopPanel()},b.disableToolTip();var c="rgba(0, 0, 0, 0)";b.background=c,b.gradientColor=c,b.hoverBackground=c,b.hoverGradientColor=c,b.activeBackground=c,b.activeGradientColor=c,b.preferredSize={width:60,height:60},b.iconWidth=60,b.iconHeight=60,b.borderWidth=0,b.on("propertyChange",function(a){"value"===a.property&&b.onValueChanged&&b.onValueChanged(a.newValue)})});mc.prototype.isSameAnchor=function(a,b){if(a===b)return!0;if(a&&b){var c="",d="";for(var e in a)c+=e+a[e];for(var e in b)d+=e+b[e];return c===d}},b.defineProperties(mc.prototype,{strValueMap:{get:function(){return{leftTop:[0,0,0,0],centerTop:[.5,0,.5,0],rightTop:[1,0,1,0],hStretchTop:[0,0,1,0],leftMiddle:[0,.5,0,.5],centerMiddle:[.5,.5,.5,.5],rightMiddle:[1,.5,1,.5],hStretchMiddle:[0,.5,1,.5],leftBottom:[0,1,0,1],centerBottom:[.5,1,.5,1],rightBottom:[1,1,1,1],hStretchBottom:[0,1,1,1],leftVStretch:[0,0,0,1],centerVStretch:[.5,0,.5,1],rightVStretch:[1,0,1,1],hStretchVStretch:[0,0,1,1]}}},icon:{get:function(){return lc}},value:{get:function(){return this._value},set:function(a){var b=this.value;this.isSameAnchor(b,a)||(this._strValue=this.valueToStr(a),this.setPropertyValue("value",a))}}}),mc.prototype.valueToStr=function(a){if(a){var c;c=Array.isArray(a)?a:[a.minAnchorX,a.minAnchorY,a.maxAnchorX,a.maxAnchorY];for(var d=this.strValueMap,e=b.keys(d),f=0;f<e.length;f++){var g=e[f];if(d[g].join()===c.join())return g}return 0===a.minAnchorX&&0===a.maxAnchorX?"leftCustom":.5===a.minAnchorX&&.5===a.maxAnchorX?"centerCustom":1===a.minAnchorX&&1===a.maxAnchorX?"rightCustom":0===a.minAnchorX&&1===a.maxAnchorX?"hStretchCustom":0===a.minAnchorY&&0===a.maxAnchorY?"topCustom":.5===a.minAnchorY&&.5===a.maxAnchorY?"middleCustom":1===a.minAnchorY&&1===a.maxAnchorY?"bottomCustom":0===a.minAnchorY&&1===a.maxAnchorY?"vStretchCustom":"custom"}},mc.prototype.strToValue=function(a,b){var c=this.strValueMap[a];return c?c:b?(b={minAnchorX:b.minAnchorX,minAnchorY:b.minAnchorY,maxAnchorX:b.maxAnchorX,maxAnchorY:b.maxAnchorY},"leftCustom"===a?(b.minAnchorX=0,b.maxAnchorX=0):"centerCustom"===a?(b.minAnchorX=.5,b.maxAnchorX=.5):"rightCustom"===a?(b.minAnchorX=1,b.maxAnchorX=1):"hStretchCustom"===a?(b.minAnchorX=0,b.maxAnchorX=1):"topCustom"===a?(b.minAnchorY=0,b.maxAnchorY=0):"middleCustom"===a?(b.minAnchorY=.5,b.maxAnchorY=.5):"bottomCustom"===a?(b.minAnchorY=1,b.maxAnchorY=1):"vStretchCustom"===a&&(b.minAnchorY=0,b.maxAnchorY=1),[b.minAnchorX,b.minAnchorY,b.maxAnchorX,b.maxAnchorY]):void 0},mc.prototype.handleClick=function(){var a=this,b=a.view.getBoundingClientRect(),c=a._anchorPresetsPanel;if(c||(c=a._anchorPresetsPanel=new oc,c.on("propertyChange",a.handleAnchorPresetsPanelPropertyChange,a)),c.isInDOM())a.removePopPanel();else{var d=c.preferredSize,e={x:b.left+10,y:b.top+b.height,width:d.width,height:d.height},f=k.getWindowInfo();e.x+e.width>f.width&&(e.x=f.width-e.width),e.y+e.height>f.height&&(e.y=f.height-e.height),c.addToDOM(e),c.value=this._strValue,c.requestFocus(),c.on("doubleClick",a._bindingRemovePopPanel),document.addEventListener("mousedown",a._bindingHandleDocumentMousedown),document.addEventListener("keydown",a._bindingHandleDocumentKeydown),fa.e.on(fa.e.JS_CHANGED,a._bindingRemovePopPanel),a.onPopPanelShown&&a.onPopPanelShown()}},mc.prototype.handleDocumentKeydown=function(a){var b=this,c=b._anchorPresetsPanel;c&&F(a)&&b.removePopPanel()},mc.prototype.handleDocumentMousedown=function(a){var b=this,c=b._anchorPresetsPanel,d=a.target;c.view.contains(d)||b.view.contains(d)||b.removePopPanel()},mc.prototype.removePopPanel=function(){var a=this._anchorPresetsPanel;a.off("propertyChange",this.handleAnchorPresetsPanelPropertyChange,this),a.dispose(),delete this._anchorPresetsPanel,document.removeEventListener("mousedown",this._bindingHandleDocumentMousedown),document.removeEventListener("keydown",this._bindingHandleDocumentKeydown),fa.e.off(fa.e.JS_CHANGED,this._bindingRemovePopPanel),this.onPopPanelHidden&&this.onPopPanelHidden()},mc.prototype.handleAnchorPresetsPanelPropertyChange=function(a){if("value"===a.property){var b,c,d=a.newValue;/altDown/.test(d)&&(d=d.replace(":altDown",""),b=!0),/shiftDown/.test(d)&&(d=d.replace(":shiftDown",""),c=!0);var e=this.strToValue(d,this._value),f={minAnchorX:e[0],minAnchorY:e[1],maxAnchorX:e[2],maxAnchorY:e[3]};b&&(f.position=d),c&&(f.pivot=d),
this.value=f}};var nc=m("qc.editor.AnchorPresetsViewInteractor",null,function Je(a){var b=this;b._view=a,Je["super"].constructor.call(b,a),b.addListeners()},{handle_mousewheel:function(a){Y(a)},handle_DOMMouseScroll:function(a){Y(a)}},{interactor:!0},{view:{get:function(){return this._view}}}),oc=m("qc.editor.AnchorPresetsView",qc.widget.graph.GraphView,function Ke(a){var b=this;Ke["super"].constructor.call(b,a),b.interactors=[],b.scrollBarMode="off",b.loadDataModel(),b.view.addEventListener("mousedown",function(a){Y(a)}),b.view.addEventListener("click",b.handleClick.bind(b)),b.forEach(function(a){a.s("select.color","white"),a.s("select.padding",4)}),b.addEventListener("keydown",b.handleKeyEvent.bind(b)),b.addEventListener("keyup",b.handleKeyEvent.bind(b)),b.addBottomPainter(function(a){a.beginPath(),a.rect(0,0,b.width,b.height),a.fillStyle=b._background,a.fill()});var c=b.validateImpl;b.validateImpl=function(){b.view.style.border="1px solid "+b._borderColor,c.call(b)},new nc(b)});oc.prototype.handleKeyEvent=function(a){var b=this;b.altDown=a.altKey?!0:!1,b.shiftDown=a.shiftKey?!0:!1},oc.prototype.invalidateData=function(a){this._redrawAll=1,qc.widget.graph.GraphView.prototype.invalidateData.call(this,a)},oc.prototype.handleClick=function(a){var b=this;if(k.isDoubleClick(a))b.emit("doubleClick");else{for(var c,d=b.dataModel,e=d._datas,f=b.lp(a),g=0;g<e.length;g++){var h=e[g],i=h.id;if(i&&v(h.rect,f)){c=h;break}}c&&b.handleDataClick(c)}},oc.prototype.handleDataClick=function(a){var b=this,c=b.dataModel,d=c.getDataById("customContent");if(a&&a!==d){var e,f=a.category;if(/header/i.test(f)){b.selectHeader(a);var g,h,i=b.selectedColumnHeader,j=b.selectedRowHeader;i&&(g=i.id.replace(/header/i,"")),j&&(h=j.id.replace(/header/i,"")),i&&j?(h=h.substr(0,1).toUpperCase()+h.substr(1),e=g+h):i?e=g+"Custom":j&&(e=h+"Custom")}else"content"===a.category&&(e=a.id.replace(/content/i,""));e&&(b.altDown&&(e+=":altDown"),b.shiftDown&&(e+=":shiftDown"),b.value=e)}},oc.prototype.selectHeader=function(a){var b=this,c=b.dataModel,d=c.selectionModel,e=d.selection,f=a.category;if(e&&e.length>0)if("columnHeader"===f)for(var g=0;g<e.length;g++){var h=e[g];"columnHeader"===h.category&&d.removeSelection(h)}else if("rowHeader"===f&&e.length>=1)for(var g=0;g<e.length;g++){var h=e[g];"rowHeader"===h.category&&d.removeSelection(h)}d.appendSelection(a)},oc.prototype.handleValueChange=function(a){var b=this,c=b.dataModel,d=c.selectionModel,e=c.getDataById("customContent");if(d.clearSelection(),/custom/i.test(a))e.s("visible",!0),e.s("label.visible",!0),e.s("label2.visible",!0),d.selection=e,["left","right","center","hStretch"].forEach(function(b){0===a.indexOf(b)&&(f=b,d.appendSelection(c.getDataById(b+"Header")),e.s("label.visible",!1))}),["top","middle","bottom","vStretch"].forEach(function(b){0===a.indexOf(b)&&(d.appendSelection(c.getDataById(b+"Header")),e.s("label2.visible",!1))});else{e.s("visible",!1),a=a.replace(":altDown",""),a=a.replace(":shiftDown",""),d.selection=c.getDataById(a+"Content");var f;["left","right","center","hStretch"].forEach(function(b){0===a.indexOf(b)&&(f=b,d.appendSelection(c.getDataById(b+"Header")))}),["Top","Middle","Bottom","VStretch"].forEach(function(b){a.indexOf(b)>0&&(b=b.substr(0,1).toLowerCase()+b.substr(1),d.appendSelection(c.getDataById(b+"Header")))})}},b.defineProperties(oc.prototype,{altDown:{get:function(){return this._altDown},set:function(a){this.setPropertyValue("altDown",a)}},shiftDown:{get:function(){return this._shiftDown},set:function(a){this.setPropertyValue("shiftDown",a)}},preferredSize:{get:function(){return{width:262,height:302}}},selectedColumnHeader:{get:function(){var a=this.dataModel.selectionModel.selection;if(a)for(var b=0;b<a.length;b++){var c=a[b];if("columnHeader"===c.category)return c}}},selectedRowHeader:{get:function(){var a=this.dataModel.selectionModel.selection;if(a)for(var b=0;b<a.length;b++){var c=a[b];if("rowHeader"===c.category)return c}}},customed:{get:function(){var a=this.dataModel.getDataById("customContent");return this.isSelected(a)}},value:{get:function(){return this._value},set:function(a){var b=this,c=b.orientation;b.setPropertyValue("value",a),c!==a&&b.handleValueChange(a)}}}),oc.prototype.loadDataModel=function(){var a=this,b=new qc.widget.graph.Node;a.dataModel.add(b),b.setAnchor(0,0),b.setPosition(0,0),b.image={width:260,height:36,comps:[{type:"rect",rect:[0,0,260,36],background:{func:function(a,b){return b._titleBackground}},borderWidth:0,gradient:""},{type:"text",text:"Anchor Presets",color:{func:function(a,b){return b._labelColor}},align:"center",font:"bold 11px Arial",rect:[0,3,107,12]},{type:"text",text:"Shift: Also set pivot",color:{func:function(a,b){return b._labelColor}},align:"center",font:"10px Arial",rect:[0,21,107,7]},{type:"text",text:"Alt: Also set position",color:{func:function(a,b){return b._labelColor}},align:"center",font:"11px Arial",rect:[115,21,107,7]},{type:"rect",background:{func:function(a,b){return b._borderColor}},rect:[0,35,260,1]}]};var c=new qc.widget.graph.Node;c.image={width:10,height:10,comps:[{type:"rect",background:{func:function(a,b){return b._borderColor}},rect:[17,1,1],relative:!0}]},c.setAnchor(0,0),c.setPosition(0,97),c.setSize(260,1),a.dataModel.add(c);var d=new qc.widget.graph.Node;d.image={width:10,height:10,comps:[{type:"rect",background:{func:function(a,b){return b._borderColor}},rect:[17,1,1],relative:!0}]},d.setAnchor(0,0),d.setPosition(61,36),d.setSize(1,264),a.dataModel.add(d);var e=new qc.widget.graph.Node;e.image={width:100,height:100,comps:[{type:"rect",rect:[17,1,1],relative:!0,background:{func:function(a,b){return b._titleBackground}}}]},e.setAnchor(1,1),e.setPosition(260,300),e.setSize(198,202),a.dataModel.add(e);var f=new qc.widget.graph.Node;f.setAnchor(0,0),f.setPosition(21,58),f.image=kc,f.s("label","custom"),f.s("label.font","10px Arial"),f.s("label.position",3),f.s("label.offset.y",-3),f.s("label2","custom"),f.s("label2.font","10px Arial"),f.s("label2.position",14),f.s("label2.offset.x",6),f.s("label2.rotation",-Math.PI/2),f.id="customContent",f.category="content",a.dataModel.add(f);var g=new qc.widget.graph.Node;g.name="left",g.s("label.font","10px Arial"),g.s("label.position",3),g.s("label.offset.y",-3),g.setAnchor(0,0),g.setPosition(78,58),g.image=kc,g.id="leftHeader",g.category="columnHeader",a.dataModel.add(g);var h=new qc.widget.graph.Node;h.name="center",h.s("label.font","10px Arial"),h.s("label.position",3),h.s("label.offset.y",-3),h.setAnchor(0,0),h.setPosition(121,58),h.id="centerHeader",h.category="columnHeader",h.image=kc,a.dataModel.add(h);var i=new qc.widget.graph.Node;i.name="right",i.s("label.font","10px Arial"),i.s("label.position",3),i.s("label.offset.y",-3),i.setAnchor(0,0),i.id="rightHeader",i.category="columnHeader",i.setPosition(164,58),i.image=kc,a.dataModel.add(i);var j=new qc.widget.graph.Node;j.name="stretch",j.s("label.font","10px Arial"),j.s("label.position",3),j.s("label.offset.y",-3),j.setAnchor(0,0),j.setPosition(222,58),j.image=kc,j.id="hStretchHeader",j.category="columnHeader",a.dataModel.add(j);var k=new qc.widget.graph.Node;k.name="top",k.s("label.font","10px Arial"),k.s("label.position",14),k.s("label.offset.x",-3),k.s("label.rotation",-Math.PI/2),k.setAnchor(0,0),k.setPosition(21,116),k.image=kc,k.id="topHeader",k.category="rowHeader",a.dataModel.add(k);var l=new qc.widget.graph.Node;l.name="middle",l.s("label.font","10px Arial"),l.s("label.position",14),l.s("label.offset.x",6),l.s("label.rotation",-Math.PI/2),l.setAnchor(0,0),l.setPosition(21,159),l.image=kc,l.id="middleHeader",l.category="rowHeader",a.dataModel.add(l);var m=new qc.widget.graph.Node;m.name="bottom",m.s("label.font","10px Arial"),m.s("label.position",14),m.s("label.offset.x",6),m.s("label.rotation",-Math.PI/2),m.setAnchor(0,0),m.setPosition(21,202),m.image=kc,m.id="bottomHeader",m.category="rowHeader",a.dataModel.add(m);var n=new qc.widget.graph.Node;n.name="stretch",n.s("label.font","10px Arial"),n.s("label.position",14),n.s("label.offset.x",6),n.s("label.rotation",-Math.PI/2),n.setAnchor(0,0),n.setPosition(21,260),n.image=kc,n.id="vStretchHeader",n.category="rowHeader",a.dataModel.add(n);var o=new qc.widget.graph.Node;o.setAnchor(0,0),o.setPosition(78,116),o.image=kc,o.id="leftTopContent",o.category="content",a.dataModel.add(o);var p=new qc.widget.graph.Node;p.setAnchor(0,0),p.setPosition(121,116),p.image=kc,p.id="centerTopContent",p.category="content",a.dataModel.add(p);var q=new qc.widget.graph.Node;q.setAnchor(0,0),q.setPosition(164,116),q.image=kc,q.id="rightTopContent",q.category="content",a.dataModel.add(q);var r=new qc.widget.graph.Node;r.setAnchor(0,0),r.setPosition(222,116),r.image=kc,r.id="hStretchTopContent",r.category="content",a.dataModel.add(r);var s=new qc.widget.graph.Node;s.setAnchor(0,0),s.setPosition(78,159),s.image=kc,s.id="leftMiddleContent",s.category="content",a.dataModel.add(s);var t=new qc.widget.graph.Node;t.setAnchor(0,0),t.setPosition(121,159),t.image=kc,t.id="centerMiddleContent",t.category="content",a.dataModel.add(t);var u=new qc.widget.graph.Node;u.setAnchor(0,0),u.setPosition(164,159),u.image=kc,u.id="rightMiddleContent",u.category="content",a.dataModel.add(u);var v=new qc.widget.graph.Node;v.setAnchor(0,0),v.setPosition(222,159),v.image=kc,v.id="hStretchMiddleContent",v.category="content",a.dataModel.add(v);var w=new qc.widget.graph.Node;w.setAnchor(0,0),w.setPosition(78,202),w.image=kc,w.id="leftBottomContent",w.category="content",a.dataModel.add(w);var x=new qc.widget.graph.Node;x.setAnchor(0,0),x.setPosition(121,202),x.image=kc,x.id="centerBottomContent",x.category="content",a.dataModel.add(x);var y=new qc.widget.graph.Node;y.setAnchor(0,0),y.setPosition(164,202),y.image=kc,y.id="rightBottomContent",y.category="content",a.dataModel.add(y);var z=new qc.widget.graph.Node;z.setAnchor(0,0),z.setPosition(222,202),z.image=kc,z.id="hStretchBottomContent",z.category="content",a.dataModel.add(z);var A=new qc.widget.graph.Node;A.setAnchor(0,0),A.setPosition(78,260),A.image=kc,A.id="leftVStretchContent",A.category="content",a.dataModel.add(A);var B=new qc.widget.graph.Node;B.setAnchor(0,0),B.setPosition(121,260),B.image=kc,B.id="centerVStretchContent",B.category="content",a.dataModel.add(B);var C=new qc.widget.graph.Node;C.setAnchor(0,0),C.setPosition(164,260),C.image=kc,C.id="rightVStretchContent",C.category="content",a.dataModel.add(C);var D=new qc.widget.graph.Node;D.setAnchor(0,0),D.setPosition(222,260),D.image=kc,D.id="hStretchVStretchContent",D.category="content",a.dataModel.add(D)},oc.prototype.calculateClientWidth=function(){return this.width-2},oc.prototype.calculateClientHeight=function(){return this.height-2};var pc=qc.editor.InspectorUtil={};pc.redraw=function(a){fa.inspector.propertyView.inspect(a)},pc.makePropertyName=function(a){for(var b=function(a){return a&&a.substring(0,1).toUpperCase()+a.substring(1)},c=[],d=0,e=!1,f=0;f<a.length;++f)if(a[f]>="0"&&a[f]<="9"){if(!e){var g=a.substring(d,f);c.push(b(g)),d=f,e=!0}}else if(a[f]>="A"&&a[f]<="Z"){if(f===d)continue;var g=a.substring(d,f);c.push(b(g)),d=f,e=!1}else if(e){var g=a.substring(d,f);c.push(b(g)),d=f,e=!1}var g=a.substring(d);return c.push(b(g)),c.join(" ")},pc.drawPrefabInput=function(a,b,c){var d;return _.line([_.text(b),d=_.objectInput({objectType:"prefab",target:a,targetField:c,bind:c})]),d},pc.drawTextureInput=function(a,b,c,d,e){c=c||"texture",b=b||pc.makePropertyName(c);var f;if("object"==typeof b){var g=b.toolTip;b=b.title}return _.line([_.text(b,{toolTip:g}),f=_.objectInput({objectType:"texture",target:a,targetField:c,bind:c,onValueChanged:d,bindTarget:e})]),f},pc.drawSoundInput=function(a,b,c,d){b=b||"Sound",c=c||"sound";var e;if("object"==typeof b){var f=b.toolTip;b=b.title}return _.line([_.text(b,{toolTip:f}),e=_.objectInput({objectType:"sound",target:a,targetField:c,bind:c,onValueChanged:d})]),e},pc.drawTextAssetInput=function(a,b,c,d){b=b||"Text",c=c||"text";var e;if("object"==typeof b){var f=b.toolTip;b=b.title}return _.line([_.text(b,{toolTip:f}),e=_.objectInput({objectType:"textAsset",target:a,targetField:c,bind:c,onValueChanged:d})]),e},pc.drawExcelAssetInput=function(a,b,c,d){b=b||"Text",c=c||"text";var e;return _.line([_.text(b),e=_.objectInput({objectType:"excelAsset",target:a,targetField:c,bind:c,onValueChanged:d})]),e},pc.drawColorPicker=function(a,b,c,d,e){b=b||"Color",c=c||"colorTint";var f;if("object"==typeof b){var g=b.toolTip;b=b.title}if(d)var h=_.line([_.empty(),_.text(b,{toolTip:g}),f=_.colorPicker({bind:c,"dropDown.colorChooser.alphaEnabled":e===!1?!1:!0})]);else var h=_.line([_.text(b,{toolTip:g}),f=_.colorPicker({bind:c,"dropDown.colorChooser.alphaEnabled":e===!1?!1:!0})]);return f.value=a[c],h},pc.drawNodeRef=function(a,b,c,d,e){if(e=e||pc.makePropertyName(b),"object"==typeof e){var f=e.toolTip;e=e.title}var g=_.objectInput({objectType:"node",target:a,targetField:b,bind:b,nodeType:c});if(d)var h=_.line([_.empty(),_.text(e,{toolTip:f}),g]);else var h=_.line([_.text(e,{toolTip:f}),g]);return h},pc.drawUserDefines=function(a){var b=a.scripts,c=[];for(var d in b){var e=b[d],f=e["class"];if(!pc.builtinScripts()[f]){var g=new qc.editor.UserDefinePanel(e);c.push(g)}}return c},pc.drawBuiltinComponents=function(a){var b=pc.builtinScripts(),c=a.scripts,d=[];return c&&c.length&&c.forEach(function(a){var c=b[a["class"]];c&&d.push(new c(a))}),d},pc.createBuiltinScripts=function(){return{"qc.TransitionBehaviour":xc,"qc.ScaleAdapter":zc,"qc.ToggleGroup":Bc,"qc.NodeMask":Dc,"qc.TableLayout":Sc,"qc.AspectRatioFitter":Uc,"qc.TweenPosition":$c,"qc.TweenRotation":ad,"qc.TweenAlpha":Yc,"qc.TweenScale":bd,"qc.TweenColor":Zc,"qc.TweenProperty":_c,"qc.HorizontalLayout":Qc,"qc.VerticalLayout":Tc,"qc.LayoutElement":Rc,"qc.FilterGroup":Vc,"qc.CacheAsBitmap":rc,"qc.NonexistScript":tc}},pc.builtinScripts=function(){var a=pc._builtinScripts;return a||(a=pc._builtinScripts=pc.createBuiltinScripts()),a},pc.drawPoint=function(a,b,c){var b=b||pc.makePropertyName(c);if("object"==typeof b){var d=b.toolTip;b=b.title}return a[c]||(a[c]=new qc.Point(0,0)),_.line([_.text(b,{align:"left",toolTip:d}),_.text("X",{align:"left"}),_.numberInput({bind:c+".x"}),_.text("Y",{align:"left"}),_.numberInput({bind:c+".y"})])},pc.drawScriptRef=function(a,b){var c,d=b["class"];_.line([_.text("Script",{align:"left"}),c=_.stringInput({readonly:!0})]),c.value=d,c.onValueChanged=function(c){try{a.addScript(c)}catch(d){return console.log(d.stack),void Gb(d.message)}b.destroy(),pc.redraw(a)}},pc.drawAddComponent=function(a,b){if(a instanceof qc.Node){var c=b.getPanelInstance(qc.editor.AddComponentButton,a);c.items=[];var d=pc.builtinScripts();for(var e in d){var f=qc.Util.findClass(e);f&&!f.__hiddenInMenu&&c.addItem(f.__menu?f.__menu:e,null,{icon:"JsIcon",clazz:e})}var g=qc._userScripts;for(var e in g)if(!d[e]){var f=qc.Util.findClass(e);f&&!f.__hiddenInMenu&&c.addItem(f.__menu?f.__menu:"Scripts/"+e,null,{icon:"JsIcon",clazz:e})}c.on(fa.e.SELECT_COMPONENT,function(b){try{fa.inspector.propertyView.emit("addComponent",b.clazz),a.addScript(b.clazz)}catch(c){return console.log(c.stack),void fa.notification.error(fa._("Failed to add component"))}});var h=new qc.widget.Container;return h.layout=new qc.widget.layout.TableLayout(h),h.layout.cellPadding=[5,24,5,24],h.scrollBarMode="off",h.setItems([{height:34,widths:[.1],cells:[{align:"center",element:c}]}]),h.view._dropView=h,h.handleCrossDrag=function(a,b,c){var d=c.view;if(("exit"===b||"cancel"===b)&&(h.ninePatchImage=null),"enter"===b||"over"===b){if(d!==fa.fileList)return;var e=d.draggingData;if(!e.treeData)return;e.name.lastIndexOf(".js")===e.name.length-3&&(h.ninePatchImage="addcomponent_active.9",h.ninePatchBorder=[10,10,10,10])}else if("drop"===b){var f=fa.hierarchy.selectionModel.lastData;if(f&&(f=f.node),"addcomponent_active.9"===h.ninePatchImage&&f){var e=d.draggingData,g=e.treeData.id;qc.editor.Operation.SOURCE(g,function(a){var b=a.source,c=b.match(/qc.defineBehaviour[\(\s]*['"](.*)['"]/);c&&(c=c[1],qc._userScripts[c]&&f&&f.addScript(c)&&(fa.inspector.propertyView.emit("addComponent",c),fa.notification.info(fa._("Script added."))))}),h.ninePatchImage=null}}},h}},pc.drawRectangle=function(a,b){var c,d,e,f,g=_.titleLine(pc.makePropertyName(b)),h=a[b]||new qc.Rectangle(0,0,0,0);g.add(_.line([_.empty(),_.text("Coord"),_.text("X",{align:"right"}),c=_.numberInput(),_.text("Y",{align:"right"}),d=_.numberInput()])),g.add(_.line([_.empty(),_.text("Size"),_.text("W",{align:"right"}),e=_.numberInput(),_.text("H",{align:"right"}),f=_.numberInput()])),c.value=h.x,d.value=h.y,e.value=h.width,f.value=h.height,c.onValueChanged=function(c){c!==h.x&&(h.x=c,a[b]=h)},d.onValueChanged=function(c){c!==h.y&&(h.y=c,a[b]=h)},e.onValueChanged=function(c){c!==h.width&&(h.width=c,a[b]=h)},f.onValueChanged=function(c){c!==h.height&&(h.height=c,a[b]=h)}},pc.drawCircle=function(a,b){var c,d,e,f=a[b]||new qc.Circle(0,0,0),g=_.titleLine(pc.makePropertyName(b));g.add(_.line([_.empty(),_.text("Coord"),_.text("X",{align:"right"}),c=_.numberInput(),_.text("Y",{align:"right"}),d=_.numberInput()])),g.add(_.line([_.empty(),_.text("Radius",{colspan:2}),e=_.numberInput({},{colspan:3})])),c.value=f.x,d.value=f.y,e.value=f.radius,c.onValueChanged=function(c){c!==f.x&&(f.x=c,a[b]=f)},d.onValueChanged=function(c){c!==f.y&&(f.y=c,a[b]=f)},e.onValueChanged=function(c){c!==f.radius&&(f.radius=c,a[b]=f)}},pc.drawEllipse=function(a,b){var c,d,e,f,g=_.titleLine(pc.makePropertyName(b)),h=a[b]||new qc.Ellipse(0,0,0,0);g.add(_.line([_.empty(),_.text("Coord"),_.text("X",{align:"right"}),c=_.numberInput(),_.text("Y",{align:"right"}),d=_.numberInput()])),g.add(_.line([_.empty(),_.text("Size"),_.text("W",{align:"right"}),e=_.numberInput(),_.text("H",{align:"right"}),f=_.numberInput()])),c.value=h.x,d.value=h.y,e.value=h.width,f.value=h.height,c.onValueChanged=function(c){c!==h.x&&(h.x=c,a[b]=h)},d.onValueChanged=function(c){c!==h.y&&(h.y=c,a[b]=h)},e.onValueChanged=function(c){c!==h.width&&(h.width=c,a[b]=h)},f.onValueChanged=function(c){c!==h.height&&(h.height=c,a[b]=h)}},pc.drawArray=function(a,b,c,d,e){var f=b[d]||[];if(c=c||pc.makePropertyName(d),"object"==typeof c){var g=c.toolTip;c=c.title}var h=_.titleLine(c);h.toolTip=g;var i;h.add(_.line([_.text("  Length",{align:"right"}),i=_.intInput()]));var j=f.length;i.value=j,i.input.addEventListener("change",function(){var a=i.value;if(0>a&&(a=0),a!==j){for(var c=[],e=0;a>e;e++)c.push(j>e?f[e]:null);b[d]=c}});for(var k in f)e(k,f[k],h);a._cacheForDetection||(a._cacheForDetection={}),a._cacheForDetection[d]=f.slice(0)},pc.drawGeom=function(a,b,c,d){var e,f=a[c]||new qc.Point(0,0),g=_.titleLine(b);g.add(_.line([_.text("Type",{colspan:2}),e=_.dropDownList({items:["Point","Rectangle","Circle","Ellipse"]},{colspan:3})]));var h="Point";f instanceof qc.Rectangle?h="Rectangle":f instanceof qc.Circle?h="Circle":f instanceof qc.Ellipse&&(h="Ellipse"),e.value=h,e.onValueChanged=function(b){b!==h&&(h=b,"Point"===b?f=new qc.Point(f.x,f.y):"Rectangle"===b?f=new qc.Rectangle(f.x,f.y,0,0):"Circle"===b?f=new qc.Circle(f.x,f.y,0):"Ellipse"===b&&(f=new qc.Ellipse(f.x,f.y,0)),a[c]=f,d.repaint())};var i,j,k,l;"Point"===h?(g.add(_.line([_.empty(),_.text("X",{align:"right"}),i=_.numberInput(),_.text("Y",{align:"right"}),j=_.numberInput()])),i.value=f.x,j.value=f.y,i.onValueChanged=function(b){b!==f.x&&(f.x=b,a[c]=f)},j.onValueChanged=function(b){b!==f.y&&(f.y=b,a[c]=f)}):"Rectangle"===h||"Ellipse"===h?(g.add(_.line([_.text("    Coord"),_.text("X",{align:"right"}),i=_.numberInput(),_.text("Y",{align:"right"}),j=_.numberInput()])),i.value=f.x,j.value=f.y,i.onValueChanged=function(b){b!==f.x&&(f.x=b,a[c]=f)},j.onValueChanged=function(b){b!==f.y&&(f.y=b,a[c]=f)},g.add(_.line([_.text("    Size"),_.text("W",{align:"right"}),k=_.numberInput(),_.text("H",{align:"right"}),l=_.numberInput()])),k.value=f.width,l.value=f.height,k.onValueChanged=function(b){b!==f.width&&(f.width=b,a[c]=f)},l.onValueChanged=function(b){b!==f.height&&(f.height=b,a[c]=f)}):"Circle"===h&&(g.add(_.line([_.text("    Coord"),_.text("X",{align:"right"}),i=_.numberInput(),_.text("Y",{align:"right"}),j=_.numberInput()])),g.add(_.line([_.text("    Radius",{colspan:2}),k=_.numberInput({},{colspan:3})])),i.value=f.x,j.value=f.y,k.value=f.radius,i.onValueChanged=function(b){b!==f.x&&(f.x=b,a[c]=f)},j.onValueChanged=function(b){b!==f.y&&(f.y=b,a[c]=f)},k.onValueChanged=function(b){b!==f.radius&&(f.radius=b,a[c]=f)})},pc.drawTextures=function(a,b,c){var d=a.target,e=function(a,b,e){var f;e.add(_.line([_.text(""+a,{align:"right"}),f=_.objectInput({objectType:"texture",target:d,targetField:c,arrIndex:a})])),f.setTextureObjectValue(b,null)};pc.drawArray(a,d,b,c,e)},pc.drawNodes=function(a,b,c){var d=a.target,e=function(a,b,e){var f;e.add(_.line([_.text(""+a,{align:"right"}),f=_.objectInput({objectType:"node",target:d,targetField:c,arrIndex:a})])),f.setObjectValue(b)};pc.drawArray(a,d,b,c,e)};var rc=m("qc.editor.CacheAsBitmapPanel",qc.editor.Panel,function Le(a){var b=this;Le["super"].constructor.call(b,a),b.title="CacheAsBitmap",b.checkable=!0,b.removable=!0});rc.prototype.onEnable=function(){this.target.enable=!0},rc.prototype.onDisable=function(){this.target.enable=!1},rc.prototype.onRemove=function(){var a=this;a.removeSelf()},rc.prototype.update=function(){var a=this;a.checked=a.target.enable},rc.prototype.paint=function(){this.target;_.columnWidths=["90+0.1","60+0.5"],_.line([_.text("Cache Type",{align:"left",toolTip:fa._("CacheAsBitmap.cacheType")}),_.dropDownList({bind:"cacheType",items:[{label:"Cache For Screen",value:qc.CacheAsBitmap.CACHE_FOR_SCREEN},{label:"Cache For Self",value:qc.CacheAsBitmap.CAHCE_FOR_SELF}]})]),_.line([_.text("Bounds Type",{align:"left",toolTip:fa._("CacheAsBitmap.boundsType")}),_.dropDownList({bind:"boundsType",items:[{label:"Only Self",value:qc.CacheAsBitmap.BOUNDS_SELF},{label:"All Children",value:qc.CacheAsBitmap.BOUNDS_ALL}]})]),_.line([_.text("Bounds In Screen",{toolTip:fa._("CacheAsBitmap.boundsInScreen")}),_.checkBox({bind:"boundsInScreen"})])};var sc=m("qc.editor.NodePanel",qc.editor.Panel,function Me(a){var b=this;Me["super"].constructor.call(b,a),b.title=a["class"],b.checkable=!0,b.removable=!1,b.lockable=!0});sc.prototype.onEnable=function(){this.target.visible=!0,fa.hierarchy.iv()},sc.prototype.onDisable=function(){this.target.visible=!1,fa.hierarchy.iv()},sc.prototype.update=function(){var a=this;a.checked=a.target.visible},sc.prototype.paint=function(){var a=this,b=a.target;if(_.columnWidths=["120+0.1","60+0.5"],_.line([_.text("Name",{toolTip:fa._("CNode.name")}),_.stringInput({bind:"name"})]),b.parent instanceof qc.World&&_.line([_.text("Ignore Destroy",{toolTip:fa._("CNode.ignoreDestroy")}),_.checkBox({bind:"ignoreDestroy"})]),_.line([_.text("Alpha",{toolTip:fa._("CNode.alpha")}),_.stringInput({bind:"alpha"})]),b._prefab){var c;_.line([_.empty(),c=_.button(fa._("Apply Prefab"))]),c.on("click",function(){fa.menu.applyPrefab()})}};var tc=m("qc.editor.NonexistScriptPanel",qc.editor.Panel,function Ne(a){var b=this;Ne["super"].constructor.call(b,a),b.title=b.target.script,b.checkable=!1,b.removable=!0});tc.prototype.onRemove=function(){var a=this;a.removeSelf()},tc.prototype.paint=function(){this.target;_.columnWidths=["90+1"],_.line([_.text("The script is not exist.")])};var uc=m("qc.editor.RectTransformPanel",qc.editor.Panel,function Oe(a){var b=this;Oe["super"].constructor.call(b,a),b.title="Transform",b.icon="inspector_rectTransform",b.checkable=!1,b.removable=!1});uc.prototype.update=function(){var a=this,b=a._anchorButton,d=a.target;b._anchorPresetsPanel||(b.value={minAnchorX:d.minAnchor.x,minAnchorY:d.minAnchor.y,maxAnchorX:d.maxAnchor.x,maxAnchorY:d.maxAnchor.y});var e=document.activeElement;if(a._minAnchorX.view.contains(e)||(a._minAnchorX.value=d.minAnchor.x),a._minAnchorY.view.contains(e)||(a._minAnchorY.value=d.minAnchor.y),a._maxAnchorX.view.contains(e)||(a._maxAnchorX.value=d.maxAnchor.x),a._maxAnchorY.view.contains(e)||(a._maxAnchorY.value=d.maxAnchor.y),a._label1&&(d.minAnchor.x!==d.maxAnchor.x?(a._label1.text="Left",a._label1.toolTip=fa._("CNode.left"),a._input1.bind="left",a._label3.text="Right",a._label3.toolTip=fa._("CNode.right"),a._input3.bind="right"):(a._label1.text="AnchoredX",a._label1.toolTip=fa._("CNode.anchoredX"),a._input1.bind="anchoredX",a._label3.text="Width",a._label3.toolTip=fa._("CNode.width"),a._input3.bind="width"),d.minAnchor.y!==d.maxAnchor.y?(a._label2.text="Top",a._label2.toolTip=fa._("CNode.top"),a._input2.bind="top",a._label4.text="Bottom",a._label4.toolTip=fa._("CNode.bottom"),a._input4.bind="bottom"):(a._label2.text="AnchoredY",a._label2.toolTip=fa._("CNode.anchoredY"),a._input2.bind="anchoredY",a._label4.text="Height",a._label4.toolTip=fa._("CNode.height"),a._input4.bind="height")),a._hitAreaCheckBox){a._hitAreaCheckBox.selected=fa.editHitAreaEnabled;var f=a._hitAreaTypeDropDown;if(f)if(d.phaser.hitArea===c)f.value="Fit Target";else{var g=d.hitArea;f.value=g instanceof qc.Rectangle?"Rectangle":g instanceof qc.Ellipse?"Ellipse":"None"}}},uc.prototype.onAnchorPopPanelShown=function(){var a=this,b=a._anchorButton,c=a.target,d=b._undoValue={minAnchorX:c.minAnchor.x,minAnchorY:c.minAnchor.y,maxAnchorX:c.maxAnchor.x,maxAnchorY:c.maxAnchor.y},e=a.createAnchorUndoFunc;b._undo=e(a.setAnchor,c,d)},uc.prototype.createAnchorUndoFunc=function(a,b,c){return function(){a(b,c)}},uc.prototype.onAnchorPopPanelHidden=function(){var a=this,b=a._anchorButton,c=a.target;if(b._undoValue&&b._undo){var d=b._undoValue,e=b._undo,f={minAnchorX:c.minAnchor.x,minAnchorY:c.minAnchor.y,maxAnchorX:c.maxAnchor.x,maxAnchorY:c.maxAnchor.y};if(d.minAnchorX!==f.minAnchorX||d.minAnchorY!==f.minAnchorY||d.maxAnchorX!==f.maxAnchorX||d.maxAnchorY!==f.maxAnchorY){var g=a.createAnchorUndoFunc,h=g(a.setAnchor,c,f);fa.undo.add(e,h)}}delete b._undo,delete b._undoValue},uc.prototype.paint=function(){var a=this,b=this._anchorButton=new qc.editor.AnchorButton,c=[80,20,"40+0.1",20,"40+0.1"];_.columnWidths=c,a.drawNormalAnchor(b),b.onValueChanged=function(b){fa.inspector._updating||a.setAnchor(a.target,b)},b.onPopPanelHidden=function(){a.onAnchorPopPanelHidden()},b.onPopPanelShown=function(){a.onAnchorPopPanelShown()},_.columnWidths=[a.indent,80-a.indent,20,"40+0.1",20,"40+0.1"];var d,e,f,g,h=_.titleLine("Anchors",!0);h.add(_.line([_.empty(),_.text("Min",{toolTip:fa._("CNode.minAnchor")}),_.text("X",{"for":"rt_minAnchorX",dragStep:.01,align:"center"}),d=a._minAnchorX=_.numberInput({id:"rt_minAnchorX",precision:5,max:1,min:0}),_.text("Y",{"for":"rt_minAnchorY",dragStep:.01,align:"center"}),e=a._minAnchorY=_.numberInput({id:"rt_minAnchorY",precision:5,max:1,min:0})])),h.add(_.line([_.empty(),_.text("Max",{toolTip:fa._("CNode.maxAnchor")}),_.text("X",{"for":"rt_maxAnchorX",dragStep:.01,align:"center"}),f=a._maxAnchorX=_.numberInput({id:"rt_maxAnchorX",precision:5,max:1,min:0}),_.text("Y",{"for":"rt_maxAnchorY",dragStep:.01,align:"center"}),g=a._maxAnchorY=_.numberInput({id:"rt_maxAnchorY",precision:5,max:1,min:0})])),d.onValueChanged=function(b){if(!fa.inspector._updating&&"number"==typeof b&&!isNaN(b)){var c=a.target;a.setTargetProperty(c,"minAnchor.x",b),c._calcAnchoredX(),c._calcAnchoredY(),c._calcMargin()}},e.onValueChanged=function(b){if(!fa.inspector._updating&&"number"==typeof b&&!isNaN(b)){var c=a.target;a.setTargetProperty(c,"minAnchor.y",b),c._calcAnchoredX(),c._calcAnchoredY(),c._calcMargin()}},f.onValueChanged=function(b){if(!fa.inspector._updating&&"number"==typeof b&&!isNaN(b)){var c=a.target;a.setTargetProperty(c,"maxAnchor.x",b),c._calcAnchoredX(),c._calcAnchoredY(),c._calcMargin()}},g.onValueChanged=function(b){if(!fa.inspector._updating&&"number"==typeof b&&!isNaN(b)){var c=a.target;a.setTargetProperty(c,"maxAnchor.y",b),c._calcAnchoredX(),c._calcAnchoredY(),c._calcMargin()}},_.columnWidths=c,_.line([_.text("Pivot"),_.text("X",{"for":"rt_pivotx",dragStep:.01,align:"center",toolTip:fa._("CNode.pivotX")}),_.numberInput({bind:"pivotX",id:"rt_pivotx"}),_.text("Y",{"for":"rt_pivoty",dragStep:.01,align:"center",toolTip:fa._("CNode.pivotY")}),_.numberInput({bind:"pivotY",id:"rt_pivoty"})]),_.line([_.text("Scale"),_.text("X",{"for":"rt_scaleX",dragStep:.01,align:"center",toolTip:fa._("CNode.scaleX")}),_.numberInput({bind:"scaleX",id:"rt_scaleX"}),_.text("Y",{"for":"rt_scaleY",dragStep:.01,align:"center",toolTip:fa._("CNode.scaleY")}),_.numberInput({bind:"scaleY",id:"rt_scaleY"})]),_.line([_.text("Rotation",{toolTip:fa._("CNode.rotation")}),_.text("R",{"for":"rt_rotation",dragStep:1,align:"center"}),_.angleInput({id:"rt_rotation",bind:"rotation"},{colspan:3})]),this.drawHitArea()},uc.prototype.drawHitArea=function(){var a,b,d=this,e=this.target;_.columnWidths=[d.indent,80,20,"40+0.1",20,"40+0.1"],_.line([_.divider(null,{colspan:6})]);var f=_.titleLine("Hit Area"),g=e.interactive;f.add(_.line([_.empty(),_.text("Interactive",{toolTip:fa._("CNode.interactive")}),d._interactive=_.checkBox({bind:"interactive"},{colspan:4})])),d._interactive.onValueChanged=function(a){a!==g&&(g=a,d.repaint())},g&&(f.add(_.line([_.empty(),_.text("Editable"),a=d._hitAreaCheckBox=_.checkBox(null,{colspan:4})])),a.onValueChanged=function(a){fa.editHitAreaEnabled=a},f.add(_.line([_.empty(),_.text("Type"),b=d._hitAreaTypeDropDown=_.dropDownList({items:["None","Fit Target","Rectangle","Ellipse"]},{colspan:4})])),b.onValueChanged=function(a){if(!fa.inspector._updating){var b=e.hitArea||e.rect,d=[];if(b&&(d=[b.x,b.y,b.width,b.height]),"None"===a)e.hitArea=null;else if("Fit Target"===a)e.hitArea=c;else if("Rectangle"===a){var f=new qc.Rectangle(d[0],d[1],d[2],d[3]);e.hitArea=f}else if("Ellipse"===a){var g=new qc.Ellipse(d[0],d[1],d[2],d[3]);e.hitArea=g}}},f.add(_.line([_.empty(),_.text("Coord"),_.text("X",{"for":"rt_hitareax"}),_.numberInput({bind:"hitArea.x",id:"rt_hitareax"}),_.text("Y",{"for":"rt_hitareay"}),_.numberInput({bind:"hitArea.y",id:"rt_hitareay"})])),f.add(_.line([_.empty(),_.text("Size"),_.text("W",{"for":"rt_hitareaw"}),_.numberInput({bind:"hitArea.width",id:"rt_hitareaw"}),_.text("H",{"for":"rt_hitareah"}),_.numberInput({bind:"hitArea.height",id:"rt_hitareah"})])))},uc.prototype.drawNormalAnchor=function(a){var b=this;_.line([_.comp(a,null,{rowspan:4,fill:"none",vAlign:"middle",cellPadding:[1,1,1,6]}),b._label1=_.text("Left",{"for":"rt_left",dragStep:.1},{colspan:2,fill:"none",align:"left"}),b._label2=_.text("Top",{"for":"rt_top",dragStep:.1},{colspan:2,fill:"none",align:"left"})]),_.line([b._input1=_.numberInput({bind:"left",id:"rt_left"},{colspan:2,cellPadding:null}),b._input2=_.numberInput({bind:"top",id:"rt_top"},{colspan:2})]),_.line([b._label3=_.text("Right",{"for":"rt_right",dragStep:.1},{colspan:2,fill:"none",align:"left",cellPadding:null}),b._label4=_.text("Bottom",{"for":"rt_bottom",dragStep:.1},{colspan:2,fill:"none",align:"left"})]),_.line([b._input3=_.numberInput({bind:"right",id:"rt_right"},{colspan:2,cellPadding:null}),b._input4=_.numberInput({bind:"bottom",id:"rt_bottom"},{colspan:2})])},uc.prototype.setAnchor=function(a,b){if(a.setAnchor(new qc.Point(b.minAnchorX,b.minAnchorY),new qc.Point(b.maxAnchorX,b.maxAnchorY)),b.position){var c,d,e,f,g=b.position,h=a.parent;/left/i.test(g)?c=a.width*a.pivotX:/center/i.test(g)?c=(h.width-a.width)/2+a.width*a.pivotX:/right/i.test(g)?c=h.width-a.width*(1-a.pivotX):/hStretch/i.test(g)&&(e=h.width,c=e*a.pivotX),c-=h.width*h.pivotX,/top/i.test(g)?d=a.height*a.pivotY:/middle/i.test(g)?d=(h.height-a.height)/2+a.height*a.pivotY:/bottom/i.test(g)?d=h.height-a.height*(1-a.pivotY):/vStretch/i.test(g)&&(f=h.height,d=f*a.pivotY),d-=h.height*h.pivotY,null!=c&&(a.x=c),null!=d&&(a.y=d),null!=e&&(a.width=e),null!=f&&(a.height=f)}if(b.pivot){var i,j,k,l,m=b.pivot;/left/i.test(m)?i=0:/center/i.test(m)?i=.5:/right/i.test(m)?i=1:/hStretch/i.test(m)&&(i=.5),/top/i.test(m)?j=0:/middle/i.test(m)?j=.5:/bottom/i.test(m)?j=1:/vStretch/i.test(m)&&(j=.5),null!=i&&(k=a.x+a.width*(i-a.pivotX),a.pivotX=i,a.x=k),null!=j&&(l=a.y+a.height*(j-a.pivotY),a.pivotY=j,a.y=l)}};var vc=m("qc.editor.ImagePanel",qc.editor.Panel,function Pe(a){var b=this;Pe["super"].constructor.call(b,a),
b.title="UIImage",b.icon="inspector_image",b.checkable=!1,b.removable=!1});vc.prototype.paint=function(){var a=this,b=this.target;_.columnWidths=[80,"60+0.5"];var c=pc.drawTextureInput(b,{title:"Atlas",toolTip:fa._("CUIImage.texture")},"texture/frame",function(){a.repaint()}),d=b.texture?b.texture.frameNames:[0];d.indexOf(b.frame)<0&&(b.frame=d[0]);var e;b.frame?_.line([_.text("Frame",{toolTip:fa._("CUIImage.frame")}),e=_.dropDownList({bind:"frame",items:d})]):b.frame=0,e&&c&&(e.onValueChanged=function(a){var b=c.associatedViewAndData;b&&(b.fileList[1]=a)}),pc.drawColorPicker(b,{title:"ColorTint",toolTip:fa._("CNode.colorTint")},"colorTint",null,!1),a._drawImageType()},vc.prototype._drawImageType=function(){var a=this,b=this.target;_.line([_.text("Image Type",{toolTip:fa._("CUIImage.imageType")}),_.dropDownList({bind:"imageType",items:[{label:"Simple",value:qc.UIImage.IMAGE_TYPE_SIMPLE},{label:"Sliced",value:qc.UIImage.IMAGE_TYPE_SLICED},{label:"Tiled",value:qc.UIImage.IMAGE_TYPE_TILED}]})]),_.line([a._setNativeSize=_.button(fa._("Reset Native Size"),{},{colspan:2})]),a._setNativeSize.on("click",function(){fa.inspector.propertyView.emit(fa.e.INSPECTOR_COMP_VALUE_CHANGE,{node:b,field:"size"}),b.resetNativeSize()})};var wc=m("qc.editor.ButtonPanel",qc.editor.Panel,function Qe(a){var b=this;Qe["super"].constructor.call(b,a),b.title="Button",b.icon="inspector_button",b.checkable=!1,b.removable=!1,this.state=fa.preference.query("collapse.button")===!0?"collapse":""});wc.prototype.paint=function(){var a=this.target;_.columnWidths=[70,"60+0.5"],pc.drawNodeRef(a,"text",qc.UIText,!1,{title:"Text",toolTip:fa._("CButton.text")}),_.line([_.text("State",{toolTip:fa._("CButton.state")}),_.dropDownList({bind:"state",items:[{label:"Normal",value:qc.UIState.NORMAL},{label:"Pressed",value:qc.UIState.PRESSED},{label:"Disabled",value:qc.UIState.DISABLED}]})]),_.columnWidths=[100,"60+0.5"],_.line([_.text("Native Click",{toolTip:fa._("CButton.supportNativeEvent")}),_.checkBox({bind:"supportNativeEvent",selected:a.supportNativeEvent})])};var xc=m("qc.editor.TransitionPanel",qc.editor.Panel,function Re(a){var b=this;Re["super"].constructor.call(b,a),b.title="TransitionBehaviour",b.checkable=!0,b.removable=!0,this.state="collapse"});xc.prototype.onEnable=function(){this.target.enable=!0},xc.prototype.onDisable=function(){this.target.enable=!1},xc.prototype.onRemove=function(){var a=this;a.removeSelf()},xc.prototype.update=function(){var a=this,b=a.target;if(b.transition===qc.Transition.TEXTURE_SWAP){var c=a._texture,d=b.target.texture;if(c!==d)return void a.repaint()}a.checked=a.target.enable},xc.prototype.paint=function(){var a=this,b=this.target;_.columnWidths=[90,"60+0.5"],_.line([_.text("Transition",{toolTip:fa._("TransitionBehaviour.transition")}),a._transition=_.dropDownList({items:[{label:"None",value:qc.Transition.NONE},{label:"Color Tint",value:qc.Transition.COLOR_TINT},{label:"Texture Swap",value:qc.Transition.TEXTURE_SWAP}]})]),a._transition.value=b.transition,a._transition.onValueChanged=function(c){c!==b.transition&&(b.transition=c,a.repaint())},_.columnWidths=[a.indent,60,"60+0.5"];var c=b.target.texture?b.target.texture.frameNames:[0];a._texture=b.target.texture,b.transition===qc.Transition.TEXTURE_SWAP?(_.line([_.divider(null,{colspan:3})]),_.line([_.empty(),_.text("Normal",{toolTip:fa._("TransitionBehaviour.normalTexture")}),_.dropDownList({bind:"normalTexture",items:c})]),_.line([_.empty(),_.text("Pressed",{toolTip:fa._("TransitionBehaviour.pressedTexture")}),_.dropDownList({bind:"pressedTexture",items:c})]),_.line([_.empty(),_.text("Disabled",{toolTip:fa._("TransitionBehaviour.disabledTexture")}),_.dropDownList({bind:"disabledTexture",items:c})])):b.transition===qc.Transition.COLOR_TINT&&(_.line([_.divider(null,{colspan:3})]),pc.drawColorPicker(b,{title:"Normal",toolTip:fa._("TransitionBehaviour.normalColor")},"normalColor",!0),pc.drawColorPicker(b,{title:"Pressed",toolTip:fa._("TransitionBehaviour.pressedColor")},"pressedColor",!0),pc.drawColorPicker(b,{title:"Disabled",toolTip:fa._("TransitionBehaviour.disabledColor")},"disabledColor",!0))};var yc=m("qc.editor.UserDefinePanel",qc.editor.Panel,function Se(a){var b=this;Se["super"].constructor.call(b,a),b.title=a["class"],b.checkable=!0,b.removable=!0});yc.prototype.onEnable=function(){this.target.enable=!0},yc.prototype.onDisable=function(){this.target.enable=!1},yc.prototype.onRemove=function(){var a=this;a.removeSelf()},yc.prototype.update=function(){var a=this;a.checked=a.target.enable},yc.prototype.defaultDraw=function(){var a=this,b=this.target,c=["80+0.1","60+0.5"];_.columnWidths=c,pc.drawScriptRef(b.gameObject,b);var d=b.getMeta();for(var e in d)if("enable"!==e&&"runInEditor"!==e&&"uuid"!==e){var f=qc.Serializer,g=d[e];switch(g){case f.INT:a.drawCommonField(e,"intInput");break;case f.INTS:a.drawArray(e,function(){return _.intInput()});break;case f.NUMBER:a.drawCommonField(e,"numberInput");break;case f.NUMBERS:a.drawArray(e,function(){return _.numberInput()});break;case f.BOOLEAN:a.drawCommonField(e,"checkBox");break;case f.BOOLEANS:a.drawArray(e,function(){return _.checkBox()});break;case f.STRING:a.drawCommonField(e,"stringInput");break;case f.STRINGS:a.drawArray(e,function(){return _.stringInput()});break;case f.MAPPING:a.drawMapping(e);break;case f.COLOR:pc.drawColorPicker(b,pc.makePropertyName(e),e);break;case f.COLORS:a.drawColors(e);break;case f.POINT:_.columnWidths=["60+0.1","15+0.01","30+0.5","15+0.01","30+0.5"],pc.drawPoint(b,pc.makePropertyName(e),e),_.columnWidths=c;break;case f.POINTS:break;case f.RECTANGLE:_.columnWidths=[30,"40+0.1","15+0.01","30+0.5","15+0.01","30+0.5"],pc.drawRectangle(b,e),_.columnWidths=c;break;case f.RECTANGLES:break;case f.CIRCLE:_.columnWidths=[30,"40+0.1","15+0.01","30+0.5","15+0.01","30+0.5"],pc.drawCircle(b,e),_.columnWidths=c;break;case f.FONT:_.line([_.text(pc.makePropertyName(e)),_.objectInput({objectType:"allFont",target:b,targetField:e,bind:e})]);break;case f.FONTS:a.drawFonts(e);break;case f.CIRCLES:break;case f.ELLIPSE:_.columnWidths=[30,"40+0.1","15+0.01","30+0.5","15+0.01","30+0.5"],pc.drawEllipse(b,e),_.columnWidths=c;break;case f.ELLIPSES:break;case f.GEOM:_.columnWidths=["40+0.1","15+0.01","30+0.5","15+0.01","30+0.5"],pc.drawGeom(b,pc.makePropertyName(e),e,a),_.columnWidths=c;break;case f.GEOMS:break;case f.NODE:pc.drawNodeRef(b,e);break;case f.NODES:pc.drawNodes(a,pc.makePropertyName(e),e);break;case f.TEXTURE:pc.drawTextureInput(b,pc.makePropertyName(e),e,null);break;case f.TEXTURES:pc.drawTextures(a,pc.makePropertyName(e),e);break;case f.PREFAB:pc.drawPrefabInput(b,pc.makePropertyName(e),e);break;case f.PREFABS:a.drawPrefabs(e);break;case f.AUDIO:pc.drawSoundInput(b,pc.makePropertyName(e),e);break;case f.AUDIOS:a.drawAudios(e);break;case f.TEXTASSET:pc.drawTextAssetInput(b,pc.makePropertyName(e),e);break;case f.TEXTASSETS:break;case f.EXCELASSET:pc.drawExcelAssetInput(b,pc.makePropertyName(e),e);break;case f.EXCELASSETS:}}},yc.prototype.paint=function(){var a=this.target,b=fa.extend.findInspector(a["class"]);return b?void b.call(this):void this.defaultDraw()},yc.prototype.drawPrefabs=function(a){var b=this,c=b.target,d=function(b,d,e){var f;e.add(_.line([_.text(""+b,{align:"right"}),f=_.objectInput({objectType:"prefab",target:c,targetField:a,arrIndex:b})])),f.setObjectValue(d)};pc.drawArray(b,c,a,d)},yc.prototype.drawFonts=function(a){var b=this,c=b.target,d=function(b,d,e){var f;e.add(_.line([_.text(""+b,{align:"right"}),f=_.objectInput({objectType:"allFont",target:c,targetField:a,arrIndex:b})])),f.setObjectValue(d)};pc.drawArray(b,c,a,d)},yc.prototype.drawAudios=function(a){var b=this,c=b.target,d=function(b,d,e){var f;e.add(_.line([_.text(""+b,{align:"right"}),f=_.objectInput({objectType:"sound",target:c,targetField:a,arrIndex:b})])),f.setObjectValue(d)};pc.drawArray(b,c,a,d)},yc.prototype.drawColors=function(a){var b=this,c=b.target,d=c[a]||[],e=function(c,e,f){var g;f.add(_.line([_.text(""+c,{align:"right"}),g=_.colorPicker()])),e&&(g.value=e.toNumber(!0)),g.onValueChanged=function(e){fa.inspector._updating||(d[c]=e,b.target[a]=d,b._cacheForDetection[a]=d.slice(0))}};pc.drawArray(b,c,a,e)},yc.prototype.drawCommonField=function(a,b){_.line([_.text(pc.makePropertyName(a),{align:"left"}),_[b]({bind:a})])},yc.prototype.drawArrayLength=function(a){var b,c=this,d=c.target,e=d[a]||[],f=_.titleLine(pc.makePropertyName(a));f.add(_.line([_.text("  Length",{align:"right"}),b=_.intInput()]));var g=e.length;return b.value=g,b.input.addEventListener("change",function(){var d=b.value;if(0>d&&(d=0),d!==g){for(var f=[],h=0;d>h;h++)f.push(g>h?e[h]:null);c.target[a]=f}}),c._cacheForDetection||(c._cacheForDetection={}),c._cacheForDetection[a]=e.slice(0),f},yc.prototype.drawArray=function(a,b){var c=this,d=c.target,e=d[a]||[],f=c.drawArrayLength(a);for(var g in e)c.drawArrayItem(a,g,f,b)},yc.prototype.drawArrayItem=function(a,b,c,d){var e,f=this,g=f.target,h=g[a][b];c.add(_.line([_.text(""+b,{align:"right"}),e=d()])),null!==h&&(e instanceof qc.widget.ToggleButton?e.selected=h:e.value=h),e.onValueChanged=function(c){if(!fa.inspector._updating){if(c===h)return;g[a][b]=c,h=c,f._cacheForDetection[a]=g[a].slice(0)}}},yc.prototype.drawMapping=function(a){var c,d=this,e=d.target,f=e[a]||[],g=_.titleLine(pc.makePropertyName(a));g.add(_.line([_.text("  Count",{align:"right"}),c=_.intInput()]));var h=b.keys(f).length;c.value=h,c.onValueChanged=function(c){if(0>c&&(c=0),c!==h){for(var g=[],i=b.keys(f),j=0;c>j;j++)g.push(h>j?i[j]:fa.game.math.uuid());var k={};for(var j in g)k[g[j]]=f[g[j]]||"";e[a]=k,d.repaint()}};var i=function(a){var b,c;g.add(_.line([b=_.stringInput(),c=_.stringInput()])),b.value=a,c.value=f[a];var d=f[a];b.onValueChanged=function(b){delete f[a],f[b]=d,a=b},c.onValueChanged=function(b){f[a]=b,d=b}};for(var j in f)i(j)};var zc=m("qc.editor.ScaleAdapterPanel",qc.editor.Panel,function Te(a){var b=this;Te["super"].constructor.call(b,a),b.title="ScaleAdapter",b.checkable=!0,b.removable=!0});zc.prototype.onEnable=function(){this.target.enable=!0},zc.prototype.onDisable=function(){this.target.enable=!1},zc.prototype.onRemove=function(){var a=this;a.removeSelf()},zc.prototype.update=function(){var a=this;a.checked=a.target.enable},zc.prototype.paint=function(){var a=this,b=(this.target,["90+0.1","60+0.5"]);_.columnWidths=b,_.line([_.text("Manual Type",{toolTip:fa._("ScaleAdapter.manualType")}),_.dropDownList({bind:"manualType",items:[{label:"None",value:qc.ScaleAdapter.NONE},{label:"Height",value:qc.ScaleAdapter.MANUAL_HEIGHT},{label:"Width",value:qc.ScaleAdapter.MANUAL_WIDTH},{label:"Expand",value:qc.ScaleAdapter.EXPAND},{label:"Shrink",value:qc.ScaleAdapter.SHRINK},{label:"Fill",value:qc.ScaleAdapter.FILL}]})]),_.columnWidths=[a.indent,20,"30+0.3",20,"30+0.3"];var c=_.titleLine("Reference Resolution");c.toolTip=fa._("ScaleAdapter.referenceResolution"),c.add(_.line([_.empty(),_.text("W",{align:"center"}),_.intInput({bind:"referenceResolution.x"}),_.text("H",{align:"center"}),_.intInput({bind:"referenceResolution.y"})]))};var Ac=m("qc.editor.UITextPanel",qc.editor.Panel,function Ue(a){var b=this;Ue["super"].constructor.call(b,a),b.title="UIText",b.icon="inspector_text",b.checkable=!1,b.removable=!1});Ac.prototype.paint=function(){var a=this,b=a.target;_.columnWidths=[70,"60+1"],_.line([_.text("Overflow",{toolTip:fa._("CUIText.overflow")}),_.checkBox({bind:"overflow"})]),pc.drawColorPicker(b,{title:"Color",toolTip:fa._("CUIText.color")},"color",null,!1),pc.drawColorPicker(b,{title:"ColorTint",toolTip:fa._("CUIText.colorTint")},"colorTint",null,!1),_.columnWidths=[a.indent,"60+1"];var d=_.titleLine("Text");d.toolTip=fa._("CUIText.text"),d.add(_.line([_.empty(),_.textArea({bind:"text"})],50)),_.columnWidths=[a.indent,"70+0.1","60+0.5"];var e,d=_.titleLine("Character",fa.preference.query("collapse.text")===!0),f=["System","Web","Bitmap"];d.add(_.line([_.empty(),_.text("Font Family",{toolTip:fa._("CUIText.fontFamily")}),e=_.dropDownList({items:f})])),e.value=f[b.fontFamily===c?0:b.fontFamily],e.onValueChanged=function(c){var d=f.indexOf(c)||0;a.lastFontEdit||(a.lastFontEdit={}),a.lastFontEdit[b.fontFamily]=b.font,b.fontFamily=d,a.lastFontEdit[d]&&(b.font=a.lastFontEdit[d]),a.repaint()},d.add(b.fontFamily===qc.UIText.SYSTEMFONT?_.line([_.empty(),_.text("Font",{toolTip:fa._("CUIText.font")}),_.stringInput({bind:"font"})]):_.line([_.empty(),_.text("Font",{toolTip:fa._("CUIText.font")}),_.objectInput({objectType:b.fontFamily===qc.UIText.BITMAPFONT?"bitmapFont":"font",target:b,targetField:"font",bind:"font"})])),d.add(_.line([_.empty(),_.text("Bold",{toolTip:fa._("CUIText.bold")}),_.checkBox({bind:"bold"})])),d.add(_.line([_.empty(),_.text("Font Size",{align:"left",toolTip:fa._("CUIText.fontSize")}),_.intInput({bind:"fontSize"})])),d.add(_.line([_.empty(),_.text("Line Spacing",{toolTip:fa._("CUIText.lineSpacing")}),_.intInput({bind:"lineSpacing"})]));var d=_.titleLine("Paragraph",fa.preference.query("collapse.text")===!0);d.add(_.line([_.empty(),_.text("AlignH",{toolTip:fa._("CUIText.alignH")}),_.buttonGroup([{text:"Left",value:qc.UIText.LEFT},{text:"Center",value:qc.UIText.CENTER},{text:"Right",value:qc.UIText.RIGHT}],{bind:"alignH"})])),d.add(_.line([_.empty(),_.text("AlignV",{toolTip:fa._("CUIText.alignV")}),_.buttonGroup([{text:"Top",value:qc.UIText.TOP},{text:"Middle",value:qc.UIText.MIDDLE},{text:"Bottom",value:qc.UIText.BOTTOM}],{bind:"alignV"})])),d.add(_.line([_.empty(),_.text("Wrap",{toolTip:fa._("CUIText.wrap")}),_.checkBox({bind:"wrap"})]));var d=_.titleLine("Stroke",fa.preference.query("collapse.text")===!0);d.add(_.line([_.empty(),_.text("Thickness",{toolTip:fa._("CUIText.strokeThickness")}),_.numberInput({bind:"strokeThickness"})])),d.add(pc.drawColorPicker(b,{title:"Color",toolTip:fa._("CUIText.stroke")},"stroke",!0));var d=_.titleLine("Shadow",fa.preference.query("collapse.text")===!0);d.add(_.line([_.empty(),_.text("On",{toolTip:fa._("CUIText.enableShadow")}),_.checkBox({bind:"enableShadow"})])),d.add(pc.drawColorPicker(b,{title:"Color",toolTip:fa._("CUIText.shadowColor")},"shadowColor",!0)),d.add(_.line([_.empty(),_.text("Blur",{align:"left",toolTip:fa._("CUIText.shadowBlur")}),_.numberInput({bind:"shadowBlur"})])),d.add(_.line([_.empty(),_.text("OffsetX",{align:"left",toolTip:fa._("CUIText.shadowOffsetX")}),_.intInput({bind:"shadowOffsetX"})])),d.add(_.line([_.empty(),_.text("OffsetY",{align:"left",toolTip:fa._("CUIText.shadowOffsetY")}),_.intInput({bind:"shadowOffsetY"})]));var d=_.titleLine("Gradient",fa.preference.query("collapse.text")===!0);d.add(_.line([_.empty(),_.text("On",{toolTip:fa._("CUIText.gradient")}),_.checkBox({bind:"gradient"})])),d.add(pc.drawColorPicker(b,{title:"Start",toolTip:fa._("CUIText.startColor")},"startColor",!0)),d.add(pc.drawColorPicker(b,{title:"End",toolTip:fa._("CUIText.endColor")},"endColor",!0));var d=_.titleLine("Glow",fa.preference.query("collapse.text")===!0);d.add(_.line([_.empty(),_.text("On",{toolTip:fa._("CUIText.enableGlow")}),_.checkBox({bind:"enableGlow"})])),d.add(pc.drawColorPicker(b,{title:"Color",toolTip:fa._("CUIText.glowColor")},"glowColor",!0)),d.add(_.line([_.empty(),_.text("Blur",{align:"left",toolTip:fa._("CUIText.glowBlur")}),_.numberInput({bind:"glowBlur"})]))};var Bc=m("qc.editor.ToggleGroupPanel",qc.editor.Panel,function Ve(a){var b=this;Ve["super"].constructor.call(b,a),b.title="ToggleGroup",b.checkable=!0,b.removable=!0});Bc.prototype.onEnable=function(){this.target.enable=!0},Bc.prototype.onDisable=function(){this.target.enable=!1},Bc.prototype.onRemove=function(){var a=this;a.removeSelf()},Bc.prototype.update=function(){var a=this;a.checked=a.target.enable},Bc.prototype.paint=function(){var a=this,b=this.target;_.columnWidths=["70+0.1","60+0.5"],pc.drawNodeRef(b,"toggle",qc.Node,!1,{title:"Toggle",toolTip:fa._("ToggleGroup.toggle")}),_.line([_.text("Allow Off",{toolTip:fa._("ToggleGroup.allowSwitchOff")}),_.checkBox({bind:"allowSwitchOff"})]),pc.drawNodes(a,{title:"Toggles",toolTip:fa._("ToggleGroup.toggles")},"toggles")};var Cc=m("qc.editor.TogglePanel",qc.editor.Panel,function We(a){var b=this;We["super"].constructor.call(b,a),b.title="Toggle",b.icon="inspector_toggle",b.checkable=!1,b.removable=!1});Cc.prototype.paint=function(){var a=this.target;_.columnWidths=[80,"60+0.5"],pc.drawNodeRef(a,"background",qc.Image,!1,{title:"Background",toolTip:fa._("CToggle.background")}),pc.drawNodeRef(a,"checkMark",qc.Image,!1,{title:"CheckMark",toolTip:fa._("CToggle.checkMark")}),pc.drawNodeRef(a,"text",qc.UIText,!1,{title:"Text",toolTip:fa._("CToggle.text")}),_.line([_.text("On",{toolTip:fa._("CToggle.on")}),_.checkBox({bind:"on"})]),_.line([_.text("State",{toolTip:fa._("CToggle.state")}),_.dropDownList({bind:"state",items:[{label:"Normal",value:qc.UIState.NORMAL},{label:"Pressed",value:qc.UIState.PRESSED},{label:"Disabled",value:qc.UIState.DISABLED}]})])};var Dc=m("qc.editor.MaskPanel",qc.editor.Panel,function Xe(a){var b=this;Xe["super"].constructor.call(b,a),b.title="NodeMask",b.checkable=!0,b.removable=!0,this.state="collapse"});Dc.prototype.onEnable=function(){this.target.enable=!0},Dc.prototype.onDisable=function(){this.target.enable=!1},Dc.prototype.onRemove=function(){var a=this;a.removeSelf()},Dc.prototype.update=function(){var a=this;a.checked=a.target.enable},Dc.prototype.paint=function(){this.target;_.columnWidths=["90+0.1","60+0.5"],_.line([_.text("Check In Field",{align:"left",toolTip:fa._("NodeMask.checkInField")}),_.checkBox({bind:"checkInField"})]),_.line([_.text("Clip Mode",{toolTip:fa._("NodeMask.mode")}),_.dropDownList({bind:"mode",items:[{label:"Rectangle",value:qc.NodeMask.MODE_DEFAULT},{label:"Pixel",value:qc.NodeMask.MODE_PIXEL}]})])};var Ec=m("qc.editor.ScrollBarPanel",qc.editor.Panel,function Ye(a){var b=this;Ye["super"].constructor.call(b,a),b.title="ScrollBar",b.icon="inspector_scrollbar",b.checkable=!1,b.removable=!1});Ec.prototype.update=function(){},Ec.prototype.paint=function(){var a=this,b=a.target;delete a._isFixedValue,_.columnWidths=["70+0.1","60+0.5"],_.line([_.text("Direction",{toolTip:fa._("CScrollBar.direction")}),_.dropDownList({bind:"direction",items:[{label:"Left to Right",value:qc.ScrollBar.LEFT_TO_RIGHT},{label:"Right to Left",value:qc.ScrollBar.RIGHT_TO_LEFT},{label:"Top to Bottom",value:qc.ScrollBar.TOP_TO_BOTTOM},{label:"Bottom to Top",value:qc.ScrollBar.BOTTOM_TO_TOP}]})]),_.line([_.text("Value",{toolTip:fa._("CScrollBar.value")}),_.numberInput({bind:"value"})]),pc.drawNodeRef(b,"sliders",qc.UIImage,!1,{title:"Sliders",toolTip:fa._("CScrollBar.sliders")}),_.line([_.text("Size",{toolTip:fa._("CScrollBar.size")}),_.numberInput({bind:"size"})]),_.line([_.text("Fix Sliders Size",{toolTip:fa._("CScrollBar.fixSlidersSize")}),_.checkBox({bind:"fixSlidersSize"})]),_.line([_.text("Number Of Step",{toolTip:fa._("CScrollBar.numberOfStep")}),_.numberInput({bind:"numberOfStep"})])};var Fc=m("qc.editor.ScrollViewPanel",qc.editor.Panel,function Ze(a){var b=this;Ze["super"].constructor.call(b,a),b.title="ScrollView",b.icon="inspector_scrollview",b.checkable=!1,b.removable=!1});Fc.prototype.update=function(){},Fc.prototype.paint=function(){var a=this,b=this.target,d=["90+0.1","60+0.5"];_.columnWidths=d,pc.drawNodeRef(b,"content",qc.Node,!1,{title:"Content",toolTip:fa._("CScrollView.content")}),_.columnWidths=[a.indent,"70+0.1","60+0.5"];var e=_.titleLine("Horizontal Scroll",fa.preference.query("collapse.scrollView")===!0);e.add(_.line([_.empty(),_.text("Horizontal",{toolTip:fa._("CScrollView.canHorizontal")}),_.checkBox({bind:"canHorizontal"})])),e.add(pc.drawNodeRef(b,"horizontalScrollBar",c,!0,{title:"ScrollBarH",toolTip:fa._("CScrollView.horizontalScrollBar")})),e.add(_.line([_.empty(),_.text("Value",{toolTip:fa._("CScrollView.horizontalNormalizedPosition")}),_.numberInput({bind:"horizontalNormalizedPosition"})]));var e=_.titleLine("Vertical Scroll",fa.preference.query("collapse.scrollView")===!0);e.add(_.line([_.empty(),_.text("Vertical",{toolTip:fa._("CScrollView.canVertical")}),_.checkBox({bind:"canVertical"})])),e.add(pc.drawNodeRef(b,"verticalScrollBar",c,!0,{title:"ScrollBarV",toolTip:fa._("CScrollView.verticalScrollBar")})),e.add(_.line([_.empty(),_.text("Value",{toolTip:fa._("CScrollView.verticalNormalizedPosition")}),_.numberInput({bind:"verticalNormalizedPosition"})])),_.columnWidths=d,_.line([_.text("Movement Type",{toolTip:fa._("CScrollView.movementType")}),a._moveType=_.dropDownList({bind:"movementType",items:[{label:"Unrestricted",value:qc.ScrollView.MOVEMENT_UNRESTRICTED},{label:"Elastic",value:qc.ScrollView.MOVEMENT_ELASTIC},{label:"Clamped",value:qc.ScrollView.MOVEMENT_CLAMPED}]})]);var f=b.movementType;a._moveType.onValueChanged=function(b){b!==f&&a.repaint()},b.movementType===qc.ScrollView.MOVEMENT_ELASTIC&&_.line([_.text("Elasticity",{align:"left",toolTip:fa._("CScrollView.elasticity")}),_.numberInput({bind:"elasticity"})]),_.line([_.text("Inertia",{align:"left",toolTip:fa._("CScrollView.inertia")}),_.checkBox({bind:"inertia"})]),_.line([_.text("Deceleration Rate",{toolTip:fa._("CScrollView.decelerationRate")}),_.numberInput({bind:"decelerationRate"})]),_.line([_.text("Scroll Sensitivity",{toolTip:fa._("CScrollView.scrollSensitivity")}),_.numberInput({bind:"scrollSensitivity"})]),_.line([_.text("Propagation Scroll",{toolTip:fa._("CScrollView.propagationScroll")}),_.checkBox({bind:"propagationScroll"})])};var Gc=m("qc.editor.SoundPanel",qc.editor.Panel,function $e(a){var b=this;$e["super"].constructor.call(b,a),b.title="Sound",b.icon="inspector_sound",b.checkable=!1,b.removable=!1});Gc.prototype.paint=function(){var a=this,b=this.target;_.columnWidths=["95+0.1","60+0.5"],pc.drawSoundInput(b,{title:"Audio",toolTip:fa._("CSound.audio")},"audio"),_.line([_.text("Loop",{toolTip:fa._("CSound.loop")}),_.checkBox({bind:"loop"})]),_.line([_.text("Mute",{toolTip:fa._("CSound.mute")}),_.checkBox({bind:"mute"})]),_.line([_.text("Volume",{toolTip:fa._("CSound.volume")}),_.numberInput({bind:"volume"})]),_.line([_.text("Play On Awake",{toolTip:fa._("CSound.playOnAwake")}),_.checkBox({bind:"playOnAwake"})]),_.line([_.text("Destroy When Stop",{toolTip:fa._("CSound.destroyWhenStop")}),_.checkBox({bind:"destroyWhenStop"})]),_.line([a.playBtn=_.button(fa._("Play"),{},{colspan:2})]),a.playBtn.on("click",function(){b.play()}),_.line([a.stopBtn=_.button(fa._("Stop"),{},{colspan:2})]),a.stopBtn.on("click",function(){b.stop()})};var Hc=m("qc.editor.ProgressBarPanel",qc.editor.Panel,function _e(a){var b=this;_e["super"].constructor.call(b,a),b.title="ProgressBar",b.checkable=!1,b.removable=!1});Hc.prototype.update=function(){var a=this;if(a._isFixedValue){var b=a.target.fixedSize>=0;a._isFixedValue._autoUpdate=!0,a._isFixedValue.selected=b,delete a._isFixedValue._autoUpdate}},Hc.prototype.paint=function(){var a=this,b=this.target;_.columnWidths=["70+0.1","60+0.5"],pc.drawNodeRef(b,"sliders",qc.UIImage,!1,{title:"Sliders",toolTip:fa._("CProgressBar.sliders")});var c;_.line([_.text("Style",{toolTip:fa._("CProgressBar.style")}),c=_.dropDownList({bind:"style",items:[{label:"Horizontal",value:qc.ProgressBar.STYLE_HORIZONTAL},{label:"Vertical",value:qc.ProgressBar.STYLE_VERTICAL},{label:"Circle",value:qc.ProgressBar.STYLE_CIRCLE}]})]),c.onValueChanged=function(c){c!==b.style&&a.repaint()};var d;_.line([_.text("Indeterminable",{toolTip:fa._("CProgressBar.indeterminable")}),d=_.checkBox({selected:b.indeterminable,bind:"indeterminable"})]),d.onValueChanged=function(){a.repaint()};var e,f,g;_.line([_.text("Min Value",{toolTip:fa._("CProgressBar.minValue")}),e=_.numberInput({bind:"minValue",max:b.maxValue-1})]),_.line([_.text("Max Value",{toolTip:fa._("CProgressBar.maxValue")}),f=_.numberInput({bind:"maxValue",min:b.minValue+1})]),_.line([_.text("Value",{toolTip:fa._("CProgressBar.value")}),g=_.numberInput({bind:"value",min:b.minValue,max:b.maxValue})]),e.addEventListener("change",function(){f.min=e.finalValue+1,g.min=e.finalValue}),f.addEventListener("change",function(){e.max=f.finalValue-1,g.max=f.finalValue});var h=null;b.fixedSize<0?(_.columnWidths=["70+0.1","60+0.5"],_.line([_.text("Fixed Size",{toolTip:fa._("CProgressBar.fixedSize")}),h=a._isFixedValue=_.checkBox()])):(_.columnWidths=["70+0.1","30+0.0","60+0.5"],_.line([_.text("Fixed Size",{toolTip:fa._("CProgressBar.fixedSize")}),h=a._isFixedValue=_.checkBox(),_.sliderInput({bind:"fixedSize",step:0,min:0,max:1})])),h.selected=b.fixedSize>=0,h.onValueChanged=function(c){h._autoUpdate||(b.fixedSize=c?.5:-1),a.repaint()},_.columnWidths=["70+0.1","60+0.5"],b.indeterminable&&_.line([_.text("Loop Time",{toolTip:fa._("CProgressBar.loopTime")}),_.intInput({bind:"loopTime"})]),_.line([_.text("Clip Sliders",{toolTip:fa._("CProgressBar.clipSliders")}),_.checkBox({bind:"clipSliders"})]),_.line([_.text("Show Mode",{toolTip:fa._("CProgressBar.showMode")}),_.dropDownList({bind:"showMode",items:[{label:"Processed",value:qc.ProgressBar.SHOW_PROCESSED},{label:"Remained",value:qc.ProgressBar.SHOW_REMAINED}]})]),_.line([_.text("Reverse",{toolTip:fa._("CProgressBar.reverse")}),_.checkBox({bind:"reverse"})]),b.style===qc.ProgressBar.STYLE_CIRCLE&&(_.line([_.text("Start Radian",{toolTip:fa._("CProgressBar.startRadian")}),_.numberInput({bind:"startRadian"})]),_.line([_.text("End Radian",{toolTip:fa._("CProgressBar.endRadian")}),_.numberInput({bind:"endRadian"})]),_.line([_.text("Start Angle",{toolTip:fa._("CProgressBar.startAngle")}),_.numberInput({bind:"startAngle"})]),_.line([_.text("End Angle",{toolTip:fa._("CProgressBar.endAngle")}),_.numberInput({bind:"endAngle"})]))};var Ic=m("qc.editor.SliderPanel",qc.editor.Panel,function af(a){var b=this;af["super"].constructor.call(b,a),b.title="Slider",b.icon="inspector_slider",b.checkable=!1,b.removable=!1});Ic.prototype.update=function(){var a=this;if(a._isFixedValue){var b=a.target.fixedSize>=0;a._isFixedValue._autoUpdate=!0,a._isFixedValue.selected=b,delete a._isFixedValue._autoUpdate}},Ic.prototype.paint=function(){var a=this,b=a.target;delete a._isFixedValue,_.columnWidths=["70+0.1","60+0.5"],pc.drawNodeRef(b,"sliders",qc.UIImage,!1,{title:"Sliders",toolTip:fa._("CProgressBar.sliders")});var c;_.line([_.text("Style",{toolTip:fa._("CSlider.style")}),c=_.dropDownList({bind:"style",items:[{label:"Horizontal",value:qc.Slider.STYLE_HORIZONTAL},{label:"Vertical",value:qc.Slider.STYLE_VERTICAL},{label:"Circle",value:qc.Slider.STYLE_CIRCLE}]})]),c.onValueChanged=function(c){c!==b.style&&a.repaint()};var d,e,f;_.line([_.text("Min Value",{toolTip:fa._("CProgressBar.minValue")}),d=_.intInput({bind:"minValue",max:b.maxValue-1})]),_.line([_.text("Max Value",{toolTip:fa._("CProgressBar.maxValue")}),e=_.intInput({bind:"maxValue",min:b.minValue+1})]),_.line([_.text("Value",{toolTip:fa._("CProgressBar.value")}),f=_.numberInput({bind:"value",min:b.minValue,max:b.maxValue})]),d.addEventListener("change",function(){e.min=d.finalValue+1,f.min=d.finalValue}),e.addEventListener("change",function(){d.max=e.finalValue-1,f.max=e.finalValue});var g=null;b.fixedSize<0?(_.columnWidths=["70+0.1","60+0.5"],_.line([_.text("Fixed Size",{toolTip:fa._("CProgressBar.fixedSize")}),g=a._isFixedValue=_.checkBox()])):(_.columnWidths=["70+0.1","30+0.0","30+0.5"],_.line([_.text("Fixed Size",{toolTip:fa._("CProgressBar.fixedSize")}),g=a._isFixedValue=_.checkBox(),_.sliderInput({bind:"fixedSize",step:0,min:0,max:1})])),_.columnWidths=["70+0.1","60+0.5"],g.selected=b.fixedSize>=0,g.onValueChanged=function(c){g._autoUpdate||(b.fixedSize=c?.5:-1),a.repaint()},_.line([_.text("Can Pursue",{toolTip:fa._("CSlider.canPursue")}),_.checkBox({bind:"canPursue"})]),_.line([_.text("Clip Sliders",{toolTip:fa._("CProgressBar.clipSliders")}),_.checkBox({bind:"clipSliders"})]),b.style===qc.ProgressBar.STYLE_CIRCLE&&(_.line([_.text("Start Radian",{toolTip:fa._("CProgressBar.startRadian")}),_.numberInput({bind:"startRadian"})]),_.line([_.text("End Radian",{toolTip:fa._("CProgressBar.endRadian")}),_.numberInput({bind:"endRadian"})]),_.line([_.text("Start Angle",{toolTip:fa._("CProgressBar.startAngle")}),_.numberInput({bind:"startAngle"})]),_.line([_.text("End Angle",{toolTip:fa._("CProgressBar.endAngle")}),_.numberInput({bind:"endAngle"})])),_.line([_.text("State",{toolTip:fa._("CSlider.state")}),_.dropDownList({bind:"state",items:[{label:"Normal",value:qc.UIState.NORMAL},{label:"Pressed",value:qc.UIState.PRESSED},{label:"Disabled",value:qc.UIState.DISABLED}]})])};var Jc=m("qc.editor.ScriptOrderPanel",qc.editor.Panel,function(a){a=a||{};var b=this;b.target=a,b.target.path=Hb(b.target.path),b.parentPath=b.getParentPath(b.target.path),b.parentPath&&(Jc["super"].constructor.call(b,a),b.title=fa._("Script Order Panel"),b.checkable=!1,b.removable=!1,qc.editor.Operation.GET_SCRIPT_ORDER(b.parentPath,function(a){a&&a.operRet&&(b.scriptOrder=a.order,b.repaint())}))});Jc.prototype.syncData=function(){var a=this;a.listWidget&&(a.scriptOrder=[],a.listWidget.dataModel.roots.forEach(function(b){a.scriptOrder.push(b.name)}))},Jc.prototype.paint=function(){var a=this;if(a.scriptOrder){_.columnWidths=[a.indent,"60+0.5",40,80];var b=_.titleLine(fa._("Add, remove and switch order for files or folders")),c=new Za({removable:!0,draggable:!0});c.addTopPainter(a.drawDNDState.bind(a)),a.listWidget=c,c.view._dropView=a,c.dataModel.on("dataModelChange",function(b){"remove"===b.kind&&a.syncData()}),c.dataModel.on("hierarchyChange",function(){a.syncData()}),c.on("clickData",function(b){a.blinkUrl(b.name)}),b.add(_.line([_.empty(),_.comp(c,{},{colspan:3})],250));var d,e=a.scriptOrder.length;if(e)for(d=0;e>d;d++){var f=new qc.widget.Data;f.name=a.scriptOrder[d],c.dataModel.add(f)}var g;b.add(_.line([_.empty(),g=_.button("Apply",{},{colspan:3})]),30),g.on("click",function(){qc.editor.Operation.SET_SCRIPT_ORDER(a.parentPath,a.scriptOrder)})}},Jc.prototype.blinkUrl=function(a){var b,c={fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a};for(b in c){var d=c[b],e=fa.mainContainer.findViewById(b),f=e.dataModel.getDataById(d);"fileTree"===b&&(e.selectionModel.selection=f),e.makeVisible(f),e.blink(f)}},Jc.prototype.drawDNDState=function(a){var b=this,c=b.listWidget;if(c.tip){var d=c.clientWidth,e=c.rowHeight,f=c.tip.rowIndex,g=c.tip.type;f>=0&&(a.beginPath(),"up"===g?(a.moveTo(0,f*e),a.lineTo(d,f*e)):"down"===g&&(a.moveTo(0,(f+1)*e),a.lineTo(d,(f+1)*e)),a.strokeStyle="#507aea",a.lineWidth=2,a.stroke())}},Jc.prototype.handleCrossDrag=function(a,b,c){var d=this,e=function(){var a=c.view;if(a instanceof Gd||a instanceof Dd){var b=a.draggingData;if(!b){var e=a.selection;b=e[0]}if(b){var f=Hb(b.id);if(d.getParentPath(f)===d.parentPath){var g=d.scriptOrder.indexOf(f);if(!(g>=0))return f}}}};if("enter"===b||"over"===b){var f=e();f&&(d._dragPath=f,d._crossDragging(a))}else if("exit"===b||"cancel"===b)d._dragPath&&d._clearCrossDragInfo();else if("drop"===b&&d._dragPath){var g=d.listWidget.tip,h=g.rowIndex;"up"===g.type?d.scriptOrder.splice(h,0,d._dragPath):d.scriptOrder.splice(h+1,0,d._dragPath),d._clearCrossDragInfo(),d.repaint()}},Jc.prototype._clearCrossDragInfo=function(){var a=this;a._dragPath&&(a._dragPath=null,delete a.listWidget.tip,a.listWidget.iv())},Jc.prototype._crossDragging=function(a){var b=this,c=b.listWidget;if(null!=b._dragPath){var d=c.rowHeight,e=c.lp(a),f=e.y/d,g=Math.floor(f);if(g>c.rowDatas.length-1)c.tip=0===c.rowDatas.length?{rowIndex:0,type:"up"}:{rowIndex:c.rowDatas.length-1,type:"down"};else{var h={};h.rowIndex=g;var i=e.y-g*d;.3*d>i?h.type="up":i>.7*d&&(h.type="down"),c.tip=h}c.autoScroll(a),c.iv()}},Jc.prototype.getParentPath=function(a){var b=/.*?(^|\/)(Scripts|Editor)\//.exec(a);return b?b[0].slice(0,b[0].length-1):null};var Kc=m("qc.editor.SpritePanel",qc.editor.Panel,function bf(a){var b=this;bf["super"].constructor.call(b,a),b.title="Sprite",b.icon="inspector_sprite",b.checkable=!1,b.removable=!1});Kc.prototype.paint=function(){var a=this,b=a.target;delete a._defaultAnimationDropDown,_.columnWidths=["60+0.3","60+0.5"];var d=b.animationType===qc.Sprite.DRAGON_BONES||b.animationType===qc.Sprite.FRAME_SAMPLES,e=pc.drawTextureInput(b,{title:"Texture",toolTip:fa._("CUIImage.texture")},d?"texture":"texture/frame",function(){
delete a._dragonbones,a.repaint()});if(!d){var f=b.texture?b.texture.frameNames:[0];f.indexOf(b.frame)<0&&(b.frame=f[0]);var g;b.frame?_.line([_.text("Frame",{toolTip:fa._("CSprite.texture")}),g=_.dropDownList({bind:"frame",items:f})]):b.frame=0,g&&e&&(g.onValueChanged=function(a){var b=e.associatedViewAndData;b&&(b.fileList[1]=a)})}if(pc.drawColorPicker(b,{title:"ColorTint",toolTip:fa._("CSprite.colorTint")},"colorTint",null,!1),b.animationType===qc.Sprite.NONE_ANIMATION||b.animationType===qc.Sprite.FRAME_ANIMATION?(_.line([a._setNativeSize=_.button(fa._("Reset Native Size"),{},{colspan:2})]),a._setNativeSize.on("click",function(){fa.inspector.propertyView.emit(fa.e.INSPECTOR_COMP_VALUE_CHANGE,{node:b,field:"size"}),b.resetNativeSize()})):a._dragonbones===!1||a._dragonbones===c&&b.animationType===qc.Sprite.FRAME_SAMPLES?(_.line([_.empty(),a._revertBtn=_.button(fa._("Revert"))]),a._revertBtn.on("click",function(){a._revertBtn.enabled=!1,qc.editor.Operation.REVERT_TO_DRAGONBONES(b.texture.url,function(b){b&&(a._dragonbones=!0,a.repaint())})})):(_.line([_.empty(),a._sampleBtn=_.button(fa._("Sampled"))]),a._sampleBtn.on("click",function(){qc.editor.Operation.SAMPLE_DRAGON_BONES(b,function(b){b&&(a._sampleBtn.enabled=!1)},function(){a._dragonbones=!1,a.repaint()})})),b.animationNameList){var h,i=["none"].concat(b.animationNameList);_.line([_.text("Default Animation",{toolTip:"defaultAnimation"}),h=a._defaultAnimationDropDown=_.dropDownList({items:i})]),h.value=i.indexOf(b.defaultAnimation)>=0?b.defaultAnimation:"none",h.onValueChanged=function(){fa.inspector._updating||(b.defaultAnimation="none"===h.value?null:h.value)}}_.columnWidths=[a.indent,"60+0.5",40,80];var j;if(b.animationType===qc.Sprite.FRAME_ANIMATION?j=_.titleLine(fa._("Frame Animation"),fa.preference.query("collapse.sprite")===!0):b.animationType===qc.Sprite.DRAGON_BONES?j=_.titleLine(fa._("DragonBone"),fa.preference.query("collapse.sprite")===!0):b.animationType===qc.Sprite.FRAME_SAMPLES&&(j=_.titleLine(fa._("DragonBone(Sampled)"),fa.preference.query("collapse.sprite")===!0)),j){var i=b.animationNameList.sort();j.add(_.line([_.empty(),_.text(fa._("Name"),{align:"center"}),_.text(fa._("Loop"),{align:"center"}),_.text(fa._("Operation"),{align:"center"})])),j.add(_.line([_.divider(null,{colspan:4})]));for(var k in i)a._drawAnimationInfo(i[k],j);j.add(_.line([_.divider(null,{colspan:4})]))}},Kc.prototype.update=function(){var a=this,b=a.target;if(a._defaultAnimationDropDown){var c=b.defaultAnimation,d=["none"].concat(b.animationNameList);a._defaultAnimationDropDown.value=d.indexOf(c)>=0?c:"none"}},Kc.prototype._drawAnimationInfo=function(a,b){var c,d=this,e=d.target.getAnimationInfo(a).loop;b.add(_.line([_.empty(),_.text(a,{align:"left"}),_.text(0===e?"Y":"N",{align:"center"}),c=_.button(fa._("Play"))])),c.on("click",function(){d.target.playAnimation(a)})};var Lc=m("qc.editor.InputFieldPanel",qc.editor.Panel,function cf(a){var b=this;cf["super"].constructor.call(b,a),b.title="InputField",b.icon="inspector_inputfield",b.checkable=!1,b.removable=!1});Lc.prototype.paint=function(){var a=this.target;_.columnWidths=["80+0.1","60+0.5"],_.line([_.text("Text",{toolTip:fa._("CInputField.text")}),_.stringInput({bind:"text"})]),_.line([_.text("Placeholder Text",{toolTip:fa._("CInputField.placeholderText")}),_.stringInput({bind:"placeholderText"})]),_.line([_.text("State",{toolTip:fa._("CInputField.state")}),_.dropDownList({bind:"state",items:[{label:"Normal",value:qc.UIState.NORMAL},{label:"Pressed",value:qc.UIState.PRESSED},{label:"Disabled",value:qc.UIState.DISABLED}]})]),_.line([_.text("Character Limit",{toolTip:fa._("CInputField.characterLimit")}),_.intInput({bind:"characterLimit"})]),_.line([_.text("Line Type",{toolTip:fa._("CInputField.lineType")}),_.dropDownList({bind:"lineType",items:[{label:"Single",value:qc.InputField.SINGLE_LINE},{label:"Multi",value:qc.InputField.MULTI_LINE}]})]),_.line([_.text("Content Type",{toolTip:fa._("CInputField.contentType")}),_.dropDownList({bind:"contentType",items:[{label:"Standard",value:qc.InputField.STANDARD},{label:"Int",value:qc.InputField.INT},{label:"Number",value:qc.InputField.NUMBER},{label:"Tel",value:qc.InputField.TEL},{label:"Email",value:qc.InputField.EMAIL},{label:"Password",value:qc.InputField.PASSWORD}]})]),pc.drawNodeRef(a,"textComponent",qc.UIText,!1,{title:"TextComponent",toolTip:fa._("CInputField.textComponent")}),pc.drawNodeRef(a,"placeholder",qc.UIText,!1,{title:"Placeholder",toolTip:fa._("CInputField.placeholder")})};var Mc=m("qc.editor.EmitterPanel",qc.editor.Panel,function df(a){var b=this;df["super"].constructor.call(b,a),b.title="Emitter",b.icon="inspector_particle",b.checkable=!1,b.removable=!1});Mc.prototype.paint=function(){var a=this,b=this.target,d=["100+0.1","70+1"];_.columnWidths=d,pc.drawTextureInput(b,"Texture","texture",function(){a.repaint()});var e=b.texture;e&&e.frameNames.length>1?a.drawArray("frames",function(){return _.dropDownList({items:e.frameNames})}):e&&1===e.frameNames.length&&(b.frames=[0]),_.columnWidths=["100+0.1","30+0.5",10,"30+0.5"],_.line([_.text("Max Particles"),_.intInput({bind:"maxParticles"},{colspan:3})]),_.columnWidths=[40,20,"30+0.5",10,"30+0.5"];var f=_.titleLine("Speed",!0);f.add(_.line([_.empty(),_.text("X"),_.numberInput({bind:"minParticleSpeed.x"}),_.text("-",{align:"center"}),_.numberInput({bind:"maxParticleSpeed.x"})])),f.add(_.line([_.empty(),_.text("Y"),_.numberInput({bind:"minParticleSpeed.y"}),_.text("-",{align:"center"}),_.numberInput({bind:"maxParticleSpeed.y"})])),_.columnWidths=["100+0.1","30+0.5",10,"30+0.5"],_.line([_.text("Rotation"),_.numberInput({bind:"minRotation"}),_.text("-"),_.numberInput({bind:"maxRotation"})]),_.columnWidths=[40,"60+0.1",20,"30+0.5",20,"30+0.5"];var f=_.titleLine("Scale",!0);f.add(_.line([_.empty(),_.text("From"),_.text("X"),_.numberInput({bind:"scaleFrom.x"}),_.text("Y"),_.numberInput({bind:"scaleFrom.y"})])),f.add(_.line([_.empty(),_.text("To"),_.text("X"),_.numberInput({bind:"scaleTo.x"}),_.text("Y"),_.numberInput({bind:"scaleTo.y"})])),f.add(_.line([_.empty(),_.text("Duration"),_.numberInput({bind:"scaleDuration"},{colspan:4})])),f.add(_.line([_.empty(),_.text("Ease"),_.dropDownList({bind:"scaleEase",items:a.easing()},{colspan:4})])),f.add(_.line([_.empty(),_.text("Yoyo"),_.checkBox({bind:"scaleYoyo"},{colspan:4})])),_.columnWidths=[40,"60+0.1","60+1"];var f=_.titleLine("Alpha",!0);f.add(_.line([_.empty(),_.text("From"),_.numberInput({bind:"alphaFrom"})])),f.add(_.line([_.empty(),_.text("To"),_.numberInput({bind:"alphaTo"})])),f.add(_.line([_.empty(),_.text("Duration"),_.numberInput({bind:"alphaDuration"})])),f.add(_.line([_.empty(),_.text("Ease"),_.dropDownList({bind:"alphaEase",items:a.easing()})])),f.add(_.line([_.empty(),_.text("Yoyo"),_.checkBox({bind:"alphaYoyo"})])),_.columnWidths=["100+0.1","30+0.5",10,"30+0.5"],_.line([_.text("Gravity"),_.numberInput({bind:"gravity"},{colspan:3})]),_.columnWidths=["100+0.1",20,"30+0.5",20,"30+0.5"],pc.drawPoint(b,"ParticleDrag","particleDrag"),pc.drawPoint(b,"Bounce","bounce"),_.columnWidths=["110+0.1","30+0.5",10,"30+0.5"],_.line([_.text("Angular Drag"),_.numberInput({bind:"angularDrag"},{colspan:3})]),_.line([_.text("Frequency"),_.numberInput({bind:"frequency"},{colspan:3})]),_.line([_.text("Lifespan"),_.numberInput({bind:"lifespan"},{colspan:3})]),_.line([_.text("On"),_.checkBox({bind:"on"},{colspan:3})]),_.line([_.text("Collide"),_.checkBox({bind:"collide"},{colspan:3})]),_.line([_.text("Collide World Bounds"),_.checkBox({bind:"collideWorldBounds"},{colspan:3})]),_.line([_.text("BringToTop"),_.checkBox({bind:"particleBringToTop"},{colspan:3})]),_.line([_.text("SendToBack"),_.checkBox({bind:"particleSendToBack"},{colspan:3})]),_.columnWidths=[60,"40+0.4","60+0.1"];var g;b._explodeCount===c&&(b._explodeCount=10),_.line([_.text("Count"),_.intInput({bind:"_explodeCount"}),g=_.button(fa._("Explode"))]),g.on("click",function(){b.explode(b.lifespan,b._explodeCount)});var h;_.columnWidths=["100+0.1"],_.line([h=_.button(fa._("Rebuild"))]),h.on("click",function(){b.rebuild()})},Mc.prototype.drawArrayLength=function(a){var b,c=this,d=c.target,e=d[a]||[],f=_.titleLine(pc.makePropertyName(a));f.add(_.line([_.text("  length",{align:"right"}),b=_.intInput()]));var g=e.length;return b.value=g,b.input.addEventListener("change",function(){var d=b.value;if(0>d&&(d=0),d!==g){for(var f=[],h=0;d>h;h++)f.push(g>h?e[h]:null);c.target[a]=f}}),c._cacheForDetection||(c._cacheForDetection={}),c._cacheForDetection[a]=e.slice(0),f},Mc.prototype.drawArray=function(a,b){var c=this,d=c.target,e=d[a]||[],f=c.drawArrayLength(a);for(var g in e)c.drawArrayItem(a,g,f,b)},Mc.prototype.drawArrayItem=function(a,b,d,e){var f,g=this,h=g.target,i=h[a][b];d.add(_.line([_.text(""+b,{align:"right"}),f=e()])),null!==i&&i!==c&&(f.value=i),f.onValueChanged=function(c){if(!fa.inspector._updating){if(c===i)return;h[a][b]=c,i=c,g._cacheForDetection[a]=h[a].slice(0)}}},Mc.prototype.easing=function(){return["Linear","Quadratic In","Quadratic Out","Quadratic InOut","Cubic In","Cubic Out","Cubic InOut","Quartic In","Quartic Out","Quartic InOut","Quintic In","Quintic Out","Quintic InOut","Sinusoidal In","Sinusoidal Out","Sinusoidal InOut","Exponential In","Exponential Out","Exponential InOut","Circular In","Circular Out","Circular InOut","Elastic In","Elastic Out","Elastic InOut","Back In","Back Out","Back InOut","Bounce In","Bounce Out","Bounce InOut"]};var Nc=m("qc.editor.ObjectLayerPanel",qc.editor.Panel,function ef(a){var b=this;ef["super"].constructor.call(b,a),b.title="ObjectLayer",b.icon="inspector_button",b.checkable=!1,b.removable=!1});Nc.prototype.paint=function(){var a=this.target;_.columnWidths=["80+0.1","60+0.5"],pc.drawNodeRef(a,"tilemap"),_.line([_.text("Layer Index"),_.intInput({bind:"layerIndex"})]),_.line([_.text("ScrollX Ratio"),_.numberInput({bind:"scrollXRatio"})]),_.line([_.text("ScrollX Ratio"),_.numberInput({bind:"scrollYRatio"})])};var Oc=m("qc.editor.TileLayerPanel",qc.editor.Panel,function ff(a){var b=this;ff["super"].constructor.call(b,a),b.title="TileLayer",b.icon="inspector_title_tilelayer",b.checkable=!1,b.removable=!1});Oc.prototype.paint=function(){var a=this.target;_.columnWidths=["80+0.1","60+0.5"],pc.drawNodeRef(a,"tilemap"),_.line([_.text("Layer Index"),_.intInput({bind:"layerIndex"})]),_.line([_.text("ScrollX Ratio"),_.numberInput({bind:"scrollXRatio"})]),_.line([_.text("ScrollX Ratio"),_.numberInput({bind:"scrollYRatio"})])};var Pc=m("qc.editor.TilemapPanel",qc.editor.Panel,function gf(a){var b=this;gf["super"].constructor.call(b,a),b.title="Tilemap",b.icon="inspector_title_tilemap",b.checkable=!1,b.removable=!1});Pc.prototype.paint=function(){var a,b,c=this,d=c.target;_.columnWidths=["60+0.1","60+0.5"],pc.drawTextAssetInput(d,{title:"Data",toolTip:fa._("CTilemap.data")},"data"),_.line([_.text("ScrollX",{"for":"scrollX",toolTip:fa._("CTilemap.scrollX")}),_.numberInput({bind:"scrollX",id:"scrollX"})]),_.line([_.text("ScrollY",{"for":"scrollY",toolTip:fa._("CTilemap.scrollY")}),_.numberInput({bind:"scrollY",id:"scrollY"})]),_.line([a=_.button(fa._("Generate Layers"),{},{colspan:2})]),a.on("click",function(){d.generateLayers(function(){c.repaint()})}),_.line([b=_.button(fa._("Reset Native Size"),{},{colspan:2})]),b.on("click",function(){fa.inspector.propertyView.emit(fa.e.INSPECTOR_COMP_VALUE_CHANGE,{node:d,field:"size"}),d.resetNativeSize()}),pc.drawNodes(this,{title:"Layers",toolTip:fa._("CTilemap.layers")},"layers"),pc.drawTextures(this,{title:"Tilesets",toolTip:fa._("CTilemap.tilesets")},"tilesets")};var Qc=m("qc.editor.HorizontalLayoutPanel",qc.editor.Panel,function hf(a){var b=this;hf["super"].constructor.call(b,a),b.title="HorizontalLayout",b.checkable=!0,b.removable=!0});Qc.prototype.onEnable=function(){this.target.enable=!0},Qc.prototype.onDisable=function(){this.target.enable=!1},Qc.prototype.onRemove=function(){var a=this;a.removeSelf()},Qc.prototype.update=function(){var a=this;a.checked=a.target.enable},Qc.prototype.paint=function(){var a=this;a.checked=a.target.enable},Qc.prototype.paint=function(){var a=this,b=this.target;_.columnWidths=[a.indent,120-a.indent,"60+0.5"];var c=_.titleLine("Padding");c.add(_.line([_.empty(),_.text("Left",{"for":"horLayout_paddingLeft",dragStep:1,toolTip:fa._("Bounds.paddingLeft")}),_.numberInput({bind:"paddingLeft",id:"horLayout_paddingLeft"})])),c.add(_.line([_.empty(),_.text("Right",{"for":"horLayout_paddingRight",dragStep:1,toolTip:fa._("Bounds.paddingRight")}),_.numberInput({bind:"paddingRight",id:"horLayout_paddingRight"})])),c.add(_.line([_.empty(),_.text("Top",{"for":"horLayout_paddingTop",dragStep:1,toolTip:fa._("Bounds.paddingTop")}),_.numberInput({bind:"paddingTop",id:"horLayout_paddingTop"})])),c.add(_.line([_.empty(),_.text("Bottom",{"for":"horLayout_paddingBottom",dragStep:1,toolTip:fa._("Bounds.paddingBottom")}),_.numberInput({bind:"paddingBottom",id:"horLayout_paddingBottom"})])),_.columnWidths=[120,"60+0.5"],_.line([_.text("Spacing",{"for":"horLayout_spacing",dragStep:.01,toolTip:fa._("HorizontalLayout.spacing")}),_.numberInput({bind:"spacing",id:"horLayout_spacing"})]),_.line([_.text("Size Provider",{toolTip:fa._("TableLayout.contentSizeProvider")}),_.dropDownList({bind:"contentSizeProvider",items:[{label:"Real Bounds",value:qc.TableLayout.USE_BOUNDS},{label:"RectTransform",value:qc.TableLayout.USE_RECTTRANSFORM}]})]),_.line([_.text("Content Alignment",{toolTip:fa._("TableLayout.contentAlignment")}),_.dropDownList({bind:"contentAlignment",items:[{label:"Left",value:qc.TableLayout.ALIGN_TOP_LEFT},{label:"Center",value:qc.TableLayout.ALIGN_TOP_CENTER},{label:"Right",value:qc.TableLayout.ALIGN_TOP_RIGHT}]})]),_.line([_.text("Cell Alignment",{toolTip:fa._("TableLayout.cellAlignment")}),_.dropDownList({bind:"cellAlignment",items:[{label:"Top",value:qc.TableLayout.ALIGN_TOP_LEFT},{label:"Middle",value:qc.TableLayout.ALIGN_MIDDLE_LEFT},{label:"Bottom",value:qc.TableLayout.ALIGN_BOTTOM_LEFT}]})]),_.columnWidths=["100"],_.line([_.text("Child Force Expand")]),_.columnWidths=[a.indent,120-a.indent,"60+0.5"],_.line([_.empty(),_.text("Width",{toolTip:fa._("HorizontalLayout.childForceExpandWidth")}),_.checkBox({bind:"childForceExpandWidth"})]),_.line([_.empty(),_.text("Height",{toolTip:fa._("HorizontalLayout.childForceExpandHeight")}),_.checkBox({bind:"childForceExpandHeight"})]),_.columnWidths=[120,"60+0.5"],_.line([_.text("Auto Update",{toolTip:fa._("TableLayout.autoUpdate")}),_.checkBox({bind:"autoUpdate"})]),_.line([_.empty(),a._rebuildTable=_.button(fa._("Relayout"))]),a._rebuildTable.on("click",function(){b.relayout()})};var Rc=m("qc.editor.LayoutElementPanel",qc.editor.Panel,function jf(a){var b=this;jf["super"].constructor.call(b,a),b.title="LayoutElement",b.checkable=!0,b.removable=!0});Rc.prototype.onEnable=function(){this.target.enable=!0},Rc.prototype.onDisable=function(){this.target.enable=!1},Rc.prototype.onRemove=function(){var a=this;a.removeSelf()},Rc.prototype.update=function(){var a=this;a.checked=a.target.enable},Rc.prototype.paint=function(){var a=this,b=a.target;_.columnWidths=[a.indent,90-a.indent,"60+0.5"];var c=_.titleLine("Margin");c.add(_.line([_.empty(),_.text("Left",{"for":"layoutElement_marginLeft",dragStep:1,toolTip:fa._("Bounds.marginLeft")}),_.numberInput({bind:"marginLeft",id:"layoutElement_marginLeft"})])),c.add(_.line([_.empty(),_.text("Right",{"for":"layoutElement_marginRight",dragStep:1,toolTip:fa._("Bounds.marginRight")}),_.numberInput({bind:"marginRight",id:"layoutElement_marginRight"})])),c.add(_.line([_.empty(),_.text("Top",{"for":"layoutElement_marginTop",dragStep:1,toolTip:fa._("Bounds.marginTop")}),_.numberInput({bind:"marginTop",id:"layoutElement_marginTop"})])),c.add(_.line([_.empty(),_.text("Bottom",{"for":"layoutElement_marginBottom",dragStep:1,toolTip:fa._("Bounds.marginBottom")}),_.numberInput({bind:"marginBottom",id:"layoutElement_marginBottom"})])),_.columnWidths=["90+0.3","60+0.5"],_.line([_.text("Ignore Layout",{toolTip:fa._("LayoutElement.ignoreLayout")}),_.checkBox({bind:"ignoreLayout"})]),_.line([_.text("Size Provider",{toolTip:fa._("Bounds.sizeProvider")}),_.dropDownList({bind:"sizeProvider",items:[{label:"Real Bounds",value:qc.TableLayout.USE_BOUNDS},{label:"RectTransform",value:qc.TableLayout.USE_RECTTRANSFORM}]})]),_.columnWidths=[110,20,"40+0.5"];var d=[_.text("Min Width",{"for":"layoutElement_minWidth",dragStep:.01,min:0,toolTip:fa._("LayoutElement.minWidth")}),_.checkBox({bind:"hasMinWidth",selected:b.hasMinWidth})];b.hasMinWidth&&d.push(_.numberInput({bind:"minWidth",id:"layoutElement_minWidth"})),d[1].onValueChanged=function(){a.repaint()},_.line(d),d=[_.text("Min Height",{"for":"layoutElement_minHeight",dragStep:.01,min:0,toolTip:fa._("LayoutElement.minHeight")}),_.checkBox({bind:"hasMinHeight",selected:b.hasMinHeight})],b.hasMinHeight&&d.push(_.numberInput({bind:"minHeight",id:"layoutElement_minHeight"})),d[1].onValueChanged=function(){a.repaint()},_.line(d),d=[_.text("Preferred Width",{"for":"layoutElement_preferredWidth",dragStep:.01,min:0,toolTip:fa._("LayoutElement.preferredWidth")}),_.checkBox({bind:"hasPreferredWidth",selected:b.hasPreferredWidth})],b.hasPreferredWidth&&d.push(_.numberInput({bind:"preferredWidth",id:"layoutElement_preferredWidth"})),d[1].onValueChanged=function(){a.repaint()},_.line(d),d=[_.text("Preferred Height",{"for":"layoutElement_preferredHeight",dragStep:.01,min:0,toolTip:fa._("LayoutElement.preferredHeight")}),_.checkBox({bind:"hasPreferredHeight",selected:b.hasPreferredHeight})],b.hasPreferredHeight&&d.push(_.numberInput({bind:"preferredHeight",id:"layoutElement_preferredHeight"})),d[1].onValueChanged=function(){a.repaint()},_.line(d),d=[_.text("Flexible Width",{"for":"layoutElement_flexibleWidth",dragStep:.01,min:0,toolTip:fa._("LayoutElement.flexibleWidth")}),_.checkBox({bind:"hasFlexibleWidth",selected:b.hasFlexibleWidth})],b.hasFlexibleWidth&&d.push(_.numberInput({bind:"flexibleWidth",id:"layoutElement_flexibleWidth"})),d[1].onValueChanged=function(){a.repaint()},_.line(d),d=[_.text("Flexible Height",{"for":"layoutElement_flexibleHeight",dragStep:.01,min:0,toolTip:fa._("LayoutElement.flexibleHeight")}),_.checkBox({bind:"hasFlexibleHeight",selected:b.hasFlexibleHeight})],b.hasFlexibleHeight&&d.push(_.numberInput({bind:"flexibleHeight",id:"layoutElement_flexibleHeight"})),d[1].onValueChanged=function(){a.repaint()},_.line(d)};var Sc=m("qc.editor.TableLayoutPanel",qc.editor.Panel,function kf(a){var b=this;kf["super"].constructor.call(b,a),b.title="TableLayout",b.checkable=!0,b.removable=!0});Sc.prototype.onEnable=function(){this.target.enable=!0},Sc.prototype.onDisable=function(){this.target.enable=!1},Sc.prototype.onRemove=function(){var a=this;a.removeSelf()},Sc.prototype.update=function(){var a=this;a.checked=a.target.enable},Sc.prototype.paint=function(){var a=this,b=a.target;_.columnWidths=[a.indent,120-a.indent,"60+0.5"];var c=_.titleLine("Padding");c.add(_.line([_.empty(),_.text("Left",{"for":"tableLayout_paddingLeft",dragStep:1,toolTip:fa._("Bounds.paddingLeft")}),_.numberInput({bind:"paddingLeft",id:"tableLayout_paddingLeft"})])),c.add(_.line([_.empty(),_.text("Right",{"for":"tableLayout_paddingRight",dragStep:1,toolTip:fa._("Bounds.paddingRight")}),_.numberInput({bind:"paddingRight",id:"tableLayout_paddingRight"})])),c.add(_.line([_.empty(),_.text("Top",{"for":"tableLayout_paddingTop",dragStep:1,toolTip:fa._("Bounds.paddingTop")}),_.numberInput({bind:"paddingTop",id:"tableLayout_paddingTop"})])),c.add(_.line([_.empty(),_.text("Bottom",{"for":"tableLayout_paddingBottom",dragStep:1,toolTip:fa._("Bounds.paddingBottom")}),_.numberInput({bind:"paddingBottom",id:"tableLayout_paddingBottom"})])),_.columnWidths=[120],_.line([_.text("Cell Size")]),_.columnWidths=[a.indent,120-a.indent,"40+0.1",20,"40+0.1"],_.line([_.empty(),_.text("X",{"for":"tableLayout_cellWidth",dragStep:1,toolTip:fa._("TableLayout.cellWidth")}),_.numberInput({bind:"cellWidth",id:"tableLayout_cellWidth"}),_.text("Y",{"for":"tableLayout_cellHeight",dragStep:1,toolTip:fa._("TableLayout.cellHeight")}),_.numberInput({bind:"cellHeight",id:"tableLayout_cellHeight"})]),_.columnWidths=[120],_.line([_.text("Spacing Size")]),_.columnWidths=[a.indent,120-a.indent,"40+0.1",20,"40+0.1"],_.line([_.empty(),_.text("X",{"for":"tableLayout_spacingX",dragStep:.01,toolTip:fa._("TableLayout.spacingX")}),_.numberInput({bind:"spacingX",id:"tableLayout_spacingX"}),_.text("Y",{"for":"tableLayout_spacingY",dragStep:.01,toolTip:fa._("TableLayout.spacingY")}),_.numberInput({bind:"spacingY",id:"tableLayout_spacingY"})]),_.columnWidths=[120,"60+0.5"],_.line([_.text("Style",{toolTip:fa._("TableLayout.style")}),_.dropDownList({bind:"style",items:[{label:"Wrap Element",value:qc.TableLayout.STYLE_WRAP_ELEMENT},{label:"Resize Element",value:qc.TableLayout.STYLE_RESIZE_ELEMENT}]})]),_.line([_.text("Size Provider",{toolTip:fa._("TableLayout.contentSizeProvider")}),_.dropDownList({bind:"contentSizeProvider",items:[{label:"Real Bounds",value:qc.TableLayout.USE_BOUNDS},{label:"RectTransform",value:qc.TableLayout.USE_RECTTRANSFORM}]})]),_.line([_.text("Start Corner",{toolTip:fa._("TableLayout.startCorner")}),_.dropDownList({bind:"startCorner",items:[{label:"Top Left",value:qc.TableLayout.CORNER_TOP_LEFT},{label:"Top Right",value:qc.TableLayout.CORNER_TOP_RIGHT},{label:"Bottom Left",value:qc.TableLayout.CORNER_BOTTOM_LEFT},{label:"Bottom Right",value:qc.TableLayout.CORNER_BOTTOM_RIGHT}]})]),_.line([_.text("Start Axis",{toolTip:fa._("TableLayout.startAxis")}),_.dropDownList({bind:"startAxis",items:[{label:"Horizontal",value:qc.TableLayout.AXIS_HORIZONTAL},{label:"Vertical",value:qc.TableLayout.AXIS_VERTICAL}]})]),_.line([_.text("Content Alignment",{toolTip:fa._("TableLayout.contentAlignment")}),_.dropDownList({bind:"contentAlignment",items:[{label:"Top Left",value:qc.TableLayout.ALIGN_TOP_LEFT},{label:"Top Center",value:qc.TableLayout.ALIGN_TOP_CENTER},{label:"Top Right",value:qc.TableLayout.ALIGN_TOP_RIGHT},{label:"Middle Left",value:qc.TableLayout.ALIGN_MIDDLE_LEFT},{label:"Middle Center",value:qc.TableLayout.ALIGN_MIDDLE_CENTER},{label:"Middle Right",value:qc.TableLayout.ALIGN_MIDDLE_RIGHT},{label:"Bottom Left",value:qc.TableLayout.ALIGN_BOTTOM_LEFT},{label:"Bottom Center",value:qc.TableLayout.ALIGN_BOTTOM_CENTER},{label:"Bottom Right",value:qc.TableLayout.ALIGN_BOTTOM_RIGHT}]})]),_.line([_.text("Cell Alignment",{toolTip:fa._("TableLayout.cellAlignment")}),_.dropDownList({bind:"cellAlignment",items:[{label:"Top Left",value:qc.TableLayout.ALIGN_TOP_LEFT},{label:"Top Center",value:qc.TableLayout.ALIGN_TOP_CENTER},{label:"Top Right",value:qc.TableLayout.ALIGN_TOP_RIGHT},{label:"Middle Left",value:qc.TableLayout.ALIGN_MIDDLE_LEFT},{label:"Middle Center",value:qc.TableLayout.ALIGN_MIDDLE_CENTER},{label:"Middle Right",value:qc.TableLayout.ALIGN_MIDDLE_RIGHT},{label:"Bottom Left",value:qc.TableLayout.ALIGN_BOTTOM_LEFT},{label:"Bottom Center",value:qc.TableLayout.ALIGN_BOTTOM_CENTER},{label:"Bottom Right",value:qc.TableLayout.ALIGN_BOTTOM_RIGHT}]})]);var d,e=b.constraint;if(_.line([_.text("Constraint",{toolTip:fa._("TableLayout.constraint")}),d=_.dropDownList({bind:"constraint",items:[{label:"Flexible",value:qc.TableLayout.CONSTRAINT_FLEXIBLE},{label:"Fix Column Count",value:qc.TableLayout.CONSTRAINT_FIX_COLUMN_COUNT},{label:"Fix Row Count",value:qc.TableLayout.CONSTRAINT_FIX_ROW_COUNT}]})]),d.onValueChanged=function(b){e!==b&&(e=b,a.repaint())},e!==qc.TableLayout.CONSTRAINT_FLEXIBLE){var f;f=e===qc.TableLayout.CONSTRAINT_FIX_COLUMN_COUNT?_.text("Column Count",{"for":"tableLayout_stride",dragStep:1,toolTip:fa._("TableLayout.columnsCount")}):_.text("Row Count",{"for":"tableLayout_stride",dragStep:1,toolTip:fa._("TableLayout.rowsCount")}),_.line([f,_.numberInput({bind:"stride",id:"tableLayout_stride"})])}_.line([_.text("Ignore X pos",{toolTip:fa._("TableLayout.ignoreX")}),_.checkBox({bind:"ignoreX"})]),_.line([_.text("Ignore Y pos",{toolTip:fa._("TableLayout.ignoreY")}),_.checkBox({bind:"ignoreY"})]),_.line([_.text("Auto Update",{toolTip:fa._("TableLayout.autoUpdate")}),_.checkBox({bind:"autoUpdate"})]),_.line([_.empty(),a._rebuildTable=_.button(fa._("Relayout"))]),a._rebuildTable.on("click",function(){b.relayout()})};var Tc=m("qc.editor.VerticalLayoutPanel",qc.editor.Panel,function lf(a){var b=this;lf["super"].constructor.call(b,a),b.title="VerticalLayout",b.checkable=!0,b.removable=!0});Tc.prototype.onEnable=function(){this.target.enable=!0},Tc.prototype.onDisable=function(){this.target.enable=!1},Tc.prototype.onRemove=function(){var a=this;a.removeSelf()},Tc.prototype.update=function(){var a=this;a.checked=a.target.enable},Tc.prototype.paint=function(){var a=this;a.checked=a.target.enable},Tc.prototype.paint=function(){var a=this,b=a.target;_.columnWidths=[a.indent,120-a.indent,"60+0.5"];var c=_.titleLine("Padding");c.add(_.line([_.empty(),_.text("Left",{"for":"verLayout_paddingLeft",dragStep:1,toolTip:fa._("Bounds.paddingLeft")}),_.numberInput({bind:"paddingLeft",id:"verLayout_paddingLeft"})])),c.add(_.line([_.empty(),_.text("Right",{"for":"verLayout_paddingRight",dragStep:1,toolTip:fa._("Bounds.paddingRight")}),_.numberInput({bind:"paddingRight",id:"verLayout_paddingRight"})])),c.add(_.line([_.empty(),_.text("Top",{"for":"verLayout_paddingTop",dragStep:1,toolTip:fa._("Bounds.paddingTop")}),_.numberInput({bind:"paddingTop",id:"verLayout_paddingTop"})])),c.add(_.line([_.empty(),_.text("Bottom",{"for":"verLayout_paddingBottom",dragStep:1,toolTip:fa._("Bounds.paddingBottom")}),_.numberInput({bind:"paddingBottom",id:"verLayout_paddingBottom"})])),_.columnWidths=[120,"60+0.5"],_.line([_.text("Spacing",{"for":"verLayout_spacing",dragStep:.01,toolTip:fa._("VerticalLayout.spacing")}),_.numberInput({bind:"spacing",id:"verLayout_spacing"})]),_.line([_.text("Size Provider",{toolTip:fa._("TableLayout.contentSizeProvider")}),_.dropDownList({bind:"contentSizeProvider",items:[{label:"Real Bounds",value:qc.TableLayout.USE_BOUNDS},{label:"RectTransform",value:qc.TableLayout.USE_RECTTRANSFORM}]})]),_.line([_.text("Content Alignment",{toolTip:fa._("TableLayout.contentAlignment")}),_.dropDownList({bind:"contentAlignment",items:[{label:"Top",value:qc.TableLayout.ALIGN_TOP_LEFT},{label:"Middle",value:qc.TableLayout.ALIGN_MIDDLE_LEFT},{label:"Bottom",value:qc.TableLayout.ALIGN_BOTTOM_LEFT}]})]),_.line([_.text("Cell Alignment",{toolTip:fa._("TableLayout.cellAlignment")}),_.dropDownList({bind:"cellAlignment",items:[{label:"Left",value:qc.TableLayout.ALIGN_TOP_LEFT},{label:"Center",value:qc.TableLayout.ALIGN_TOP_CENTER},{label:"Right",value:qc.TableLayout.ALIGN_TOP_RIGHT}]})]),_.columnWidths=["100"],_.line([_.text("Child Force Expand")]),_.columnWidths=[a.indent,120-a.indent,"60+0.5"],_.line([_.empty(),_.text("Width",{toolTip:fa._("VerticalLayout.childForceExpandWidth")}),_.checkBox({bind:"childForceExpandWidth"})]),_.line([_.empty(),_.text("Height",{toolTip:fa._("VerticalLayout.childForceExpandHeight")}),_.checkBox({bind:"childForceExpandHeight"})]),_.columnWidths=[120,"60+0.5"],_.line([_.text("Auto Update",{toolTip:fa._("TableLayout.autoUpdate")}),_.checkBox({bind:"autoUpdate"})]),_.line([_.empty(),a._rebuildTable=_.button(fa._("Relayout"))]),a._rebuildTable.on("click",function(){b.relayout()})};var Uc=m("qc.editor.AspectRatioFitterPanel",qc.editor.Panel,function mf(a){var b=this;mf["super"].constructor.call(b,a),b.title="Aspect Ratio Fitter",b.checkable=!0,b.removable=!0});Uc.prototype.onEnable=function(){this.target.enable=!0},Uc.prototype.onDisable=function(){this.target.enable=!1},Uc.prototype.onRemove=function(){var a=this;a.removeSelf()},Uc.prototype.update=function(){var a=this;a.checked=a.target.enable},Uc.prototype.paint=function(){var a=this,b=a.target;_.columnWidths=["60+0.1","60+0.5",60],_.line([_.text("Mode",{toolTip:fa._("AspectRatioFitter.mode")}),_.dropDownList({bind:"mode",items:[{label:"None",value:qc.AspectRatioFitter.NONE},{label:"Width Controls Height",value:qc.AspectRatioFitter.WIDTH_CONTROLS_HEIGHT},{label:"Height Controls Width",value:qc.AspectRatioFitter.HEIGHT_CONTROLS_WIDTH},{label:"Fit In Parent",value:qc.AspectRatioFitter.FIT_IN_PARENT},{label:"Envelope Parent",value:qc.AspectRatioFitter.ENVELOPE_PARENT}]},{colspan:2})]);var c;_.line([_.text("Ratio",{toolTip:fa._("AspectRatioFitter.ratio")}),_.numberInput({bind:"ratio"}),c=_.button(fa._("Calculate"))]),c.on("click",function(){var a=fa.hierarchy.activeNode;if(a){var c=a.texture,d=a.frame;if(c)if(c.frameNames&&c.frameNames.indexOf(d)>=0){var e=c.frames[c.frameNames.indexOf(d)].width,f=c.frames[c.frameNames.indexOf(d)].height;b.ratio=e/f}else c.img&&(b.ratio=c.img.width/c.img.height)}})};var Vc=m("qc.editor.FilterGroupPanel",qc.editor.Panel,function nf(a){var b=this;nf["super"].constructor.call(b,a),b.title="FilterGroup",b.checkable=!0,b.removable=!0});Vc.prototype.onEnable=function(){this.target.enable=!0},Vc.prototype.onDisable=function(){this.target.enable=!1},Vc.prototype.onRemove=function(){var a=this;a.removeSelf()},Vc.prototype.update=function(){var a=this;a.checked=a.target.enable},Vc.prototype.paint=function(){var a=this,b=this.target,c=[95,20,"30+0.3",20,"30+0.3"];_.columnWidths=[90,"60+0.5"],_.line([_.text("Inherited"),_.checkBox({bind:"inherited"})]);var d=new qc.editor.AddComponentButton;d.text=fa._("Add Filter"),d.items=[];var e=qc.Filter.filters;for(var f in e){var g=qc.Util.findClass(f);g&&d.addItem(f,null,{icon:"UnknowIcon",clazz:f})}d.on(fa.e.SELECT_COMPONENT,function(c){fa.inspector.propertyView.emit(fa.e.INSPECTOR_COMP_VALUE_CHANGE,{node:b,field:"filter"}),b.addFilter(c.clazz),a.repaint()}),_.line([_.comp(d,{},{colspan:2})]);var h=new Wc({draggable:!0,removable:!0}),e=b.filters;if(e.forEach(function(a){h.addItem(a)}),a._currentFilter=a._currentFilter||(e.length>0?e[0]:null),h.select(a._currentFilter),h.selectionModel.on("selectionChange",function(){var b=h.selection[0];a._currentFilter=b&&b.filter,a.repaint()}),h.dataModel.on("dataModelChange",function(a){"remove"===a.kind&&(fa.inspector.propertyView.emit(fa.e.INSPECTOR_COMP_VALUE_CHANGE,{node:b,field:"filter"}),b.removeFilter(a.data.filter))}),h.dataModel.on("hierarchyChange",function(){var a=[];h.dataModel.roots.forEach(function(b){a.push(b.filter)}),b.filters=a}),_.line([_.comp(h,{},{colspan:2})],100),a._currentFilter){_.columnWidths=c;var i=a._currentFilter.getExtraUniforms();for(var j in i){var k=i[j];this.drawUniform(a,a._currentFilter,j,k)}}},Vc.prototype.drawUniform=function(a,b,c,d){var e=this,f=qc.Filter,g=this.target;switch(_.columnWidths=[95,20,"30+0.3",20,"30+0.3"],d){case f.F1:case f.I1:return void _.line([_.text(pc.makePropertyName(c)),_.numberInput({bind:c,bindTarget:b},{colspan:4})]);case f.I2V:case f.F2V:return b[c]||(b[c]=[0,0]),void _.line([_.text(pc.makePropertyName(c)),_.text("X"),_.numberInput({bind:"0",bindTarget:b[c]}),_.text("Y"),_.numberInput({bind:"1",bindTarget:b[c]})]);case f.I3V:case f.F3V:return b[c]||(b[c]=[0,0,0]),_.columnWidths=[95,20,"20+0.3",20,"20+0.3",20,"20+0.3"],void _.line([_.text(pc.makePropertyName(c)),_.text("X"),_.numberInput({bind:"0",bindTarget:b[c]}),_.text("Y"),_.numberInput({bind:"1",bindTarget:b[c]}),_.text("Z"),_.numberInput({bind:"2",bindTarget:b[c]})]);case f.I4V:case f.F4V:return b[c]||(b[c]=[0,0,0,0]),_.line([_.text(pc.makePropertyName(c)),_.text("X"),_.numberInput({bind:"0",bindTarget:b[c]}),_.text("Y"),_.numberInput({bind:"1",bindTarget:b[c]})]),void _.line([_.text(pc.makePropertyName(c)),_.text("Z"),_.numberInput({bind:"2",bindTarget:b[c]}),_.text("W"),_.numberInput({bind:"3",bindTarget:b[c]})]);case f.MAT2:return b[c]||(b[c]=[1,0,0,1]),_.columnWidths=[95,"20+0.3","20+0.3"],_.line([_.text(pc.makePropertyName(c))]),_.line([_.empty(),_.numberInput({bind:"0",bindTarget:b[c]}),_.numberInput({bind:"1",bindTarget:b[c]})]),void _.line([_.empty(),_.numberInput({bind:"2",bindTarget:b[c]}),_.numberInput({bind:"3",bindTarget:b[c]})]);case f.MAT3:return b[c]||(b[c]=[1,0,1,0,1,1,0,0,1]),_.columnWidths=[95,"20+0.3","20+0.3","20+0.3"],_.line([_.text(pc.makePropertyName(c))]),_.line([_.empty(),_.numberInput({bind:"0",bindTarget:b[c]
}),_.numberInput({bind:"1",bindTarget:b[c]}),_.numberInput({bind:"2",bindTarget:b[c]})]),_.line([_.empty(),_.numberInput({bind:"3",bindTarget:b[c]}),_.numberInput({bind:"4",bindTarget:b[c]}),_.numberInput({bind:"5",bindTarget:b[c]})]),void _.line([_.empty(),_.numberInput({bind:"6",bindTarget:b[c]}),_.numberInput({bind:"7",bindTarget:b[c]}),_.numberInput({bind:"8",bindTarget:b[c]})]);case f.MAT4:return b[c]||(b[c]=[1,0,0,1,0,1,0,1,0,0,1,1,0,0,0,1]),_.columnWidths=[95,"20+0.3","20+0.3","20+0.3","20+0.3"],_.line([_.text(pc.makePropertyName(c))]),_.line([_.empty(),_.numberInput({bind:"0",bindTarget:b[c]}),_.numberInput({bind:"1",bindTarget:b[c]}),_.numberInput({bind:"2",bindTarget:b[c]}),_.numberInput({bind:"3",bindTarget:b[c]})]),_.line([_.empty(),_.numberInput({bind:"4",bindTarget:b[c]}),_.numberInput({bind:"5",bindTarget:b[c]}),_.numberInput({bind:"6",bindTarget:b[c]}),_.numberInput({bind:"7",bindTarget:b[c]})]),_.line([_.empty(),_.numberInput({bind:"8",bindTarget:b[c]}),_.numberInput({bind:"9",bindTarget:b[c]}),_.numberInput({bind:"10",bindTarget:b[c]}),_.numberInput({bind:"11",bindTarget:b[c]})]),void _.line([_.empty(),_.numberInput({bind:"12",bindTarget:b[c]}),_.numberInput({bind:"13",bindTarget:b[c]}),_.numberInput({bind:"14",bindTarget:b[c]}),_.numberInput({bind:"15",bindTarget:b[c]})]);case f.I2:case f.F2:return b[c]||(b[c]={x:0,y:0}),void _.line([_.text(pc.makePropertyName(c)),_.text("X"),_.numberInput({bind:"x",bindTarget:b[c]}),_.text("Y"),_.numberInput({bind:"y",bindTarget:b[c]})]);case f.I3:case f.F3:return b[c]||(b[c]={x:0,y:0,z:0}),_.columnWidths=[95,20,"20+0.3",20,"20+0.3",20,"20+0.3"],void _.line([_.text(pc.makePropertyName(c)),_.text("X"),_.numberInput({bind:"x",bindTarget:b[c]}),_.text("Y"),_.numberInput({bind:"y",bindTarget:b[c]}),_.text("Z"),_.numberInput({bind:"z",bindTarget:b[c]})]);case f.I4:case f.F4:return b[c]||(b[c]={x:0,y:0,z:0,w:0}),_.line([_.text(pc.makePropertyName(c)),_.text("X"),_.numberInput({bind:"x",bindTarget:b[c]}),_.text("Y"),_.numberInput({bind:"y",bindTarget:b[c]})]),void _.line([_.empty(),_.text("Z"),_.numberInput({bind:"z",bindTarget:b[c]}),_.text("W"),_.numberInput({bind:"w",bindTarget:b[c]})]);case f.SAMPLER2D:_.columnWidths=[95,"60+0.5"];var h=b[c];h||(h=b[c]=new qc.Filter.FilterTexture(g.gameObject.game));var i=pc.drawTextureInput(h,pc.makePropertyName(c),"texture/frame",function(){e.repaint()},b[c]),j=h.texture?h.texture.frameNames:[0];j.indexOf(h.frame)<0&&(h.frame=j[0]);var k;return h.frame?_.line([_.text("Frame"),k=_.dropDownList({bind:"frame",items:j,bindTarget:b[c]})]):h.frame=0,void(k&&i&&(k.onValueChanged=function(a){var b=i.associatedViewAndData;b&&(b.fileList[1]=a)}))}};var Wc=m("qc.editor.FilterList",qc.editor.InspectorList,function of(a){var b=this;of["super"].constructor.call(b,a)});Wc.prototype.addItem=function(a){var b=new qc.widget.Data;b.name=a["class"],b.filter=a,this.dataModel.add(b)},Wc.prototype.select=function(a){for(var b,c=this.dataModel.datas,d=0;d<c.length;d++){var e=c[d];if(e.filter===a){b=e;break}}this.selection=b};var Xc=qc.editor.TweenUtil=function(){};Xc.paintTweenBase=function(a,b){var c=a,d=[70,20,"30+1",20,"30+1"];_.columnWidths=[c.indent,120-c.indent,"60+0.5"];var e=_.titleLine("Tween",fa.preference.query("collapse.tween")===!0);e.add(_.line([_.empty(),_.text("Play Style",{toolTip:fa._("Tween.style")}),_.dropDownList({bind:"style",items:[{label:"Once",value:qc.Tween.STYLE_ONCE},{label:"Loop",value:qc.Tween.STYLE_LOOP},{label:"PingPong",value:qc.Tween.STYLE_PINGPONG}]})])),e.add(_.line([_.empty(),_.text("Curve",{toolTip:fa._("Tween.curve")}),c._curveButton=_.curveButton({})],60)),c._curveButton.bezierCurve=b.curve,e.add(_.line([_.empty(),_.text("Duration",{toolTip:fa._("Tween.duration")}),_.numberInput({bind:"duration"})])),e.add(_.line([_.empty(),_.text("Start Delay",{toolTip:fa._("Tween.delay")}),_.numberInput({bind:"delay"})])),e.add(_.line([_.empty(),_.text("Tween Group",{toolTip:fa._("Tween.tweenGroup")}),_.numberInput({bind:"tweenGroup"})])),e.add(_.line([_.empty(),_.text("Flag",{toolTip:fa._("Tween.flag")}),_.stringInput({bind:"flag"})])),_.columnWidths=d,_.line([_.empty(),c.btn=_.button(fa._("Play/Stop"),{},{colspan:4})]),c.btn.on("click",function(){b.canRunInEditor?b.stop():(b.resetToBeginning(),b.play())}),_.line([_.empty(),c.resetBtn=_.button(fa._("Reset To Begin"),{},{colspan:4})]),c.resetBtn.on("click",function(){b.canRunInEditor&&b.stop(),b.resetToBeginning()}),_.line([_.empty(),c.btn=_.button(fa._("Play/Stop Group"),{},{colspan:4})]),c.btn.on("click",function(){b.canRunInEditor?b.stopGroup():(b.resetGroupToBeginning(),b.playGroup())}),_.line([_.empty(),c.resetBtn=_.button(fa._("Reset Group to Begin"),{},{colspan:4})]),c.resetBtn.on("click",function(){b.canRunInEditor&&b.stopGroup(),b.resetGroupToBeginning()})},Xc.paintTween=function(a,b){var c=a,d=[70,20,"30+1",20,"30+1"];_.columnWidths=d,_.line([_.empty(),c.btnSetCurrToStart=_.button(fa._("Set Curr To Start"),{},{colspan:4})]),c.btnSetCurrToStart.on("click",function(){b.setCurrToStartValue(),c.iv()}),_.line([_.empty(),c.btnSetCurrToEnd=_.button(fa._("Set Curr To End"),{},{colspan:4})]),c.btnSetCurrToEnd.on("click",function(){b.setCurrToEndValue(),c.iv()}),_.columnWidths=[120,"50+1"],_.line([_.text("Play On Awake",{toolTip:fa._("Tween.playOnAwake")}),_.checkBox({bind:"playOnAwake"})]),Xc.paintTweenBase(a,b)};var Yc=m("qc.editor.TweenAlphaPanel",qc.editor.Panel,function pf(a){var b=this;pf["super"].constructor.call(b,a),b.title="TweenAlpha",b.icon="inspector_text",b.checkable=!0,b.removable=!0});Yc.prototype.onEnable=function(){this.target.enable=!0},Yc.prototype.onDisable=function(){this.target.enable=!1},Yc.prototype.onRemove=function(){var a=this;a.removeSelf()},Yc.prototype.update=function(){var a=this;a.checked=a.target.enable},Yc.prototype.paint=function(){var a=this,b=this.target,c=[70,"60+1"];_.columnWidths=c,_.line([_.text("From",{title:"From",toolTip:fa._("TweenAlpha.from")}),_.numberInput({bind:"from"})]),_.line([_.text("To",{title:"From",toolTip:fa._("TweenAlpha.to")}),_.numberInput({bind:"to"})]),qc.editor.TweenUtil.paintTween(a,b)};var Zc=m("qc.editor.TweenColorPanel",qc.editor.Panel,function(a){var b=this;Zc["super"].constructor.call(b,a),b.title="TweenColor",b.icon="inspector_text",b.checkable=!0,b.removable=!0});Zc.prototype.onEnable=function(){this.target.enable=!0},Zc.prototype.onDisable=function(){this.target.enable=!1},Zc.prototype.onRemove=function(){var a=this;a.removeSelf()},Zc.prototype.update=function(){var a=this;a.checked=a.target.enable},Zc.prototype.paint=function(){var a=this,b=this.target;_.columnWidths=[70,"60+1"],pc.drawColorPicker(b,{title:"From",toolTip:fa._("TweenColor.from")},"from"),pc.drawColorPicker(b,{title:"To",toolTip:fa._("TweenColor.to")},"to"),qc.editor.TweenUtil.paintTween(a,b)};var $c=m("qc.editor.TweenPositionPanel",qc.editor.Panel,function qf(a){var b=this;qf["super"].constructor.call(b,a),b.title="TweenPosition",b.icon="inspector_text",b.checkable=!0,b.removable=!0});$c.prototype.onEnable=function(){this.target.enable=!0},$c.prototype.onDisable=function(){this.target.enable=!1},$c.prototype.onRemove=function(){var a=this;a.removeSelf()},$c.prototype.update=function(){var a=this;a.checked=a.target.enable},$c.prototype.paint=function(){var a=this,b=this.target,c=[70,20,"30+1",20,"30+1"];_.columnWidths=["70+0.1","60+0.5"],_.line([_.text("Move Axis",{toolTip:fa._("TweenPosition.moveAxis")}),a._moveType=_.dropDownList({bind:"moveAxis",items:[{label:"X,Y",value:qc.TweenPosition.BOTH},{label:"Only X",value:qc.TweenPosition.ONLY_X},{label:"Only Y",value:qc.TweenPosition.ONLY_Y}]})]),_.columnWidths=c,pc.drawPoint(b,{title:"From",toolTip:fa._("TweenPosition.from")},"from"),pc.drawPoint(b,{title:"To",toolTip:fa._("TweenPosition.to")},"to"),qc.editor.TweenUtil.paintTween(a,b)};var _c=m("qc.editor.TweenPropertyPanel",qc.editor.Panel,function rf(a){var b=this;rf["super"].constructor.call(b,a),b.title="TweenProperty",b.icon="inspector_text",b.checkable=!0,b.removable=!0});_c.prototype.onEnable=function(){this.target.enable=!0},_c.prototype.onDisable=function(){this.target.enable=!1},_c.prototype.onRemove=function(){var a=this;a.removeSelf()},_c.prototype.update=function(){var a=this;a.checked=a.target.enable},_c.prototype.paint=function(){var a=this,b=this.target,c=[90,"60+1"];_.columnWidths=c,_.line([_.text("Property",{toolTip:fa._("TweenProperty.property")}),_.stringInput({bind:"property"})]),_.line([_.text("From",{toolTip:fa._("TweenProperty.from")}),_.numberInput({bind:"from"})]),_.line([_.text("To",{toolTip:fa._("TweenProperty.to")}),_.numberInput({bind:"to"})]),qc.editor.TweenUtil.paintTween(a,b)};var ad=m("qc.editor.TweenRotationPanel",qc.editor.Panel,function sf(a){var b=this;sf["super"].constructor.call(b,a),b.title="TweenRotation",b.icon="inspector_text",b.checkable=!0,b.removable=!0});ad.prototype.onEnable=function(){this.target.enable=!0},ad.prototype.onDisable=function(){this.target.enable=!1},ad.prototype.onRemove=function(){var a=this;a.removeSelf()},ad.prototype.update=function(){var a=this;a.checked=a.target.enable},ad.prototype.paint=function(){var a=this,b=this.target,c=[70,"60+1"];_.columnWidths=c,_.line([_.text("From",{toolTip:fa._("TweenRotation.from")}),_.angleInput({bind:"from"})]),_.line([_.text("To",{toolTip:fa._("TweenRotation.to")}),_.angleInput({bind:"to"})]),qc.editor.TweenUtil.paintTween(a,b)};var bd=m("qc.editor.TweenScalePanel",qc.editor.Panel,function tf(a){var b=this;tf["super"].constructor.call(b,a),b.title="TweenScale",b.icon="inspector_text",b.checkable=!0,b.removable=!0});bd.prototype.onEnable=function(){this.target.enable=!0},bd.prototype.onDisable=function(){this.target.enable=!1},bd.prototype.onRemove=function(){var a=this;a.removeSelf()},bd.prototype.update=function(){var a=this;a.checked=a.target.enable},bd.prototype.paint=function(){var a=this,b=this.target,c=[70,20,"30+1",20,"30+1"];_.columnWidths=c,pc.drawPoint(b,{title:"From",toolTip:fa._("TweenScale.from")},"from"),pc.drawPoint(b,{title:"To",toolTip:fa._("TweenScale.to")},"to"),qc.editor.TweenUtil.paintTween(a,b)};var cd=m("qc.editor.AtlasNodePanel",qc.editor.Panel,function uf(a,b){var d=this;uf["super"].constructor.call(d),d.title=fa._("UI Atlas"),d.checkable=!1,d.removable=!1,fa.atlasNodePanel=d,d.uuid=a,d.target=fa.project.findByUUID(a),d.targetKey=d.target?d.target.url:"",d.image=c,d.defaultFrame=b,d.target&&(d.image=d.target.img,d.repaint())});fa.e.on(fa.e.BG_RESOURCE_LOADED,function(a){var b=fa.atlasNodePanel;if(b&&b.targetKey===a.key){var c=fa.inspector.propertyView.children;c&&c.length&&b===c[0]&&(b.target=a,b.image=b.target.img,b.repaint())}}),cd.prototype.paint=function(){var a=this,c=a.target;if(c&&a.image){var d,e,f;if(c.json&&0!==b.keys(c.json).length?(f=c.meta.animationType)?1===f?(d="frameAnimation",e=fa._("Frame Animation")):2===f?(d="dragonBones",e=fa._("DragonBone")):3===f&&(d="frameSamples",e=fa._("DragonBone(Sampled)")):(d="atlas",e=fa._("Atlas")):(d="normal",e=fa._("Normal Texture")),_.columnWidths=["100+0.5","120+0.1"],_.line([_.text(e,{textFont:"bold 12px Arial"},{colspan:2})]),"atlas"===d||"frameAnimation"===d){var g;_.line([_.text(sb(c.url),{}),g=_.button(fa._("Edit Frame Animation"))]),g.on("click",function(){fa.inspector.propertyView.inspect(null,"frameAnimation",{uuid:a.uuid,previousPanel:"AtlasNodePanel"})})}else if("frameSamples"===d){var h;_.line([_.text(sb(c.url),{}),h=_.button(fa._("Revert"))]),h.on("click",function(){a.revertToDragonbones()})}else if("dragonBones"===d){var i;_.line([_.text(sb(c.url),{}),i=_.button(fa._("Sampled"))]),i.on("click",function(){a.sampleCurrentAnimation()})}else _.line([_.text(sb(c.url),{},{colspan:2})]);var j,l=150,m=144,n=fa.project.getImageURLByAtlas(c);_.line([j=_.painter({borderWidth:1,tileSize:m,preferredSize:{width:l,height:l}},{fill:"none",align:"center",colspan:2})],l),j.addTopPainter(function(a){k.drawImage(a,n,"uniform",(l-m)/2,(l-m)/2,m,m)}),"dragonBones"===d?a.drawAtlasAnimations(!0):"frameSamples"===d?a.drawAtlasAnimations(!1):"frameAnimation"===d?(a.drawAtlasFrames(),a.drawAtlasAnimations(!1)):"atlas"===d?a.drawAtlasFrames():"normal"===d&&a.drawNormalImage()}},cd.prototype.revertToDragonbones=function(){var a=this,b=a.target;return b&&b.json&&b.meta&&3===b.meta.animationType?void qc.editor.Operation.REVERT_TO_DRAGONBONES(b.url):void fa.log.trace("当前目标不是帧采样动画，无法恢复。")},cd.prototype.sampleCurrentAnimation=function(){var a=this,b=a.target;return b&&b.json&&b.meta&&2===b.meta.animationType?void qc.editor.Operation.SAMPLE_DRAGON_BONES(b):void fa.log.trace("当前目标不是 dragonbones，不进行 sample 化。")},cd.prototype.drawAtlasAnimations=function(a){var c,d=this;c=a?d.target.animation.data.armature[0].animation:d.target.animation.data.animations||d.target.animation.data.samples,_.columnWidths=[d.indent,"60+0.5",40,80];var e=_.titleLine(fa._("Animations List"));e.add(_.line([_.empty(),_.text(fa._("Name"),{align:"left"}),_.text(fa._("Loop"),{align:"center"}),_.text(fa._("Operation"),{align:"center"})])),e.add(_.line([_.divider(null,{colspan:4})]));var f=c?b.keys(c).sort():[];for(var g in f)!function(b){var f=c[b];a&&(b=f.name);var g,h=f.loop;e.add(_.line([_.empty(),_.text(b,{align:"left"}),_.text(a&&0===h||!a&&h===!0?"Y":"N",{align:"center"}),g=_.button(fa._("Play"))])),g.on("click",function(){d.playAnimation(b)})}(f[g]);e.add(_.line([_.divider(null,{colspan:4})]))},cd.prototype.playAnimation=function(a){var b=this,c=b.target;if(c){var d="playAniNode",e=fa.hiddenGame,f=e.world.find(d);f||(f=e.add.sprite(),f.name=d),f.texture!==c&&(f.texture=c);var g=160,h=160;if((fa.hiddenGame.width!==g||fa.hiddenGame.height!==h)&&fa.hiddenGame.phaser.scale.setGameSize(g,h),b.calcNodeScale(f,a),f.animationNameList&&!(f.animationNameList.indexOf(a)<0)){f.playAnimation(a),f.animationType===qc.Sprite.FRAME_ANIMATION&&f.resetNativeSize();var i=fa.inspector.previewView.content;if(!i||i.atlas!==c||!i.parent){i=_.painter({background:null}),i._zoom=i._cacheZoom=1,b.adjustNodePos(f),fa.hiddenGame.phaser.updateRender(),i.atlas=c,fa.inspector.previewView.content=i;var j=new qc.widget.Slider;j.view.style.right="5px",j.view.style.top="5px",j.background="rgb(63, 76, 106)",j.forecolor="rgb(139, 151, 172)",j.min=.5,j.max=2,j.step=.1,j.value=1,j.width=70,j.height=12,j.disableToolTip(),j.on("propertyChange",function(a){"value"===a.property&&(fa.inspector.previewView.content._zoom=a.newValue)}),i.view.appendChild(j.view),j.iv(),i.addTopPainter(function(a){var b=Math.min(i.width,i.height);a.drawImage(fa.hiddenGame.canvas,0,0,fa.hiddenGame.canvas.width,fa.hiddenGame.canvas.height,.5*(i.width-b),.5*(i.height-b),b,b)});var k=setInterval(function(){return i.parent?(i._zoom!==i._cacheZoom&&(i._cacheZoom=i._zoom,b.adjustNodePos(f,i._zoom)),void i.iv()):void clearInterval(k)},33)}}}},cd.prototype.calcNodeScale=function(a,b){if(!a.texture._aniPlayInfo){var c=a.game.width,d=a.game.height,e=this.getSpriteBox(a,b),f=c/(1.6*e.width),g=d/(1.6*e.height);f>1&&g>1&&(f=1,g=1);var h=Math.min(f,g);a.texture._aniPlayInfo={scale:h,box:e}}},cd.prototype.adjustNodePos=function(a,b){if(a.texture){var c=a.texture._aniPlayInfo;if(c){var d=c.scale*(b||1),e=c.box;a.scaleX=d,a.scaleY=d;var f=a.game.width,g=a.game.height;a.x=.5*f-(.5*e.width+e.x)*d,a.y=.5*g-(.5*e.height+e.y)*d}}},cd.prototype.getSpriteBox=function(a,b){var c,d=a.animationType;if(d===qc.Sprite.FRAME_ANIMATION){var e=a._animation[b].frames[0],f=a.texture.getFrame(e);c=new qc.Rectangle(0,0,f.width,f.height)}else if(d===qc.Sprite.DRAGON_BONES){var g=a.width,h=a.height;a.width=0,a.height=0;var i,j,k;a.children.length&&(i=a.children[0],j=i.width,k=i.height,i.width=0,i.height=0),a.playAnimation(b),a._armature.advanceTime(0),c=qc.Bounds.getBox(a,0,!0,-1,a),a.stop(),a.width=g,a.height=h,i&&(i.width=j,i.height=k)}else if(d===qc.Sprite.FRAME_SAMPLES){var l=a.phaser.texture.baseTexture.width,m=a.phaser.texture.baseTexture.height,n=a._animation[b],o=0,p=n.frames[o],q=a.texture.animation.data,r=q.uvs;q.convert||(q.convert={});for(var s=(q.convert[b]||{})[o],t=1/0,u=1/0,v=-(1/0),w=-(1/0),x=function(a,b){t=Math.min(a,t),v=Math.max(a,v),u=Math.min(b,u),w=Math.max(b,w)},y=0,z=p.length/10;z>y;y++){var A=10*y,B=4*p[A];if(s)x(p[A+1],p[A+2]),x(p[A+3],p[A+4]),x(p[A+5],p[A+6]),x(p[A+7],p[A+8]);else{var C=p[A+1],D=p[A+2],E=p[A+3],F=p[A+4],G=p[A+5],H=p[A+6],I=p[A+7],J=p[A+8],K=(r[B+2]-r[B])*l,L=(r[B+3]-r[B+1])*m,M=K*-I,N=L*-J,O=K*(1-I),P=L*(1-J);x(C*M+E*N+G,D*M+F*N+H),x(C*O+E*N+G,D*O+F*N+H),x(C*O+E*P+G,D*O+F*P+H),x(C*M+E*P+G,D*M+F*P+H)}}c=new qc.Rectangle(t,u,v-t,w-u)}return c},cd.prototype.drawAtlasFrames=function(){var a,c=this,d=b.keys(c.target.json.frames).sort();if(_.columnWidths=["60+0.01","40+0.5"],_.line([_.text(fa._("Frames")),a=_.dropDownList({items:d})]),c.ninePaddingConf)a.value=c.ninePaddingConf.frameKey;else{var e;e=c.defaultFrame||d[0],a.value=e,c.selectFrame(e)}a.onValueChanged=function(a){c.selectFrame(a,!0)},c.drawImage()},cd.prototype.selectFrame=function(a,b){var c,d,e,f,g=this;if(!((c=this.target)&&(d=c.json)&&(e=d.frames)&&(f=e[a])))return!1;var h=f.frame;return g.ninePaddingConf={frameKey:a,frame:h},b&&g.repaint(),!0},cd.prototype.drawNormalImage=function(){var a=this;a.ninePaddingConf={frameKey:0,frame:{x:0,y:0,w:a.target.img.width,h:a.target.img.height}},a.drawImage()},cd.prototype.drawImage=function(){var a,b=this;_.columnWidths=["15+0.0","35+0.1","12+0.5","35+0.1","12+0.5"];var c,d,e,f,g=_.titleLine(fa._("Nine Patch Padding")),h=function(c,d,e,f,g){if(fa.inspector.previewView.content!==a&&(fa.inspector.previewView.content=a),g){var h=b.target.meta.padding,i=b.ninePaddingConf.frameKey;h||(b.target.meta.padding=h={}),h[i]||(h[i]=[0,0,0,0]),h[i][0]=parseFloat(c),h[i][1]=parseFloat(d),h[i][2]=parseFloat(e),h[i][3]=parseFloat(f),qc.editor.Operation.SAVE_PADDING(b.target.url,i,h[i])}a.paddingData=[parseFloat(c),parseFloat(d),parseFloat(e),parseFloat(f)],a.iv()},i=function(a){var c=b.target.meta.padding;if(!c)return 0;var d=b.ninePaddingConf.frameKey;return c[d]?c[d][a]:0};g.add(_.line([_.empty(),_.text("Left",{"for":"ninePaddingLeft",dragStep:.1,align:"center"}),c=_.numberInput({id:"ninePaddingLeft",value:i(0)}),_.text("Right",{"for":"ninePaddingRight",dragStep:.1,align:"center"}),e=_.numberInput({id:"ninePaddingRight",value:i(2)})])),g.add(_.line([_.empty(),_.text("Top",{"for":"ninePaddingTop",dragStep:.1,align:"center"}),d=_.numberInput({id:"ninePaddingTop",value:i(1)}),_.text("Bottom",{"for":"ninePaddingBottom",dragStep:.1,align:"center"}),f=_.numberInput({id:"ninePaddingBottom",value:i(3)})]));var j;g.add(_.line([j=_.button(fa._("Save"),{preferredSize:{width:60,height:18}},{colspan:5,fill:"none",align:"right"})])),j.on("click",function(){h(c.finalValue,d.finalValue,e.finalValue,f.finalValue,!0)}),c.onValueChanged=d.onValueChanged=e.onValueChanged=f.onValueChanged=function(){h(c.finalValue,d.finalValue,e.finalValue,f.finalValue)},a=_.painter({background:null}),a.paddingData=[i(0),i(1),i(2),i(3)],fa.inspector.previewView.content=a;b.target.json.frames;a.addTopPainter(function(c){var d=b.ninePaddingConf.frame,e=a.width,f=a.height,g=d.w,h=d.h,i=1;(g>e||h>f)&&(i=Math.min(e/g,f/h));var j=g*i,l=h*i,m=function(a){return a*i+(e-j)/2},n=function(a){return a*i+(f-l)/2};c.drawImage(b.image,d.x,d.y,g,h,m(0),n(0),j,l),c.strokeStyle="lime";var o,p,q=!1;p=this.paddingData[0],p>0&&(q=!0,c.beginPath(),c.moveTo(m(p),n(0)),c.lineTo(m(p),n(h)),c.stroke()),p=this.paddingData[1],p>0&&(q=!0,c.beginPath(),c.moveTo(m(0),n(p)),c.lineTo(m(g),n(p)),c.stroke()),p=this.paddingData[2],p>0&&(q=!0,o=g-p,c.beginPath(),c.moveTo(m(o),n(0)),c.lineTo(m(o),n(h)),c.stroke()),p=this.paddingData[3],p>0&&(q=!0,o=h-p,c.beginPath(),c.moveTo(m(0),n(o)),c.lineTo(m(g),n(o)),c.stroke()),q&&(c.strokeStyle="black",h>g?(c.beginPath(),c.moveTo(m(0),n(0)),c.lineTo(m(0),n(h)),c.stroke(),c.beginPath(),c.moveTo(m(g),n(0)),c.lineTo(m(g),n(h)),c.stroke()):g>h&&(c.beginPath(),c.moveTo(m(0),n(0)),c.lineTo(m(g),n(0)),c.stroke(),c.beginPath(),c.moveTo(m(0),n(h)),c.lineTo(m(g),n(h)),c.stroke()));var r="12px Arial";c.font=r;var s=d.w+" * "+d.h,t=k.getTextSize(r,s);t.width+=6;var u=(e-t.width)/2,v=f-16;c.beginPath(),c.rect(u,v,t.width,16),c.fillStyle="rgb(19, 19, 19)",c.fill(),c.beginPath(),k.drawText(c,s,r,"white",u,v,t.width,16,"center")})};var dd=m("qc.editor.JSNodePanel",qc.editor.Panel,function vf(a){var b=this;b.uuid=a.resUUID;var c={name:a._name,fullPath:a._id,uuid:a.resUUID,dependences:a.dependences||[]};vf["super"].constructor.call(b,c),b.treeData=a,b.title=fa._("JavaScript Management"),b.checkable=!1,b.removable=!1,0===b.target.fullPath.indexOf("Editor")&&(b.target.isEditorScript=!0),b.repaint()});dd.prototype.paint=function(){_.columnWidths=[100,"60+0.5"],this.drawJSInfo(),this.drawCode()},dd.prototype.drawJSInfo=function(){var a,b=this,c=b.target,d=c.fullPath;_.line([_.text(fa._("Script")),b.label(c.name,d)]),_.line([_.text(fa._("Path")),b.label(d,d)]),/^Plugins/i.test(c.fullPath)||(_.line([_.text(fa._("Load Order")),a=_.button(fa._("Edit"))]),a.on("click",function(){fa.inspector.propertyView.inspect(null,"scriptOrder",{uuid:b.uuid,path:d,previousPanel:"JSNodePanel"})}))},dd.prototype.drawCode=function(){var a=this.target.fullPath,b=new Ka;_.line([_.text(fa._("Code Preview"),null,{colspan:2})]),_.line([_.comp(b,{},{colspan:2})],300),qc.editor.Operation.SOURCE(a,function(a){if(a){var c=a.source;c=c.replace(/</g,"&lt;"),c=c.replace(/>/g,"&gt;"),b.layout.content='<pre class="prettyprint linenums">'+c+"</pre>",U(function(){prettyPrint(null,b.view)})}})},dd.prototype.blinkUrl=function(a){var b,c={fileTree:a.substring(0,a.lastIndexOf("/")),fileList:a};for(b in c){var d=c[b],e=fa.mainContainer.findViewById(b),f=e.dataModel.getDataById(d);"fileTree"===b&&(e.selectionModel.selection=f),e.makeVisible(f),e.blink(f)}},dd.prototype.label=function(a,b){var c=this,d=_.label(a,{borderColor:"rgb(221, 221, 221)"});return d.addEventListener("click",function(){c.blinkUrl(b)}),d};var ed=m("qc.editor.ReferencePanel",qc.editor.Panel,function wf(a){var b=this;b.nodeObjs=a,wf["super"].constructor.call(b),b.checkable=!1,b.removable=!1,b.title=fa._("Retainers")});ed.prototype.paint=function(){var a=this,b=a.nodeObjs;if(_.columnWidths=[.1],b.length>0){var c=1;b.forEach(function(b){var d,e=b.node,f=c++ +".  "+a.getFullPath(e);b.script?f+='<span style="color: rgb(199, 146, 234)">['+b.script["class"]+'<span style="color: rgb(128, 203, 174)">#'+b.property+"</span>]</span>":b.property&&(f+='<span style="color: rgb(128, 203, 174)">#'+b.property+"</span>"),_.line([d=_.text(f,{textFont:"13px Arial"})]),d.view.addEventListener("click",function(){for(var a=fa.hierarchy.dataModel.datas,b=0;b<a.length;b++){var c=a[b];if(c.id===e.uuid){fa.hierarchy.makeVisible(c),fa.hierarchy.blink(c);break}}})})}else _.line([_.text(fa._("No retainer"),{textFont:"13px Arial"})])},ed.prototype.getFullPath=function(a){for(var b,c=a.name;(b=a.parent)&&b!==fa.game.world;)c=b.name+"/"+c,a=b;return c};var fd=m("qc.editor.ScenePanel",qc.editor.Panel,function xf(a){var b=this,c=a._name;c=c.slice(0,c.lastIndexOf("."));var d={name:c,fullPath:a._id,uuid:a.resUUID};xf["super"].constructor.call(b,d),fa.scenePanel=b,b.title=fa._("Scene Management"),b.checkable=!1,b.removable=!1,b.target=d,b.updateHistory()});fa.e.on(fa.e.SCENE_SAVED,function(a){var b=fa.scenePanel;if(b){var c=fa.inspector.propertyView.children;c&&c.length&&b===c[0]&&b.target&&b.target.name===a&&b.updateHistory()}}),fd.prototype.updateHistory=function(){var a=this,b=a.target.name;delete a.histories,qc.editor.Operation.GET_SCENE_BACKUP_LIST(b,function(b){b.operRet===!0&&(a.histories=(b.list||[]).sort(),a.repaint())})},fd.prototype.paint=function(){if(this.histories){_.columnWidths=["100+0.08","60+0.5"];var a=_.titleLine(fa._("Scene History")),b=fa.sceneList=new qc.editor.InspectorList({});a.add(_.line([_.comp(b,null,{colspan:2})],200));for(var c,d=this.histories,e=d.length;e--;){var c=d[e],f=new qc.widget.Data;f.fileName=c;var g=c.slice(-10);f.name=g.slice(0,2)+"/"+g.slice(2,4)+", "+g.slice(4,6)+":"+g.slice(6,8)+" "+(parseInt(g.slice(4,6))<12?"AM":"PM"),b.dataModel.add(f)}var h=this;b.view.addEventListener("dblclick",function(a){var c=b.getDataAt(a),d=c.fileName;return fa.config.editor.currScene!==h.target.name?void fa.notification.warn(fa._("Current Scene is not {0}, can not revert.").replace("{0}",h.target.name)):void mb(function(){qc.editor.Operation.REVERT_SCENE_TO_REVISION(h.target.name,d,function(a){return a.operRet!==!0?void fa.notification.warn(fa._("Revert Failed.")):void fa.service.request("SWITCH_SCENE",h.target.name,function(){fa.storage.set("switchScene","1"),fa.config.editor.currScene=h.target.name,fa.scene.reload(),ib(),h.updateHistory()})})})})}};var gd=m("qc.editor.WebFontNodePanel",qc.editor.Panel,function yf(a){var b=this,c={};"string"==typeof a&&fa.project.findByUUID(a)&&(b.uuid=a,b.wfont=fa.project.findByUUID(a),c.name=sb(b.wfont.url).slice(0,-4),c.url=b.wfont._fontUrl.join("\n")),yf["super"].constructor.call(b,c),b.title=fa._("Web Font"),b.checkable=!1,b.removable=!1});gd.prototype.paint=function(){var a=this,b=a.target;_.columnWidths=["50+0.1","60+0.5"],_.line(a.wfont?[_.text(fa._("Font Name")),_.text(b.name)]:[_.text(fa._("Font Name")),_.stringInput({bind:"name"})]),_.columnWidths=[a.indent,"60+1"];var c,d=_.titleLine(fa._("Font URLs (One URL per line)"));d.add(_.line([c=_.textArea({bind:"url"},{colspan:2})],100));var e;_.line([e=_.button(fa._("Save"),{},{colspan:2})],26),e.on("click",function(){a.save()})},gd.prototype.save=function(){var a=this,b=a.target;if(!b.url||!b.url.length)return void fa.notification.error(fa._("Font URLs are invalid"));var c,d,e,f,g=b.url.replace(/\\/g,"/"),h=g.split("\n"),i=[],j=h.length;for(c=0;j>c;c++)d=h[c],d&&i.indexOf(d)<0&&i.push(d);if(!i.length)return void fa.notification.error(fa._("Font URLs are invalid"));if(a.wfont)f=a.wfont.url.slice(0,-4)+".wfont";else{if(e=b.name,!e||!/^(\w)*$/.test(e))return void fa.notification.error(fa._("Name must be digital or letter"));f=fa.fileList.currentDir+"/"+e+".wfont"}qc.editor.Operation.UPLOAD(f,JSON.stringify({url:i}),function(){fa.notification.info(fa._("Web font is saved to: ")+f),b.url!==g&&(b.url=g)})};var hd=m("qc.editor.PluginManagerEditor",qc.editor.Panel,function(a){var b=this;hd["super"].constructor.call(b,a),b.title=fa._("Plugin Manager"),b.checkable=!1,b.removable=!1,b.target=fa.pluginInfo,qc.editor.Operation.QUERY_PLUGIN_INFO(function(a){fa.pluginInfo=a,b.target=fa.pluginInfo,b.repaint()})});hd.prototype.paint=function(){_.columnWidths=["40+0.08","80+0.5"];var a=this;_.line([_.text(fa._("Plugin List"),{},{colspan:2})]);var b=new Za({checkable:!0});_.line([_.comp(b,{},{colspan:2})],150);var c=fa.pluginInfo&&fa.pluginInfo.plugins,d=fa.pluginInfo&&fa.pluginInfo.effective;if(c){for(var e in d){var f,g=new qc.widget.Data;g.name=(f=c[e]&&c[e].name)?f:e,g.type=1,g.key=e,b.dataModel.add(g),b.selectionModel.appendSelection(g)}for(var e in c)if(!d[e]){var g=new qc.widget.Data;g.name=c[e].name,g.type=2,g.key=e,b.dataModel.add(g)}}if(b.selectionModel.on("selectionChange",function(c){var e=c.datas;if(1===e.length){var f=e[0];if(1===f.type){if(b.selectionModel.isSelected(f))return;a.invalidatePlugin(f.key),delete d[f.key],a.repaint(),a.savePluginInfo()}else{if(!b.selectionModel.isSelected(f))return;a.validatePlugin(f.key),d[f.key]={},a.repaint(),a.savePluginInfo()}}}),a._currentSelectionKey)for(var h=0;h<b.dataModel.length;h++){var g=b.dataModel.datas[h];if(g.key===a._currentSelectionKey){b.focusData=g;break}}b.on("propertyChange",function(b){"focusData"===b.property&&a._currentSelectionKey!==(b.newValue&&b.newValue.key)&&(a._currentSelectionKey=b.newValue&&b.newValue.key,a.repaint())});do{if(!a._currentSelectionKey)break;var i=c[a._currentSelectionKey];if(!i||!d[a._currentSelectionKey])break;var j=d[a._currentSelectionKey].variable=d[a._currentSelectionKey].variable||{};for(var e in i.variable)j[e]||(j[e]=i.variable["default"]||"");for(var e in j)a.drawPluginVariable(a,j,e,a._currentSelectionKey)}while(!1)},hd.prototype.drawPluginVariable=function(a,b,c,d){var e=this,f=null;_.columnWidths=[95,20,"30+0.3",20,"30+0.3"],_.line([_.text(pc.makePropertyName(c)),f=_.stringInput({bind:c,bindTarget:b},{colspan:4})]),f.addEventListener("change",function(){e.savePluginInfo();var a=fa.game.getWindow()._pluginVariables_[d]||(fa.game.getWindow()._pluginVariables_[d]={});a[c]=b[c],e.validatePlugin(d),this.gameStart=!1,this.gameEnd&&e.change(function(){this.keyword="test plugins"})})},hd.prototype._findScriptElement=function(a,b){for(var c=a.children.length;c--;){var d=a.children[c];if(d.getAttribute("src")===b)return d}},hd.prototype.removeScript=function(a,b){for(var c=a.children.length;c--;){var d=a.children[c];d.getAttribute("plugin_id")===b&&a.removeChild(d)}},hd.prototype.invalidatePlugin=function(a){{var b=this;fa.pluginInfo&&fa.pluginInfo.effective}qc.editor.Operation.QUERY_PLUGIN_SCRIPT(a,function(c){for(var d=c.editor,e=(c.script,document.getElementsByTagName("head")[0]),f=d.length;f--;){var g=b._findScriptElement(e,d[f]);g&&e.removeChild(g)}var h;fa.workable&&fa.game&&(h=fa.game.getWindow())&&(e=h.document.getElementsByTagName("head")[0],b.removeScript(e,a),h._pluginVariables_&&delete h._pluginVariables_[a])})},hd.prototype.validatePlugin=function(a){var b=this;qc.editor.Operation.QUERY_PLUGIN_SCRIPT(a,function(c){var d=fa.pluginInfo&&fa.pluginInfo.effective,e=(d[a]||(d[a]={}))&&(d[a].variable||(d[a].variable={})),f=c.editor,g=c.script,h=c.external;for(var i in c.variable)e[i]||(e[i]=c.variable[i]["default"]||"");var j=document.getElementsByTagName("head")[0];b.removeScript(j,a);for(var k=f.length;k--;){var l=b._findScriptElement(j,f[k]);l||(l=document.createElement("script"),l.setAttribute("type","text/javascript"),l.setAttribute("src",f[k]),j.appendChild(l))}var m;if(fa.workable&&fa.game&&(m=fa.game.getWindow())){for(j=m.document.getElementsByTagName("head")[0],b.removeScript(j,a),k=g.length;k--;){var l=b._findScriptElement(j,"../"+g[k]);l||(l=m.document.createElement("script"),l.setAttribute("type","text/javascript"),l.setAttribute("src","../"+g[k]),l.setAttribute("plugin_id",a),j.appendChild(l))}for(k=h?h.length:0;k--;){var n=b.formatString(h[k],e),l=b._findScriptElement(j,n);l||(l=m.document.createElement("script"),l.setAttribute("type","text/javascript"),l.setAttribute("src",n),l.setAttribute("plugin_id",a),j.appendChild(l))}var o=m._pluginVariables_||(m._pluginVariables_={});o[a]||(o[a]={})}})},hd.prototype.savePluginInfo=function(){qc.editor.Operation.SAVE_PLUGIN_INFO(fa.pluginInfo.effective)},hd.prototype.formatString=function(a,b){var c=a;for(var d in b){var e=new RegExp("\\{"+d+"\\}","g");c=c.replace(e,b[d])}return c};var id=m("qc.editor.ProjectSettingPanel",qc.editor.Panel,function zf(a){var b=this;zf["super"].constructor.call(b,a),b.title=fa._("Project Settings"),b.checkable=!1,b.removable=!1});id.prototype.paint=function(){_.columnWidths=["100+0.08","60+0.5"];var a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;_.line([_.text(fa._("Project Name")),a=_.stringInput({},{})]),_.line([_.text(fa._("Game Name")),c=_.stringInput({},{})]),_.line([_.text(fa._("Company")),d=_.stringInput({},{})]),_.line([_.text(fa._("Identifier")),e=_.stringInput({},{})]),_.line([_.text(fa._("Instance")),f=_.stringInput({},{})]),_.line([_.text(fa._("Version")),g=_.stringInput({},{})]),j=pc.drawPrefabInput({loading:fa.config.project.loading},fa._("Loading Prefab"),"loading"),_.columnWidths=["30+0","70+0.08","60+0.5"];var r=_.titleLine(fa._("Frame Rate"),!1);r.add(_.line([_.empty(),_.text("Mobile"),k=_.intInput()])),r.add(_.line([_.empty(),_.text("Desktop"),l=_.intInput()])),_.columnWidths=["100+0.08","60+0.5"],_.line([_.text(fa._("Background Color")),m=_.colorPicker({"dropDown.colorChooser.alphaEnabled":!1})]),_.line([_.text(fa._("Transparent")),p=_.checkBox({selected:fa.config.project.transparent})]),_.line([_.text(fa._("Renderer")),q=_.dropDownList({items:[{value:"Auto",label:fa._("Auto")},{value:"WebGL",label:"WebGL"},{value:"Canvas",label:"Canvas"}]})]),_.line([_.text(fa._("Run in Background")),n=_.checkBox({selected:fa.config.project.runInBackground
})]),_.line([_.text(fa._("Antialias")),o=_.checkBox({selected:fa.config.project.antialias})]),_.line([_.text(fa._("Developer Mode")),h=_.checkBox({selected:fa.config.project.developerMode})]),_.line([_.text(fa._("Application Cache")),i=_.checkBox({selected:fa.config.project.appCache})]),a.value=fa.config.project.projectName,c.value=fa.config.project.gameName,d.value=fa.config.project.companyName,e.value=fa.config.project.bundleIdentifier,f.value=fa.config.project.gameInstance,q.value=fa.config.project.renderer,g.value=fa.config.project.version,g.maskRe=/[\d\.]/,l.value=fa.config.project.frameRate.desktop,k.value=fa.config.project.frameRate.mobile,m.value=fa.game.stage.backgroundColor;var s;_.line([s=_.button(fa._("Apply"),{},{colspan:2})]),s.on("click",function(){fa.config.project.projectName=a.value,fa.config.project.gameName=c.value,fa.config.project.companyName=d.value,fa.config.project.bundleIdentifier=e.value,fa.config.project.gameInstance=f.value,fa.config.project.version=g.value,fa.config.project.loading=j.value,fa.config.project.runInBackground=n.selected,fa.config.project.frameRate={mobile:k.value,desktop:l.value},fa.config.project.antialias=o.selected,fa.config.project.transparent=p.selected,fa.config.project.renderer=q.value,fa.config.project.developerMode=h.selected,fa.config.project.appCache=i.selected,"Empty(Prefab)"===fa.config.project.loading&&(fa.config.project.loading="");var b=m.value;fa.config.project.backgroundColor=new qc.Color([b.r,b.g,b.b]).toNumber(),qc.editor.Operation.UPDATE_PROJECT_SETTINGS(fa.config.project),ib(),jb(),fa.game.time.applyFrameRate(fa.config.project.frameRate),fa.game.runInBackground=fa.config.project.runInBackground,fa.game.transparent=fa.config.project.transparent,fa.notification.info(fa._("Operation completed"))});var t=_.titleLine(fa._("Scene List")),u=fa.sceneList=new qc.editor.InspectorList({checkable:!0,draggable:!0});t.add(_.line([_.comp(u,null,{colspan:2})],200));for(var v=[],w=fa.project.findByType(fa.ASSET_TYPE.ASSET_SCENE,"name"),x=0;x<w.length;x++)fa.fileTree.dataModel.getDataById(w[x])&&v.push(sb(w[x].substr(0,w[x].length-4)));var y=b.keys(fa.config.scene.scene),z=[];for(var x in y){var A=y[x];if(!(v.indexOf(A)<0||"scene_editor"===A)){var B=new qc.widget.Data;B.name=A,z.push(B),u.dataModel.add(B)}}u.selectionModel.selection=z;for(var x in v){var A=v[x];if(!(y.indexOf(A)>=0||"scene_editor"===A)){var B=new qc.widget.Data;B.name=A,u.dataModel.add(B)}}u.selectionModel.on("selectionChange",function(){var a=u.dataModel.roots,b=[];for(var c in a)u.isSelected(a[c])&&b.push(a[c].name);qc.editor.Operation.UPDATE_SCENE_SETTINGS(b)}),u.dataModel.on("hierarchyChange",function(){var a=u.dataModel.roots,b=[];for(var c in a)u.isSelected(a[c])&&b.push(a[c].name);qc.editor.Operation.UPDATE_SCENE_SETTINGS(b)})};var jd=m("qc.editor.PreferencePanel",qc.editor.Panel,function Af(a){var b=this;Af["super"].constructor.call(b,a),b.title=fa._("Preference"),b.checkable=!1,b.removable=!1,b.target={},qc.editor.Operation.QUERY_EDITORSERVICE_SETTING("stateHistorySize",function(a){a.operRet===!0&&(b.stateHistorySize=a.stateHistorySize,b.repaint())})});jd.prototype.paint=function(){if(this.stateHistorySize!==c){_.columnWidths=[30,"90+0.1","60+0.5"];var a,b,d,e,f,g=_.titleLine(fa._("Collapse"));g.add(_.line([_.empty(),_.text("Text"),a=_.checkBox({selected:fa.preference.query("collapse.text")})])),g.add(_.line([_.empty(),_.text("Sprite"),b=_.checkBox({selected:fa.preference.query("collapse.sprite")})])),g.add(_.line([_.empty(),_.text("Button"),e=_.checkBox({selected:fa.preference.query("collapse.button")})])),g.add(_.line([_.empty(),_.text("ScrollView"),f=_.checkBox({selected:fa.preference.query("collapse.scrollView")})])),g.add(_.line([_.empty(),_.text("Tween"),d=_.checkBox({selected:fa.preference.query("collapse.tween")})]));var h,i,j,k=parseInt(this.stateHistorySize);g=_.titleLine(fa._("State History Size")),g.add(_.line([_.empty(),_.text("Size"),i=_.numberInput({value:k})])),g=_.titleLine(fa._("Save Scene Interval")),g.add(_.line([_.empty(),_.text("Interval(second)"),j=_.numberInput({value:fa.preference.query("saveSceneInterval")||10})]));var l,m=[fa._("Double Click"),fa._("Shift + Double Click")],n=fa.preference.query("JSEditor")||m[1];g=_.titleLine(fa._("Use System Editor for JavaScript")),g.add(_.line([_.empty(),_.text("Open Mode"),l=_.dropDownList({items:m})])),l.value=n;var o;_.line([o=_.button(fa._("Apply"),{},{colspan:3})]),o.on("click",function(){fa.preference.set("collapse.text",a.selected),fa.preference.set("collapse.sprite",b.selected),fa.preference.set("collapse.button",e.selected),fa.preference.set("collapse.tween",d.selected),fa.preference.set("collapse.scrollView",f.selected),fa.preference.set("JSEditor",l.value),fa.preference.set("saveSceneInterval",parseInt(j.value)),fa.sceneManager.resetTimer(parseInt(j.value)),h=parseInt(i.value),console.log(h),h!==k?qc.editor.Operation.SAVE_EDITORSERVICE_SETTING("stateHistorySize",h,function(a){a.operRet===!0&&(i.value=a.stateHistorySize),fa.notification.info(fa._("Operation completed"))}):fa.notification.info(fa._("Operation completed"))})}};var kd=m("qc.editor.CheckForUpdatesEditor",qc.editor.Panel,function(a){var b=this,c=qc.editor.version;kd["super"].constructor.call(b,a),b.title=fa._("Check for Updates"),b.checkable=!1,b.removable=!1,b.target=c.latestVersion,b.queryLatestVersion(!0)});kd.prototype.queryLatestVersion=function(a){var b=this;qc.editor.Operation.CHECK_FOR_UPDATES(a,function(a){b.target=a,b.repaint()})},kd.prototype.paint=function(){var a=qc.editor.version;_.columnWidths=["80+0.08"];var c=this;if(_.line([_.text(fa._("Version Info"))]),_.line([_.text(fa._("Local Editor Version: ")+qc.editor.VERSION)]),_.line([_.text(fa._("Latest Editor Version: ")+(c.target&&c.target.editor))]),a.versionCompare(qc.editor.VERSION,c.target&&c.target.editor)<0){var d;_.line([d=_.button(fa._("Update"))]),d.on("click",function(){qc.editor.version.updateVersion()});var e=fa.storage.get("language"),f=c.target.description&&b.keys(c.target.description)&&c.target.description[e];if(!f)for(var g in c.target.description)if(f=c.target.description[g])break;_.columnWidths=[c.indent,"60+1"];var h=_.titleLine(fa._("Version Description: ")),i=new Ha;h.add(_.line([_.empty(),_.comp(i)],300)),f&&(f=f.replace("\\n","\n")),i.value=f,i.readonly=!0}else _.line([_.text(fa._("You are using the latest version."),{textColor:"rgb(0,255,0)"})])};var ld=m("qc.editor.DomPanel",qc.editor.Panel,function Bf(a){var b=this;Bf["super"].constructor.call(b,a),b.title=a["class"],b.checkable=!1,b.removable=!1});ld.prototype.paint=function(){var a=this,b=this.target;_.columnWidths=["90+0.1","60+0.5"],_.line([_.text("Pos",{toolTip:fa._("CDom.pos")}),_.dropDownList({bind:"pos",items:[{label:"BACK",value:0},{label:"FRONT",value:1}]})]),_.columnWidths=[30,"90+0.1","60+1"];var c,d=_.titleLine("InnerHTML");d.add(_.line([_.empty(),_.text("Serializable",{toolTip:fa._("CDom.serializable")}),c=_.checkBox({bind:"serializable"})])),d.add(_.line([_.empty(),_.textArea({bind:"innerHTML",disabled:!b.serializable},{colspan:2})],100));var e=a.target.serializable;c.onValueChanged=function(b){b!==e&&a.repaint()},d.add(_.line([_.empty(),_.text("Overflow",{toolTip:fa._("CDom.overflow")}),_.dropDownList({bind:"overflow",items:["auto","visible","hidden","scroll"]})])),d.add(_.line([_.empty(),_.text("ZIndex",{toolTip:fa._("CDom.zIndex")}),_.intInput({bind:"zIndex"})])),d.add(_.line([_.empty(),_.text("ClassName",{toolTip:fa._("CDom.className")}),_.stringInput({bind:"className"})]))};var md=m("qc.editor.GraphicsPanel",qc.editor.Panel,function Cf(a){var b=this;Cf["super"].constructor.call(b,a),b.title=a["class"],b.checkable=!1,b.removable=!1});md.prototype.paint=function(){this.target;_.columnWidths=["90+0.1","60+0.5"]};var nd=m("qc.editor.ImportResourceEditor",qc.editor.Panel,function(){var a=this;nd["super"].constructor.call(a),a.title=fa._("Import Assets"),a.checkable=!1,a.removable=!1});nd.prototype._getDataResolvedName=function(a){var b=a.resolvedName;if(b!==c)return b;var d=a.name;if(d.indexOf(".json")>=0){var e=rb(a.fileContent);if(e)try{var f=JSON.parse(e);f.armature&&f.frameRate&&(b=d.replace(".json",".ani"))}catch(g){console.error("Resource Data parse error：",g),Gb(g.message)}}return b===c&&(b=d),a.resolvedName=b,b},nd.prototype._getDataAnimationType=function(a){var b=a.animationType;if(b!==c)return b;var d=rb(a.fileContent);if(d)try{var e=JSON.parse(d);b=e&&e.animations?1:e&&e.samples?3:2}catch(f){console.error("Resource Data parse error：",f),Gb(f.message)}return b===c&&(b=2),a.animationType=b,b},nd.prototype.getDefaultPath=function(){var a=fa.fileTree.dataModel._roots[0];return a.name+"/Assets"},nd.prototype.paint=function(){var a=this;_.columnWidths=["80+0.08","50+0.5",26];var b;_.line([_.text(fa._("Asset Name")),b=_.stringInput({},{colspan:2})]);var c;_.line([_.text(fa._("Asset Path")),a._txtPath=_.stringInput(),c=_.button("...")]),a._txtPath.value=a.getDefaultPath(),c.on("click",a.pickFolder.bind(a)),_.line([_.text(fa._("Asset Type")),a._txtResourceType=_.text("",{},{colspan:2})]),_.line([_.text(fa._("List of Files"),{},{colspan:3})]);var d=new ud;d.dataModel.on("dataModelChange",function(c){if("add"===c.kind&&!b.value){var e=c.data;b.value=e.name.substring(0,e.name.lastIndexOf("."))}d.redraw();var f=[];d.dataModel.forEach(function(b){f.push(a._getDataResolvedName(b))}),qc.editor.Operation.ASSET_TYPE(f,function(b){var c,e=b.type,g=b.source;if(3===e)switch(g.length){case 2:c=fa._("Atlas");break;case 3:d.dataModel.forEach(function(b){var d=a._getDataResolvedName(b);if(!(d.indexOf(".ani")<0)){var e=a._getDataAnimationType(b);switch(e){case 2:c=fa._("DragonBone");break;case 3:c=fa._("DragonBone(Sampled)");break;default:c=fa._("Frame Animation")}}});break;default:c=fa._("Image")}else c=5===e?fa._("BitmapFont"):6===e?fa._("Sound"):7===e?fa._("Excel"):8===e?fa._("WebFont"):0===f.length?"":fa._("Invalid asset");a._txtResourceType.text=c;var h=[];if(g&&g.length>0)for(var i=0;i<g.length;i++)for(var j=0;j<d.dataModel.length;j++){var k=d.dataModel.datas[j],l=a._getDataResolvedName(k);if(h.indexOf(k)<0&&l.indexOf(g[i])===l.length-g[i].length){h.push(k);break}}d.dataModel.forEach(function(a){h.indexOf(a)>=0?a.s("useless",!1):a.s("useless",!0)})})}),_.line([_.comp(d,{},{colspan:3})],160);var e;_.line([e=_.button(fa._("Import"),{},{colspan:3})],26),e.on("click",function(){var c=b.value;if(!c)return void fa.notification.error(fa._("The asset name is invalid"));var e=a._txtPath.value;if(!e)return void fa.notification.error(fa._("Asset path is empty"));var f=fa.fileTree.dataModel._roots[0];0===e.indexOf(f.name+"/")?e=e.replace(f.name+"/",""):0===e.indexOf(f.name)&&(e=e.replace(f.name,""));var g=[];if(d.dataModel.forEach(function(a){a.s("useless")||g.push(a)}),g.length<=0)return void fa.notification.error(fa._("Files is empty"));var h={};g.forEach(function(b){h[a._getDataResolvedName(b)]=b.fileContent}),qc.editor.Operation.IMPORT_RESOURCE(e,c,h,function(c){c&&c.operRet===!0?(fa.notification.info(fa._("Import is done")),a._txtPath.value=a.getDefaultPath(),b.value="",d.dataModel.clear()):fa.notification.error(fa._("Import failed:")+(c&&c.reason)?"，"+c.reason:"")})})},nd.prototype.pickFolder=function(){var a=this,b=new qc.widget.Tree,c=fa.fileTree,d=new qc.widget.graph.Serializer(c.dataModel);d.isSerializable=function(a){return c.isVisible(a)?!0:!1};var e=d.serialize(),f=new qc.widget.graph.Serializer(b.dataModel);f.deserialize(e),b.expand(b.dataModel.roots[0]),b.onDataDoubleClick=function(c){g.hide();var d=b.dataModel.roots[0];a._txtPath.value=c!==d?d.name+"/"+c.id:d.name};var g=new qc.editor.Dialog;g.modal=!0,g.contentPadding=[2,2,2,2],g.title=fa._("Double click to select the folder"),g.content=b,g.width=300,g.height=350,g.show()};var od=m("qc.editor.FrameAnimationEditor",qc.editor.Panel,function(a){a=a||{};var b,c=this;a.uuid&&(b=c.findAtlasByUUID(a.uuid)),c.frameAnimationEditor=!0,c.previousPanel=a.previousPanel,od["super"].constructor.call(c,b),c.title=fa._("Frame Animation Editor"),c.checkable=!1,c.removable=!1});od.prototype.verifyAtlas=function(a){return a?a.meta&&a.meta.type===fa.ASSET_TYPE.ASSET_ATLAS?2===a.meta.animationType?fa._("DragonBone cannot be modified."):a.json&&a.json.frames?!0:fa._("File must be texture atlas"):fa._("File must be texture atlas"):void 0},od.prototype.findAtlasByUUID=function(a){var b=this,c=fa.project.findByUUID(a);return b.verifyAtlas(c)===!0?c:void 0},od.prototype.trySetAtlasByUUID=function(a){var b=this,c=b.findAtlasByUUID(a);c&&(b.target=b.findAtlasByUUID(a),b.repaint())},od.prototype.paint=function(){_.columnWidths=["90+0.08","50+0.5"];var a=this;if(delete a.toPlayFrames,delete a.toPlayRate,delete a.frameList,delete a._valueChanged,!a.target){var c,d=200;return _.line([c=_.painter({borderWidth:1},{fill:"fill",colspan:2})],d),a._handleAtlasCrossDrop(c),void c.addTopPainter(function(a){var b="20px Arial",d="rgb(100, 128, 163)",e=c.width,f=c.height;k.drawText(a,fa._("Drop Atlas File Here"),b,d,0,0,e,f,"center")})}if(a.drawAnimationDropDownList(),a.target.animation&&b.keys(a.target.animation.data.animations).length)a.drawAnimationInfo();else{var e,f;_.line([f=_.button(fa._(" Back "),null,{cellPadding:[0,5,0,5]}),e=_.button(fa._(" New "),null,{cellPadding:[0,0,0,0]})]),a.previousPanel?f.on("click",function(){fa.inspector.propertyView.inspect(null,"atlas",[a.target.uuid,null])}):f.on("click",function(){fa.inspector.propertyView.inspect(null,"frameAnimation")}),e.on("click",a.handleNewButtonClick.bind(a))}U(function(){a.drawPreview()})},od.prototype.drawAnimationDropDownList=function(){var a,c=this,d=c.target,e=d.animation?b.keys(d.animation.data.animations):[];_.line([_.text(fa._("Animation")),a=_.dropDownList({items:e})]),_.line([_.divider(null,{colspan:2})]);var f=c.currentAnimation;a.value=e.indexOf(f)>=0?f:e[0],c.currentAnimation=a.value,a.onValueChanged=function(a){c.currentAnimation=a,c.repaint()}},od.prototype._handleAtlasCrossDrop=function(a){var b=this;a.view._dropView=a,a.handleCrossDrag=function(a,c,d){if("drop"===c){var e=b._getDragTarget(d);!e.treeData&&e.master&&(e=e.master),e.treeData&&b.trySetAtlasByUUID(e.treeData.resUUID)}}},od.prototype._getDragTarget=function(a){var b=a.view;if(b instanceof Gd){var c=a.view.draggingData;if(c&&c instanceof Fd)return c}},od.prototype.handleNewButtonClick=function(){var a,c=this,d=c.target,e=0,f=d.animation?b.keys(d.animation.data.animations):[];do a="newAnimation"+(1===++e?"":e);while(f.indexOf(a)>=0);d.animation||(d.animation={data:{animations:{}}}),d.animation.data.animations[a]={frames:[],rate:10},c.currentAnimation=a,qc.editor.Operation.UPLOAD(d.url.slice(0,-4)+".ani",JSON.stringify(d.animation.data)),c.repaint()},od.prototype.drawAnimationInfo=function(){var a,b,c,d,e=this,f=e.target,g=e.currentAnimation,h=f.animation?f.animation.data.animations[g]:{};_.line([_.text("Name"),a=_.stringInput()]),a.value=g,a.on("propertyChange",function(a){"value"===a.property&&(e._valueChanged=!0)}),_.line([_.text("Rate"),b=_.intInput()]),h&&null!=h.rate&&(b.value=h.rate),e.toPlayRate=b.value,b.onValueChanged=function(a){e._valueChanged=!0,e.toPlayRate=a},_.line([_.text("Loop"),c=_.checkBox()]),h&&null!=h.loop&&(c.selected=!!h.loop),c.onValueChanged=function(){e._valueChanged=!0},_.line([_.text("Frames",null,{colspan:2})]),d=h&&h.frames?h.frames.slice(0):[],e.toPlayFrames=d;var i=e.frameList=new rd;i.enableToolTip(),i.handleCrossDrag=e.handleFrameListCrossDrag.bind(e);for(var j=f.json.frames,k=0,l=d.length;l>k;k++){var m=new pd;m.name=d[k];var n;if(j[d[k]]){n=j[d[k]].frame,m.image=f.img,m.toolTip=m.name,m.a("clipX",n.x),m.a("clipY",n.y),m.a("clipWidth",n.w),m.a("clipHeight",n.h);var o=f.url;m.a("associatedViewAndData",{fileTree:o.substring(0,o.lastIndexOf("/")),fileList:[o,m.name]})}else m.image="lost";i.dataModel.add(m)}_.line([_.comp(i,null,{colspan:2})],160),i.dataModel.on("dataModelChange",function(){e._valueChanged=!0;var a=[];i.dataModel.forEach(function(b){a.push(b.name)}),e.toPlayFrames=a,i.redraw()});var p=new qc.widget.Container;p.layout=new qc.widget.layout.HBoxLayout(p),p.layout.align="right";var q=new qc.editor.InspectorButton({text:fa._(" New ")}),r=new qc.editor.InspectorButton({text:fa._(" Save ")}),s=new qc.editor.InspectorButton({text:fa._(" Delete ")}),t=new qc.editor.InspectorButton({text:fa._(" Back ")});p.setItems([t,q,r,s]),e.previousPanel?t.on("click",function(){fa.inspector.propertyView.inspect(null,"atlas",[f.uuid,null])}):t.on("click",function(){fa.inspector.propertyView.inspect(null,"frameAnimation")}),_.line([_.comp(p,null,{colspan:2})],30),q.on("click",e.handleNewButtonClick.bind(e)),r.on("click",function(){var d=[];if(i.dataModel.forEach(function(a){d.push(a.name)}),d.length<=0)return void fa.notification.error(fa._("Animation is empty"));if(!a.value.length)return void fa.notification.error(fa._("Animation's name is invalid"));if(!f.animation)return void fa.notification.error(fa._("Please create an animation"));var h=a.value;h!==g&&delete f.animation.data.animations[g],f.animation.data.animations[h]={frames:d,rate:b.value,loop:c.selected},e.currentAnimation=h,qc.editor.Operation.UPLOAD(f.url.slice(0,-4)+".ani",JSON.stringify(f.animation.data)),e.repaint()}),s.on("click",function(){f.animation&&f.animation.data.animations[g]&&(delete f.animation.data.animations[e.currentAnimation],qc.editor.Operation.UPLOAD(f.url.slice(0,-4)+".ani",JSON.stringify(f.animation.data)),e.repaint())})},od.prototype.handleFrameListCrossDrag=function(a,b,c){var d,e=this,f=e.frameList,g=e._getDragTarget(c);d=fa.project.findByUUID(g.master?g.master.treeData.resUUID:g.treeData.resUUID);var h=e.verifyAtlas(d);if(h){if(k.isString(h))return void fa.notification.error(h);if(d.uuid===e.target.uuid&&c.view===fa.fileList){var i=f._focusData,j=f._focusType;if("exit"===b||"cancel"===b)return void(i&&(f._focusData=null,f._focusType=null,f.redraw()));var l=f.lp(a),m=f.getDataAt(l),n=null,o=f.dataModel,p=f.dataModel.datas,q=p[p.length-1],r=q?f.getDataUI(q).bounds:null;if(q){if(l.y>r.y+r.height||l.y>=r.y&&l.x>r.x+r.width)m=q,n=1;else if(m){var s=m.rect;n=l.x-s.x<=4?-1:0}}else m=1,n=1;if("enter"===b||"over"===b)f.autoScroll(a),(i!==m||j!=n)&&(f._focusData=m,f._focusType=n,f.redraw());else if("drop"===b){if(g&&m){var t,u;if(0===n?(t=m,m.name=g.name):-1===n?(t=new pd,u=o.datas.indexOf(m)):1===n&&(t=new pd,u=o.datas.indexOf(m)+1),t){t.image=d.img,t.name=g.name,t.a("clipX",g.a("clipX")),t.a("clipY",g.a("clipY")),t.a("clipWidth",g.a("clipWidth")),t.a("clipHeight",g.a("clipHeight")),t.toolTip=t.name;var v=d.url;t.a("associatedViewAndData",{fileTree:v.substring(0,v.lastIndexOf("/")),fileList:[v,t.name]}),o.contains(t)||t.addToDataModel(o,u)}}f._focusData&&(f._focusData=null,f._focusType=null,f.redraw())}}}},od.prototype.drawPreview=function(){var a=this,b=a.previewPainter=_.painter({background:null});fa.inspector.previewView.content=b;var c,d=a.target,e=0,f=function(){var d=(new Date).getTime(),g=1;if(c){var h=a.toPlayRate||1,i=1e3/h,j=d-(c+i);0>j?g=0:(j>=i&&(g=Math.floor(j/i),j-=g*i,g+=1),c=d-j)}else c=d;g&&(e+=g,a.toPlayFrames&&a.toPlayFrames.length>0&&(b.iv(),b.validate())),b.isInDOM()&&U(f)};f();var g=d.json.frames;b.addTopPainter(function(c){var f=a.toPlayFrames||[],h=f[e%f.length];if(g[h]){var i=g[h].frame,j=b.width,k=b.height,l=i.w,m=i.h,n=1;(l>j||m>k)&&(n=Math.min(j/l,k/m));var o=l*n,p=m*n,q=Math.round((j-o)/2),r=Math.round((k-p)/2);c.drawImage(d.img,i.x,i.y,i.w,i.h,q,r,o,p)}})};var pd=m("qc.editor.FrameNode",qc.editor.ItemNode,function Df(a){var b=this;Df["super"].constructor.call(b,a)});pd.prototype.addToDataModel=function(a,b){var c=this,d=c.uuid;if(a._dataMap[d])throw"Data already in this DataModel";null!=c.id&&(a._idMap[c.id]=c),a._dataMap[d]=c,a._datas.splice(b,0,c),c._setDataModel(a),a.onAdd(c),a.emit("dataModelChange",{kind:"add",data:c})},pd.prototype.getImageComps=function(){var a=this,b=pd["super"].getImageComps.call(a);return b.push({type:"circle",rect:{func:function(a){return[a.width-13,1,12,12]}},borderColor:"rgb(222, 70, 67)",background:"rgb(252, 97, 93)",borderWidth:1,visible:{func:function(a,b){return b._hoverData===a?!0:!1}}}),b.push({type:"shape",points:{func:function(a){for(var b=[2,2,8,8,2,8,8,2],c=0;c<b.length;c++)b[c]+=c%2===0?a.width-12:2;return b}},background:null,segments:[1,2,1,2],borderColor:"rgba(0, 0, 0, 0.6)",borderWidth:1,visible:{func:function(a,b){return b._hoverData===a?!0:!1}}}),b};var qd=m("qc.editor.FrameListInteractor",qc.widget.graph.Interactor,function(a){this.frameList=a,qd["super"].constructor.call(this,a)});qd.prototype.clear=function(){this._clientPoint=null},qd.prototype.handle_mousedown=function(a){this.handle_touchstart(a)},qd.prototype.handle_mouseup=function(a){this.handle_touchend(a)},qd.prototype.handle_touchstart=function(a){var b=this.frameList;if(this.clear(a),!b.isCloseToVScrollBar(a)){var c=b.getDataAt(a);if(this._clientPoint=B(a),!c&&b.clearSelectionOnBackgroundClicked&&b.selectionModel.clearSelection(),c){var d=c.rect,e=b.lp(a),f={x:d.x+d.width-13,y:d.y+1,width:12,height:12};if(!v(f,e)){var g=c.a("associatedViewAndData");g&&zb(g)}}}},qd.prototype.handle_mouseleave=function(){var a=this.frameList,b=a._hoverData;a._hoverData=null,b&&a.invalidateData(b)},qd.prototype.handle_mousemove=function(a){var b=this.frameList,c=b._hoverData;if(fa.dragAndDrop.isDragging())b._hoverData=null,c&&b.invalidateData(c);else{var d=b.getDataAt(a);c!=d&&(b._hoverData=d,d&&b.invalidateData(d),c&&b.invalidateData(c))}},qd.prototype.handle_touchend=function(a){var b=this._clientPoint;if(b){var c=B(a);if(k.getDistance(c,b)<2){var d=this.frameList,e=d.getDataAt(a);if(e){var f=e.rect,g=d.lp(a),h={x:f.x+f.width-13,y:f.y+1,width:12,height:12};v(h,g)&&d.dataModel.remove(e)}}}this.clear(a)},qd.prototype.handle_keydown=function(a){var b=this.frameList;if(J(a)||K(a)||H(a)||I(a)){var c=b.dataModel.datas,d=b.selectionModel.lastData;if(!c.length)return;if(d){var e=c.indexOf(d);e>=0&&(J(a)||H(a)?0!==e&&(d=c[e-1],b.selection=d):e!==c.length-1&&(d=c[e+1],b.selection=d))}else b.selection=c[0]}};var rd=m("qc.editor.FrameList",ma,function Ef(){var a=this;Ef["super"].constructor.call(a),a.pannable=!1,a.clearSelectionOnBackgroundClicked=!0,a.interactors=[new qc.widget.graph.ScrollBarInteractor(a),new qc.widget.graph.SelectInteractor(a),new qd(a),new qc.widget.graph.BasicInteractor(a)],a.addBottomPainter(function(b){var c=a.clientWidth,d=a.clientHeight;b.beginPath(),b.fillStyle=a._background,b.rect(0,-a.translateY,c,d),b.fill()}),a.addTopPainter(function(b){if(0===a.dataModel.length){var c="20px serif",d="rgb(100, 128, 163)",e=a.width,f=a.height;k.drawText(b,"Drop Atlas Frame",c,d,0,0,e,f-30,"center"),k.drawText(b,"from FileList to here",c,d,0,0,e,f+30,"center")}var g=a._focusData,h=a._focusType;if(g)if(1===g)b.beginPath(),b.fillStyle="#507aea",b.rect(1,2,2,a.itemHeight),b.fill();else{var i=g.rect;b.beginPath(),0===h?(b.strokeStyle="#507aea",b.lineWidth=2,b.rect(i.x+2,i.y+2,i.width-4,i.height-4),b.stroke()):-1===h?(b.fillStyle="#507aea",b.rect(i.x-1,i.y,2,i.height),b.fill()):(b.fillStyle="#507aea",b.rect(i.x+i.width+1,i.y,2,i.height),b.fill())}}),a.view._dropView=a});rd.prototype._itemGap=2,b.defineProperties(rd.prototype,{background:{get:function(){return this._background},set:function(a){this.setPropertyValue("background",a)}},borderColor:{get:function(){return this._borderColor},set:function(a){this.setPropertyValue("borderColor",a)}}}),rd.prototype.validateImpl=function(){var a=this,b=a.borderColor,c="1px solid "+b;a.view.style.border=c,rd["super"].validateImpl.call(a)},rd.prototype.calculateClientWidth=function(){var a=this.width;return a-2},rd.prototype.calculateClientHeight=function(){var a=this.height;return a-2};var sd=m("qc.editor.ResourceNode",qc.editor.ItemNode,function Ff(a){var b=this;Ff["super"].constructor.call(b,a)});sd.prototype.getImageComps=function(){var a=this,b=sd["super"].getImageComps.call(a);return b.push({type:"border",rect:[17,1,1],relative:!0,borderColor:"rgb(222, 70, 67)",borderWidth:2,visible:{func:function(a){return a.s("useless")}}}),b.push({type:"circle",rect:{func:function(a){return[a.width-13,1,12,12]}},borderColor:"rgb(222, 70, 67)",background:"rgb(252, 97, 93)",borderWidth:1,visible:{func:function(a,b){return b._hoverData===a?!0:!1}}}),b.push({type:"shape",points:{func:function(a){for(var b=[2,2,8,8,2,8,8,2],c=0;c<b.length;c++)b[c]+=c%2===0?a.width-12:2;return b}},background:null,segments:[1,2,1,2],borderColor:"rgba(0, 0, 0, 0.6)",borderWidth:1,visible:{func:function(a,b){return b._hoverData===a?!0:!1}}}),b};var td=m("qc.editor.ResourceListInteractor",qc.widget.graph.Interactor,function(a){this.resourceList=a,td["super"].constructor.call(this,a)});td.prototype.clear=function(){this._clientPoint=null},td.prototype.handle_mousedown=function(a){this.handle_touchstart(a)},td.prototype.handle_mouseup=function(a){this.handle_touchend(a)},td.prototype.handle_touchstart=function(a){var b=this.resourceList;if(this.clear(a),!b.isCloseToVScrollBar(a)){var c=b.getDataAt(a);this._clientPoint=B(a),!c&&b.clearSelectionOnBackgroundClicked&&b.selectionModel.clearSelection()}},td.prototype.handle_mouseleave=function(){var a=this.resourceList,b=a._hoverData;a._hoverData=null,b&&a.invalidateData(b)},td.prototype.handle_mousemove=function(a){var b=this.resourceList,c=b._hoverData,d=b.getDataAt(a);c!=d&&(b._hoverData=d,d&&b.invalidateData(d),c&&b.invalidateData(c))},td.prototype.handle_touchend=function(a){var b=this._clientPoint;if(b){var c=B(a);if(k.getDistance(c,b)<2){var d=this.resourceList,e=d.getDataAt(a);if(e){var f=e.rect,g=d.lp(a),h={x:f.x+f.width-13,y:f.y+1,width:12,height:12};v(h,g)?d.dataModel.remove(e):d.selectionModel.selection=e}}}this.clear(a)};var ud=m("qc.editor.ResourceList",ma,function Gf(){var a=this;Gf["super"].constructor.call(a),a.pannable=!1,a.clearSelectionOnBackgroundClicked=!0,a.interactors=[new qc.widget.graph.ScrollBarInteractor(a),new td(a),new qc.widget.graph.BasicInteractor(a)],a.addBottomPainter(function(b){var c=a.clientWidth,d=a.clientHeight;b.beginPath(),b.fillStyle=a._background,b.rect(0,-a.translateY,c,d),b.fill()}),a.addTopPainter(function(b){if(0===a.dataModel.length){var c="20px serif",d="rgb(100, 128, 163)",e=a.width,f=a.height;k.drawText(b,fa._("Drop files here"),c,d,0,0,e,f-10,"center")}}),a._initNativeDND(),a.enableToolTip()});ud.prototype._itemGap=2,ud.prototype._itemWidth=60,ud.prototype._itemHeight=60,b.defineProperties(ud.prototype,{background:{get:function(){return this._background},set:function(a){this.setPropertyValue("background",a)}},borderColor:{get:function(){return this._borderColor},set:function(a){this.setPropertyValue("borderColor",a)}}}),ud.prototype._initNativeDND=function(){function a(a){f.borderColor="#ebd541",a.preventDefault(),a.stopPropagation()}function b(a){f.borderColor="rgb(32, 32, 32)",a.preventDefault(),a.stopPropagation()}function c(a){a.preventDefault(),a.stopPropagation()}function d(a){f.borderColor="rgb(32, 32, 32)",a.preventDefault(),a.stopPropagation();for(var b=a.dataTransfer.files,c=b.length,d=0;c>d;d++){var g=b[d],h=new FileReader;h.onload=e,h.file=g,h.readAsArrayBuffer(g)}}function e(a){var b=a.target,c=b.file,d=b.result,e=c.name,g=new sd;if(g.name=e,g.fileContent=d,g.toolTip=e,0===c.type.indexOf("image/")){var h=document.createElement("img");h.onload=function(){g.image=h},h.src="data:"+c.type+";base64,"+f.arrayBuffer2Base64(d)}else g.image=e.indexOf(".json")===e.length-5?"JsonIcon":"UnknowIcon";f.dataModel.add(g)}var f=this,g=this._interactionDiv;g.addEventListener("dragenter",a,!1),g.addEventListener("dragleave",b,!1),g.addEventListener("dragover",c,!1),g.addEventListener("drop",d,!1)},ud.prototype.arrayBuffer2Base64=function(b){for(var c="",d=new Uint8Array(b),e=d.byteLength,f=0;e>f;f++)c+=String.fromCharCode(d[f]);return a.btoa(c)},ud.prototype.validateImpl=function(){var a=this,b=a.borderColor,c="1px solid "+b;a.view.style.border=c,ud["super"].validateImpl.call(a)},ud.prototype.calculateClientWidth=function(){var a=this.width;return a-2},ud.prototype.calculateClientHeight=function(){var a=this.height;return a-2};var vd=m("qc.editor.PropertyView",qc.widget.Container,function Hf(a){var b=this;Hf["super"].constructor.call(b,a),b.layout=new qc.widget.layout.VBoxLayout(b),b.layout.padding=[7,0,0,0],b.layout.gap=7,new xd(b)},{inspectPreferenceImpl:function(){var a=this;a.clear();var b=a.getPanelInstance(jd);a.setItems([b])},inspectSettingImpl:function(){var a=this;a.clear();var b=a.getPanelInstance(id);a.setItems([b])},inspectFrameAnimationImpl:function(a){var b=this;b.clear();var c=new od(a);b.setItems([c])},inspectAtlasImpl:function(a){var b=this;b.clear();var c=new qc.editor.AtlasNodePanel(a[0],a[1]);b.setItems([c])},inspectWebFontImpl:function(a){var b=this;b.clear();var c=new qc.editor.WebFontNodePanel(a);b.setItems([c])},inspectPluginManagerImpl:function(){var a=this;a.clear();var b=new hd;a.setItems([b])},inspectImportResourceImpl:function(){var a=this;a.clear();var b=new nd;a.setItems([b])},inspectJsImpl:function(a){var b=this;b.clear();var c=new qc.editor.JSNodePanel(a);b.setItems([c])},scriptOrderImpl:function(a){var b=this;b.clear();var c=new qc.editor.ScriptOrderPanel(a);b.setItems([c])},inspectSceneImpl:function(a){var b=this;b.clear();var c=new qc.editor.ScenePanel(a);b.setItems([c])},inspectCheckForUpdatesImpl:function(){var a=this;a.clear();var b=new kd;a.setItems([b])},inspectPanelImpl:function(a,b){var c=this;c.clear();var d=new qc.editor[a](b);c.setItems([d])},inspectImpl:function(a){var b=this;if(b.clear(),a){b.target=a;var c=[],d=b.getPanelInstance(qc.editor.NodePanel,a);c.push(d);var e=b.getPanelInstance(qc.editor.RectTransformPanel,a);c.push(e);var f=fa.inspector._nodesMap;for(var g in f){var h=f[g][0],i=f[g][1];if(a instanceof h){if(h===qc.ProgressBar&&a instanceof qc.Slider)continue;var j=b.getPanelInstance(i,a);c.push(j)}}var k=pc.drawBuiltinComponents(a);c=c.concat(k);var l=pc.drawUserDefines(a);c=c.concat(l),c.push(pc.drawAddComponent(a,b)),b.setItems(c),b._oldScripts=a.scripts?a.scripts.slice(0):[],b._oldNodeLock=null,b.update()}},inspect:function(a,b,c){var d=this;d._oldScripts=null,delete d._oldNodeLock,null!=d._laterId&&(k.cancelLater(d._laterId),delete d._laterId);var e=!1;if(d.layout.children){var f=d.layout.children[0];f instanceof od&&f._valueChanged&&(e=!0,kb(fa._("Stop editing frame animation?"),fa._("Warning"),function(){d.startCallLater(b,a,c)},null,{icon:"alert"}))}e||d.startCallLater(b,a,c)},startCallLater:function(a,b,c){var d=this;d._laterId=U(function(){"setting"===a?d.inspectSettingImpl(b):"preference"===a?d.inspectPreferenceImpl(b):"atlas"===a?d.inspectAtlasImpl(c):"webfont"===a?d.inspectWebFontImpl(c):"js"===a?d.inspectJsImpl(c):"scriptOrder"===a?d.scriptOrderImpl(c):"scene"===a?d.inspectSceneImpl(c):"frameAnimation"===a?d.inspectFrameAnimationImpl(c):"pluginManager"===a?d.inspectPluginManagerImpl(c):"importResource"===a?d.inspectImportResourceImpl(c):"checkForUpdates"===a?d.inspectCheckForUpdatesImpl():a&&0===a.indexOf("Panel:")?(a=a.replace("Panel:",""),d.inspectPanelImpl(a,c)):d.inspectImpl(b),delete d._laterId})},getCompAt:function(a){a=k.checkTouch(a);var b=this,c=a.target,d=b.children;if(d)for(var e=0;e<d.length;e++){var f=d[e];if(f instanceof Ma){var g=f.eachChildren(function(a){return a.view.contains(c)?!0:void 0});if(g)return g}}},clear:function(){var a=this,b=a.children;a.setItems([]),b&&b.forEach(function(a){a&&a.dispose()}),a.target=null,fa.e.emit(fa.e.INSPECTOR_VIEW_CLEAR)}},{properties:[]},{});vd.prototype.isSameArray=function(a,b){if(a.length!==b.length)return!1;for(var c=0;c<b.length;c++)if(b[c]!==a[c])return!1;return!0},vd.prototype.update=function(){var a=this,b=a.children,c=a.target;if(null==a._laterId){var d=a._oldScripts;if(d){var e=c.scripts||[],f=a.isSameArray(d,e);if(!f)return void a.inspect(c)}if("_oldNodeLock"in a){var g=c.__lock;g!==a._oldNodeLock&&(b&&b.forEach(function(a){a instanceof Ma&&(g?a.disableTitle():a.enableTitle()),a.disabled=!!g}),a._oldNodeLock=g)}b&&(fa.inspector._updating=!0,b.forEach(function(b){if(b instanceof qc.editor.Panel){
var c=!1,d=b._cacheForDetection;if(d)for(var e in d)if(c=!a.isSameArray(d[e],b.target[e]||[]))break;c?b.repaint():(b.updateChildrenValue(),b.update&&b.update())}}),fa.inspector._updating=!1)}},vd.prototype.getPanelInstance=function(a,b){return a===qc.editor.Panel||k.isSubClassOf(a,qc.editor.Panel)?new a(b):new a},b.defineProperties(vd.prototype,{target:{get:function(){return this._target},set:function(a){this._target=a}}});var wd=m("qc.editor.PreviewView",qc.widget.Container,function If(a){var b=this;If["super"].constructor.call(b,a),b.layout=new qc.widget.layout.TableLayout(b),b.scrollBarModel="off",fa.e.on(fa.e.INSPECTOR_VIEW_CLEAR,function(){b.clear()})},{clear:function(){this.setItems([])}});b.defineProperties(wd.prototype,{content:{get:function(){return this._content},set:function(a){var b=this;b.setPropertyValue("content",a),b.setItems([{widths:[.1],height:.1,cells:[{cellPadding:15,element:a,align:"center",vAlign:"middle"}]}])}}});var xd=m(null,b,function(a){var b=this;b._propertyView=a,b.addListeners()},{clear:function(){var a=this,b=a._mask;b&&(b.style.cursor="",a._propertyView.view.removeChild(b)),a._clientPoint=a._comp=a._oldValue=a._mask=null},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){Y(a);var b=this,c=b._propertyView,d=c.getCompAt(a);(d instanceof qc.widget.Label||d instanceof qc.editor.Text)&&d["for"]&&!d.disabled&&(b._clientPoint=B(a),b._comp=d)},handle_mousemove:function(a){this.handle_touchmove(a)},handle_touchmove:function(a){var b=this,c=b._clientPoint,d=b._comp,e=b.view,f=B(a);if(d&&!A()){var g=e.findViewById(d["for"]);if(b._oldValue=g.value||0,y(f,c)>=1){var h=b._mask=p();h.style.left="0",h.style.top="0",h.style.bottom="0",h.style.right="0",h.style.cursor="ew-resize",e.view.appendChild(h),z(b,a)}}},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(){A()||this.clear()},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=this,c=b.view,d=b._comp,e=c.findViewById(d["for"]),f=b._clientPoint,g=null!=d.min?d.min:e.min,h=null!=d.max?d.max:e.max,i=e.precision,j=B(a),k=j.x-f.x;k=null==i?parseFloat(b._oldValue)+parseFloat(k)*(d.dragStep||1):parseFloat((parseFloat(b._oldValue)+parseFloat(k)*(d.dragStep||1)).toFixed(i)),null!=g&&g>k&&(k=g),null!=h&&k>h&&(k=h),e.value=k},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(){this.clear()}},{interactor:!0},{view:{get:function(){return this._propertyView}}}),yd=m("qc.editor.Inspector",qc.widget.Container,function Jf(a){var b=this;Jf["super"].constructor.call(b,a);var c=b.layout=new qc.widget.layout.BorderLayout(b),d=b.propertyView=new qc.editor.PropertyView,e=b.previewView=new qc.editor.PreviewView;c.splitterSize=18,c.toggleLength=62,c.hitSize=18,c.toggleIconScale=.6,c.toggleNinePatchImage="project_add.9",c.toggleNinePatchBorder=[10,10,10,10],b.addEventListener("mousedown",function(){fa.activeView=b}),b.setItems([{region:"center",element:d},{region:"bottom",height:200,element:e}]),fa.e.on(fa.e.ACTIVE_NODE_CHANGE,function(a){d.inspect(a.newValue)}),fa.e.on(fa.e.JS_CHANGED,function(){d.children&&1===d.children.length&&d.children[0]instanceof dd&&fa.inspector.propertyView.inspect(null,"js",d.children[0].treeData)})});yd.prototype.update=function(){this.propertyView.update()};var zd=m("qc.editor.Menu",qc.widget.Menu,function Kf(a){var b=this;Kf["super"].constructor.call(b,a),b.items=[],b._setBuiltinMenu(),b._bindingClose=function(){b.hide()}});qc.editor.Menu.prototype.registerCloseEvent=function(a){qc.editor.Menu["super"].registerCloseEvent.call(this,a),fa.e.on(fa.e.JS_CHANGED,this._bindingClose)},qc.editor.Menu.prototype.unregisterCloseEvent=function(a){qc.editor.Menu["super"].unregisterCloseEvent.call(this,a),fa.e.off(fa.e.JS_CHANGED,this._bindingClose)},zd.prototype._setBuiltinMenu=function(){this._addQCItems(),this._addProjectItems(),this._addEditorItems(),this._addAssetItems(),this._addComponentItems(),this._addToolItems(),this._addPluginsItems(),this._addLayoutItems(),this._addLanguageItems()};var zd=qc.widget.Menu.prototype;zd._addAssetItems=function(){var a=this;this.addItem(fa._("GameObject/Empty Node"),function(){a.createNode()}),this.addItem(fa._("GameObject/Image"),function(){a.createImage()}),this.addItem(fa._("GameObject/Sprite"),function(){a.createSprite()}),this.addItem(fa._("GameObject/Text"),function(){a.createText()}),this.addItem(fa._("GameObject/Button"),function(){a.createButton()}),this.addItem(fa._("GameObject/Toggle"),function(){a.createToggle()}),this.addItem(fa._("GameObject/ScrollBar"),function(){a.createScrollBar()}),this.addItem(fa._("GameObject/ScrollView"),function(){a.createScrollView()}),this.addItem(fa._("GameObject/ProgressBar"),function(){a.createProgressBar()}),this.addItem(fa._("GameObject/Slider"),function(){a.createSlider()}),this.addItem(fa._("GameObject/Input Field"),function(){a.createInputField()}),this.addItem(fa._("GameObject/Sound"),function(){a.createSound()}),this.addItem(fa._("GameObject/Dom"),function(){a.createDom()}),this.addItem(fa._("GameObject/Graphics"),function(){a.createGraphics()}),this.addItem(fa._("GameObject/UIRoot"),function(){a.createUIRoot()}),this.addItem(fa._("GameObject/Tilemap"),function(){a.createTilemap()})},zd.createUIRoot=function(){var a=new qc.UIRoot(fa.game);return fa.hierarchy.activeNode=a,fa.dataModel.addNodeForUndo(a),a},zd.createNode=function(a){var b=fa.game.add.node(a||hb());return fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createEmitter=function(a){var b=fa.game.add.emitter(a||hb());return fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createTilemap=function(a){var b=fa.game.add.tilemap(a||hb());return fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createImage=function(a){var b=fa.game.add.image(a||hb(!0));return b.texture=this._builtinAtlas(),b.frame="empty.png",fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createSprite=function(a){var b=fa.game.add.sprite(a||hb());return b.texture=this._builtinAtlas(),b.frame="empty.png",fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createText=function(a){var b=fa.game.add.text(a||hb(!0));return b.text="TEXT",b.width=120,b.height=30,fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createButton=function(a){var b=fa.game.add.button(a||hb(!0));return b.texture=this._builtinAtlas(),b.frame="button.png",b.imageType=qc.UIImage.IMAGE_TYPE_SLICED,fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createToggle=function(a){var b=fa.game.add.toggle(a||hb(!0));return b.background.texture=this._builtinAtlas(),b.background.frame="button.png",b.background.imageType=qc.UIImage.IMAGE_TYPE_SLICED,b.checkMark.texture=this._builtinAtlas(),b.checkMark.frame="ok.png",b.checkMark.imageType=qc.UIImage.IMAGE_TYPE_SLICED,b.checkMark.width=50,b.checkMark.height=50,b.text.text="Toggle",b.text.color=new qc.Color(16777215),b.text.fontSize=24,b.on=!0,fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createScrollBar=function(a){var b=fa.game.add.scrollBar(a||hb(!0),!0);return b.texture=this._builtinAtlas(),b.frame="sliderbg.png",b.imageType=qc.UIImage.IMAGE_TYPE_SLICED,b.sliders.texture=this._builtinAtlas(),b.sliders.frame="button.png",b.sliders.imageType=qc.UIImage.IMAGE_TYPE_SLICED,fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createScrollView=function(a){var b=fa.game.add.scrollView(a||hb(!0));b.texture=null,b.width=400,b.height=400,b.canVertical=!0,b.canHorizontal=!1,b.interactive=!0,b.movementType=qc.ScrollView.MOVEMENT_ELASTIC,b.elasticity=2;var c=b.addScript("qc.NodeMask");c.checkInField=!1;var d=fa.game.add.node(b);return d.width=400,d.height=800,b.content=d,fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createSlider=function(a){var b=fa.game.add.slider(a||hb(!0),!0);return b.texture=this._builtinAtlas(),b.frame="button.png",b.imageType=qc.UIImage.IMAGE_TYPE_SLICED,b.height=15,b.sliders.texture=this._builtinAtlas(),b.sliders.frame="button.png",b.sliders.imageType=qc.UIImage.IMAGE_TYPE_SLICED,b.sliders.height=15,b.value=.5,fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createProgressBar=function(a){var b=fa.game.add.progressBar(a||hb(!0),!0);return b.texture=this._builtinAtlas(),b.frame="button.png",b.imageType=qc.UIImage.IMAGE_TYPE_SLICED,b.value=.5,b.sliders.texture=this._builtinAtlas(),b.sliders.frame="button.png",b.sliders.imageType=qc.UIImage.IMAGE_TYPE_SLICED,b.sliders.colorTint=new qc.Color("#E0E0E0"),fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createInputField=function(a){var b=fa.game.add.inputField(a||hb(!0));return b.texture=this._builtinAtlas(),b.frame="button.png",b.imageType=qc.UIImage.IMAGE_TYPE_SLICED,b.textComponent.fontSize=18,b.placeholder.fontSize=18,fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createSound=function(a){var b=fa.game.add.sound(a||hb());return fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createDom=function(a){var b=fa.game.add.dom(a||hb());return fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd.createGraphics=function(a){var b=fa.game.add.graphics(a||hb());return fa.hierarchy.activeNode=b,fa.dataModel.addNodeForUndo(b),b},zd._builtinAtlas=function(){return fa.game.assets.find("__builtin_resource__")};var zd=qc.widget.Menu.prototype;zd._addComponentItems=function(){},zd._addComponentItem=function(a){this.addItem(a,function(){var a=fa.hierarchy.activeNode;if(a){try{target.addScript(event.label)}catch(b){return void fa.notification.warn(fa._("Current node is not allowed to add this component."))}pc.redraw(a)}})};var zd=qc.widget.Menu.prototype;zd._addEditorItems=function(){var b=this;this.addItem(fa._("Edit/Undo"),function(){Eb(document.activeElement)||b.undo()},{shortcut:"mod+z",suffix:Z?"Command+Z":"Ctrl+Z",disabled:function(){return!fa.undo.canUndo()}}),this.addItem(fa._("Edit/Redo"),function(){Eb(document.activeElement)||b.redo()},{shortcut:"mod+y",suffix:Z?"Command+Y":"Ctrl+Y",disabled:function(){return!fa.undo.canRedo()}}),this.addSeparator(fa._("Edit/Redo")),this.addItem(fa._("Edit/Cut"),function(){Eb(document.activeElement)||b.cut()},{shortcut:"mod+x",preventDefault:!1,suffix:Z?"Command+X":"Ctrl+X"}),this.addItem(fa._("Edit/Copy"),function(){Eb(document.activeElement)||b.copy()},{shortcut:"mod+c",preventDefault:!1,suffix:Z?"Command+C":"Ctrl+C"}),this.addItem(fa._("Edit/Paste"),function(){Eb(document.activeElement)||b.paste()},{shortcut:"mod+v",preventDefault:!1,suffix:Z?"Command+V":"Ctrl+V"}),this.addSeparator(fa._("Edit/Paste")),this.addItem(fa._("Edit/Duplicate"),function(){Eb(document.activeElement)||b.duplicate()},{shortcut:"mod+d",suffix:Z?"Command+D":"Ctrl+D"}),this.addItem(fa._("Edit/Delete"),function(){b["delete"]()}),this.addSeparator(fa._("Edit/Delete")),this.addItem(fa._("Edit/Preview (WebGL)"),function(){fa.playing?a.open("PreviewGameWebGL.html","previewGameWebGL"):(qc.editor.Operation.SAVE_CURR_SCENE(),a.open("PreviewGameWebGL.html","previewGameWebGL"))}),this.addItem(fa._("Edit/Preview (Canvas)"),function(){fa.playing?a.open("PreviewGameCanvas.html","previewGameCanvas"):(qc.editor.Operation.SAVE_CURR_SCENE(),a.open("PreviewGameCanvas.html","previewGameCanvas"))}),this.addItem(fa._("Edit/Run"),function(){b.run()},{shortcut:"mod+p",suffix:Z?"Command+P":"Ctrl+P"}),this.addSeparator(fa._("Edit/Run")),this.addItem(fa._("Edit/Apply To Prefab"),function(){b.applyPrefab()})},zd.undo=function(){fa.undo.undo()},zd.redo=function(){fa.undo.redo()},zd.copy=function(){var a=fa.activeView;a&&a.handleCopy&&a.handleCopy()},zd.cut=function(){var a=fa.activeView;a&&a.handleCut&&a.handleCut()},zd.paste=function(){var a=fa.activeView;a&&a.handlePaste&&a.handlePaste()},zd["delete"]=function(){var a=fa.activeView;a&&a.handleDelete&&a.handleDelete()},zd.duplicate=function(){var a=fa.activeView;a&&a.handleDuplicate&&a.handleDuplicate()},zd.run=function(){fa.playing=!fa.playing},zd.applyPrefab=function(){var a=fa.hierarchy.activeNode;if(a&&a._prefab){var b=fa.game.assets.findByUUID(a._prefab);b instanceof qc.Prefab&&qc.editor.Operation.SAVE_PREFAB(a,b.url)}};var zd=qc.widget.Menu.prototype;zd._addLanguageItems=function(){this.addItem("Language/中文",function(){if("zh"!==fa.localize.language){if(fa.playing)return void fa.notification.warn(fa._("Quit running mode first"));if(fa.prefabInfo)return void fa.notification.warn(fa._("Stop editing prefab first"));qc.editor.Operation.SAVE_CURR_SCENE(function(){fa.localize.language="zh",fa.storage.set("language",fa.localize.language),fa.storage.save(),fa.silentRefresh=!0,a.location.reload()})}},{id:"zh",type:"radio",groupId:"language",selected:function(){return"zh"===fa.localize.language}}),this.addItem("Language/English",function(){if("en"!==fa.localize.language){if(fa.playing)return void fa.notification.warn(fa._("Quit running mode first"));if(fa.prefabInfo)return void fa.notification.warn(fa._("Stop editing prefab first"));qc.editor.Operation.SAVE_CURR_SCENE(function(){fa.localize.language="en",fa.storage.set("language",fa.localize.language),fa.storage.save(),fa.silentRefresh=!0,a.location.reload()})}},{id:"en",type:"radio",groupId:"language",selected:function(){return"zh"!==fa.localize.language}})};var zd=qc.widget.Menu.prototype;zd._addLayoutItems=function(){var a=function(a){return fa.playing?void fa.notification.warn(fa._("Quit running mode first")):fa.prefabInfo?void fa.notification.warn(fa._("Stop editing prefab first")):void qc.editor.Operation.SAVE_CURR_SCENE(a)};this.addItem(fa._("Layout/Portrait"),function(){"Portrait"!==fa.orientation&&a(function(){fa.orientation="Portrait",fa.storage.set("orientation","Portrait")})},{id:"Portrait",type:"radio",groupId:"orientation",selected:function(){return"Portrait"===fa.orientation}}),this.addItem(fa._("Layout/Landscape"),function(){"Landscape"!==fa.orientation&&a(function(){fa.orientation="Landscape",fa.storage.set("orientation","Landscape")})},{id:"Landscape",type:"radio",groupId:"orientation",selected:function(){return"Landscape"===fa.orientation}})};var zd=qc.widget.Menu.prototype;zd._addPluginsItems=function(){this.addItem(fa._("Plugins/Plugin Manager"),function(){fa.inspector.propertyView.inspect({},"pluginManager")}),this.addItem(fa._("Plugins/Plugin Store"),function(){Ad()}),this.addSeparator(fa._("Plugins/Plugin Store")),this.addItem(fa._("Plugins/Export Plugin"),function(){})};var Ad=function(){fa.pluginStore&&(qc.Util.removeHTML(fa.pluginStore),fa.pluginStore=null);var a=document.createElement("iframe"),b=fa.storage.get("language"),c="http://"+location.host+"/Temp/InstallPlugin.html";a.src="http://www.zuoyouxi.com/Store/index?callback="+encodeURIComponent(c)+"&lng="+b,a.style.borderWidth="0",a.style.margin="0",a.style.padding="0",a.style.display="block";var d=new qc.editor.Dialog;d.title=fa._("Plugin Store");var e=Cb(760,600);d.width=e.width,d.height=e.height,d.htmlFill=!0,d.contentPadding=[2,2,2,2],d.content=a,d.modal=!0,d.show()},Bd=function(a){qc.editor.Operation.QUERY_PLUGIN_INFO(function(b){fa.pluginInfo=b;var c=fa.pluginInfo&&fa.pluginInfo.plugins;a(c)})},Cd=function(a,b,c,d){console.log(a,c),qc.editor.Operation.INSTALL_PLUGIN(a,b,c,d)};fa.initInstallPlugin=function(a){var b=fa.localize=new qc.editor.Localize("zh");fa._=function(a){return b._.call(b,a)};var c=a.document.getElementById("installPlugin");c.innerText=fa._("Checking..."),c.stat=0;var d=$("plugin_id",context),e=($("plugin_name",context),$("version",context)),f=$("session",context);c.addEventListener("click",function(){1===c.stat&&(c.innerText=fa._("Installing..."),c.stat=2,Cd(d,e,f,function(a){0===a?(c.stat=3,c.innerText=fa._("Installed"),fa.notification.info(fa._("{0} has been successfully installed."))):(c.stat=1,c.innerText=fa._("Install"),fa.notification.info(fa._("{0} failed to install.")))}))}),Bd(function(a){var b=a[d];!b||qc.editor.version.versionCompare(b.version,e)<0?(c.stat=1,c.innerText=fa._("Install")):(c.stat=3,c.innerText=fa._("Installed"))})};var zd=qc.widget.Menu.prototype;zd._addProjectItems=function(){var b=this;b.addItem(fa._("Project/New Scene"),function(){b.createScene()},{shortcut:"mod+m",suffix:Z?"Command+M":"Ctrl+M"}),b.addItem(fa._("Project/Save Scene"),function(){b.saveScene()},{shortcut:"mod+s",suffix:Z?"Command+S":"Ctrl+S"}),b.addItem(fa._("Project/Reload Scene"),function(){fa.playing?fa.scene.reload():qc.editor.Operation.SAVE_CURR_SCENE(function(){fa.scene.reload()})}),b.addSeparator(fa._("Project/Reload Scene")),b.addItem(fa._("Project/Open Recent")),qc.editor.Operation.RECENT_OPEN(function(c){c&&c.forEach(function(c){var d,e=k.isMac?"/":"\\";c.charAt(c.length-1)===e&&(d=c.substring(0,c.lastIndexOf(e))),d&&(d=d.substr(d.lastIndexOf(e)+1),b.findItem(fa._("Project/Open Recent")+"/"+d)&&(d="`"+c+"`"),b.addItem(fa._("Project/Open Recent")+"/"+d,function(b){var c=function(){qc.editor.Operation.OPEN_PROJECT(b.project,function(b){b?(fa.silentRefresh=!0,fa.storage.set("switchProject","1"),a.location.reload()):fa.notification.error(fa._("Open project failed."))})};mb(c)},{project:c}))})}),b.addItem(fa._("Project/New Project"),function(){b.createProject()}),b.addItem(fa._("Project/Open Project"),function(){b.openProject()}),this.addSeparator(fa._("Project/Open Project")),this.addItem(fa._("Project/Publish..."),function(){b.publish()}),this.addSeparator(fa._("Project/Publish...")),this.addItem(fa._("Project/Settings..."),function(){b.openSettings()},{shortcut:"shift+mod+b",suffix:Z?"Shift+Command+B":"Shift+Ctrl+B"})},zd.createScene=function(){qc.editor.Operation.NEW_SCENE()},zd.saveScene=function(){return fa.playing?void fa.notification.warn(fa._("Quit running mode first")):fa.prefabInfo?void fa.notification.warn(fa._("Stop editing prefab first")):void(fa.config.editor.currScene&&"unsavedScene"!=fa.config.editor.currScene?(qc.editor.Operation.SAVE_SCENE(fa.config.editor.currScene),qc.editor.Operation.UPDATE_EDITOR_SETTINGS(fa.config.editor)):lb(fa._("Enter the new scene name"),"",function(a){if(a){fa.config.editor.currScene=a,qc.editor.Operation.SAVE_SCENE(a),qc.editor.Operation.UPDATE_EDITOR_SETTINGS(fa.config.editor);var c=b.keys(fa.config.scene.scene);c.push(a),qc.editor.Operation.UPDATE_SCENE_SETTINGS(c),ib()}}))},zd.createProject=function(){var b=function(){var b=new qc.editor.Dialog,c=new ab({labelWidth:"en"===fa.localize.language?110:70});b.contentPadding=[2,2,2,2],b.content=c,b.width=420,b.height=180,b.modal=!0,b.show(),c.on("create",function(b){var c=b.path;c?qc.editor.Operation.CREATE_PROJECT(c,function(b,d){b?qc.editor.Operation.OPEN_PROJECT(c,function(b){b?(fa.silentRefresh=!0,fa.storage.set("switchProject","1"),a.location.reload()):fa.notification.error(fa._("Open project failed."))}):fa.notification.error(fa._("Create project failed.")+" Reason:"+d)}):fa.notification.error(fa._("Please choose a folder to create the project"))})};mb(b)},zd.openProject=function(){mb(function(){var b=new $a,c=new Na;c.modal=!0,c.title=fa._("Choose Folder"),c.content=b,c.contentPadding=2;var d=Cb(800,500);c.width=d.width,c.height=d.height,c.show(),b.on("clickOk",function(b){qc.editor.Operation.OPEN_PROJECT(b,function(b){b?(fa.silentRefresh=!0,fa.storage.set("switchProject","1"),a.location.reload()):fa.notification.error(fa._("Open project failed."))}),c.hide()}),b.on("clickCancel",function(){c.hide()})})},zd.publish=function(){qc.editor.Operation.PUBLISH()},zd.openSettings=function(){var a=fa.inspector;a.propertyView.inspect(null,"setting")};var zd=qc.widget.Menu.prototype;zd._addQCItems=function(){var b=this;b.addItem(fa._("QICI Engine/About QICI Engine..."),function(){"zh"==fa.localize.language?a.open("http://www.zuoyouxi.com","QICI Engine"):a.open("http://www.qiciengine.com","QICI Engine")}),b.addSeparator(fa._("QICI Engine/About QICI Engine...")),b.addItem(fa._("QICI Engine/Check for Updates..."),function(){b.checkForUpdates()}),b.addSeparator(fa._("QICI Engine/Check for Updates...")),b.addItem(fa._("QICI Engine/Help/zh/Manual..."),function(){a.open("http://docs.zuoyouxi.com/manual/index.html","QICI Engine")}),b.addItem(fa._("QICI Engine/Help/zh/API..."),function(){a.open("http://docs.zuoyouxi.com/api/index.html","QICI Engine")}),b.addItem(fa._("QICI Engine/Help/zh/Forum..."),function(){a.open("http://bbs.zuoyouxi.com","QICI Engine")}),b.addItem(fa._("QICI Engine/Help/en/Manual..."),function(){a.open("http://docs.qiciengine.com/manual/index.html","QICI Engine")}),b.addItem(fa._("QICI Engine/Help/en/API..."),function(){a.open("http://docs.qiciengine.com/api/index.html","QICI Engine")}),b.addItem(fa._("QICI Engine/Help/en/Forum..."),function(){a.open("http://bbs.qiciengine.com","QICI Engine")}),b.addItem(fa._("QICI Engine/Preference..."),function(){var a=fa.inspector;a.propertyView.inspect(null,"preference")})},zd.checkForUpdates=function(){var a=fa.inspector;a.propertyView.inspect(null,"checkForUpdates")};var zd=qc.widget.Menu.prototype;zd._addToolItems=function(){this.addItem(fa._("Tool/Frame Animation Editor"),function(){fa.inspector.propertyView.inspect(null,"frameAnimation")}),this.addItem(fa._("Tool/Import Assets"),function(){fa.inspector.propertyView.inspect(null,"importResource")}),this.addItem(fa._("Tool/Repack Texture Atlases"),function(){fa.texturePacker.packAll()}),this.addItem(fa._("Tool/Create WebFont"),function(){fa.inspector.propertyView.inspect(null,"webfont","")})};var Dd=m("qc.editor.FileTree",na,function(a){Dd["super"].constructor.call(this,a),this.dragToIndexEnabled=!1,this.clearSelectionOnBackgroundClicked=!1,this._initMenu(),this.visibleFunc=function(a){return a.isDir?!0:!1},this.selectionModel.on("selectionChange",function(){fa.project.onTreeSelectionChange()})});Dd.prototype.blink=function(a){var b=this;if(b._anim&&(b._anim.finishFunc=function(){b._blinkData.s("blink.background",null),b._anim=null,b._blinkData=null},b._anim.stop()),a){b._blinkData=a;var c=0,d=function(){4>c?(c++,b._anim=W({duration:400,finishFunc:d,action:e})):(a.s("blink.background",null),b._anim=null,b._blinkData=null)},e=function(b){c%2===0&&(b=1-b),a.s("blink.background","rgba(255, 255, 0, "+b+")")};d()}},Dd.prototype.clearHighlight=function(){var a=this,b=a.dataModel;b.datas.forEach(function(a){a.s("blink.background",null)})},Dd.prototype.drawRowBackground=function(a,b,c,d,e,f){var g=this;Dd["super"].drawRowBackground.call(g,a,b,c,d,e,f);var h=b.s("blink.background");h&&(a.beginPath(),k.drawShape(a,"roundRect",{x:c,y:d,width:e,height:f}),a.fillStyle=h,a.fill())},Dd.prototype.rename=function(a,b){b&&b.length&&b!==a.name&&(a.name=b,qc.editor.Operation.RENAME(a.id,fa.project.getFullPath(a,b)))},Dd.prototype.constructTree=function(a,b){for(var c in a){var d=a[c],e=new qc.widget.Data;e.name=c,b||(e.isProjectDir=!0,e.displayName=e.name+"("+fa.projectPath+")"),"string"==typeof d.uuid?(e.icon="",e.assetType=d.assetType,e.isBin=!0,e.resUUID=d.uuid,e.dependences=d.dependences,e.source=d.source):d.raw===!0?e.isRaw=!0:(e.icon="tree_folder",e.isDir=!0,b&&"Assets"===b.name&&b.predefined&&("atlas"===c?e.icon="tree_atlas_folder":"audio"===c?e.icon="tree_audio_folder":"excel"===c?e.icon="tree_excel_folder":"font"===c?e.icon="tree_font_folder":"state"===c?e.icon="tree_state_folder":"css"===c?e.icon="tree_css_folder":"prefab"===c?e.icon="tree_prefab_folder":"raw"===c?e.icon="tree_raw_folder":"sprite"===c?e.icon="tree_sprite_folder":"texture"===c&&(e.icon="tree_atlas_folder")),d.predefined&&("Assets"===c?e.icon="tree_assets_folder":"Scripts"===c&&(e.icon="tree_js_folder"),e.predefined=!0),d.virtualDir&&(e.virtualDir=!0,e.icon="tree_link_folder")),b&&(e.parent=b),this.dataModel.add(e),e.id=fa.project.getFullPath(e),e.isBin&&e.assetType!==fa.ASSET_TYPE.ASSET_JS&&fa.bgLoad.addResource(e.resUUID,e.id,e.assetType),e.isDir&&this.constructTree(d.sub,e)}},Dd.prototype.handleCrossDrag=function(a,b,c){(c.view===fa.fileList||c.view===fa.hierarchy)&&Dd["super"].handleCrossDrag.call(this,a,b,c)},Dd.prototype._endCrossDrag=function(a,b){if(b.view===fa.hierarchy){var c=fa.hierarchy.draggingData;if(c){var d=c.node;if(d){var e=this._crossDragInfo.rowIndex,f=this.rowDatas[e];if(!f)return;var g=f.id;qc.editor.Operation.SAVE_PREFAB(d,g+"/"+d.name+".prefab")}}}},Dd.prototype._endDrag=function(a,b){var c=b.rowIndex,d=this.rowDatas[c];if(d){var e=d.id;if(this.isSelected(this.draggingData))this.topRowOrderSelection.forEach(function(a){var b=a.id;fa.project.canMoveDir(b,e)&&(qc.editor.Operation.MOVE(b,e),a.parent=d)},this);else{var f=this.draggingData.id;fa.project.canMoveDir(f,e)&&(qc.editor.Operation.MOVE(f,e),this.draggingData.parent=d)}}},Dd.prototype._initMenu=function(){var b=this,c=new qc.editor.ContextMenu([{label:fa._("New Folder"),func:"handleMakeDir",disabled:function(){return b._isInVirtualDir()}},{label:fa._("Delete"),func:"handleDelete",disabled:function(){if(b._isInVirtualDir()||0===b.selection.length)return!0;for(var a=0;a<b.selection.length;a++){var c=b.selection[a];if(c.isProjectDir)return!0}}},{label:fa._("Rename"),func:"handleRename",disabled:function(){if(b._isInVirtualDir()||1!==b.selection.length)return!0;var a=b.selection[0];return a.isProjectDir?!0:void 0}},{type:"-"},{label:fa._("New JavaScript File"),func:"handleCreateJS",disabled:function(){return b._isInVirtualDir()||1!==b.selection.length||!b.selectionModel.lastData||!fa.project.canCreateJSInPath(b.selectionModel.lastData.id)}},{type:"-"},{label:fa._("Reimport"),func:"handleReimport",disabled:function(){return 1!==b.selection.length}},{type:"-"},{label:fa._("Open in Local File Explorer"),func:"handleReveal",disabled:function(){return!/^(127\.0\.0\.1|localhost)(:\d+|)$/.test(a.location.host)}},{type:"-"},{label:fa._("Expand"),func:"handleExpand"},{label:fa._("Collapse"),func:"handleCollapse"}]);c.on("action",function(a){a.item.func&&("function"==typeof a.item.func?a.item.func():b[a.item.func](a))}),c.addTo(b)},Dd.prototype.handleExpand=function(){var a=this.selectionModel.lastData;this.expandAll(a)},Dd.prototype.handleCollapse=function(){var a=this.selectionModel.lastData;this.collapseAll(a)},Dd.prototype.handleMakeDir=function(){var a=this._getMenuDestDir();if("string"==typeof a)return this._isInVirtualDir()?void fa.notification.error("{0} cannot be modified(builtin files).",data.id):void lb(fa._("Enter a new folder name"),"",function(b){b&&b.length&&qc.editor.Operation.MKDIR(a?a+"/"+b:b)})},Dd.prototype.handleReveal=function(){var a=this._getMenuDestDir();"string"==typeof a&&qc.editor.Operation.REVEAL_IN_FINDER(a)},Dd.prototype._isInVirtualDir=function(a){var b=this;if(a=a||b.selectionModel.lastData,!a)return!1;for(var c=a.virtualDir;!c&&a;)a=a.parent,c|=a&&a.virtualDir;return c},Dd.prototype._getMenuDestDir=function(){var a=this.selectionModel.lastData;return a?a.id:null},Dd.prototype.handleCreateJS=function(){var a=this._getMenuDestDir();"string"==typeof a&&fa.project.canCreateJSInPath(a)&&lb(fa._("Enter a new JavaScript file name"),"",function(b){qc.editor.Operation.CREATE_JS(a,b)})},Dd.prototype.handleRename=function(){var a=this.selectionModel.lastData;if(a){if(this._isInVirtualDir(a))return void fa.notification.error("{0} cannot be modified(builtin files).",a.treeData.id);this.beginEditing(a)}},Dd.prototype.handleDelete=function(){var a=this,b=a.selection.slice(0);0!==b.length&&kb(fa._("Sure to delete this file?"),fa._("Warning"),function(){b.forEach(function(b){a._isInVirtualDir(b)?fa.notification.error("{0} cannot be removed(builtin files).",b.id):b.predefined?fa.notification.error(fa._("{0} cannot be removed(builtin files)."),b.id):(qc.editor.Operation.REMOVE(b.id),a.dataModel.remove(b))})},null,{icon:"alert"})},Dd.prototype.handleReimport=function(){var a=this._getMenuDestDir();"string"==typeof a&&fa.project.reimportResource(a)};var Ed=m("qc.editor.FileNodeUI",qc.widget.graph.NodeUI,function Lf(a,b){var c=this;Lf["super"].constructor.call(c,a,b)});Ed.prototype.blinkBackground={width:{func:function(a){return a._width}},height:{func:function(a){return a._height}},comps:[{type:"roundRect",rect:[17,1,1],relative:!0,background:{func:function(a){return a.s("blink.background")}}}]},Ed.prototype.prepare=function(){var a=this,b=a.data,c=a.gv,d=b.followers;if(Ed["super"].prepare.call(a),"tile"===c.layout&&d&&d.length>0){var e=b.rect,f=c.itemWidth/48*16,g=c.itemHeight/48*16,h={};h.x=e.x+e.width-c.itemWidth/48*5,h.y=e.y+e.height/2-g/2,h.width=f,h.height=g,a.addRect(h),a.nodeInfo.expandIconRect=h}},Ed.prototype.drawBody=function(a){var b=this,c=b.data,d=b.gv,e=b.nodeInfo,f=c.s("blink.background"),g=e.expandIconRect,h=c._position,i=c._anchor,j=c._rotation,l=c.width,m=c.height,n=c._scale,o=n.x,p=n.y,q={x:-l*i.x,y:-m*i.y,width:l,height:m};q.x+=h.x,q.y+=h.y;var r=j||1!==o||1!==p;if(r&&(a.save(),k.gTranslate(a,h.x,h.y),k.gRotate(a,j),a.scale(o,p),k.gTranslate(a,-h.x,-h.y)),"list"===d.layout&&d.isSelected(c)&&(a.beginPath(),a.fillStyle=d===fa.activeView?d._selectBackground:d._inactiveSelectBackground,a.rect(0,q.y,d.viewRect.width,q.height),a.fill()),f&&(a.beginPath(),k.drawImage(a,b.blinkBackground,"fill",q.x,q.y,q.width,q.height,c,d)),r&&a.restore(),Ed["super"].drawBody.call(b,a),g&&"list"!==d.layout){var s="project_expand";c.expand&&(s="project_collapse"),k.drawImage(a,s,"uniform",g.x,g.y,g.width,g.height,c,d)}};var Fd=m("qc.editor.FileNode",qc.editor.ItemNode,function Mf(a){var b=this;Mf["super"].constructor.call(b,a)},{},{properties:["expand","followers"]},{uiClass:{get:function(){return Ed}}});Fd.prototype.getImageComps=function(){var a=this,b=Fd["super"].getImageComps.call(a);return b.splice(0,0,{type:"image",stretch:null,rect:{func:function(a,b){var c=b._indent,d=b._rowHeight;return[0,1,c,d-2]}},name:{func:function(a,b){return"list"===b.layout&&a.followers?a.expand?"treeExpand":"treeCollapse":void 0}}}),b.splice(1,0,{type:"rect",rect:[17,1,1],relative:!0,background:"#484848",borderColor:"#507aea",borderWidth:2,visible:{func:function(a){return a.a("focused")===!0}}}),b.push({type:"border",rect:[17,1,1],relative:!0,borderColor:"#507aea",borderWidth:2,visible:{func:function(a){return a.a("focused")===!0}}}),b},Fd.prototype.addToDataModel=function(a,b){var c=this,d=c.uuid;if(a._dataMap[d])throw"Data already in this DataModel";null!=c.id&&(a._idMap[c.id]=c),a._dataMap[d]=c,a._datas.splice(b,0,c),c._setDataModel(a),a.onAdd(c),a.emit("dataModelChange",{kind:"add",data:c})},Fd.prototype.addFollower=function(a){var b=this,c=b.followers||[];c.indexOf(a)<0&&(c=c.slice(0),c.push(a),b.followers=c)},Fd.prototype.removeFollower=function(a){var b=this,c=b.followers||[];c.indexOf(a)>=0&&(c=c.slice(0),k.removeArray(c,a),b.followers=c)},Fd.prototype.onPropertyChange=function(a){Fd["super"].onPropertyChange.call(this,a);var b=this;if("expand"===a.property){var c=b.expand,d=b.followers,e=b.dataModel;if(d)for(var f=e.datas.indexOf(b),g=0;g<d.length;g++){var h=d[g];c?h.addToDataModel(e,f+g+1):e.remove(h)}}else if("followers"===a.property){var i=a.oldValue,j=a.newValue;i&&i.forEach(function(a){delete a.master}),j&&j.forEach(function(a){a.master=b})}};var Gd=m("qc.editor.FileList",qc.editor.ItemList,function Nf(){var a=this;Nf["super"].constructor.call(a),a.pannable=!1,a._lastClickTime=(new Date).getTime(),a.clearSelectionOnBackgroundClicked=!0,a.editable=!0,a._initMenu(),a._initNativeDND(),a._initCrossDND(),a.selectionModel.on("selectionChange",function(){a.selectionChange()}),new qc.editor.FileListSelectionInteractor(a),a.interactors=[new qc.widget.graph.ScrollBarInteractor(a),new qc.editor.FileListInteractor(a),new qc.widget.graph.BasicInteractor(a)],a.view._dropView=a,a.addBottomPainter(a.drawFollowersBackground.bind(a)),fa.e.on(fa.e.BG_RESOURCE_LOADED,a._onBgResourceLoaded)});b.defineProperties(Gd.prototype,{editable:{get:function(){return this._editable},set:function(a){this._editable=a}}}),Gd.prototype.getListLabelIndent=function(a){var b=this,c=b._indent;return a.master?3*c:2*c},Gd.prototype.getListIndent=function(a){var b=this,c=b._indent;return a.master?2*c:c},Gd.prototype.calcRightGap=function(){var a=this.itemWidth,b=this.itemGap;return Math.max(b,a/48*16-a/48*5)},Gd.prototype.onBackgroundDoubleClick=function(){var a=fa.fileTree.selectionModel.lastData;

a&&a.parent&&(fa.fileTree.selection=a.parent)},Gd.prototype.selectionChange=function(){if(!fa.project._updatingFileListDataModel){var a=this.selectionModel.lastData;if(a&&!this._selectedByRestore){var b,c=a.treeData;if(c||a.master&&(c=a.master.treeData,b=a.name),c){var d=c.assetType,e=a.name;if(d===fa.ASSET_TYPE.ASSET_ATLAS){var f=fa.inspector.propertyView.children;if(f&&f.length&&c.resUUID===f[0].uuid)f[0].selectFrame(b,!0);else{if(f&&f.length&&f[0].frameAnimationEditor&&f[0].target&&c.resUUID===f[0].target.uuid)return;if(!fa.project.findByUUID(c.resUUID))return;fa.inspector.propertyView.inspect(null,"atlas",[c.resUUID,b])}}else if(d===fa.ASSET_TYPE.ASSET_WEBFONT)fa.inspector.propertyView.inspect(null,"webfont",c.resUUID);else if(d===fa.ASSET_TYPE.ASSET_JS)fa.inspector.propertyView.inspect(null,"js",c);else if(d===fa.ASSET_TYPE.ASSET_SCENE)fa.inspector.propertyView.inspect(null,"scene",c);else if(e.indexOf(".png")===e.length-4||e.indexOf(".jpg")===e.length-4){fa.inspector.propertyView.clear();var g=_.painter({background:null});fa.inspector.previewView.content=g,g.addTopPainter(function(b){var c=k.getImage(a._image),d=g.width,e=g.height;k.drawImage(b,c,"centerUniform",0,0,d,e);var f="12px Arial";b.font=f;var h=c.width+" * "+c.height,i=k.getTextSize(f,h);i.width+=6;var j=(d-i.width)/2,l=e-16;b.beginPath(),b.rect(j,l,i.width,16),b.fillStyle="rgb(19, 19, 19)",b.fill(),b.beginPath(),k.drawText(b,h,f,"white",j,l,i.width,16,"center")})}else c.isBin&&fa.inspector.propertyView.clear()}}}},Gd.prototype._showImageWhenDoubleClick=function(a){var b=new qc.editor.Dialog;b.position="center",b.title=a;var c=Cb(400,400);b.width=c.width,b.height=c.height,b.htmlFill=!0,b.content="<div style=\"background: url('"+a+"?"+fa.game.math.uuid()+"') no-repeat;background-size: contain;background-position: 50% 50%;\"><div>",b.show()},Gd.prototype._showTextEditorWhenDoubleClick=function(b,c){U(function(){var d=document.createElement("iframe");d.style.borderWidth="0",d.style.margin="0",d.style.padding="0",d.style.display="block",d.src="CodeEditor.html?filePath="+b;var e=new qc.editor.Dialog;e.title=fa._("Code Editor")+" - "+(c||b);var f=Cb(800,600);e.width=f.width,e.height=f.height,e.htmlFill=!0,e.contentPadding=[2,2,2,2],e.content=d,e.handleToolClick=function(){d.contentWindow.codePaneValueChanged?nb(fa._("Do you want to save the changes?"),fa._("Confirm"),[{text:fa._("Save"),key:"enter",onClick:function(){d.contentWindow.saveCode(),this.hide(),e.hide(),a.focus()}},{text:fa._("Don't Save"),onClick:function(){this.hide(),e.hide(),a.focus()}},{text:fa._("Cancel"),key:"esc",onClick:function(){this.hide()}}]):(e.hide(),a.focus())},e.show()})},Gd.prototype.onDataDoubleClick=function(a,b){if(!this.isOnExpandIcon(b,a)){var c=a.treeData;if(c)if(c.isDir)fa.fileTree.selection=c,fa.fileTree.expand(c);else if(c.isRaw){var d=ub(c.name);if([".png",".jpg",".jpeg",".gif"].indexOf(d)>=0)this._showImageWhenDoubleClick(c.id);else if("js"==d){var e=fa.preference.query("JSEditor");e==fa._("Double Click")||b.shiftKey?qc.editor.Operation.OPEN_JS(f):this._showTextEditorWhenDoubleClick(c.id)}else[".text",".txt",".css",".js",".html"].indexOf(d)>=0&&this._showTextEditorWhenDoubleClick(c.id)}else if(c.assetType===fa.ASSET_TYPE.ASSET_SCENE)qc.editor.Operation.SWITCH_SCENE(c.name.slice(0,-4));else if(c.assetType===fa.ASSET_TYPE.ASSET_PREFAB)fa.startEditingPrefab(c);else if(c.assetType===fa.ASSET_TYPE.ASSET_ATLAS)this._showImageWhenDoubleClick(fa.project.getImageURLByTreeData(c),c.id);else{var f=c.id;c.assetType===fa.ASSET_TYPE.ASSET_TEXT&&(f=f.substring(0,f.length-4)+c.source[0]);var d=ub(c.name),e=fa.preference.query("JSEditor");".js"!=d||e!=fa._("Double Click")&&!b.shiftKey?this._showTextEditorWhenDoubleClick(f,c.name):qc.editor.Operation.OPEN_JS(f)}}},Gd.prototype.addFileNode=function(a){var b=new qc.editor.FileNode;if(b.name=a.name,b.id=a.id,b.treeData=a,a.isBin)switch(a.assetType){case fa.ASSET_TYPE.ASSET_SOUND:b.image="SoundIcon";break;case fa.ASSET_TYPE.ASSET_JS:b.image="JsIcon";break;case fa.ASSET_TYPE.ASSET_WEBFONT:b.image="FontIcon";break;case fa.ASSET_TYPE.ASSET_SCENE:b.image="StateIcon";break;case fa.ASSET_TYPE.ASSET_ATLAS:case fa.ASSET_TYPE.ASSET_FONT:var c=fa.project.getImageURLByTreeData(a);b.image=c,c.indexOf("@atlas")>=0&&(b.name=sb(c)),a.assetType===fa.ASSET_TYPE.ASSET_ATLAS&&this.addAtlasFrame(b);break;default:b.image="UnknowIcon"}else if(a.isRaw){var d=ub(a.name);b.image=[".png",".jpg",".jpeg",".gif"].indexOf(d)>=0?fa.service.url+a.id:".js"===d?"JsIcon":[".mp3",".ogg"].indexOf(d)>=0?"SoundIcon":".css"===d?"CssIcon":"UnknowIcon"}else{var e=a.name,f="folder";"Assets"===e&&a.predefined?f="assets_folder":"Scripts"===e&&a.predefined?f="js_folder":a.virtualDir?f="link_folder":a.parent&&"Assets"===a.parent.name&&a.parent.predefined&&("atlas"===e?f="atlas_folder":"audio"===e?f="audio_folder":"excel"===e?f="excel_folder":"font"===e?f="font_folder":"state"===e?f="state_folder":"css"===e?f="css_folder":"prefab"===e?f="prefab_folder":"raw"===e?f="raw_folder":"sprite"===e?f="sprite_folder":"texture"===e&&(f="atlas_folder")),b.image=f}this.dataModel.add(b)},Gd.prototype.addAtlasFrame=function(a){var c=a.treeData,d=fa.project.findByUUID(c.resUUID),e=fa.project.getImageURLByTreeData(c);if(d&&d.json&&(d.json.SubTexture||d.json.frames)){var f;d.json.SubTexture?(f={},d.json.SubTexture.forEach(function(a){f[a.name]={frame:{x:a.x,y:a.y,w:a.width,h:a.height}}})):f=d.json.frames;var g=b.keys(f).sort();g.forEach(function(b){var c=f[b].frame,d=new qc.editor.FileNode;d.name=b,d.image=e,d.a("clipX",c.x),d.a("clipY",c.y),d.a("clipWidth",c.w),d.a("clipHeight",c.h),a.addFollower(d)})}},Gd.prototype.isOnExpandIcon=function(a,b){if(b){var c=this,d=c.lp(a);if("tile"===c.layout){var e=c.getDataUI(b),f=e.nodeInfo,g=f.expandIconRect;if(g&&v(g,d))return!0}else{var h=b.rect;if(h.width=c._indent,h.height=c._rowHeight,b.followers&&v(h,d))return!0}}},Gd.prototype.blink=function(a){var b=this;if(b._anim&&(b._anim.finishFunc=function(){b._blinkData.s("blink.background",null),b._anim=null,b._blinkData=null},b._anim.stop()),a){b._blinkData=a;var c=0,d=function(){4>c?(c++,b._anim=W({duration:400,finishFunc:d,action:e})):(a.s("blink.background",null),b._anim=null,b._blinkData=null)},e=function(b){c%2===0&&(b=1-b),a.s("blink.background","rgba(255, 255, 0, "+b+")")};d()}},Gd.prototype._onBgResourceLoaded=function(a){var b=a.uuid,d=fa.fileList,e=fa.fileTree.dataModel.getDataById(a.url);if(e&&e.assetType===fa.ASSET_TYPE.ASSET_ATLAS){var f=fa.project.getImageURLByTreeData(e);qc.widget.Default.setImage(f,c)}var g;if(d.dataModel&&(g=d.dataModel._roots)){for(var h,i,j=0,k=g.length;k>j;j++)if(h=g[j],h&&h.treeData&&h.treeData.resUUID===b){i=!0;break}i&&(d.savePanelContext(),fa.project.onTreeSelectionChange(),d.restorePanelContext())}},Gd.prototype.savePanelContext=function(){var a=this,b=[];a.dataModel.roots.forEach(function(a){a.expand&&b.push(a.id)}),a._contextSnap={search:fa.project.searchValue,translateY:a.translateY,selection:a.selection.slice(),expanded:b}},Gd.prototype.restorePanelContext=function(){var a=this,b=a._contextSnap;delete a._contextSnap;var c=b.search,d=b.translateY,e=b.selection,f=b.expanded;c&&(fa.project.searchValue=c),a.dataModel.roots.forEach(function(a){a.followers&&f.indexOf(a.id)>=0&&(a.expand=!0)});for(var g=[],h=0;h<e.length;h++){var i,j=e[h];j.id?(i=a.dataModel.getDataById(j.id),i&&g.push(i)):j.master&&(i=a.dataModel.getDataById(j.master.id),i&&i.followers&&i.followers.forEach(function(a){a.name===j.name&&g.push(a)}))}a._selectedByRestore=!0,a.selection=g,delete a._selectedByRestore,a.translateY=d},Gd.prototype.clearHighlight=function(){var a=this,b=a.dataModel;b.datas.forEach(function(a){a.s("blink.background",null)})},Gd.prototype.drawFollowersBackground=function(a){var b=this,c=b.dataModel,d=c.datas;if("list"!==b.layout)for(var e=0;e<d.length;e++){var f=d[e],g=f.followers;if(g&&g.length>0&&f.expand)for(var h=0;h<g.length;h++){var i=g[h],j=i.rect;j.x-=8,j.width+=16,a.beginPath(),a.fillStyle="rgb(82, 82, 82)";var l=b.itemWidth/48*8;0===h&&1===g.length?k.drawRoundRect(a,j.x,j.y,j.width,j.height,l,l,l,l):0===h?k.drawRoundRect(a,j.x,j.y,j.width,j.height,l,0,l,0):h===g.length-1?k.drawRoundRect(a,j.x,j.y,j.width,j.height,0,l,0,l):a.rect(j.x,j.y,j.width,j.height),a.fill()}}},Gd.prototype._initMenu=function(){var b=this,c=new qc.editor.ContextMenu([{label:fa._("New Folder"),func:"handkeMakeDir",disabled:function(){return b._isInVirtualDir()}},{label:fa._("Delete"),func:"handleDelete",disabled:function(){return b._isInVirtualDir()||0===b.selection.length}},{label:fa._("Rename"),func:"handleRename",disabled:function(){return b._isInVirtualDir()||1!==b.selection.length}},{type:"-"},{label:fa._("New JavaScript File"),func:"handleCreateJS",disabled:function(){var a=b._getMenuDestDir();return b._isInVirtualDir()||!fa.project.canCreateJSInPath(a)}},{type:"-"},{label:fa._("Reimport"),func:"handleReimport"},{type:"-"},{label:fa._("Show Retainers"),func:"handleFindReferences",disabled:function(){var a=fa.fileList.selectionModel.selection[0];return a&&a.treeData&&(a.treeData.assetType===fa.ASSET_TYPE.ASSET_JS||a.treeData.assetType===fa.ASSET_TYPE.ASSET_PREFAB)?!1:!0}},{label:fa._("Open in Local File Explorer"),func:"handleReveal",disabled:function(){return!/^(127\.0\.0\.1|localhost)(:\d+|)$/.test(a.location.host)}}]);c.on("action",function(a){a.item.func&&("function"==typeof a.item.func?a.item.func():b[a.item.func](a))}),c.addTo(b)},Gd.prototype._isInVirtualDir=function(a){var b=this;if(a=a||b.selectionModel.lastData&&b.selectionModel.lastData.treeData||fa.fileTree.selection[0],!a)return!1;for(var c=a.virtualDir;!c&&a;)a=a.parent,c|=a&&a.virtualDir;return c},Gd.prototype._getMenuDestDir=function(){var a,b=this,c=b.selectionModel.lastData;if(c){var d=c.treeData;d&&d.isDir&&(a=d.id)}return a||(a=b.currentDir),a},Gd.prototype.handkeMakeDir=function(){if(this._isInVirtualDir())return void fa.notification.error("{0} cannot be modified(builtin files).",data.treeData.id);var a=this._getMenuDestDir();lb(fa._("Enter a new folder name"),"",function(b){b&&b.length&&qc.editor.Operation.MKDIR(a?a+"/"+b:b)})},Gd.prototype.handleReveal=function(){qc.editor.Operation.REVEAL_IN_FINDER(this._getMenuDestDir())},Gd.prototype.handleRename=function(){var a=this.selectionModel.lastData;if(a){if(this._isInVirtualDir(a.treeData))return void fa.notification.error("{0} cannot be modified(builtin files).",data.treeData.id);this.beginEditing(a)}},Gd.prototype.handleDelete=function(){var a=this,b=a.selection.slice(0);0!==b.length&&kb(fa._("Sure to delete this file?"),fa._("Warning"),function(){b.forEach(function(b){b.treeData&&(a._isInVirtualDir(b.treeData)?fa.notification.error("{0} cannot be removed(builtin files).",b.treeData.id):b.treeData.predefined?fa.notification.error("{0} cannot be removed(builtin files).",b.treeData.id):(qc.editor.Operation.REMOVE(b.treeData.id),a.dataModel.remove(b),fa.fileTree.dataModel.remove(b.treeData)))})},null,{icon:"alert"})},Gd.prototype.handleCreateJS=function(){var a=this._getMenuDestDir();fa.project.canCreateJSInPath(a)&&lb(fa._("Enter a new JavaScript file name"),"",function(b){qc.editor.Operation.CREATE_JS(a,b)})},Gd.prototype.findScriptReferences=function(a){qc.editor.Operation.SOURCE(a,function(a){var b=a.source,c=b.match(/qc.defineBehaviour[\(\s]*['"](.*)['"]/);if(c){c=c[1];var d=[],e=function(a){for(var b=a.children,f=0;f<b.length;f++){for(var g=b[f],h=g.scripts,i=0;i<h.length;i++){var j=h[i];j["class"]===c&&d.push({node:g})}e(g)}};e(fa.game.world),fa.inspector.propertyView.inspect(null,"Panel:ReferencePanel",d)}})},Gd.prototype.findPrefabReferences=function(a){var b=a.resUUID,c=[],d=function(a){for(var e=a.children,f=0;f<e.length;f++){var g=e[f],h=g.getMeta();for(var i in h)if(16===h[i]&&g[i]&&g[i].key===b)c.push({node:g,property:i});else if(17===h[i]&&g[i])for(var j=0;j<g[i].length;j++)if(g[i][j].key===b){c.push({node:g,property:i});break}for(var k=g.scripts,j=0;j<k.length;j++){var l=k[j];h=l.getMeta();for(var i in h)if(16===h[i]&&l[i]&&l[i].key===b)c.push({node:g,script:l,property:i});else if(17===h[i]&&l[i])for(var m=0;m<l[i].length;m++)if(l[i][m].key===b){c.push({node:g,script:l,property:i});break}}d(g)}},e=fa.game.world;d(e),fa.inspector.propertyView.inspect(null,"Panel:ReferencePanel",c)},Gd.prototype.handleFindReferences=function(){var a=this.selectionModel.lastData,b=a.treeData;b&&(b.assetType===fa.ASSET_TYPE.ASSET_JS?this.findScriptReferences(b.id):b.assetType===fa.ASSET_TYPE.ASSET_PREFAB&&this.findPrefabReferences(b))},Gd.prototype.handleReimport=function(){var a=this._getMenuDestDir();fa.project.reimportResource(a)},Gd.prototype.handleDataDoubleSelect=function(a,b){var c=this;if(c.editable){if(c._pendingEditing)return void(c._pendingEditing="cancel");if(!L(a)&&b.treeData){var d=c.getDataUI(b);d.labelInfo&&v(d.labelInfo.rect,c.lp(a))&&(c._pendingEditing=!0,setTimeout(function(){c._pendingEditing&&(!k.popup&&"cancel"!==c._pendingEditing&&c.isSelected(b)&&c===fa.activeView&&c.beginEditing(b),delete c._pendingEditing)},700))}}},Gd.prototype.beginEditing=function(a){if(a.treeData){var b=this,c=b.getDataUI(a);if(c.labelInfo){var d,e,f,g,h,i,j=new qc.widget.TextField,k=j.getInput(),l=a.name,m=c.labelInfo.rect;if(j.maskRe=/[^\s\\/'"?\.]/,(h=l.indexOf(".mp3.bin"))>0&&h===l.length-8)l=l.substr(0,l.length-8),j.extension=".mp3.bin";else if((i=l.indexOf(".ogg.bin"))>0&&i===l.length-8)l=l.substr(0,l.length-8),j.extension=".ogg.bin";else{var o=l.lastIndexOf(".");o>0&&(j.extension=l.substr(o),l=l.substring(0,o))}"tile"===b.layout?(d=m.x+m.width/2-b.itemWidth/2,e=m.y,f=b.itemWidth,g=m.height):(d=m.x,e=m.y,f=b.width-d,g=m.height),d+=b.translateX,e+=b.translateY,b._currentEditor=j,b.view.appendChild(j.view),n(j,d,e,f,g),k.style.font=a.s("label.font"),k.onblur=function(){b.endEditing()},k.onkeydown=function(a){G(a)?b.endEditing():F(a)&&b.cancelEditing()},j._data=a,j.value=null==l?"":l,k.focus(),U(k.select,k)}}},Gd.prototype.rename=function(a,b){var c=a.treeData;if(c&&b&&b.length&&b!==a.name){var d=c.name;a.name=b,c.name=b,qc.editor.Operation.RENAME(c.id,fa.project.getFullPath(c,b)),c.assetType===fa.ASSET_TYPE.ASSET_SCENE&&d===fa.config.editor.currScene+".bin"&&(fa.config.editor.currScene=b.replace(".bin",""),ib())}},Gd.prototype.endEditing=function(){var a=this._currentEditor;a&&(this.rename(a._data,a.value+(null==a.extension?"":a.extension)),delete this._currentEditor,r(a.view),this.iv())},Gd.prototype.cancelEditing=function(){var a=this._currentEditor;a&&(delete this._currentEditor,r(a.view),this.iv())},Gd.prototype._clearDragInfo=function(){fa.dragAndDrop.hideTip(),this._dragInfo&&(this._dragInfo.focusData&&this._dragInfo.focusData.a("focused",!1),this._dragInfo=null,this.iv())},Gd.prototype._endDrag=function(){},Gd.prototype.handleDragAndDrop=function(a,b){if("prepare"===b)return void this._clearDragInfo();if("begin"===b){var c=this.draggingData.name;if(this.isSelected(this.draggingData)){var d=this.selection.length;c+=d>1?" (+"+d+") ":""}this._dragInfo={tip:c,view:this}}var e=this._dragInfo;if(e){if("begin"===b||"between"===b){var f=this.view.contains(Bb(a));return f?(e.inView=!0,e.focusData&&e.focusData.a("focused")===!0&&e.focusData.a("focused",!1),e.focusData=this.getDataAt(a),e.focusData&&e.focusData.a("focused",!0),this.autoScroll(a),fa.dragAndDrop.clearDropView(a,e)):(e.inView=!1,e.focusData&&(e.focusData.a("focused",!1),e.focusData=null),fa.dragAndDrop.crossDrag(a,e)),void fa.dragAndDrop.showTip(e.tip,a)}return"end"===b?(this._moveDragFiles(a,e),e.inView?this._endDrag(a,e):fa.dragAndDrop.crossDrop(a,e),void this._clearDragInfo()):"cancel"===b?(e.inView||fa.dragAndDrop.crossCancel(a,e),void this._clearDragInfo()):void 0}},Gd.prototype._moveDragFiles=function(a,b){var c,d=this;if(b.inView){var e=d.getDataAt(a);e&&(c=e.treeData)}else fa.dragAndDrop._dropView===fa.fileTree&&(c=fa.fileTree.getDataAt(a));if(c&&c.isDir){var f=c.id,g=d.draggingData;if(d.isSelected(g)){var h=[];d.selection.forEach(function(a){if(a.treeData){var b=a.treeData.id;fa.project.canMoveDir(b,f)&&(qc.editor.Operation.MOVE(b,f),h.push(a))}}),h.forEach(function(a){d.dataModel.remove(a),a.treeData.parent=c})}else if(g.treeData){var i=g.treeData.id;fa.project.canMoveDir(i,f)&&(qc.editor.Operation.MOVE(i,f),d.dataModel.remove(g),g.treeData.parent=c)}}},Gd.prototype._initCrossDND=function(){this.view._dropView=this},Gd.prototype.handleCrossDrag=function(a,b,c){if(c.view===fa.hierarchy){var d=this._crossFocusData;if("exit"===b||"cancel"===b)return void(d&&(d.a("focused",!1),this._crossFocusData=null));if(this._crossFocusData=this.getDataAt(a),"enter"===b||"over"===b)d!==this._crossFocusData&&(d&&d.a("focused",!1),this._crossFocusData&&this._crossFocusData.a("focused",!0));else if("drop"===b){var e=fa.hierarchy.draggingData;if(e){var f=e.node;f&&qc.editor.Operation.SAVE_PREFAB(f,this.currentDir+"/"+f.name+".prefab")}this._crossFocusData&&(this._crossFocusData.a("focused",!1),this._crossFocusData=null)}}},Gd.prototype._initNativeDND=function(){function a(a){a.preventDefault(),a.stopPropagation()}function b(a){a.preventDefault(),a.stopPropagation()}function c(a){a.preventDefault(),a.stopPropagation()}function d(a){a.preventDefault(),a.stopPropagation();for(var b=a.dataTransfer.files,c=b.length,d=0;c>d;d++){var f=b[d],g=new FileReader;g.onload=e,g.file=f,g.readAsArrayBuffer(f)}}function e(a){var b=a.target,c=b.result,d=b.file.name;fa.project.uploadFile(f.currentDir+"/"+d,c)}var f=this,g=this._interactionDiv;g.addEventListener("dragenter",a,!1),g.addEventListener("dragleave",b,!1),g.addEventListener("dragover",c,!1),g.addEventListener("drop",d,!1)};var Hd=m("qc.editor.FileListInteractor",qc.widget.graph.Interactor,function(a){this.fileList=a,this._dragging=!1,this._lastSelectDataTime=X(),Hd["super"].constructor.call(this,a)});Hd.prototype.clear=function(a){var b=this.fileList;this._dragging&&!this._dragCancel&&b.handleDragAndDrop(a,"end"),b.draggingData&&(b.draggingData=null,b.invalidateAll()),this._dragging=this._clientPoint=this._dragCancel=this._touchStartDataId=null},Hd.prototype.handle_mousedown=function(a){this.handle_touchstart(a)},Hd.prototype.handle_mouseup=function(a){this.handle_touchend(a)},Hd.prototype.handleWindowMouseMove=function(a){this.handleWindowTouchMove(a)},Hd.prototype.handleWindowMouseUp=function(a){this.handleWindowTouchEnd(a)},Hd.prototype.handle_touchstart=function(a){var b=this.fileList,c=b.getDataAt(a);if(!b.isCloseToVScrollBar(a)){this.clear(a),this._clientPoint=B(a);var d=b.isOnExpandIcon(a,c);d&&(c.expand=!c.expand,b.redraw()),N(a)?(c&&!d&&(this._touchStartDataId=c.id),!c&&b.clearSelectionOnBackgroundClicked&&b.selectionModel.clearSelection(),c&&b.handleDragAndDrop&&!b.isCloseToVScrollBar(a)&&!b.isOnExpandIcon(a,c)&&(b.draggingData=c,b.invalidateAll(),b.handleDragAndDrop(a,"prepare"),z(this,a))):(c&&(d||this.handleSelection(a,c)),this.clear(a))}},Hd.prototype.handle_touchend=function(a){if(this._clientPoint&&!this._dragging){var b=this.fileList.getDataAt(a);if(b&&b.id===this._touchStartDataId){var c=this.fileList.isOnExpandIcon(a,b);c||this.handleSelection(a,b)}}this.clear(a)},Hd.prototype.handleWindowTouchMove=function(a){this._dragging?this._dragCancel||this.fileList.handleDragAndDrop(a,"between"):this._clientPoint&&this.fileList.draggingData&&y(B(a),this._clientPoint)>2&&(this._dragging=!0,this.fileList.handleDragAndDrop(a,"begin"))},Hd.prototype.handleWindowTouchEnd=function(a){this.clear(a)},Hd.prototype.handleSelection=function(a,b){var c=this.fileList,d=c.selectionModel,e=d.lastData;if(P(a))c.isSelected(b)?d.removeSelection(b):d.appendSelection(b);else if(O(a))if(e)for(var f=c.dataModel.datas,g=f.indexOf(e),h=f.indexOf(b);g!==h;)g+=h>g?1:-1,d.appendSelection(f[g]);else d.selection=b;else if(N(a)){var i=X();d.isSelected(b)?i-this._lastSelectDataTime<1500&&c.handleDataDoubleSelect(a,b):d.selection=b,this._lastSelectDataTime=i}},Hd.prototype.handle_keydown=function(a){var b=this.fileList;if(F(a))this._dragging&&!this._dragCancel&&(b.handleDragAndDrop(a,"cancel"),this._dragCancel=!0);else if(J(a)||K(a)||H(a)||I(a)){var c=b.dataModel.datas,d=b.selectionModel.lastData;if(!c.length)return;if(d){var e=c.indexOf(d);e>=0&&(J(a)||H(a)?0!==e&&(d=c[e-1],b.selection=d):e!==c.length-1&&(d=c[e+1],b.selection=d))}else b.selection=c[0]}};var Id=(m("qc.editor.FileListSelectionInteractor",b,function(a){var b=this;b._fileList=a,b.addListeners()},{clearHierarchySelection:function(){fa.hierarchy.selectionModel.clearSelection()},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this,c=b._fileList;if(b._isOnExpandIcon=null,b._startPoint=null,c.isCloseToVScrollBar(a));else{var d=c.getDataAt(a);d?(b._startPoint=B(a),b._isOnExpandIcon=c.isOnExpandIcon(a,d)):b.clearHierarchySelection()}},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(a){var b=this,c=b._startPoint,d=B(a);!b._isOnExpandIcon&&c&&y(c,d)<2&&b.clearHierarchySelection(),b._startPoint=null,b._isOnExpandIcon=null}},{interactor:!0},{view:{get:function(){return this._fileList}}}),[{region:"top",elementConfig:{type:"container",layout:"table",scrollBarMode:"off",children:[{height:30,widths:["40+0.1",170],cells:[{fill:"none",vAlign:"middle",elementConfig:{type:"dropdownbutton",icon:"project_add",ninePatchImage:"project_add.9",ninePatchBorder:[10,10,10,10],hoverNinePatchImage:"project_add.9",hoverNinePatchBorder:[10,10,10,10],activeNinePatchImage:"project_add.9",activeNinePatchBorder:[10,10,10,10],borderWidth:0,preferredSize:{width:34,height:25},iconWidth:null,iconHeight:null,id:"projectCreate"}},{elementConfig:{type:"container",layout:{type:"hbox",align:"right"},children:[{type:"textfield",id:"searchField",preferredSize:{width:160},padding:[2,0,2,22]}]}}]}]}},{region:"left",elementConfig:{type:"qc.editor.FileTree",id:"fileTree",preferredSize:{width:140}}},{region:"center",elementConfig:{type:"container",layout:{type:"border",bottomSplitterVisible:!1},children:[{region:"center",elementConfig:{type:"qc.editor.FileList",id:"fileList"}},{region:"bottom",elementConfig:{type:"container",layout:"table",scrollBarMode:"off",children:[{height:26,widths:[.1,70],cells:[{elementConfig:{type:"qc.editor.Text",id:"filePathLabel",align:"left"}},{elementConfig:{type:"slider",id:"projectSlider",preferredSize:{width:70,height:26},min:1,max:100}}]}]}}]}}]),Jd=m("qc.editor.Project",qc.widget.Container,function Of(a){var b=this;Of["super"].constructor.call(b,a),b.layout=new qc.widget.layout.BorderLayout(b),o(Id,b),b.layout.topToggleVisible=!1,b.layout.topResizable=!1,b.layout.leftToggleVisible=!1,b.layout.splitterSize=1,b.layout.topSplitterSize=2,fa.fileTree=b.findViewById("fileTree"),fa.fileList=b.findViewById("fileList"),this._searchField=b.findViewById("searchField");var d=this._searchField.input.style;d.backgroundImage='url("'+fa.assetPath+'magnifying-glass.png")',d.backgroundRepeat="no-repeat",d.backgroundSize="17px 17px",d.backgroundPosition="2px 50%";var e=b.findViewById("projectCreate");e.menuItems=[{label:fa._("Folder")},{type:"-"},{label:fa._("JavaScript File"),createType:"js",disabled:function(){if(!fa||!fa.project)return!0;var a=fa.project._getMenuDestDir();return fa.project.canCreateJSInPath(a)?!1:!0}}],e.contextMenu.on("action",function(a){var c=a.item;b._handleCreateMenu(c)}),b._slider=b.findViewById("projectSlider");var f=b._filePathLabel=b.findViewById("filePathLabel");f.iv=function(a){var b=this._sourceText;if(b){var c=k.getTextSize(k.labelFont,b);this._text=c.width>this.width?"<marquee>"+b+"</marquee>":b}else this._text="";qc.editor.Text.prototype.iv.call(this,a)},fa.fileList.selectionModel.on("selectionChange",function(){if(!b._updatingFileListDataModel){var a=fa.fileList.selectionModel.lastData;if(a&&a.treeData){b._fileListSelectionId=a.id;for(var d=a.treeData,e=d.name;d.parent&&d.parent.parent;)e=d.parent.name+"/"+e,d=d.parent;f._sourceText=e,f.iv()}else b._fileListSelectionId=c,f._sourceText="",f.iv()}}),b._initSlider(),b._initSearchField()});Jd.prototype._initSlider=function(){var a=this,b=a._slider,c=fa.fileList;b.value=32,b.disableToolTip(),b.onValueChange=function(a){16>=a?1===a?c.layout="list":b.value=1:(c.layout="tile",c.itemWidth=c.itemHeight=40+Math.round(.5*a-8))}},Jd.prototype._initSearchField=function(){var a=this;a._searchField.on("propertyChange",function(b){"value"===b.property&&a.onSearchFieldChanged()})},Jd.prototype.onSearchFieldChanged=function(){var a=this,b=fa.fileList,c=a.searchValue;if(a._updatingFileListDataModel=!0,c.length){b.dataModel.clear(),b.contentType="search";var d=new RegExp(c,"i"),e=function(a,c){var f=a.name;!c&&d.test(f)&&b.addFileNode(a),a.children&&a.children.forEach(function(a){e(a)})};fa.fileTree.topRowOrderSelection.forEach(function(a){e(a,!0)})}else if("search"===b.contentType){var f=b.dataModel.getDataById(a._fileListSelectionId);f?fa.fileTree.selectionModel.selection=[f.treeData.parent]:this.onTreeSelectionChange()}b.selectionModel.selection=b.dataModel.getDataById(a._fileListSelectionId),a._updatingFileListDataModel=!1},Jd.prototype.canMoveDir=function(a,b){var a=a.replace(/\\/g,"/"),b=b.replace(/\\/g,"/"),c=["","Assets","Editor","ProjectSetting","Scripts","Temp"];if(c.indexOf(a)>=0)return fa.notification.warn(fa._("Built-in files cannot be modified")),!1;if(0===a.indexOf("Plugins")||0===b.indexOf("Plugins"))return fa.notification.warn(fa._("Built-in files cannot be modified")),!1;var d=0===a.indexOf("Assets/raw"),e=0===b.indexOf("Assets/raw");return!d&&e?(fa.notification.warn(fa._("Can not move file into raw floder")),!1):a===b?!1:b.indexOf(a)>=0?!1:a.indexOf(b)>=0&&tb(a)==b?!1:!0},Jd.prototype.onTreeSelectionChange=function(){var a=fa.fileList;a.dataModel.clear(),a.contentType="explore";var b=fa.fileTree.selectionModel.lastData;b&&(this.searchValue="",a.currentDir=b.id,b.children.forEach(function(b){a.addFileNode(b)}))},Jd.prototype.getFullPath=function(a,b){if(b=b||a.name,a.parent){var c=a.parent.id;return c?c+"/"+b:b}return""},Jd.prototype.exploreTree=function(a,b){b=b||fa.game.world;for(var c,d=b.children,e=this,f=0,g=d.length;g>f;f++)c=d[f],a(c),e.exploreTree(a,c)},Jd.prototype.findFileNodeByUUID=function(a){var b,c=this;return fa.fileTree.dataModel._roots.forEach(function(d){c.exploreTree(function(c){c.resUUID===a&&(b=c)},d)}),b},Jd.prototype.findByUUID=function(a,b){if(!fa.hiddenGame)return null;var c=fa.hiddenGame.assets.find(a);return c?this.descAssetByType(c,b):null},Jd.prototype.findByType=function(a,b){var c=fa.hiddenGame.assets._assets,d=[];for(var e in c){var f=c[e];f.meta&&f.meta.type===a&&d.push(this.descAssetByType(f,b))}return d},Jd.prototype.findByName=function(a,b){var c=fa.hiddenGame.assets._assets,d=[];for(var e in c){var f=c[e];f.url.indexOf(a)>=0&&d.push(this.descAssetByType(f,b))}return d},Jd.prototype.descAssetByType=function(a,b){switch(b){case"basename":return sb(a.url);case"name":return a.url;case"uuid":return a.uuid;case"type":return a.meta.type;default:return a}},Jd.prototype.uploadFile=function(a,b){var c=this.pendingUpload;if(c||(this.pendingUpload=c={list:[],index:0}),c.list.push([a,b]),!c.isUploading){c.isUploading=!0;var d=this,e=function(){if(d.pendingUpload.index===d.pendingUpload.list.length)return void delete d.pendingUpload;var a=d.pendingUpload.list[c.index++];setTimeout(function(){qc.editor.Operation.UPLOAD(a[0],a[1],e)},30)};e()}},Jd.prototype.getImageURLByAtlas=function(a){var b,c;if(a.meta&&a.meta.source){c=a.meta.source;for(var d=0,e=c.length;e>d;d++)if(".json"!==c[d]){b=c[d];break}}return b=b||".png",fa.service.url+a.url.slice(0,-4)+b},Jd.prototype.getImageURLByTreeData=function(a){var b,c;if(a.source){c=a.source;for(var d=0,e=c.length;e>d;d++)if(".json"!==c[d]){b=c[d];break}}return b=b||".png",fa.service.url+a.id.slice(0,-4)+b},Jd.prototype.reimportResource=function(a){var b=fa.fileTree.dataModel.getDataById(a);if(b){var d=[];return fa.project.exploreTree(function(a){a.assetType!==c&&a.assetType!==fa.ASSET_TYPE.ASSET_UNKNOWN&&a.assetType!==fa.ASSET_TYPE.ASSET_JS&&d.push(a.id)},b),d.length?void qc.editor.Operation.REMOVE_BIN(d,function(){fa.notification.info(fa._("Reimport completed"))}):void qc.editor.Operation.EXPLORE()}},Jd.prototype.canCreateJSInPath=function(a){return/^(Scripts|Editor)($|\/)/.test(a)},Jd.prototype._getMenuDestDir=function(){var a;return fa.activeView===fa.fileList&&(a=fa.fileList._getMenuDestDir()),a||(a=fa.fileTree._getMenuDestDir()),a},Jd.prototype._handleCreateMenu=function(a){var b,c=this,d=a.createType||"folder";b=c._getMenuDestDir(),"string"==typeof b&&lb(fa._("js"===d?"Enter a new JavaScript file name":"Enter a new folder name"),"",function(a){if(a&&a.length)if("folder"===d)qc.editor.Operation.MKDIR(b?b+"/"+a:a);else if("js"===d){if(".js"!==a.slice(-3)&&(a+=".js"),a=b+"/"+a,fa.fileTree.dataModel.getDataById(a))return;qc.editor.Operation.UPLOAD(a,"")}})},b.defineProperties(Jd.prototype,{sliderValue:{get:function(){return this._slider.value},set:function(a){this._slider.value=a}},searchValue:{get:function(){return this._searchField.value},set:function(a){this._searchField.value=a}}});var Kd=qc.editor.Service=function(a,b){fa.service=this,this._ip=a||"127.0.0.1",this._port=b||5002,this._url="http://"+this.ip+":"+this.port+"/",this._cookie=0,this._cbs={},this._cmds={};for(var c in Kd.prototype.cmds)Kd.prototype.cmds[c]()};Kd.prototype={},Kd.prototype.constructor=Kd,Kd.prototype.cmds=[],b.defineProperties(Kd.prototype,{ip:{get:function(){return this._ip}},port:{get:function(){return this._port}},url:{get:function(){return this._url}}}),Kd.prototype.connect=function(){console.log("** Connect to server, ip:",this.ip," port:",this.port,"**"),this.socket&&(this.socket.close(),this.socket=null);var a=this.socket,b=this,c=this.socket=io.connect("http://"+this.ip+":"+this.port);if(c.connection=this,a===this.socket)return this.socket;c.on("OPERATION_DONE",function(a,c){b._done(a,c)});for(var d in b._cmds)b._registerCmdToIO(d);return c.on("connect_failed",function(){alert(fa._("Connect failed"))}),c},Kd.prototype.request=function(a,b,c){return this.isConnected?(this._cookie++,"function"==typeof c&&(this._cbs[this._cookie]=c),this.socket.emit(a,this._cookie,b),!0):!1},b.defineProperty(Kd.prototype,"isConnected",{get:function(){return this.socket&&this.socket.connected}}),Kd.prototype.registerCmd=function(a){if("function"!=typeof a.main||"string"!=typeof a.name)throw new Error("消息处理器未正确定义。");this._cmds[a.name]&&console.error("消息处理器已经存在了！",a.name),this._cmds[a.name]=a},Kd.prototype._done=function(a,b){var c=this._cbs[a];c&&(c(b),delete this._cbs[a])},Kd.prototype._registerCmdToIO=function(a){var b=this;b.socket.on(a,function(c){var d=b._cmds[a];d.main.call(d,c)})};var Ld=m("qc.editor.ImageList",qc.editor.ItemList,function Pf(a){var b=this;Pf["super"].constructor.call(b,a),b.tileSize=48,b.selectionModel.on("selectionChange",function(){var a=b.selectionModel.selection;1===a.length&&(a=a[0]),b.emit(fa.e.SELECT_IMAGE,a)}),b.view.style.background="white",b.view.style.border="1px solid rgb(97, 97, 97)"},{_layout:"tile"});Ld.prototype.add=function(a,b,c,d,e,f){var g=new qc.editor.ItemNode;g.name=a,g.image=b,g.a("clipX",c),g.a("clipY",d),g.a("clipWidth",e),g.a("clipHeight",f),this.dataModel.add(g)},Ld.prototype.remove=function(a){for(var b=this.dataModel,c=b.datas,d=0;d<c.length;d++){var e=c[d];if(e.name===a){b.remove(e);break}}},b.defineProperties(Ld.prototype,{tileSize:{get:function(){return this._tileSize},set:function(a){var b=this._tileSize;b!==a&&(this.setPropertyValue("tileSize",a),this.itemWidth=a,this.itemHeight=a)}}}),Ld.prototype.calculateClientWidth=function(){return this.width-2},Ld.prototype.calculateClientHeight=function(){return this.height-2};var Md={name:"FILE_CHANGED",main:function(b){if(fa.bgLoad){var d=b.fileName;d&&fa.bgLoad.markForceLoad(b);var e=this,f=(new Date).getTime();f-e._fileChangeMutex<500&&e._timeoutID&&clearTimeout(e._timeoutID),e._fileChangeMutex=f,e._timeoutID=setTimeout(function(){delete e._fileChangeMutex,delete e._timeoutID,qc.editor.Operation.EXPLORE()},500);var g=d.replace(/\\/g,"/");0===g.indexOf("Assets/raw")&&/\.(png|gif|jpg|jpeg)/.test(g.toLowerCase())&&qc.widget.Default.setImage(fa.service.url+g,c);

var h={unlink:1,change:1,add:1,rename:1};if(h[b.event]&&d&&(d.indexOf("globalUrlMap.js")<0&&d.indexOf(".js")===d.length-3||d.indexOf(".css")===d.length-4)){if(null!=e._scriptTimeoutID)return;if(!fa.workable)return;e._scriptTimeoutID=setTimeout(function(){var b=[],c=[],f=function(a,d){a&&a.forEach(function(a){var e=a.siblings.indexOf(a);d?e=d+"/"+e:e+="",fa.hierarchy.isExpanded(a)&&b.push(e),fa.hierarchy.selectionModel.isSelected(a)&&c.push(e),f(a.children,e)})},g=fa.hierarchy.rootData;f(g.children,""),fa.storage.set("hierarchyExpandedDatas",b),fa.storage.set("hierarchySelectedDatas",c),!fa.windowFocused||fa.playing||fa.prefabInfo?(0===d.indexOf("Editor/")?fa.reloadEditorOnFocus=!0:fa.reloadSceneOnFocus=!0,delete e._scriptTimeoutID):(fa.e.emit(fa.e.JS_CHANGED),qc.editor.Operation.SAVE_CURR_SCENE(function(){0===d.indexOf("Editor/")?(fa.silentRefresh=!0,a.location.reload()):fa.scene.reload()}),delete e._scriptTimeoutID)},500)}}}};qc.editor.Service.prototype.cmds.push(function(a){return function(){fa.service.registerCmd(a)}}(Md));var Md={name:"NEW_VERSION_AVAILABLE",main:function(){fa.inspector&&fa.inspector.propertyView&&fa.inspector.propertyView.children[0]instanceof qc.editor.CheckForUpdatesEditor?fa.inspector.propertyView.children[0].queryLatestVersion(!1):qc.editor.version.checkLatestUpdates()}};qc.editor.Service.prototype.cmds.push(function(a){return function(){fa.service.registerCmd(a)}}(Md));var Md={name:"PROGRESS_UPDATE_VERSION",main:function(a){qc.editor.version.progressUpdateDialog(a.percent),a.percent<0&&qc.editor.version.showUpdateFailed(a.percent),a.percent<80?qc.editor.version.progressUpdateDialog(a.percent,fa._("Downloading...")):a.percent<90?qc.editor.version.progressUpdateDialog(a.percent,fa._("Backup current version...")):a.percent<100?qc.editor.version.progressUpdateDialog(a.percent,fa._("Completing update...")):(qc.editor.Operation.NOTIFY_UPDATE_MESSAGE_RECEIVED(),setTimeout(function(){qc.editor.version.showUpdateFinished()},1e3))}};qc.editor.Service.prototype.cmds.push(function(a){return function(){fa.service.registerCmd(a)}}(Md));var Md={name:"UPDATE_VERSION_RESULT",main:function(a){fa.project&&fa.notification.info(0!==a.result?fa._("Update failed, please try again later."):fa._("Updated successfully, restart the node.js server and refresh this page"))}};qc.editor.Service.prototype.cmds.push(function(a){return function(){fa.service.registerCmd(a)}}(Md));{qc.editor.Operation={}}qc.editor.Operation.ARCHIVE_VERSION=function(a,b){fa.service.request("ARCHIVE_VERSION",{version:a},b)},qc.editor.Operation.ASSET_TYPE=function(a,b){var c=function(a){b&&b(a)};fa.service.request("ASSET_TYPE",a,c)},qc.editor.Operation.CHECK_FOR_UPDATES=function(a,b){fa.service.request("CHECK_FOR_UPDATES",{needQuery:a},b)},qc.editor.Operation.CREATE_JS=function(a,b,c){b&&b.length&&(".js"!==b.slice(-3)&&(b+=".js"),fa.fileTree.dataModel.getDataById(a+"/"+b)||fa.service.request("CREATE_JS",{destDir:a,name:b},c))},qc.editor.Operation.CREATE_PROJECT=function(a,b){fa.service.request("CREATE_PROJECT",{path:a},function(a){a&&a.operRet===!0?b&&b(!0):b&&b(!1,a.reason)})},qc.editor.Operation.DEBUG=function(a,b){var c=function(a){fa.log.trace("DEBUG请求结果：{1}",a),b&&b(a)};fa.log.trace("Debug请求：{0}",a),fa.service.request("DEBUG",a,c)},qc.editor.Operation.DOWNSCALE_ANIMATION=function(a,b){var c,d=function(a){b&&b(a),fa.notification.info(fa._("Downscaling is done."))};if(a)c=[fa.fileTree.dataModel.getDataById(a)];else{if(c=fa.fileList.dataModel.selectionModel.selection,!c||!c.length)return void fa.notification.error(fa._("Please select an animation asset"));for(var e=0,f=c.length;f>e;e++)c[e]=c[e].treeData}for(var e=0,f=c.length;f>e;e++){var g=c[e];if(g){var h=g.resUUID,i=fa.project.findByUUID(h);if(i&&i.img&&i.json){var j=i.img,k=j.width/2,l=j.height/2,m=document.createElement("canvas");m.setAttribute("width",k),m.setAttribute("height",l);var n=m.getContext("2d");n.drawImage(j,0,0,k,l);var o=m.toDataURL();fa.service.request("DOWNSCALE_ANIMATION",{img:o,dir:i.url},d)}}}},qc.editor.Operation.EXPLORE=function(){var a=function(a){var b=fa.fileTree,c=fa.fileList,d=b.translateY,e=b.selection.slice(),f=b.expandedDatas;c.savePanelContext(),b.dataModel.clear(),b.constructTree(a);for(var g=0;g<f.length;g++){var a=b.dataModel.getDataById(f[g].id);a&&b.expand(a)}for(var h=[],g=0;g<e.length;g++){var a=b.dataModel.getDataById(e[g].id);a&&h.push(a)}h.length||(h=b.dataModel.roots[0]),b.selection=h,b.translateY=d,c.restorePanelContext(),fa.e.emit(fa.e.EXPLORE)};fa.service.request("EXPLORE",c,a)},qc.editor.Operation.GET_PLATFORM=function(a){var b=function(b){a&&a(b)};fa.service.request("GET_PLATFORM",null,b)},qc.editor.Operation.GET_SCENE_BACKUP_LIST=function(a,b){var c=function(a){b&&b(a)};fa.service.request("GET_SCENE_BACKUP_LIST",{name:a},c)},qc.editor.Operation.GET_SCRIPT_ORDER=function(a,b){var c=function(a){b&&b(a)};fa.service.request("GET_SCRIPT_ORDER",{basePath:a},c)},qc.editor.Operation.GET_USER_HOME_DIR=function(a){var b=function(b){a&&a(b)};fa.service.request("GET_USER_HOME_DIR",{},b)},qc.editor.Operation.IMPORT_RESOURCE=function(a,b,c,d){var e=function(a){d&&d(a)};fa.service.request("IMPORT_RESOURCE",{dir:a,binName:b,files:c},e)},qc.editor.Operation.INSTALL_PLUGIN=function(a,b,c,d){fa.service.request("INSTALL_PLUGIN",{pluginId:a,version:b,session:c},d)},qc.editor.Operation.LIST_DIR=function(a,b){var c=function(a){b&&b(a)};fa.service.request("LIST_DIR",a,c)},qc.editor.Operation.MKDIR=function(a,b){var c=function(a){a.operRet?fa.notification.info(fa._("Folder created")):fa.notification.error(fa._("Failed to create folder")),b&&b(a)};fa.service.request("MKDIR",{dir:a},c)},qc.editor.Operation.MOVE=function(a,b,c){var d=a.lastIndexOf(a.indexOf("\\")>=0?"\\":"/"),e=b+"/"+a.substr(d+1);qc.editor.Operation.RENAME(a,e,c)},qc.editor.Operation.NEW_SCENE=function(){if(fa.prefabInfo)return void fa.notification.warn(fa._("Stop editing prefab first"));var a=function(){fa.service.request("NEW_SCENE",!0,function(){fa.storage.set("switchScene","1"),fa.config.editor.currScene="",fa.scene.reload(),ib()})};return fa.playing?void nb(fa._("Stop running game?"),fa._("Confirm"),[{text:fa._("Stop"),key:"enter",onClick:function(){this.hide(),fa.playing=!1;var b=function(){a(),fa.e.off(fa.e.GAME_CHANGE,b)};fa.e.on(fa.e.GAME_CHANGE,b)}},{text:fa._("Cancel"),key:"esc",onClick:function(){this.hide()}}]):void mb(a)},qc.editor.Operation.NOTIFY_UPDATE_MESSAGE_RECEIVED=function(a){fa.service.request("NOTIFY_UPDATE_MESSAGE_RECEIVED",{},a)},qc.editor.Operation.OPEN_JS=function(b){var c=/^(127\.0\.0\.1|localhost|192.168.*)(:\d+|)$/.test(a.location.host);c&&fa.service.request("OPEN_JS",b)},qc.editor.Operation.OPEN_PROJECT=function(a,b){fa.service.request("OPEN_PROJECT",{path:a},function(a){a&&a.operRet===!0?b&&b(!0):b&&b(!1)})},qc.editor.Operation.PUBLISH=function(a){var b=function(b){b&&b.operRet?fa.notification.info(fa._("Publish succeeded")):fa.notification.error(fa._("Publish failed:")+(b.reason?"，"+b.reason:"。")),a&&a(b)};fa.service.request("PUBLISH",{},b)},qc.editor.Operation.QUERY_EDITORSERVICE_SETTING=function(a,b){var c=function(a){a&&a.operRet===!1&&a.reason&&fa.notification.error(a.reason),b&&b(a)};fa.service.request("QUERY_EDITORSERVICE_SETTING",{key:a},c)},qc.editor.Operation.QUERY_PLUGIN_INFO=function(a){fa.service.request("QUERY_PLUGIN_INFO","",a)},qc.editor.Operation.QUERY_PLUGIN_SCRIPT=function(a,b){fa.service.request("QUERY_PLUGIN_SCRIPT",{id:a},b)},qc.editor.Operation.QUERY_SETTINGS=function(a){var b=function(b){fa.config=b,a&&a()};fa.service.request("QUERY_SETTINGS","",b)},qc.editor.Operation.RECENT_OPEN=function(a,b){fa.service.request("RECENT_OPEN",{checkTempScene:b},function(b){var c;b&&b.operRet===!0?c=b.resent:(c=[],fa.notification.error(fa._("Failed to fetch recent projects list")));var d=b.checkRet;a&&a(c,d,b.unsaved)})},qc.editor.Operation.REMOVE=function(a){var b=function(a){a.operRet?fa.notification.info(fa._("Remove completed")):fa.notification.error(fa._("Remove failed:")+a.reason)};fa.service.request("REMOVE",a,b)},qc.editor.Operation.REMOVE_BIN=function(a){var b=function(){};fa.service.request("REMOVE_BIN",a,b)},qc.editor.Operation.REMOVE_RECENT_OPEN=function(a,b){fa.service.request("REMOVE_RECENT_OPEN",{path:a},function(a){a||(a={operRet:!1},fa.notification.error(fa._("Failed to fetch recent projects list"))),b&&b(a)})},qc.editor.Operation.RENAME=function(a,b,c){var d=function(a){fa.notification.info(fa._("Rename succeeded")),c&&c(a)};fa.service.request("RENAME",{old:a,"new":b},d)},qc.editor.Operation.REVEAL_IN_FINDER=function(a,b){fa.service.request("REVEAL_IN_FINDER",{path:a},function(a){a&&a.operRet===!0?b&&b(!0):b&&b(!1)})},qc.editor.Operation.REVERT_SCENE_TO_REVISION=function(a,b,c){var d=function(a){a&&a.operRet===!1&&a.reason&&fa.notification.error(a.reason),c&&c(a)};fa.service.request("REVERT_SCENE_TO_REVISION",{state:a,version:b},d)},qc.editor.Operation.REVERT_TO_DRAGONBONES=function(a,b){var c=function(a){var c=a&&a.operRet===!0;c?fa.notification.info("Revert to Dragonbones successfully."):fa.notification.warn(a&&a.reason?a.reason:fa._("Operate Failed")),b&&b(c)};fa.service.request("REVERT_TO_DRAGONBONES",{path:a},c)},qc.editor.Operation.SAMPLE_DRAGON_BONES=function(a,b,d){var e,f=function(a){fa.notification.info(fa._("DragonBone({0}) sampling is done"),e),d&&d(a)},g=function(a){var b=[],c=function(a,d,e,f,g,h,i){a.children.forEach(function(a){var j,k,l,m,n,o;if("qc.UIImage"===a["class"]){var p=a.phaser,q=a.pivotX,r=a.pivotY;if(isNaN(q)||isNaN(r))return;var s=Math.cos(a.skewY||0),t=Math.sin(a.skewY||0),u=-Math.sin(a.skewX||0),v=Math.cos(a.skewX||0),w=p.position.x,x=p.position.y,y=Math.sin(p.rotation),z=Math.cos(p.rotation),A=z*p.scale.x,B=y*p.scale.x,C=-y*p.scale.y,D=z*p.scale.y,E=0,F=0;j=A*s+B*u,k=A*t+B*v,l=C*s+D*u,m=C*t+D*v,n=E*s+F*u+w,o=E*t+F*v+x;var G=j,H=l,I=n;j=j*d+k*f,k=G*e+k*g,l=l*d+m*f,m=H*e+m*g,n=n*d+o*f+h,o=I*e+o*g+i;var J=function(a){return Math.floor(1e3*a)/1e3};b.push({uuid:a.uuid,frame:a.frame},J(j),J(k),J(l),J(m),J(n),J(o),J(q),J(r),Math.floor(255*a.alpha))}else{var y=Math.sin(a.rotation),z=Math.cos(a.rotation);j=z*a.scaleX,k=y*a.scaleX,l=-y*a.scaleY,m=z*a.scaleY,n=a.x,o=a.y;var G=j,H=l,I=n;j=j*d+k*f,k=G*e+k*g,l=l*d+m*f,m=H*e+m*g,n=n*d+o*f+h,o=I*e+o*g+i}c(a,j,k,l,m,n,o)})};return c(a,1,0,0,1,0,0),b},h=function(a,b){var c=a.phaser.texture.baseTexture.width,d=a.phaser.texture.baseTexture.height,e=a.texture.getFrame(b),f=e.width,g=e.height,h=e.x,i=e.y;return[h/c,i/d,(h+f)/c,(i+g)/d]},i=function(a,b){for(var d={uvs:[],samples:{}},e=a.animationNameList,f=d.samples,i=0,j=e.length;j>i;i++){var k=e[i],l=8,m=[];f[k]={loop:0===a.getAnimationInfo(k).loop?!0:!1,rate:b,frames:m},a._armature.animation.gotoAndPlay(k,0,c,1),a._armature.advanceTime(0),m.push(g(a));for(var n=0;!a.isComplete&&a.lastAnimationName===k;){for(n=0;l>n&&(a._armature.advanceTime(1/(l*b)),!a.isComplete&&a.lastAnimationName===k);n++);m.push(g(a))}f[k].last=(m.length-2)*l+2+n}for(var o,p=[],q=[],i=0,j=e.length;j>i;i++)for(var k=e[i],m=f[k].frames,r=0,s=m.length;s>r;r++)for(var t=m[r],u=0,v=t.length;v>u;u+=10){var w=t[u],x=w.uuid,y=p.indexOf(x);y>=0?t[u]=y:(p.push(x),q.push(w.frame),t[u]=p.length-1)}o=d.uvs=new Array(4*q.length);for(var i=0,j=q.length;j>i;i++){var z=h(a,q[i]);o[4*i+0]=z[0],o[4*i+1]=z[1],o[4*i+2]=z[2],o[4*i+3]=z[3]}return d};lb(fa._("Sample Frame Rate(1-60, default 15)"),"15",function(c){if(!c)return void(b&&b(!1));if(c=Math.round(1*c),isNaN(c)||c>60||0>=c)return fa.notification.error(fa._("Please input an integer between 1 - 60")),void(b&&b(!1));var d,g;if("qc.Sprite"===a["class"])d=a;else{var d=fa.hiddenGame.add.sprite();d.texture=a,g=!0}e=d.texture.url,fa.service.request("SAMPLE_DRAGON_BONES",{path:e,samples:i(d,c)},f),g&&d.destroyImmediately(),b&&b(!0)})},qc.editor.Operation.SAVE_ATLAS=function(a,b,c,d){var e=function(a){d&&d(a)};fa.service.request("SAVE_ATLAS",{atlasName:a,imageContent:b,json:c},e)},qc.editor.Operation.SAVE_CURR_SCENE=function(a){if(fa.workable){if(fa.prefabInfo)return void(a&&a());if(!fa.scene.editable)return void(a&&a());if(!fa.sceneManager.dirty)return void(a&&a());var b={},c=fa.game.serializer.buildBundle(fa.game.world,b);c.dependences=fa.game.serializer.combineDependence(b);var d=function(){a&&a()};fa.sceneManager.dirty=!1,fa.sceneManager.unsaved=!0,console.log("temporary scene have changed, save it."),fa.service.request("SAVE_CURR_SCENE",{data:c},d)}},qc.editor.Operation.SAVE_EDITORSERVICE_SETTING=function(a,b,c){var d=function(a){a&&a.operRet===!1&&a.reason&&fa.notification.error(a.reason),c&&c(a)};fa.service.request("SAVE_EDITORSERVICE_SETTING",{key:a,value:b},d)},qc.editor.Operation.SAVE_PADDING=function(a,b,c,d){var e=function(a){d&&d(a)};fa.service.request("SAVE_PADDING",{texturePath:a,frame:b,padding:c},e)},qc.editor.Operation.SAVE_PLUGIN_INFO=function(a,b){var c=function(a){b&&b(a)};fa.service.request("SAVE_PLUGIN_INFO",{data:a},c)},qc.editor.Operation.SAVE_PREFAB=function(a,b){if(a!==fa.game.world){var c={},d=fa.game.serializer.buildBundle(a,c);d.dependences=fa.game.serializer.combineDependence(c);var e=function(b){a._prefab=b,fa.notification.info(fa._("Prefab saved"))};fa.service.request("SAVE_PREFAB",{path:b,data:d},e)}},qc.editor.Operation.SAVE_SCENE=function(a){if(fa.workable){if(fa.prefabInfo)return void fa.notification.warn(fa._("Stop editing prefab first"));var b={},c=fa.game.serializer.buildBundle(fa.game.world,b);c.dependences=fa.game.serializer.combineDependence(b);var d=function(){fa.notification.info(fa._("Scene saved")),fa.e.emit(fa.e.SCENE_SAVED,a)};fa.sceneManager.unsaved=!1,fa.sceneManager.dirty=!1,fa.service.request("SAVE_SCENE",{data:c,name:a},d)}},qc.editor.Operation.SET_SCRIPT_ORDER=function(a,b,c){var d=function(a){c&&c(a)};fa.service.request("SET_SCRIPT_ORDER",{basePath:a,order:b},d)},qc.editor.Operation.SOURCE=function(a,b){fa.service.request("SOURCE",a,b)},qc.editor.Operation.SWITCH_SCENE=function(a){if(fa.prefabInfo)return void fa.notification.warn(fa._("Stop editing prefab first"));var b=function(){fa.sceneManager.unsaved=!1,fa.sceneManager.dirty=!1,fa.service.request("SWITCH_SCENE",a,function(){fa.storage.set("switchScene","1"),fa.config.editor.currScene=a,fa.scene.reload(),ib()})};if(fa.playing){var c=function(){this.hide(),fa.playing=!1;var a=function(){b(),fa.e.off(fa.e.GAME_CHANGE,a)};fa.e.on(fa.e.GAME_CHANGE,a)};return void nb(fa._("Stop running game?"),fa._("Confirm"),[{text:fa._("Stop"),key:"enter",onClick:c},{text:fa._("Cancel"),key:"esc",onClick:function(){this.hide()}}])}mb(b)},qc.editor.Operation.UPDATE_EDITOR_SETTINGS=function(a){fa.service.request("UPDATE_EDITOR_SETTINGS",a)},qc.editor.Operation.UPDATE_PROJECT_SETTINGS=function(a){fa.service.request("UPDATE_PROJECT_SETTINGS",a)},qc.editor.Operation.UPDATE_SCENE_SETTINGS=function(a){var b=function(a){fa.config.scene=a};fa.service.request("UPDATE_SCENE_SETTINGS",a,b)},qc.editor.Operation.UPDATE_VERSION=function(a){fa.service.request("UPDATE_VERSION","",a)},qc.editor.Operation.UPLOAD=function(a,b,c){fa.service.request("UPLOAD",{path:a,content:b},c)};var Nd=qc.editor.BgLoad=function(){fa.bgLoad=this,this.gameSceneForceLoad={},this.gameSceneDownloadList={},this.hiddenSceneForceLoad={},this.hiddenSceneDownloadList={},fa.e.on(fa.e.HIDDEN_SCENE_LOADED,this.tryHiddenSceneDownload);var a=this;fa.e.on(fa.e.GAME_CHANGE,function(){a.canGameSceneDownload=!1}),fa.e.on(fa.e.SCENE_LOADED,function(){a.canGameSceneDownload=!0,a.tryGameSceneDownload()})};Nd.prototype={},Nd.prototype.constructor=Nd,Nd.prototype.clearResources=function(){this.gameSceneDownloadList={},this.hiddenSceneDownloadList={}},Nd.prototype.addResource=function(a,b,c){b.indexOf("@atlas")>=0||(c!==fa.ASSET_TYPE.ASSET_SCENE&&(this.gameSceneDownloadList[a]=b),this.hiddenSceneDownloadList[a]=b,this.tryHiddenSceneDownload(),this.tryGameSceneDownload())},Nd.prototype.markForceLoad=function(a){var b=a.fileName.replace(/\\/g,"/");this.gameSceneForceLoad[b]=a,this.hiddenSceneForceLoad[b]=a},Nd.prototype.tryHiddenSceneDownload=function(){var a=fa.bgLoad,b=(new Date).getTime();b-a._hiddenSceneLoadMutex<100||(a._hiddenSceneLoadMutex=b,setTimeout(function(){delete a._hiddenSceneLoadMutex,a._startHiddenSceneDownload()},100))},Nd.prototype._startHiddenSceneDownload=function(){var a=this;if(!fa.service.isConnected||!fa.hiddenGame)return void a.tryHiddenSceneDownload();var c=a.hiddenSceneDownloadList;if(b.keys(c).length){var d=a.hiddenSceneForceLoad,e=fa.hiddenGame.assets;this._download(e,c,d)}},Nd.prototype.tryGameSceneDownload=function(){var a=fa.bgLoad,b=(new Date).getTime();b-a._gameSceneLoadMutex<100||(a._gameSceneLoadMutex=b,setTimeout(function(){delete a._gameSceneLoadMutex,a._startGameSceneDownload()},100))},Nd.prototype._startGameSceneDownload=function(){var a=this,c=!0;do{if(!fa.workable)break;if(!fa.scene.editable)return;if(!fa.scene||!a.canGameSceneDownload)break;if(!fa.service.isConnected)break;c=!1}while(!1);if(c)return void a.tryGameSceneDownload();var d=a.gameSceneDownloadList;if(b.keys(d).length){var e=a.gameSceneForceLoad,f=fa.game.assets;this._download(f,d,e)}},Nd.prototype._download=function(a,c,d){var e={},f=function(b){if(fa.workable){if(a!==fa.game.assets){if(!e[b.uuid])return;return void fa.e.emit(fa.e.BG_RESOURCE_LOADED,b)}if(b instanceof qc.Atlas||b instanceof qc.Prefab||b instanceof qc.SoundAsset){var c=b.uuid;if(e[c]){var d,f=function(a){var d=a.scripts;if(d&&d.length)for(var e=0,f=d.length;f>e;e++){var g=d[e];for(var h in g)g[h]&&g[h].key===c&&(g[h]=b)}};d=b instanceof qc.Atlas?function(a){if(a.texture&&a.texture.uuid===c){var d;if(a.animationType===qc.Sprite.FRAME_ANIMATION){var e=a.phaser.animations.currentAnim;if(e&&e.isPlaying){var g=a._animation[e.name],h=g&&g.rate?g.rate:60;d={name:e.name,loop:e.loop,speed:a._speed/h}}}if(a.texture=b,a.frame=a.frame,a.animationType===qc.Sprite.FRAME_ANIMATION){var i=a.phaser.animations._anims;for(var j in i)delete i[j];a.phaser.animations._anims={},d&&a.animationNameList.indexOf(d.name)>=0&&a.playAnimation(d.name,d.speed,d.loop)}}f(a)}:f,fa.project.exploreTree(d,fa.game.world),fa.e.emit(fa.e.SCENE_RESOURCE_LOADED,b)}}}};b.keys(c).forEach(function(b){var g=c[b];if(a.addUrlConf(b,g),d[g]){var h=d[g];delete d[g],h.exist?(e[b]=!0,a.load(b,g,f,!0)):(delete a._assets[g],delete c[b])}else a.find(b,g)||(e[b]=!0),a.load(b,g,f)})};var Od=qc.editor.HiddenScene=function(){var a=this._iframe=document.createElement("iframe");a.src="StartHiddenScene.html",navigator.userAgent.indexOf("Firefox")>0?a.style.visibility="hidden":a.style.display="none",a.style.position="absolute",document.body.appendChild(a),fa.hiddenScene=this,fa.e.on(fa.e.HIDDEN_SCENE_INITED,function(a){fa.hiddenGame=a.game,fa.e.emit(fa.e.HIDDEN_SCENE_LOADED)})};Od.prototype={},Od.prototype.constructor=Od,fa.qcplay=1,fa.extend=new qc.editor.Extend,fa.initCodeEditor=function(){var a=fa.localize=new qc.editor.Localize("en");fa._=function(b){return a._.call(a,b)},fa.log=new ca,fa.log.enableTrace=!0,fa.notification=new Pb;var b=function(){qc.editor.VERSION=fa.config.editorVersion,fa.storage=new ia(fa.config.project.projectName),fa.preference=new Qb,fa.localize.language=fa.storage.get("language")||"en",fa.skin="Light"===fa.storage.get("skin")?"Light":"Dark";var a=fa.skinManager=new ba;a.registerCodeEditorIcons(),a.overrideSizeMethod(),a.initTheme(),a.page="CodeEditor",a.skin=fa.skin,fa._initCodeEditorLayout()};fa._initService(b)},fa._initCodeEditorLayout=function(){var b=new qc.widget.Container,c=b.layout=new qc.widget.layout.BorderLayout(b);c.topResizable=!1,c.topToggleVisible=!1,c.splitterSize=1,c.splitterColor="rgb(100, 101, 105)";var d=new qc.editor.Button({text:fa._("Save"),padding:0,borderWidth:0,preferredSize:{width:70}}),e=new qc.widget.Toolbar;e.setItems([d]);var f=a.codePane=new qc.editor.CodePane,g=$("filePath");g&&g.indexOf(".css")===g.length-4&&(f.mode="css"),qc.editor.Operation.SOURCE(g,function(b){f.value=b.source,f.editor.on("change",function(){a.codePaneValueChanged=!0})});var h=a.saveCode=function(b){b&&b.preventDefault(),qc.editor.Operation.UPLOAD(g,f.value),fa.notification.info(fa._("Code Saved")),a.codePaneValueChanged=!1};d.on("click",h),qc.widget.Mousetrap.bind("mod+s",h),b.setItems([{region:"top",height:28,element:e},{region:"center",element:f}]),b.addToDOM(),U(function(){f.editor.focus()}),document.title=g},fa.initProject=function(){var a=fa.localize=new qc.editor.Localize("en");fa._=function(b){return a._.call(a,b)},fa.log=new ca,fa.log.enableTrace=!0,fa.notification=new Pb;var b=function(){qc.editor.VERSION=fa.config.editorVersion,fa.storage=new ia(fa.config.project.projectName),fa.localize.language=fa.storage.get("language")||"en",fa.preference=new Qb,fa.skin="Light"===fa.storage.get("skin")?"Light":"Dark";var a=fa.skinManager=new ba;a.registerProjectIcons(),a.overrideSizeMethod(),a.initTheme(),a.page="Project",a.skin=fa.skin,fa._initProjectLayout(),qc.editor.version.checkLatestUpdates()};fa._initService(function(){qc.editor.Operation.GET_PLATFORM(function(a){fa.platform=a}),qc.editor.Operation.GET_USER_HOME_DIR(function(a){fa.userHome=a}),qc.editor.Operation.RECENT_OPEN(function(a){a&&a.length>0?(fa.projectPath=a[0],b()):qc.editor.Operation.GET_USER_HOME_DIR(function(a){fa._defaultProjectPath=k.isMac?a+"/":a+"\\",b()})})})},fa._initProjectLayout=function(){fa.mainContainer=new qc.widget.Container;var a=fa.mainContainer.layout=fa.mainLayout=new qc.widget.layout.BorderLayout(fa.mainContainer);a.spliterColor="rgb(100, 101, 105)",a.splitterSize=2,a.leftToggleVisible=!1,a.leftResizable=!1,fa.actionPane=new qc.editor.ProjectActionPane,fa.mainContainer.setItems([{region:"left",width:300,element:fa.actionPane}]),fa.mainContainer.addToDOM()},fa.init=function(){a.name="",a.addEventListener("focus",function(){fa.windowFocused=!0,fa.checkReloadForJsChange()}),a.addEventListener("blur",function(){fa.windowFocused=!1}),k.onDialogClosed=function(){fa.activeView&&fa.activeView.requestFocus()},k.onContextMenuClose=function(){document.activeElement===document.body&&fa.activeView&&fa.activeView.requestFocus()},fa.initOk=!1,qc.widget.DataModel.prototype._indexAdjustable=!1;var b=fa.localize=new qc.editor.Localize("en");fa._=function(a){return b._.call(b,a)},fa.ASSET_TYPE={ASSET_SCENE:1,ASSET_PREFAB:2,ASSET_ATLAS:3,ASSET_TEXT:4,ASSET_FONT:5,ASSET_SOUND:6,ASSET_EXCEL:7,ASSET_WEBFONT:8,ASSET_JS:100,ASSET_UNKNOWN:101},fa.log=new ca,fa.log.enableTrace=!0,fa.clipboard=new ga,fa.notification=new Pb,fa.undo=new Lb;var c=function(){if(qc.editor.VERSION=fa.config.editorVersion,/Chrome/.test(a.navigator.userAgent)){var b=["%c♥ %c %c %c QICI Engine v"+qc.editor.VERSION+"  %c %c %c %c http://www.qiciengine.com %c %c http://www.zuoyouxi.com/ %c %c♥","color: #ff2424; background: #fff","background: #9854d8","background: #6c2ca7","color: #ffffff; background: #450f78;","background: #6c2ca7","background: #9854d8","background: #ffffff","color: #FFD100; background: #242424;","background: #ffffff","color: #FFD100; background: #242424;","background: #ffffff","color: #ff2424; background: #fff"];console.log.apply(console,b)}fa.editMode=fa.storage.get("editMode")?fa.storage.get("editMode"):"default",fa.gridVisible=null!=fa.storage.get("gridVisible")?fa.storage.get("gridVisible"):!0,fa.playing=!1;var c=fa.storage.get("gameSizeValue");c&&null!=fa.rightBanner.findViewById("gameSize")._map[c]&&(fa.rightBanner.gameSize={size:fa.storage.get("gameSize"),value:c});var d=function(){for(var a=fa.fileTree.dataModel.datas,b=0;b<a.length;b++){var c=a[b];if("state"===c.name&&c.parent&&"Assets"===c.parent.name&&c.parent.predefined){fa.fileTree.expand(c),fa.fileTree.selectionModel.selection=c;break}}fa.e.off(fa.e.SCENE_LOADED,d)};fa.e.on(fa.e.SCENE_LOADED,d),fa.e.on(fa.e.SCENE_LOADED,function(){fa.windowDisabled=!1,fa.scene.fitContent(!1),setTimeout(function(){fa.workable&&("1"===fa.storage.get("switchScene")||"1"===fa.storage.get("switchProject"))&&(fa.storage.set("switchScene","0"),fa.storage.set("switchProject","0"))},50);var a=fa.storage.get("hierarchyExpandedDatas"),b=fa.storage.get("hierarchySelectedDatas");a&&(a.forEach(function(a){for(var b=fa.hierarchy.rootData,c=a.split("/"),d=0;d<c.length&&b;d++){var e=c[d];b=b.children[e]}b&&fa.hierarchy.expand(b)}),fa.storage.del("hierarchyExpandedDatas")),b&&(b.forEach(function(a){for(var b=fa.hierarchy.rootData,c=a.split("/"),d=0;d<c.length&&b;d++){var e=c[d];b=b.children[e]}b&&fa.hierarchy.selectionModel.appendSelection(b)}),fa.storage.del("hierarchySelectedDatas"))}),fa.texturePacker=new qc.editor.TexturePacker,new qc.editor.HiddenScene,new qc.editor.BgLoad,qc.editor.Operation.EXPLORE(),fa.extend.init(),fa.initOk=!0},d=function(a){a&&a.length>0?(fa.projectPath=a[0],ib(),c()):qc.editor.Operation.GET_USER_HOME_DIR(function(a){fa._defaultProjectPath=k.isMac?a+"/":a+"\\",ib(),c()})},e=function(a){var b=fa.config.editor.currScene;b||(b=fa.config.scene.entryScene),b?fa.service.request("SWITCH_SCENE",b,function(){var b=d.bind(null,a);qc.editor.Operation.QUERY_SETTINGS(b)}):d(a)};fa._initService(function(){qc.editor.Operation.GET_PLATFORM(function(a){fa.platform=a}),qc.editor.Operation.GET_USER_HOME_DIR(function(a){fa.userHome=a}),qc.editor.Operation.RECENT_OPEN(function(a,b,c){if(fa._initLayout(),fa.preference=new Qb,fa.sceneManager=new qc.editor.SceneManager,fa.sceneManager.unsaved=c,2==b){var f="Assets/state/"+fa.config.editor.currScene+".state "+fa._("Scene file changed");nb(f,fa._("Warning"),[{text:fa._("Reload"),onClick:function(){this.hide(),e(a)}},{text:fa._("Cancel"),onClick:function(){this.hide(),d(a)}}])}else 1==b?e(a):d(a)},!0)})},fa._initLayout=function(){fa.storage=new ia(fa.config.project.projectName),fa.storage.get("switchProject")||fa.storage.set("switchProject","1"),fa.localize.language=fa.storage.get("language")||"en",fa.orientation="Landscape"===fa.storage.get("orientation")?"Landscape":"Portrait",fa.skin="Light"===fa.storage.get("skin")?"Light":"Dark";var b=fa.skinManager=new ba;b.page="Editor",b.registerIcons(),fa.dragAndDrop=new ha,b.overrideSizeMethod(),b.initTheme(),fa.mainContainer=new qc.editor.LayoutContainer,fa.menu=new qc.editor.Menu,fa.mainContainer.add("menu",qc.editor.LayoutContainer.TOP_MENU,fa.menu),fa.leftBanner=new qc.editor.LeftBanner,fa.mainContainer.add("leftBanner",qc.editor.LayoutContainer.TOP_LEFT,fa.leftBanner),fa.runBanner=new qc.editor.RunBanner,fa.mainContainer.add("runBanner",qc.editor.LayoutContainer.TOP_RUN,fa.runBanner),fa.middleBanner=new qc.editor.MiddleBanner,fa.mainContainer.add("middleBanner",qc.editor.LayoutContainer.TOP_MIDDLE,fa.middleBanner),fa.rightBanner=new qc.editor.RightBanner,fa.mainContainer.add("rightBanner",qc.editor.LayoutContainer.TOP_RIGHT,fa.rightBanner),fa.inspector=new qc.editor.Inspector,fa.inspector.title="Inspector    ",fa.inspector.icon="inspector",fa.mainContainer.add("inspector",qc.editor.LayoutContainer.INSPECTOR,fa.inspector),fa.project=new qc.editor.Project,fa.project.title="Project    ",fa.project.icon="project",fa.mainContainer.add("project",qc.editor.LayoutContainer.PROJECT,fa.project);var c=new Ub;fa.hierarchy=c._hierarchy,fa.hierarchyContainer=c,fa.hierarchy.id="hierarchy",c.title="Hierarchy    ",c.icon="hierarchy",fa.mainContainer.add("hierarchyContainer",qc.editor.LayoutContainer.HIERARCHY,c),fa.scene=new qc.editor.Scene,fa.ruler=new Ob(fa.scene),fa.mainContainer.add("scene",qc.editor.LayoutContainer.SCENE,fa.ruler),fa.mainContainer.addToDOM(),fa.mainContainer.view.addEventListener("contextmenu",function(a){fa.menu.view.contains(a.target)||Eb(a.target)||a.preventDefault()}),fa.mainContainer.orientation=fa.orientation,fa.storage.get("layout")&&fa.mainContainer.deserialize(JSON.parse(fa.storage.get("layout"))),fa.project.sliderValue=fa.storage.get("project_list")||17;var d=fa.storage.get("preview_expand"),e=fa.storage.get("preview_height");fa.inspector.layout.setExpanded("bottom",null==d?!0:d),fa.inspector.layout.bottomHeight=null==e?200:e,a.addEventListener("keydown",function(a){E(a)&&!Eb(a.target)&&a.preventDefault()},!1),a.onbeforeunload=function(){return fa.storage.set("layout",fa.mainContainer.serialize()),fa.storage.set("project_list",fa.project.sliderValue),fa.storage.set("preview_expand",fa.inspector.layout.isExpanded("bottom")),fa.storage.set("preview_height",fa.inspector.layout.bottomHeight),fa.silentRefresh?void 0:fa._("Close Tip")},b.skin=fa.skin},fa._initService=function(b){new qc.editor.Service(a.location.hostname,a.location.port),fa.service.connect();var c=function(){fa.service.isConnected?(console.log("** Connected."),qc.editor.Operation.QUERY_SETTINGS(b)):setTimeout(c,100)};c()}}}(this,Object);